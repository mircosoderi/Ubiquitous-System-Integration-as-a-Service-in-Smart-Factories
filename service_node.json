[{"id":"a82c65ac.c0b378","type":"tab","label":"Configuration","disabled":false,"info":""},{"id":"d4b094b8.7dbbe8","type":"tab","label":"Business Logic","disabled":false,"info":""},{"id":"3293da1d.80b076","type":"subflow","name":"transformation","info":"","category":"","in":[],"out":[],"env":[],"meta":{},"color":"#DDAA99"},{"id":"b1a419c1.609c28","type":"tls-config","name":"tls-config nr adm","cert":"","key":"","ca":"","certname":"","keyname":"","caname":"","servername":"","verifyservercert":false},{"id":"51b09598.a1114c","type":"tls-config","name":"tls-config cfg acl","cert":"","key":"","ca":"${CFG_ACL_CACE}","certname":"","keyname":"","caname":"","servername":"","verifyservercert":true},{"id":"76b04a6c.232224","type":"tls-config","name":"tls-config nr lib","cert":"","key":"","ca":"${NRLIB_CACE}","certname":"","keyname":"","caname":"","servername":"","verifyservercert":true},{"id":"4135546e.32de0c","type":"tls-config","name":"status tls config","cert":"/data/alerter.pem","key":"/data/alerter.key","ca":"/data/ca.pem","certname":"","keyname":"","caname":"","servername":"Server certificate","verifyservercert":true},{"id":"2146b471.31764c","type":"mqtt-broker","name":"status broker","broker":"emqx","port":"8883","tls":"4135546e.32de0c","clientid":"","usetls":true,"protocolVersion":"4","keepalive":"60","cleansession":true,"birthTopic":"","birthQos":"0","birthPayload":"","birthMsg":{},"closeTopic":"","closeQos":"0","closePayload":"","closeMsg":{},"willTopic":"","willQos":"0","willPayload":"","willMsg":{},"sessionExpiry":""},{"id":"15158cee.ee8ac3","type":"http in","z":"a82c65ac.c0b378","name":"PUT broker","url":"/node/:nodeName/broker","method":"put","upload":false,"swaggerDoc":"","x":90,"y":40,"wires":[["e19fe8b0.7f5918"]]},{"id":"a40eecc9.1106f","type":"change","z":"a82c65ac.c0b378","name":"","rules":[{"t":"set","p":"payload","pt":"msg","to":"broker","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":2420,"y":40,"wires":[["6e179684.9cc078"]]},{"id":"c4b28a8c.da37d8","type":"http in","z":"a82c65ac.c0b378","name":"GET broker","url":"/node/:nodeName/broker","method":"get","upload":false,"swaggerDoc":"","x":90,"y":140,"wires":[["9d358b52.2b27f8"]]},{"id":"98bc7ddc.42f2a","type":"http response","z":"a82c65ac.c0b378","name":"","statusCode":"","headers":{},"x":2470,"y":140,"wires":[]},{"id":"9471c10d.7f9c4","type":"http in","z":"a82c65ac.c0b378","name":"PUT topic","url":"/node/:nodeName/topic","method":"put","upload":false,"swaggerDoc":"","x":80,"y":240,"wires":[["c2da6857.cb6978"]]},{"id":"b52500b1.a1d93","type":"http response","z":"a82c65ac.c0b378","name":"","statusCode":"","headers":{},"x":3770,"y":240,"wires":[]},{"id":"2700b9d8.8d2df6","type":"http in","z":"a82c65ac.c0b378","name":"GET topic","url":"/node/:nodeName/topic","method":"get","upload":false,"swaggerDoc":"","x":80,"y":340,"wires":[["9a11955b.4b1608"]]},{"id":"4115639a.c182cc","type":"http response","z":"a82c65ac.c0b378","name":"","statusCode":"","headers":{},"x":3150,"y":340,"wires":[]},{"id":"5593b867.5a1508","type":"http in","z":"a82c65ac.c0b378","name":"PUT status","url":"/node/status","method":"put","upload":false,"swaggerDoc":"","x":80,"y":440,"wires":[["9d84aaf9.846de8"]]},{"id":"f856bc7.769d54","type":"http response","z":"a82c65ac.c0b378","name":"","statusCode":"","headers":{},"x":4270,"y":440,"wires":[]},{"id":"bff16a12.83eaf8","type":"http in","z":"a82c65ac.c0b378","name":"GET status","url":"/node/status","method":"get","upload":false,"swaggerDoc":"","x":80,"y":540,"wires":[["800b40ab.7c832"]]},{"id":"f5635461.f1eb08","type":"http response","z":"a82c65ac.c0b378","name":"","statusCode":"","headers":{},"x":3130,"y":540,"wires":[]},{"id":"1904bdda.a75392","type":"http request","z":"a82c65ac.c0b378","name":"get single flow","method":"GET","ret":"obj","paytoqs":"ignore","url":"https://localhost:1880/flow/{{flowId}}","tls":"b1a419c1.609c28","persist":false,"proxy":"","authType":"","x":2840,"y":440,"wires":[["7ce41ee8.19cc"]]},{"id":"24f5ee8a.c60c92","type":"change","z":"a82c65ac.c0b378","name":"","rules":[{"t":"set","p":"flowStatus","pt":"msg","to":"true","tot":"bool"}],"action":"","property":"","from":"","to":"","reg":false,"x":610,"y":420,"wires":[["154f7e56.335e92"]]},{"id":"8442b573.e3aee8","type":"http request","z":"a82c65ac.c0b378","name":"get flows","method":"GET","ret":"obj","paytoqs":"ignore","url":"https://localhost:1880/flows","tls":"b1a419c1.609c28","persist":false,"proxy":"","authType":"","x":2160,"y":440,"wires":[["e4c2bd92.78eec"]]},{"id":"fd1c84bb.5a01e8","type":"change","z":"a82c65ac.c0b378","name":"get flowId by name","rules":[{"t":"set","p":"flowId","pt":"msg","to":"*[type = 'tab' and label ='Business Logic'].id","tot":"jsonata"}],"action":"","property":"","from":"","to":"","reg":false,"x":2490,"y":440,"wires":[["92ff8cc5.33047"]]},{"id":"64337c3b.76af44","type":"change","z":"a82c65ac.c0b378","name":"","rules":[{"t":"set","p":"payload.disabled","pt":"msg","to":"flowStatus","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":3210,"y":440,"wires":[["53f968e5.7001a8"]]},{"id":"9ab9a607.916a68","type":"http request","z":"a82c65ac.c0b378","name":"update flow","method":"PUT","ret":"obj","paytoqs":"ignore","url":"https://localhost:1880/flow/{{payload.id}}","tls":"b1a419c1.609c28","persist":false,"proxy":"","authType":"","x":3570,"y":440,"wires":[["92ce3886.99c0d8"]]},{"id":"3bbcbff4.c0d32","type":"switch","z":"a82c65ac.c0b378","name":"","property":"payload","propertyType":"msg","rules":[{"t":"eq","v":"off","vt":"str"},{"t":"eq","v":"on","vt":"str"},{"t":"else"}],"checkall":"true","repair":false,"outputs":3,"x":430,"y":440,"wires":[["24f5ee8a.c60c92"],["74f520b.73c58e"],["b3366c2.8b0c39"]]},{"id":"74f520b.73c58e","type":"change","z":"a82c65ac.c0b378","name":"","rules":[{"t":"set","p":"flowStatus","pt":"msg","to":"false","tot":"bool"}],"action":"","property":"","from":"","to":"","reg":false,"x":610,"y":460,"wires":[["154f7e56.335e92"]]},{"id":"96c43b53.ec4998","type":"change","z":"a82c65ac.c0b378","name":"","rules":[{"t":"set","p":"payload","pt":"msg","to":"status","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":3900,"y":440,"wires":[["15a2af0c.dd9361"]]},{"id":"b10f52ff.348f7","type":"change","z":"a82c65ac.c0b378","name":"","rules":[{"t":"set","p":"headers","pt":"msg","to":"{\"Content-Type\":\"text/plain\"}","tot":"json"}],"action":"","property":"","from":"","to":"","reg":false,"x":2300,"y":140,"wires":[["98bc7ddc.42f2a"]]},{"id":"4249d2ed.68ae3c","type":"change","z":"a82c65ac.c0b378","name":"","rules":[{"t":"set","p":"headers","pt":"msg","to":"{\"Content-Type\":\"text/plain\"}","tot":"json"}],"action":"","property":"","from":"","to":"","reg":false,"x":3600,"y":240,"wires":[["b52500b1.a1d93"]]},{"id":"61be09fb.cbcd48","type":"change","z":"a82c65ac.c0b378","name":"","rules":[{"t":"set","p":"headers","pt":"msg","to":"{\"Content-Type\":\"text/plain\"}","tot":"json"}],"action":"","property":"","from":"","to":"","reg":false,"x":2980,"y":340,"wires":[["4115639a.c182cc"]]},{"id":"8678f49c.06e2b8","type":"change","z":"a82c65ac.c0b378","name":"","rules":[{"t":"set","p":"headers","pt":"msg","to":"{\"Content-Type\":\"text/plain\"}","tot":"json"}],"action":"","property":"","from":"","to":"","reg":false,"x":2960,"y":540,"wires":[["f5635461.f1eb08"]]},{"id":"15a2af0c.dd9361","type":"change","z":"a82c65ac.c0b378","name":"","rules":[{"t":"set","p":"headers","pt":"msg","to":"{\"Content-Type\":\"text/plain\"}","tot":"json"}],"action":"","property":"","from":"","to":"","reg":false,"x":4100,"y":440,"wires":[["f856bc7.769d54"]]},{"id":"c2da6857.cb6978","type":"change","z":"a82c65ac.c0b378","name":"get inputs","rules":[{"t":"set","p":"topic","pt":"msg","to":"payload","tot":"msg"},{"t":"set","p":"nodeName","pt":"msg","to":"req.params.nodeName","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":260,"y":240,"wires":[["4eab7273.ae375c"]]},{"id":"74287f20.952dd","type":"http request","z":"a82c65ac.c0b378","name":"get single flow","method":"GET","ret":"obj","paytoqs":"ignore","url":"https://localhost:1880/flow/{{flowId}}","tls":"b1a419c1.609c28","persist":false,"proxy":"","authType":"","x":2460,"y":240,"wires":[["680a33d2.d46c9c"]]},{"id":"96aab63f.20abf8","type":"http request","z":"a82c65ac.c0b378","name":"get flows","method":"GET","ret":"obj","paytoqs":"ignore","url":"https://localhost:1880/flows","tls":"b1a419c1.609c28","persist":false,"proxy":"","authType":"","x":1780,"y":240,"wires":[["471d5852.a248a8"]]},{"id":"cf0df05b.4f825","type":"change","z":"a82c65ac.c0b378","name":"get flowId by name","rules":[{"t":"set","p":"flowId","pt":"msg","to":"*[type = 'tab' and label ='Business Logic'].id","tot":"jsonata"}],"action":"","property":"","from":"","to":"","reg":false,"x":2110,"y":240,"wires":[["b74378cf.3485d8"]]},{"id":"19161682.49e1e9","type":"change","z":"a82c65ac.c0b378","name":"edit","rules":[{"t":"set","p":"old","pt":"msg","to":"payload.nodes[name=$$.nodeName]","tot":"jsonata"},{"t":"set","p":"new","pt":"msg","to":"old","tot":"msg"},{"t":"set","p":"new.topic","pt":"msg","to":"topic","tot":"msg"},{"t":"set","p":"payload.nodes","pt":"msg","to":"$eval($replace($string(payload.nodes),$string(old),$string(new)))","tot":"jsonata"}],"action":"","property":"","from":"","to":"","reg":false,"x":2770,"y":240,"wires":[["deb7bf90.088c8"]]},{"id":"7be70f5c.7d1e","type":"http request","z":"a82c65ac.c0b378","name":"update flow","method":"PUT","ret":"obj","paytoqs":"ignore","url":"https://localhost:1880/flow/{{payload.id}}","tls":"b1a419c1.609c28","persist":false,"proxy":"","authType":"","x":3070,"y":240,"wires":[["5f96bfb4.e3334"]]},{"id":"8df4b3f2.2aec7","type":"change","z":"a82c65ac.c0b378","name":"","rules":[{"t":"set","p":"payload","pt":"msg","to":"topic","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":3400,"y":240,"wires":[["4249d2ed.68ae3c"]]},{"id":"9d84aaf9.846de8","type":"change","z":"a82c65ac.c0b378","name":"","rules":[{"t":"set","p":"status","pt":"msg","to":"payload","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":260,"y":440,"wires":[["3bbcbff4.c0d32"]]},{"id":"e19fe8b0.7f5918","type":"change","z":"a82c65ac.c0b378","name":"get inputs","rules":[{"t":"set","p":"nodeName","pt":"msg","to":"req.params.nodeName","tot":"msg"},{"t":"set","p":"broker","pt":"msg","to":"payload","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":260,"y":40,"wires":[["6afd1467.972c6c"]]},{"id":"1308c910.736217","type":"http request","z":"a82c65ac.c0b378","name":"get flows","method":"GET","ret":"obj","paytoqs":"ignore","url":"https://localhost:1880/flows","tls":"b1a419c1.609c28","persist":false,"proxy":"","authType":"","x":1780,"y":40,"wires":[["9c3dc051.ac56e"]]},{"id":"f062181a.249358","type":"http response","z":"a82c65ac.c0b378","name":"","statusCode":"","headers":{},"x":2790,"y":40,"wires":[]},{"id":"6e179684.9cc078","type":"change","z":"a82c65ac.c0b378","name":"","rules":[{"t":"set","p":"headers","pt":"msg","to":"{\"Content-Type\":\"text/plain\"}","tot":"json"}],"action":"","property":"","from":"","to":"","reg":false,"x":2620,"y":40,"wires":[["f062181a.249358"]]},{"id":"93f5830.b2c4e8","type":"http in","z":"a82c65ac.c0b378","name":"PUT qos","url":"/node/:nodeName/qos","method":"put","upload":false,"swaggerDoc":"","x":80,"y":640,"wires":[["bd816e3c.1e3f9"]]},{"id":"6e0c668b.58cf18","type":"http in","z":"a82c65ac.c0b378","name":"GET qos","url":"/node/:nodeName/qos","method":"get","upload":false,"swaggerDoc":"","x":80,"y":740,"wires":[["276b5da0.267532"]]},{"id":"4d67c944.c61758","type":"http response","z":"a82c65ac.c0b378","name":"","statusCode":"","headers":{},"x":3130,"y":740,"wires":[]},{"id":"c446f215.f049b","type":"change","z":"a82c65ac.c0b378","name":"","rules":[{"t":"set","p":"headers","pt":"msg","to":"{\"Content-Type\":\"text/plain\"}","tot":"json"}],"action":"","property":"","from":"","to":"","reg":false,"x":2960,"y":740,"wires":[["4d67c944.c61758"]]},{"id":"b9815beb.3c4a78","type":"change","z":"a82c65ac.c0b378","name":"get inputs","rules":[{"t":"set","p":"qos","pt":"msg","to":"payload","tot":"msg"},{"t":"set","p":"nodeName","pt":"msg","to":"req.params.nodeName","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":380,"y":640,"wires":[["f47b20d.0842de"]]},{"id":"5199b461.b71abc","type":"http request","z":"a82c65ac.c0b378","name":"get single flow","method":"GET","ret":"obj","paytoqs":"ignore","url":"https://localhost:1880/flow/{{flowId}}","tls":"b1a419c1.609c28","persist":false,"proxy":"","authType":"","x":2580,"y":640,"wires":[["498f9036.dfb4b"]]},{"id":"f6faf63d.cde058","type":"http request","z":"a82c65ac.c0b378","name":"get flows","method":"GET","ret":"obj","paytoqs":"ignore","url":"https://localhost:1880/flows","tls":"b1a419c1.609c28","persist":false,"proxy":"","authType":"","x":1900,"y":640,"wires":[["cc00d73a.e68fd8"]]},{"id":"f9844cbd.d5368","type":"change","z":"a82c65ac.c0b378","name":"get flowId by name","rules":[{"t":"set","p":"flowId","pt":"msg","to":"*[type = 'tab' and label ='Business Logic'].id","tot":"jsonata"}],"action":"","property":"","from":"","to":"","reg":false,"x":2230,"y":640,"wires":[["87bee558.803758"]]},{"id":"d71f1a5b.464048","type":"http request","z":"a82c65ac.c0b378","name":"update flow","method":"PUT","ret":"obj","paytoqs":"ignore","url":"https://localhost:1880/flow/{{payload.id}}","tls":"b1a419c1.609c28","persist":false,"proxy":"","authType":"","x":3190,"y":640,"wires":[["f51986f8.226ef8"]]},{"id":"7126dd4a.e72b94","type":"change","z":"a82c65ac.c0b378","name":"","rules":[{"t":"set","p":"payload","pt":"msg","to":"qos","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":3520,"y":640,"wires":[["5334d47.107f52c"]]},{"id":"5334d47.107f52c","type":"change","z":"a82c65ac.c0b378","name":"","rules":[{"t":"set","p":"headers","pt":"msg","to":"{\"Content-Type\":\"text/plain\"}","tot":"json"}],"action":"","property":"","from":"","to":"","reg":false,"x":3720,"y":640,"wires":[["e241fd12.472da"]]},{"id":"e241fd12.472da","type":"http response","z":"a82c65ac.c0b378","name":"","statusCode":"","headers":{},"x":3890,"y":640,"wires":[]},{"id":"8594fb19.1ec9d8","type":"http in","z":"a82c65ac.c0b378","name":"PUT usetls","url":"/node/:nodeName/usetls","method":"put","upload":false,"swaggerDoc":"","x":80,"y":840,"wires":[["33c5e209.21e21e"]]},{"id":"c61831ea.3ee35","type":"change","z":"a82c65ac.c0b378","name":"","rules":[{"t":"set","p":"payload","pt":"msg","to":"usetls","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":2540,"y":840,"wires":[["adf72bb5.c17598"]]},{"id":"2257bec4.9453c2","type":"http in","z":"a82c65ac.c0b378","name":"GET usetls","url":"/node/:nodeName/usetls","method":"get","upload":false,"swaggerDoc":"","x":80,"y":940,"wires":[["c7678f30.eb322"]]},{"id":"f14fbf07.34e7e","type":"http response","z":"a82c65ac.c0b378","name":"","statusCode":"","headers":{},"x":2590,"y":960,"wires":[]},{"id":"c6a092cf.021c6","type":"change","z":"a82c65ac.c0b378","name":"","rules":[{"t":"set","p":"headers","pt":"msg","to":"{\"Content-Type\":\"text/plain\"}","tot":"json"}],"action":"","property":"","from":"","to":"","reg":false,"x":2420,"y":960,"wires":[["f14fbf07.34e7e"]]},{"id":"33c5e209.21e21e","type":"change","z":"a82c65ac.c0b378","name":"get inputs","rules":[{"t":"set","p":"usetls","pt":"msg","to":"payload","tot":"msg"},{"t":"set","p":"nodeName","pt":"msg","to":"req.params.nodeName","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":240,"y":840,"wires":[["283ab7a4.cbe788"]]},{"id":"c853a27a.a4fc6","type":"http request","z":"a82c65ac.c0b378","name":"get flows","method":"GET","ret":"obj","paytoqs":"ignore","url":"https://localhost:1880/flows","tls":"b1a419c1.609c28","persist":false,"proxy":"","authType":"","x":1760,"y":840,"wires":[["ba8c75f6.693a98"]]},{"id":"a35b17f.1c874e8","type":"function","z":"a82c65ac.c0b378","name":"update flows","func":"const http = global.get('https');\nconst data = JSON.stringify(msg.payload);\nconst options = {\n  hostname: 'localhost',\n  port: 1880,\n  path: '/flows',\n  method: 'POST',\n  headers: {\n    'Content-Type': 'application/json',\n    'Content-Length': data.length,\n    'Authorization': 'Bearer '+msg.accessToken\n  },\n  rejectUnauthorized: false\n};\nconst req = http.request(options);\nreq.write(data);\nreq.end();\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":2350,"y":840,"wires":[["c61831ea.3ee35"]]},{"id":"adf72bb5.c17598","type":"change","z":"a82c65ac.c0b378","name":"","rules":[{"t":"set","p":"headers","pt":"msg","to":"{\"Content-Type\":\"text/plain\"}","tot":"json"}],"action":"","property":"","from":"","to":"","reg":false,"x":2740,"y":840,"wires":[["980d45e6.a9b118"]]},{"id":"980d45e6.a9b118","type":"http response","z":"a82c65ac.c0b378","name":"","statusCode":"","headers":{},"x":2910,"y":840,"wires":[]},{"id":"fe3a5100.73e9f","type":"switch","z":"a82c65ac.c0b378","name":"","property":"usetls","propertyType":"msg","rules":[{"t":"eq","v":"no","vt":"str"},{"t":"eq","v":"yes","vt":"str"},{"t":"else"}],"checkall":"true","repair":false,"outputs":3,"x":2050,"y":840,"wires":[["4e63f112.cac73"],["75bdd19c.e2c1b"],["c9b66c3f.c5bab"]]},{"id":"57944344.0a2a9c","type":"http in","z":"a82c65ac.c0b378","name":"PUT cert","url":"/node/:nodeName/cert","method":"put","upload":false,"swaggerDoc":"","x":80,"y":1040,"wires":[["eb5eff3f.7d929"]]},{"id":"315482f.c0b267e","type":"http in","z":"a82c65ac.c0b378","name":"GET cert","url":"/node/:nodeName/cert","method":"get","upload":false,"swaggerDoc":"","x":80,"y":1140,"wires":[["478b3ed8.b2e6a"]]},{"id":"ac671209.e5fc3","type":"http response","z":"a82c65ac.c0b378","name":"","statusCode":"","headers":{},"x":2450,"y":1140,"wires":[]},{"id":"d88dafbe.ca756","type":"change","z":"a82c65ac.c0b378","name":"","rules":[{"t":"set","p":"headers","pt":"msg","to":"{\"Content-Type\":\"text/plain\"}","tot":"json"}],"action":"","property":"","from":"","to":"","reg":false,"x":2280,"y":1140,"wires":[["ac671209.e5fc3"]]},{"id":"eb5eff3f.7d929","type":"change","z":"a82c65ac.c0b378","name":"get inputs","rules":[{"t":"set","p":"cert","pt":"msg","to":"payload","tot":"msg"},{"t":"set","p":"nodeName","pt":"msg","to":"req.params.nodeName","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":240,"y":1040,"wires":[["1c802a34.c9f456"]]},{"id":"9ddc7b5c.808798","type":"http request","z":"a82c65ac.c0b378","name":"get flows","method":"GET","ret":"obj","paytoqs":"ignore","url":"https://localhost:1880/flows","tls":"b1a419c1.609c28","persist":false,"proxy":"","authType":"","x":1760,"y":1040,"wires":[["3f9144a2.dd939c"]]},{"id":"6fd6ecf6.6076e4","type":"function","z":"a82c65ac.c0b378","name":"update flows","func":"const http = global.get('https');\nconst data = JSON.stringify(msg.payload);\nconst options = {\n  hostname: 'localhost',\n  port: 1880,\n  path: '/flows',\n  method: 'POST',\n  headers: {\n    'Content-Type': 'application/json',\n    'Content-Length': data.length,\n    'Authorization': 'Bearer ' + msg.accessToken\n  },\n  rejectUnauthorized: false\n};\nconst req = http.request(options);\nreq.write(data);\nreq.end();\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":2210,"y":1040,"wires":[["7a03793a.f4b7e8"]]},{"id":"7a03793a.f4b7e8","type":"change","z":"a82c65ac.c0b378","name":"","rules":[{"t":"set","p":"payload","pt":"msg","to":"cert","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":2400,"y":1040,"wires":[["c8d845ba.52dcb8"]]},{"id":"c8d845ba.52dcb8","type":"change","z":"a82c65ac.c0b378","name":"","rules":[{"t":"set","p":"headers","pt":"msg","to":"{\"Content-Type\":\"text/plain\"}","tot":"json"}],"action":"","property":"","from":"","to":"","reg":false,"x":2600,"y":1040,"wires":[["1ecf276f.0687d9"]]},{"id":"1ecf276f.0687d9","type":"http response","z":"a82c65ac.c0b378","name":"","statusCode":"","headers":{},"x":2770,"y":1040,"wires":[]},{"id":"19548c50.09b5c4","type":"http in","z":"a82c65ac.c0b378","name":"PUT key","url":"/node/:nodeName/key","method":"put","upload":false,"swaggerDoc":"","x":80,"y":1240,"wires":[["ede36b22.896e78"]]},{"id":"37fd9f70.6fb56","type":"http in","z":"a82c65ac.c0b378","name":"GET key","url":"/node/:nodeName/key","method":"get","upload":false,"swaggerDoc":"","x":80,"y":1340,"wires":[["6eab6908.96c7b8"]]},{"id":"8bcf8e65.3721e","type":"http response","z":"a82c65ac.c0b378","name":"","statusCode":"","headers":{},"x":2450,"y":1340,"wires":[]},{"id":"f71773e5.207ce","type":"change","z":"a82c65ac.c0b378","name":"","rules":[{"t":"set","p":"headers","pt":"msg","to":"{\"Content-Type\":\"text/plain\"}","tot":"json"}],"action":"","property":"","from":"","to":"","reg":false,"x":2280,"y":1340,"wires":[["8bcf8e65.3721e"]]},{"id":"ede36b22.896e78","type":"change","z":"a82c65ac.c0b378","name":"get inputs","rules":[{"t":"set","p":"key","pt":"msg","to":"payload","tot":"msg"},{"t":"set","p":"nodeName","pt":"msg","to":"req.params.nodeName","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":240,"y":1240,"wires":[["ceb9c02a.12953"]]},{"id":"c6c5bbb8.9c96b8","type":"http request","z":"a82c65ac.c0b378","name":"get flows","method":"GET","ret":"obj","paytoqs":"ignore","url":"https://localhost:1880/flows","tls":"b1a419c1.609c28","persist":false,"proxy":"","authType":"","x":1760,"y":1240,"wires":[["a55d99e6.84af48"]]},{"id":"87e0b066.bcf57","type":"function","z":"a82c65ac.c0b378","name":"update flows","func":"const http = global.get('https');\nconst data = JSON.stringify(msg.payload);\nconst options = {\n  hostname: 'localhost',\n  port: 1880,\n  path: '/flows',\n  method: 'POST',\n  headers: {\n    'Content-Type': 'application/json',\n    'Content-Length': data.length,\n    'Authorization': 'Bearer '+msg.accessToken\n  },\n  rejectUnauthorized: false\n};\nconst req = http.request(options);\nreq.write(data);\nreq.end();\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":2210,"y":1240,"wires":[["7de6f310.841f2c"]]},{"id":"7de6f310.841f2c","type":"change","z":"a82c65ac.c0b378","name":"","rules":[{"t":"set","p":"payload","pt":"msg","to":"key","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":2400,"y":1240,"wires":[["b9db9288.017e4"]]},{"id":"b9db9288.017e4","type":"change","z":"a82c65ac.c0b378","name":"","rules":[{"t":"set","p":"headers","pt":"msg","to":"{\"Content-Type\":\"text/plain\"}","tot":"json"}],"action":"","property":"","from":"","to":"","reg":false,"x":2600,"y":1240,"wires":[["5b0c9193.0eef2"]]},{"id":"5b0c9193.0eef2","type":"http response","z":"a82c65ac.c0b378","name":"","statusCode":"","headers":{},"x":2770,"y":1240,"wires":[]},{"id":"98fee259.c3655","type":"http in","z":"a82c65ac.c0b378","name":"PUT ca","url":"/node/:nodeName/ca","method":"put","upload":false,"swaggerDoc":"","x":70,"y":1440,"wires":[["d4280e48.2bc07"]]},{"id":"1a048820.0426f8","type":"http in","z":"a82c65ac.c0b378","name":"GET ca","url":"/node/:nodeName/ca","method":"get","upload":false,"swaggerDoc":"","x":70,"y":1540,"wires":[["17f8210b.00867f"]]},{"id":"55082c18.9a22b4","type":"http response","z":"a82c65ac.c0b378","name":"","statusCode":"","headers":{},"x":2430,"y":1540,"wires":[]},{"id":"a2dfadd7.1ac86","type":"change","z":"a82c65ac.c0b378","name":"","rules":[{"t":"set","p":"headers","pt":"msg","to":"{\"Content-Type\":\"text/plain\"}","tot":"json"}],"action":"","property":"","from":"","to":"","reg":false,"x":2260,"y":1540,"wires":[["55082c18.9a22b4"]]},{"id":"d4280e48.2bc07","type":"change","z":"a82c65ac.c0b378","name":"get inputs","rules":[{"t":"set","p":"ca","pt":"msg","to":"payload","tot":"msg"},{"t":"set","p":"nodeName","pt":"msg","to":"req.params.nodeName","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":220,"y":1440,"wires":[["85e4ecb5.979cb"]]},{"id":"2ac60eb9.3866b2","type":"http request","z":"a82c65ac.c0b378","name":"get flows","method":"GET","ret":"obj","paytoqs":"ignore","url":"https://localhost:1880/flows","tls":"b1a419c1.609c28","persist":false,"proxy":"","authType":"","x":1740,"y":1440,"wires":[["16094e0d.98daa2"]]},{"id":"9d49e261.dec4","type":"function","z":"a82c65ac.c0b378","name":"update flows","func":"const http = global.get('https');\nconst data = JSON.stringify(msg.payload);\nconst options = {\n  hostname: 'localhost',\n  port: 1880,\n  path: '/flows',\n  method: 'POST',\n  headers: {\n    'Content-Type': 'application/json',\n    'Content-Length': data.length,\n    'Authorization': 'Bearer '+msg.accessToken\n  },\n  rejectUnauthorized: false\n};\nconst req = http.request(options);\nreq.write(data);\nreq.end();\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":2190,"y":1440,"wires":[["f2c882b.9a8ab8"]]},{"id":"f2c882b.9a8ab8","type":"change","z":"a82c65ac.c0b378","name":"","rules":[{"t":"set","p":"payload","pt":"msg","to":"ca","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":2380,"y":1440,"wires":[["55ab3190.467ab"]]},{"id":"55ab3190.467ab","type":"change","z":"a82c65ac.c0b378","name":"","rules":[{"t":"set","p":"headers","pt":"msg","to":"{\"Content-Type\":\"text/plain\"}","tot":"json"}],"action":"","property":"","from":"","to":"","reg":false,"x":2580,"y":1440,"wires":[["9287424a.e8576"]]},{"id":"9287424a.e8576","type":"http response","z":"a82c65ac.c0b378","name":"","statusCode":"","headers":{},"x":2750,"y":1440,"wires":[]},{"id":"70095b05.f33694","type":"http in","z":"a82c65ac.c0b378","name":"PUT verifyservercert","url":"/node/:nodeName/verifyservercert","method":"put","upload":false,"swaggerDoc":"","x":110,"y":1640,"wires":[["51e86c5.0009a94"]]},{"id":"e2a2900.b169e7","type":"http in","z":"a82c65ac.c0b378","name":"GET verifyservercert","url":"/node/:nodeName/verifyservercert","method":"get","upload":false,"swaggerDoc":"","x":110,"y":1740,"wires":[["28bbe97b.c87426"]]},{"id":"d7d56f75.9458c","type":"http response","z":"a82c65ac.c0b378","name":"","statusCode":"","headers":{},"x":2750,"y":1740,"wires":[]},{"id":"b0c94e08.f9712","type":"change","z":"a82c65ac.c0b378","name":"","rules":[{"t":"set","p":"headers","pt":"msg","to":"{\"Content-Type\":\"text/plain\"}","tot":"json"}],"action":"","property":"","from":"","to":"","reg":false,"x":2580,"y":1740,"wires":[["d7d56f75.9458c"]]},{"id":"51e86c5.0009a94","type":"change","z":"a82c65ac.c0b378","name":"get inputs","rules":[{"t":"set","p":"verifyservercert","pt":"msg","to":"payload","tot":"msg"},{"t":"set","p":"nodeName","pt":"msg","to":"req.params.nodeName","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":300,"y":1640,"wires":[["2bc70ade.973366"]]},{"id":"9d284252.6278a","type":"http request","z":"a82c65ac.c0b378","name":"get flows","method":"GET","ret":"obj","paytoqs":"ignore","url":"https://localhost:1880/flows","tls":"b1a419c1.609c28","persist":false,"proxy":"","authType":"","x":1860,"y":1640,"wires":[["dd6dad63.c519b"]]},{"id":"a733f9b6.dd2228","type":"switch","z":"a82c65ac.c0b378","name":"","property":"verifyservercert","propertyType":"msg","rules":[{"t":"eq","v":"no","vt":"str"},{"t":"eq","v":"yes","vt":"str"},{"t":"else"}],"checkall":"true","repair":false,"outputs":3,"x":2150,"y":1620,"wires":[["b7e87212.5eab"],["a37883b6.d9a2b"],["6db88de2.7a2044"]]},{"id":"6450c902.07d4e8","type":"function","z":"a82c65ac.c0b378","name":"update flows","func":"const http = global.get('https');\nconst data = JSON.stringify(msg.payload);\nconst options = {\n  hostname: 'localhost',\n  port: 1880,\n  path: '/flows',\n  method: 'POST',\n  headers: {\n    'Content-Type': 'application/json',\n    'Content-Length': data.length,\n    'Authorization': 'Bearer '+msg.accessToken\n  },\n  rejectUnauthorized: false\n};\nconst req = http.request(options);\nreq.write(data);\nreq.end();\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":2450,"y":1620,"wires":[["a17a110e.5dbda"]]},{"id":"a17a110e.5dbda","type":"change","z":"a82c65ac.c0b378","name":"","rules":[{"t":"set","p":"payload","pt":"msg","to":"verifyservercert","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":2640,"y":1620,"wires":[["3ebd9df7.ef90e2"]]},{"id":"3ebd9df7.ef90e2","type":"change","z":"a82c65ac.c0b378","name":"","rules":[{"t":"set","p":"headers","pt":"msg","to":"{\"Content-Type\":\"text/plain\"}","tot":"json"}],"action":"","property":"","from":"","to":"","reg":false,"x":2840,"y":1620,"wires":[["70884e37.89572"]]},{"id":"70884e37.89572","type":"http response","z":"a82c65ac.c0b378","name":"","statusCode":"","headers":{},"x":3010,"y":1620,"wires":[]},{"id":"a2da4e9a.07b61","type":"http in","z":"a82c65ac.c0b378","name":"PUT servername","url":"/node/:nodeName/servername","method":"put","upload":false,"swaggerDoc":"","x":100,"y":1840,"wires":[["16f6c030.bc5a2"]]},{"id":"a265f09d.16a2d","type":"http in","z":"a82c65ac.c0b378","name":"GET servername","url":"/node/:nodeName/servername","method":"get","upload":false,"swaggerDoc":"","x":100,"y":1940,"wires":[["bc793275.7e0be"]]},{"id":"d0bd5844.71c4e8","type":"http response","z":"a82c65ac.c0b378","name":"","statusCode":"","headers":{},"x":2490,"y":1940,"wires":[]},{"id":"d1a230a3.fbce7","type":"change","z":"a82c65ac.c0b378","name":"","rules":[{"t":"set","p":"headers","pt":"msg","to":"{\"Content-Type\":\"text/plain\"}","tot":"json"}],"action":"","property":"","from":"","to":"","reg":false,"x":2320,"y":1940,"wires":[["d0bd5844.71c4e8"]]},{"id":"16f6c030.bc5a2","type":"change","z":"a82c65ac.c0b378","name":"get inputs","rules":[{"t":"set","p":"servername","pt":"msg","to":"payload","tot":"msg"},{"t":"set","p":"nodeName","pt":"msg","to":"req.params.nodeName","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":280,"y":1840,"wires":[["f88b46d4.7b17d8"]]},{"id":"3868d3ff.4018dc","type":"http request","z":"a82c65ac.c0b378","name":"get flows","method":"GET","ret":"obj","paytoqs":"ignore","url":"https://localhost:1880/flows","tls":"b1a419c1.609c28","persist":false,"proxy":"","authType":"","x":1660,"y":1840,"wires":[["81c808b9.24a5b8"]]},{"id":"2916f613.1c383a","type":"function","z":"a82c65ac.c0b378","name":"update flows","func":"const http = global.get('https');\nconst data = JSON.stringify(msg.payload);\nconst options = {\n  hostname: 'localhost',\n  port: 1880,\n  path: '/flows',\n  method: 'POST',\n  headers: {\n    'Content-Type': 'application/json',\n    'Content-Length': data.length,\n    'Authorization': 'Bearer '+msg.accessToken\n  },\n  rejectUnauthorized: false\n};\nconst req = http.request(options);\nreq.write(data);\nreq.end();\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":1970,"y":1840,"wires":[["9f1de75d.101928"]]},{"id":"9f1de75d.101928","type":"change","z":"a82c65ac.c0b378","name":"","rules":[{"t":"set","p":"payload","pt":"msg","to":"servername","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":2160,"y":1840,"wires":[["6c4a91b5.176d2"]]},{"id":"6c4a91b5.176d2","type":"change","z":"a82c65ac.c0b378","name":"","rules":[{"t":"set","p":"headers","pt":"msg","to":"{\"Content-Type\":\"text/plain\"}","tot":"json"}],"action":"","property":"","from":"","to":"","reg":false,"x":2360,"y":1840,"wires":[["d0be2f8b.43412"]]},{"id":"d0be2f8b.43412","type":"http response","z":"a82c65ac.c0b378","name":"","statusCode":"","headers":{},"x":2530,"y":1840,"wires":[]},{"id":"152d95c7.67fc2a","type":"http in","z":"a82c65ac.c0b378","name":"PUT port","url":"/node/:nodeName/port","method":"put","upload":false,"swaggerDoc":"","x":80,"y":2040,"wires":[["394fbe3b.5381b2"]]},{"id":"e8bae4bc.c4c478","type":"http in","z":"a82c65ac.c0b378","name":"GET port","url":"/node/:nodeName/port","method":"get","upload":false,"swaggerDoc":"","x":80,"y":2140,"wires":[["31d54f44.310e9"]]},{"id":"9b7b9b8c.4219e8","type":"http response","z":"a82c65ac.c0b378","name":"","statusCode":"","headers":{},"x":2450,"y":2140,"wires":[]},{"id":"bf725f24.8d1f","type":"change","z":"a82c65ac.c0b378","name":"","rules":[{"t":"set","p":"headers","pt":"msg","to":"{\"Content-Type\":\"text/plain\"}","tot":"json"}],"action":"","property":"","from":"","to":"","reg":false,"x":2280,"y":2140,"wires":[["9b7b9b8c.4219e8"]]},{"id":"394fbe3b.5381b2","type":"change","z":"a82c65ac.c0b378","name":"get inputs","rules":[{"t":"set","p":"port","pt":"msg","to":"payload","tot":"msg"},{"t":"set","p":"nodeName","pt":"msg","to":"req.params.nodeName","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":240,"y":2040,"wires":[["6b0b9a74.b0a1c4"]]},{"id":"afeeb653.f639f8","type":"http request","z":"a82c65ac.c0b378","name":"get flows","method":"GET","ret":"obj","paytoqs":"ignore","url":"https://localhost:1880/flows","tls":"b1a419c1.609c28","persist":false,"proxy":"","authType":"","x":1760,"y":2040,"wires":[["8817df08.39db4"]]},{"id":"ad4fce90.4ff09","type":"function","z":"a82c65ac.c0b378","name":"update flows","func":"const http = global.get('https');\nconst data = JSON.stringify(msg.payload);\nconst options = {\n  hostname: 'localhost',\n  port: 1880,\n  path: '/flows',\n  method: 'POST',\n  headers: {\n    'Content-Type': 'application/json',\n    'Content-Length': data.length,\n    'Authorization': 'Bearer '+msg.accessToken\n  },\n  rejectUnauthorized: false\n};\nconst req = http.request(options);\nreq.write(data);\nreq.end();\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":2210,"y":2040,"wires":[["adbb628b.a92fa"]]},{"id":"adbb628b.a92fa","type":"change","z":"a82c65ac.c0b378","name":"","rules":[{"t":"set","p":"payload","pt":"msg","to":"port","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":2400,"y":2040,"wires":[["69c740d2.fe11c"]]},{"id":"69c740d2.fe11c","type":"change","z":"a82c65ac.c0b378","name":"","rules":[{"t":"set","p":"headers","pt":"msg","to":"{\"Content-Type\":\"text/plain\"}","tot":"json"}],"action":"","property":"","from":"","to":"","reg":false,"x":2600,"y":2040,"wires":[["4162f6c.b71c708"]]},{"id":"4162f6c.b71c708","type":"http response","z":"a82c65ac.c0b378","name":"","statusCode":"","headers":{},"x":2770,"y":2040,"wires":[]},{"id":"125c7b33.697695","type":"http request","z":"a82c65ac.c0b378","name":"get flows","method":"GET","ret":"obj","paytoqs":"ignore","url":"https://localhost:1880/flows","tls":"b1a419c1.609c28","persist":false,"proxy":"","authType":"","x":1780,"y":140,"wires":[["7779a238.df428c"]]},{"id":"b87ab3a7.4d89d","type":"http request","z":"a82c65ac.c0b378","name":"get single flow","method":"GET","ret":"obj","paytoqs":"ignore","url":"https://localhost:1880/flow/{{flowId}}","tls":"b1a419c1.609c28","persist":false,"proxy":"","authType":"","x":2440,"y":340,"wires":[["3c7291c0.293d9e"]]},{"id":"f12231ae.d99c7","type":"http request","z":"a82c65ac.c0b378","name":"get flows","method":"GET","ret":"obj","paytoqs":"ignore","url":"https://localhost:1880/flows","tls":"b1a419c1.609c28","persist":false,"proxy":"","authType":"","x":1760,"y":340,"wires":[["556f76f3.4ee148"]]},{"id":"ad449bc8.8b3608","type":"change","z":"a82c65ac.c0b378","name":"get flowId by name","rules":[{"t":"set","p":"flowId","pt":"msg","to":"*[type = 'tab' and label ='Business Logic'].id","tot":"jsonata"}],"action":"","property":"","from":"","to":"","reg":false,"x":2090,"y":340,"wires":[["9ae21b6d.c72438"]]},{"id":"209aabd.dc53d54","type":"change","z":"a82c65ac.c0b378","name":"","rules":[{"t":"set","p":"payload","pt":"msg","to":"payload.nodes[name=$$.nodeName].topic","tot":"jsonata"}],"action":"","property":"","from":"","to":"","reg":false,"x":2780,"y":340,"wires":[["61be09fb.cbcd48"]]},{"id":"ada5101b.02e9e","type":"http request","z":"a82c65ac.c0b378","name":"get single flow","method":"GET","ret":"obj","paytoqs":"ignore","url":"https://localhost:1880/flow/{{flowId}}","tls":"b1a419c1.609c28","persist":false,"proxy":"","authType":"","x":2280,"y":540,"wires":[["11f0741b.48092c"]]},{"id":"e1a0a188.56f8a","type":"http request","z":"a82c65ac.c0b378","name":"get flows","method":"GET","ret":"obj","paytoqs":"ignore","url":"https://localhost:1880/flows","tls":"b1a419c1.609c28","persist":false,"proxy":"","authType":"","x":1600,"y":540,"wires":[["eb77abac.1d4e68"]]},{"id":"6866a249.5e051c","type":"change","z":"a82c65ac.c0b378","name":"get flowId by name","rules":[{"t":"set","p":"flowId","pt":"msg","to":"*[type = 'tab' and label ='Business Logic'].id","tot":"jsonata"}],"action":"","property":"","from":"","to":"","reg":false,"x":1930,"y":540,"wires":[["f54f431b.f7ef2"]]},{"id":"f08534a3.cc1738","type":"switch","z":"a82c65ac.c0b378","name":"","property":"payload.disabled","propertyType":"msg","rules":[{"t":"true"},{"t":"else"}],"checkall":"true","repair":false,"outputs":2,"x":2590,"y":540,"wires":[["67f197a5.91ed38"],["f8a75eeb.f9bf4"]]},{"id":"67f197a5.91ed38","type":"change","z":"a82c65ac.c0b378","name":"","rules":[{"t":"set","p":"payload","pt":"msg","to":"off","tot":"str"}],"action":"","property":"","from":"","to":"","reg":false,"x":2760,"y":520,"wires":[["8678f49c.06e2b8"]]},{"id":"f8a75eeb.f9bf4","type":"change","z":"a82c65ac.c0b378","name":"","rules":[{"t":"set","p":"payload","pt":"msg","to":"on","tot":"str"}],"action":"","property":"","from":"","to":"","reg":false,"x":2760,"y":560,"wires":[["8678f49c.06e2b8"]]},{"id":"bf4536c6.8e60b8","type":"http request","z":"a82c65ac.c0b378","name":"get single flow","method":"GET","ret":"obj","paytoqs":"ignore","url":"https://localhost:1880/flow/{{flowId}}","tls":"b1a419c1.609c28","persist":false,"proxy":"","authType":"","x":2420,"y":740,"wires":[["6548b748.57eb28"]]},{"id":"70afc34e.a7a66c","type":"http request","z":"a82c65ac.c0b378","name":"get flows","method":"GET","ret":"obj","paytoqs":"ignore","url":"https://localhost:1880/flows","tls":"b1a419c1.609c28","persist":false,"proxy":"","authType":"","x":1740,"y":740,"wires":[["a040fb34.0528f8"]]},{"id":"1df58ba5.203df4","type":"change","z":"a82c65ac.c0b378","name":"get flowId by name","rules":[{"t":"set","p":"flowId","pt":"msg","to":"*[type = 'tab' and label ='Business Logic'].id","tot":"jsonata"}],"action":"","property":"","from":"","to":"","reg":false,"x":2070,"y":740,"wires":[["d9e56172.50319"]]},{"id":"94212df3.62863","type":"change","z":"a82c65ac.c0b378","name":"","rules":[{"t":"set","p":"payload","pt":"msg","to":"payload.nodes[name=$$.nodeName].qos","tot":"jsonata"}],"action":"","property":"","from":"","to":"","reg":false,"x":2760,"y":740,"wires":[["c446f215.f049b"]]},{"id":"c0630be3.f1ba18","type":"http request","z":"a82c65ac.c0b378","name":"get flows","method":"GET","ret":"obj","paytoqs":"ignore","url":"https://localhost:1880/flows","tls":"b1a419c1.609c28","persist":false,"proxy":"","authType":"","x":1760,"y":940,"wires":[["dbcb00fa.90302"]]},{"id":"36381449.d5b7ec","type":"switch","z":"a82c65ac.c0b378","name":"","property":"*[name = $$.nodeName & \" broker\"].usetls","propertyType":"jsonata","rules":[{"t":"true"},{"t":"else"}],"checkall":"true","repair":false,"outputs":2,"x":2050,"y":940,"wires":[["bcff9f24.1291f"],["d5b2d3c0.e9a83"]]},{"id":"bcff9f24.1291f","type":"change","z":"a82c65ac.c0b378","name":"","rules":[{"t":"set","p":"payload","pt":"msg","to":"yes","tot":"str"}],"action":"","property":"","from":"","to":"","reg":false,"x":2220,"y":940,"wires":[["c6a092cf.021c6"]]},{"id":"d5b2d3c0.e9a83","type":"change","z":"a82c65ac.c0b378","name":"","rules":[{"t":"set","p":"payload","pt":"msg","to":"no","tot":"str"}],"action":"","property":"","from":"","to":"","reg":false,"x":2220,"y":980,"wires":[["c6a092cf.021c6"]]},{"id":"53ecbf1.74d724","type":"http request","z":"a82c65ac.c0b378","name":"get flows","method":"GET","ret":"obj","paytoqs":"ignore","url":"https://localhost:1880/flows","tls":"b1a419c1.609c28","persist":false,"proxy":"","authType":"","x":1760,"y":1140,"wires":[["1c1cc6b1.373ed9"]]},{"id":"39a36245.dd33ce","type":"change","z":"a82c65ac.c0b378","name":"","rules":[{"t":"set","p":"payload","pt":"msg","to":"*[name = $$.nodeName & \" tls config\"].cert","tot":"jsonata"}],"action":"","property":"","from":"","to":"","reg":false,"x":2080,"y":1140,"wires":[["d88dafbe.ca756"]]},{"id":"b04b44e9.2db3d8","type":"http request","z":"a82c65ac.c0b378","name":"get flows","method":"GET","ret":"obj","paytoqs":"ignore","url":"https://localhost:1880/flows","tls":"b1a419c1.609c28","persist":false,"proxy":"","authType":"","x":1760,"y":1340,"wires":[["18eb92b5.7cc06d"]]},{"id":"aca85c75.32529","type":"change","z":"a82c65ac.c0b378","name":"","rules":[{"t":"set","p":"payload","pt":"msg","to":"*[name = $$.nodeName & \" tls config\"].key","tot":"jsonata"}],"action":"","property":"","from":"","to":"","reg":false,"x":2080,"y":1340,"wires":[["f71773e5.207ce"]]},{"id":"ab70a560.4db708","type":"http request","z":"a82c65ac.c0b378","name":"get flows","method":"GET","ret":"obj","paytoqs":"ignore","url":"https://localhost:1880/flows","tls":"b1a419c1.609c28","persist":false,"proxy":"","authType":"","x":1740,"y":1540,"wires":[["c16dfa5f.915468"]]},{"id":"a7d47f64.3f8bc","type":"change","z":"a82c65ac.c0b378","name":"","rules":[{"t":"set","p":"payload","pt":"msg","to":"*[name = $$.nodeName & \" tls config\"].ca","tot":"jsonata"}],"action":"","property":"","from":"","to":"","reg":false,"x":2060,"y":1540,"wires":[["a2dfadd7.1ac86"]]},{"id":"a5fead04.064ec","type":"http request","z":"a82c65ac.c0b378","name":"get flows","method":"GET","ret":"obj","paytoqs":"ignore","url":"https://localhost:1880/flows","tls":"b1a419c1.609c28","persist":false,"proxy":"","authType":"","x":1920,"y":1740,"wires":[["67455b1e.84dd54"]]},{"id":"5cb223ab.67bf9c","type":"switch","z":"a82c65ac.c0b378","name":"","property":"*[name = $$.nodeName & \" tls config\"].verifyservercert","propertyType":"jsonata","rules":[{"t":"true"},{"t":"else"}],"checkall":"true","repair":false,"outputs":2,"x":2210,"y":1740,"wires":[["370b8c75.07a1a4"],["d3123d98.29c7e"]]},{"id":"370b8c75.07a1a4","type":"change","z":"a82c65ac.c0b378","name":"","rules":[{"t":"set","p":"payload","pt":"msg","to":"yes","tot":"str"}],"action":"","property":"","from":"","to":"","reg":false,"x":2380,"y":1720,"wires":[["b0c94e08.f9712"]]},{"id":"d3123d98.29c7e","type":"change","z":"a82c65ac.c0b378","name":"","rules":[{"t":"set","p":"payload","pt":"msg","to":"no","tot":"str"}],"action":"","property":"","from":"","to":"","reg":false,"x":2380,"y":1760,"wires":[["b0c94e08.f9712"]]},{"id":"c890160e.b89058","type":"http request","z":"a82c65ac.c0b378","name":"get flows","method":"GET","ret":"obj","paytoqs":"ignore","url":"https://localhost:1880/flows","tls":"b1a419c1.609c28","persist":false,"proxy":"","authType":"","x":1800,"y":1940,"wires":[["227eda1c.2342e6"]]},{"id":"cbdfd5a9.2a7008","type":"change","z":"a82c65ac.c0b378","name":"","rules":[{"t":"set","p":"payload","pt":"msg","to":"*[name = $$.nodeName & \" tls config\"].servername","tot":"jsonata"}],"action":"","property":"","from":"","to":"","reg":false,"x":2120,"y":1940,"wires":[["d1a230a3.fbce7"]]},{"id":"47a3df94.1c30e","type":"http request","z":"a82c65ac.c0b378","name":"get flows","method":"GET","ret":"obj","paytoqs":"ignore","url":"https://localhost:1880/flows","tls":"b1a419c1.609c28","persist":false,"proxy":"","authType":"","x":1760,"y":2140,"wires":[["9e5b844e.5518c8"]]},{"id":"2a6551af.d53b2e","type":"change","z":"a82c65ac.c0b378","name":"","rules":[{"t":"set","p":"payload","pt":"msg","to":"*[name = $$.nodeName & \" broker\"].port","tot":"jsonata"}],"action":"","property":"","from":"","to":"","reg":false,"x":2080,"y":2140,"wires":[["bf725f24.8d1f"]]},{"id":"e19f3dd8.756e6","type":"http request","z":"a82c65ac.c0b378","name":"auth","method":"POST","ret":"obj","paytoqs":"ignore","url":"https://localhost:1880/auth/token","tls":"b1a419c1.609c28","persist":false,"proxy":"","authType":"","x":1110,"y":40,"wires":[["f65d1ce4.84539"]]},{"id":"8804bdcd.5d43a","type":"change","z":"a82c65ac.c0b378","name":"auth payload","rules":[{"t":"set","p":"payload","pt":"msg","to":"{}","tot":"json"},{"t":"set","p":"payload.client_id","pt":"msg","to":"node-red-editor","tot":"str"},{"t":"set","p":"payload.grant_type","pt":"msg","to":"password","tot":"str"},{"t":"set","p":"payload.scope","pt":"msg","to":"","tot":"str"},{"t":"set","p":"payload.username","pt":"msg","to":"NRADM_USER","tot":"env"},{"t":"set","p":"payload.password","pt":"msg","to":"NRADM_PASS","tot":"env"}],"action":"","property":"","from":"","to":"","reg":false,"x":950,"y":40,"wires":[["e19f3dd8.756e6"]]},{"id":"2a43ee3.8976412","type":"change","z":"a82c65ac.c0b378","name":"","rules":[{"t":"set","p":"accessToken","pt":"msg","to":"payload.access_token","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":1440,"y":40,"wires":[["5a5293d5.98809c"]]},{"id":"5a5293d5.98809c","type":"change","z":"a82c65ac.c0b378","name":"bearer","rules":[{"t":"set","p":"headers","pt":"msg","to":"{}","tot":"json"},{"t":"set","p":"headers.authorization","pt":"msg","to":"\"Bearer \" & msg.accessToken","tot":"jsonata"}],"action":"","property":"","from":"","to":"","reg":false,"x":1630,"y":40,"wires":[["1308c910.736217"]]},{"id":"5046fe1.31881","type":"http request","z":"a82c65ac.c0b378","name":"auth","method":"POST","ret":"obj","paytoqs":"ignore","url":"https://localhost:1880/auth/token","tls":"b1a419c1.609c28","persist":false,"proxy":"","authType":"","x":1110,"y":140,"wires":[["71f7a3fe.8bdf4c"]]},{"id":"eb1f03da.b1eb6","type":"change","z":"a82c65ac.c0b378","name":"auth payload","rules":[{"t":"set","p":"payload.client_id","pt":"msg","to":"node-red-editor","tot":"str"},{"t":"set","p":"payload.grant_type","pt":"msg","to":"password","tot":"str"},{"t":"set","p":"payload.scope","pt":"msg","to":"","tot":"str"},{"t":"set","p":"payload.username","pt":"msg","to":"NRADM_USER","tot":"env"},{"t":"set","p":"payload.password","pt":"msg","to":"NRADM_PASS","tot":"env"}],"action":"","property":"","from":"","to":"","reg":false,"x":950,"y":140,"wires":[["5046fe1.31881"]]},{"id":"514afb7f.5275e4","type":"change","z":"a82c65ac.c0b378","name":"","rules":[{"t":"set","p":"accessToken","pt":"msg","to":"payload.access_token","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":1440,"y":140,"wires":[["37df391b.dd59c6"]]},{"id":"37df391b.dd59c6","type":"change","z":"a82c65ac.c0b378","name":"bearer","rules":[{"t":"set","p":"headers","pt":"msg","to":"{}","tot":"json"},{"t":"set","p":"headers.authorization","pt":"msg","to":"\"Bearer \" & msg.accessToken","tot":"jsonata"}],"action":"","property":"","from":"","to":"","reg":false,"x":1630,"y":140,"wires":[["125c7b33.697695"]]},{"id":"29becb9f.2ba504","type":"http request","z":"a82c65ac.c0b378","name":"auth","method":"POST","ret":"obj","paytoqs":"ignore","url":"https://localhost:1880/auth/token","tls":"b1a419c1.609c28","persist":false,"proxy":"","authType":"","x":1110,"y":240,"wires":[["bcf9dcda.f3096"]]},{"id":"aebe1413.576a08","type":"change","z":"a82c65ac.c0b378","name":"auth payload","rules":[{"t":"set","p":"payload","pt":"msg","to":"{}","tot":"json"},{"t":"set","p":"payload.client_id","pt":"msg","to":"node-red-editor","tot":"str"},{"t":"set","p":"payload.grant_type","pt":"msg","to":"password","tot":"str"},{"t":"set","p":"payload.scope","pt":"msg","to":"","tot":"str"},{"t":"set","p":"payload.username","pt":"msg","to":"NRADM_USER","tot":"env"},{"t":"set","p":"payload.password","pt":"msg","to":"NRADM_PASS","tot":"env"}],"action":"","property":"","from":"","to":"","reg":false,"x":950,"y":240,"wires":[["29becb9f.2ba504"]]},{"id":"ffeb72f1.d7f23","type":"change","z":"a82c65ac.c0b378","name":"","rules":[{"t":"set","p":"accessToken","pt":"msg","to":"payload.access_token","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":1440,"y":240,"wires":[["d6c1c70f.525128"]]},{"id":"d6c1c70f.525128","type":"change","z":"a82c65ac.c0b378","name":"bearer","rules":[{"t":"set","p":"headers","pt":"msg","to":"{}","tot":"json"},{"t":"set","p":"headers.authorization","pt":"msg","to":"\"Bearer \" & msg.accessToken","tot":"jsonata"}],"action":"","property":"","from":"","to":"","reg":false,"x":1630,"y":240,"wires":[["96aab63f.20abf8"]]},{"id":"b74378cf.3485d8","type":"change","z":"a82c65ac.c0b378","name":"bearer","rules":[{"t":"set","p":"headers","pt":"msg","to":"{}","tot":"json"},{"t":"set","p":"headers.authorization","pt":"msg","to":"\"Bearer \" & msg.accessToken","tot":"jsonata"}],"action":"","property":"","from":"","to":"","reg":false,"x":2290,"y":240,"wires":[["74287f20.952dd"]]},{"id":"deb7bf90.088c8","type":"change","z":"a82c65ac.c0b378","name":"bearer","rules":[{"t":"set","p":"headers","pt":"msg","to":"{}","tot":"json"},{"t":"set","p":"headers.authorization","pt":"msg","to":"\"Bearer \" & msg.accessToken","tot":"jsonata"}],"action":"","property":"","from":"","to":"","reg":false,"x":2910,"y":240,"wires":[["7be70f5c.7d1e"]]},{"id":"32f918b0.5195f8","type":"http request","z":"a82c65ac.c0b378","name":"auth","method":"POST","ret":"obj","paytoqs":"ignore","url":"https://localhost:1880/auth/token","tls":"b1a419c1.609c28","persist":false,"proxy":"","authType":"","x":1090,"y":340,"wires":[["8905a8e6.a55938"]]},{"id":"af9d3574.d36228","type":"change","z":"a82c65ac.c0b378","name":"auth payload","rules":[{"t":"set","p":"payload.client_id","pt":"msg","to":"node-red-editor","tot":"str"},{"t":"set","p":"payload.grant_type","pt":"msg","to":"password","tot":"str"},{"t":"set","p":"payload.scope","pt":"msg","to":"","tot":"str"},{"t":"set","p":"payload.username","pt":"msg","to":"NRADM_USER","tot":"env"},{"t":"set","p":"payload.password","pt":"msg","to":"NRADM_PASS","tot":"env"}],"action":"","property":"","from":"","to":"","reg":false,"x":930,"y":340,"wires":[["32f918b0.5195f8"]]},{"id":"2c6cad62.e52f92","type":"change","z":"a82c65ac.c0b378","name":"","rules":[{"t":"set","p":"accessToken","pt":"msg","to":"payload.access_token","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":1420,"y":340,"wires":[["c36c8481.774e38"]]},{"id":"c36c8481.774e38","type":"change","z":"a82c65ac.c0b378","name":"bearer","rules":[{"t":"set","p":"headers","pt":"msg","to":"{}","tot":"json"},{"t":"set","p":"headers.authorization","pt":"msg","to":"\"Bearer \" & msg.accessToken","tot":"jsonata"}],"action":"","property":"","from":"","to":"","reg":false,"x":1610,"y":340,"wires":[["f12231ae.d99c7"]]},{"id":"9ae21b6d.c72438","type":"change","z":"a82c65ac.c0b378","name":"bearer","rules":[{"t":"set","p":"headers","pt":"msg","to":"{}","tot":"json"},{"t":"set","p":"headers.authorization","pt":"msg","to":"\"Bearer \" & msg.accessToken","tot":"jsonata"}],"action":"","property":"","from":"","to":"","reg":false,"x":2270,"y":340,"wires":[["b87ab3a7.4d89d"]]},{"id":"85e3fbd1.8cd418","type":"http request","z":"a82c65ac.c0b378","name":"auth","method":"POST","ret":"obj","paytoqs":"ignore","url":"https://localhost:1880/auth/token","tls":"b1a419c1.609c28","persist":false,"proxy":"","authType":"","x":1490,"y":440,"wires":[["9548c989.cfdef8"]]},{"id":"9da48f4e.4bc57","type":"change","z":"a82c65ac.c0b378","name":"auth payload","rules":[{"t":"set","p":"payload","pt":"msg","to":"{}","tot":"json"},{"t":"set","p":"payload.client_id","pt":"msg","to":"node-red-editor","tot":"str"},{"t":"set","p":"payload.grant_type","pt":"msg","to":"password","tot":"str"},{"t":"set","p":"payload.scope","pt":"msg","to":"","tot":"str"},{"t":"set","p":"payload.username","pt":"msg","to":"NRADM_USER","tot":"env"},{"t":"set","p":"payload.password","pt":"msg","to":"NRADM_PASS","tot":"env"}],"action":"","property":"","from":"","to":"","reg":false,"x":1330,"y":440,"wires":[["85e3fbd1.8cd418"]]},{"id":"209be672.98a1ea","type":"change","z":"a82c65ac.c0b378","name":"","rules":[{"t":"set","p":"accessToken","pt":"msg","to":"payload.access_token","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":1820,"y":440,"wires":[["84acca73.a34ee8"]]},{"id":"84acca73.a34ee8","type":"change","z":"a82c65ac.c0b378","name":"bearer","rules":[{"t":"set","p":"headers","pt":"msg","to":"{}","tot":"json"},{"t":"set","p":"headers.authorization","pt":"msg","to":"\"Bearer \" & msg.accessToken","tot":"jsonata"}],"action":"","property":"","from":"","to":"","reg":false,"x":2010,"y":440,"wires":[["8442b573.e3aee8"]]},{"id":"92ff8cc5.33047","type":"change","z":"a82c65ac.c0b378","name":"bearer","rules":[{"t":"set","p":"headers","pt":"msg","to":"{}","tot":"json"},{"t":"set","p":"headers.authorization","pt":"msg","to":"\"Bearer \" & msg.accessToken","tot":"jsonata"}],"action":"","property":"","from":"","to":"","reg":false,"x":2670,"y":440,"wires":[["1904bdda.a75392"]]},{"id":"53f968e5.7001a8","type":"change","z":"a82c65ac.c0b378","name":"bearer","rules":[{"t":"set","p":"headers","pt":"msg","to":"{}","tot":"json"},{"t":"set","p":"headers.authorization","pt":"msg","to":"\"Bearer \" & msg.accessToken","tot":"jsonata"}],"action":"","property":"","from":"","to":"","reg":false,"x":3410,"y":440,"wires":[["9ab9a607.916a68"]]},{"id":"e7af8cf9.31a07","type":"http request","z":"a82c65ac.c0b378","name":"auth","method":"POST","ret":"obj","paytoqs":"ignore","url":"https://localhost:1880/auth/token","tls":"b1a419c1.609c28","persist":false,"proxy":"","authType":"","x":930,"y":540,"wires":[["1e037971.3b87c7"]]},{"id":"da8e4ae.b0bf4b8","type":"change","z":"a82c65ac.c0b378","name":"auth payload","rules":[{"t":"set","p":"payload.client_id","pt":"msg","to":"node-red-editor","tot":"str"},{"t":"set","p":"payload.grant_type","pt":"msg","to":"password","tot":"str"},{"t":"set","p":"payload.scope","pt":"msg","to":"","tot":"str"},{"t":"set","p":"payload.username","pt":"msg","to":"NRADM_USER","tot":"env"},{"t":"set","p":"payload.password","pt":"msg","to":"NRADM_PASS","tot":"env"}],"action":"","property":"","from":"","to":"","reg":false,"x":770,"y":540,"wires":[["e7af8cf9.31a07"]]},{"id":"8f9c48cb.a70ee8","type":"change","z":"a82c65ac.c0b378","name":"","rules":[{"t":"set","p":"accessToken","pt":"msg","to":"payload.access_token","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":1260,"y":540,"wires":[["81f5d208.0088e"]]},{"id":"81f5d208.0088e","type":"change","z":"a82c65ac.c0b378","name":"bearer","rules":[{"t":"set","p":"headers","pt":"msg","to":"{}","tot":"json"},{"t":"set","p":"headers.authorization","pt":"msg","to":"\"Bearer \" & msg.accessToken","tot":"jsonata"}],"action":"","property":"","from":"","to":"","reg":false,"x":1450,"y":540,"wires":[["e1a0a188.56f8a"]]},{"id":"f54f431b.f7ef2","type":"change","z":"a82c65ac.c0b378","name":"bearer","rules":[{"t":"set","p":"headers","pt":"msg","to":"{}","tot":"json"},{"t":"set","p":"headers.authorization","pt":"msg","to":"\"Bearer \" & msg.accessToken","tot":"jsonata"}],"action":"","property":"","from":"","to":"","reg":false,"x":2110,"y":540,"wires":[["ada5101b.02e9e"]]},{"id":"d77788f9.d3d898","type":"http request","z":"a82c65ac.c0b378","name":"auth","method":"POST","ret":"obj","paytoqs":"ignore","url":"https://localhost:1880/auth/token","tls":"b1a419c1.609c28","persist":false,"proxy":"","authType":"","x":1230,"y":640,"wires":[["4a781f93.b2d9e"]]},{"id":"f5bbe5e3.d44368","type":"change","z":"a82c65ac.c0b378","name":"auth payload","rules":[{"t":"set","p":"payload","pt":"msg","to":"{}","tot":"json"},{"t":"set","p":"payload.client_id","pt":"msg","to":"node-red-editor","tot":"str"},{"t":"set","p":"payload.grant_type","pt":"msg","to":"password","tot":"str"},{"t":"set","p":"payload.scope","pt":"msg","to":"","tot":"str"},{"t":"set","p":"payload.username","pt":"msg","to":"NRADM_USER","tot":"env"},{"t":"set","p":"payload.password","pt":"msg","to":"NRADM_PASS","tot":"env"}],"action":"","property":"","from":"","to":"","reg":false,"x":1070,"y":640,"wires":[["d77788f9.d3d898"]]},{"id":"a454070d.8ca288","type":"change","z":"a82c65ac.c0b378","name":"","rules":[{"t":"set","p":"accessToken","pt":"msg","to":"payload.access_token","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":1560,"y":640,"wires":[["492fc232.36e03c"]]},{"id":"492fc232.36e03c","type":"change","z":"a82c65ac.c0b378","name":"bearer","rules":[{"t":"set","p":"headers","pt":"msg","to":"{}","tot":"json"},{"t":"set","p":"headers.authorization","pt":"msg","to":"\"Bearer \" & msg.accessToken","tot":"jsonata"}],"action":"","property":"","from":"","to":"","reg":false,"x":1750,"y":640,"wires":[["f6faf63d.cde058"]]},{"id":"87bee558.803758","type":"change","z":"a82c65ac.c0b378","name":"bearer","rules":[{"t":"set","p":"headers","pt":"msg","to":"{}","tot":"json"},{"t":"set","p":"headers.authorization","pt":"msg","to":"\"Bearer \" & msg.accessToken","tot":"jsonata"}],"action":"","property":"","from":"","to":"","reg":false,"x":2410,"y":640,"wires":[["5199b461.b71abc"]]},{"id":"eca6f0b7.67cef","type":"change","z":"a82c65ac.c0b378","name":"bearer","rules":[{"t":"set","p":"headers","pt":"msg","to":"{}","tot":"json"},{"t":"set","p":"headers.authorization","pt":"msg","to":"\"Bearer \" & msg.accessToken","tot":"jsonata"}],"action":"","property":"","from":"","to":"","reg":false,"x":3030,"y":640,"wires":[["d71f1a5b.464048"]]},{"id":"177cbb3b.cdb405","type":"http request","z":"a82c65ac.c0b378","name":"auth","method":"POST","ret":"obj","paytoqs":"ignore","url":"https://localhost:1880/auth/token","tls":"b1a419c1.609c28","persist":false,"proxy":"","authType":"","x":1090,"y":740,"wires":[["c0a65dd5.dc77f"]]},{"id":"e406d85d.51abd8","type":"change","z":"a82c65ac.c0b378","name":"auth payload","rules":[{"t":"set","p":"payload.client_id","pt":"msg","to":"node-red-editor","tot":"str"},{"t":"set","p":"payload.grant_type","pt":"msg","to":"password","tot":"str"},{"t":"set","p":"payload.scope","pt":"msg","to":"","tot":"str"},{"t":"set","p":"payload.username","pt":"msg","to":"NRADM_USER","tot":"env"},{"t":"set","p":"payload.password","pt":"msg","to":"NRADM_PASS","tot":"env"}],"action":"","property":"","from":"","to":"","reg":false,"x":930,"y":740,"wires":[["177cbb3b.cdb405"]]},{"id":"e2c0f823.930488","type":"change","z":"a82c65ac.c0b378","name":"","rules":[{"t":"set","p":"accessToken","pt":"msg","to":"payload.access_token","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":1420,"y":740,"wires":[["67edcec2.efedf"]]},{"id":"67edcec2.efedf","type":"change","z":"a82c65ac.c0b378","name":"bearer","rules":[{"t":"set","p":"headers","pt":"msg","to":"{}","tot":"json"},{"t":"set","p":"headers.authorization","pt":"msg","to":"\"Bearer \" & msg.accessToken","tot":"jsonata"}],"action":"","property":"","from":"","to":"","reg":false,"x":1590,"y":740,"wires":[["70afc34e.a7a66c"]]},{"id":"d9e56172.50319","type":"change","z":"a82c65ac.c0b378","name":"bearer","rules":[{"t":"set","p":"headers","pt":"msg","to":"{}","tot":"json"},{"t":"set","p":"headers.authorization","pt":"msg","to":"\"Bearer \" & msg.accessToken","tot":"jsonata"}],"action":"","property":"","from":"","to":"","reg":false,"x":2250,"y":740,"wires":[["bf4536c6.8e60b8"]]},{"id":"98dbba82.e40268","type":"http request","z":"a82c65ac.c0b378","name":"auth","method":"POST","ret":"obj","paytoqs":"ignore","url":"https://localhost:1880/auth/token","tls":"b1a419c1.609c28","persist":false,"proxy":"","authType":"","x":1090,"y":840,"wires":[["d1fe3d70.b7117"]]},{"id":"fa883453.9c63c8","type":"change","z":"a82c65ac.c0b378","name":"auth payload","rules":[{"t":"set","p":"payload","pt":"msg","to":"{}","tot":"json"},{"t":"set","p":"payload.client_id","pt":"msg","to":"node-red-editor","tot":"str"},{"t":"set","p":"payload.grant_type","pt":"msg","to":"password","tot":"str"},{"t":"set","p":"payload.scope","pt":"msg","to":"","tot":"str"},{"t":"set","p":"payload.username","pt":"msg","to":"NRADM_USER","tot":"env"},{"t":"set","p":"payload.password","pt":"msg","to":"NRADM_PASS","tot":"env"}],"action":"","property":"","from":"","to":"","reg":false,"x":930,"y":840,"wires":[["98dbba82.e40268"]]},{"id":"9da0d200.493ba","type":"change","z":"a82c65ac.c0b378","name":"","rules":[{"t":"set","p":"accessToken","pt":"msg","to":"payload.access_token","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":1420,"y":840,"wires":[["86c1d3c4.4b49e"]]},{"id":"86c1d3c4.4b49e","type":"change","z":"a82c65ac.c0b378","name":"bearer","rules":[{"t":"set","p":"headers","pt":"msg","to":"{}","tot":"json"},{"t":"set","p":"headers.authorization","pt":"msg","to":"\"Bearer \" & msg.accessToken","tot":"jsonata"}],"action":"","property":"","from":"","to":"","reg":false,"x":1610,"y":840,"wires":[["c853a27a.a4fc6"]]},{"id":"1424309d.bb1c7f","type":"http request","z":"a82c65ac.c0b378","name":"auth","method":"POST","ret":"obj","paytoqs":"ignore","url":"https://localhost:1880/auth/token","tls":"b1a419c1.609c28","persist":false,"proxy":"","authType":"","x":1090,"y":940,"wires":[["3db8931.c4ec96c"]]},{"id":"fa899f5f.39c3e","type":"change","z":"a82c65ac.c0b378","name":"auth payload","rules":[{"t":"set","p":"payload.client_id","pt":"msg","to":"node-red-editor","tot":"str"},{"t":"set","p":"payload.grant_type","pt":"msg","to":"password","tot":"str"},{"t":"set","p":"payload.scope","pt":"msg","to":"","tot":"str"},{"t":"set","p":"payload.username","pt":"msg","to":"NRADM_USER","tot":"env"},{"t":"set","p":"payload.password","pt":"msg","to":"NRADM_PASS","tot":"env"}],"action":"","property":"","from":"","to":"","reg":false,"x":930,"y":940,"wires":[["1424309d.bb1c7f"]]},{"id":"74d74735.8067e8","type":"change","z":"a82c65ac.c0b378","name":"","rules":[{"t":"set","p":"accessToken","pt":"msg","to":"payload.access_token","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":1420,"y":940,"wires":[["c807988c.ea0808"]]},{"id":"c807988c.ea0808","type":"change","z":"a82c65ac.c0b378","name":"bearer","rules":[{"t":"set","p":"headers","pt":"msg","to":"{}","tot":"json"},{"t":"set","p":"headers.authorization","pt":"msg","to":"\"Bearer \" & msg.accessToken","tot":"jsonata"}],"action":"","property":"","from":"","to":"","reg":false,"x":1610,"y":940,"wires":[["c0630be3.f1ba18"]]},{"id":"93530188.73d6d","type":"http request","z":"a82c65ac.c0b378","name":"auth","method":"POST","ret":"obj","paytoqs":"ignore","url":"https://localhost:1880/auth/token","tls":"b1a419c1.609c28","persist":false,"proxy":"","authType":"","x":1090,"y":1040,"wires":[["2fe01ccd.5e7d14"]]},{"id":"5f8fc5cd.de45dc","type":"change","z":"a82c65ac.c0b378","name":"auth payload","rules":[{"t":"set","p":"payload","pt":"msg","to":"{}","tot":"json"},{"t":"set","p":"payload.client_id","pt":"msg","to":"node-red-editor","tot":"str"},{"t":"set","p":"payload.grant_type","pt":"msg","to":"password","tot":"str"},{"t":"set","p":"payload.scope","pt":"msg","to":"","tot":"str"},{"t":"set","p":"payload.username","pt":"msg","to":"NRADM_USER","tot":"env"},{"t":"set","p":"payload.password","pt":"msg","to":"NRADM_PASS","tot":"env"}],"action":"","property":"","from":"","to":"","reg":false,"x":930,"y":1040,"wires":[["93530188.73d6d"]]},{"id":"2baeb9d.c9d8546","type":"change","z":"a82c65ac.c0b378","name":"","rules":[{"t":"set","p":"accessToken","pt":"msg","to":"payload.access_token","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":1420,"y":1040,"wires":[["41d58c3a.7f4454"]]},{"id":"41d58c3a.7f4454","type":"change","z":"a82c65ac.c0b378","name":"bearer","rules":[{"t":"set","p":"headers","pt":"msg","to":"{}","tot":"json"},{"t":"set","p":"headers.authorization","pt":"msg","to":"\"Bearer \" & msg.accessToken","tot":"jsonata"}],"action":"","property":"","from":"","to":"","reg":false,"x":1610,"y":1040,"wires":[["9ddc7b5c.808798"]]},{"id":"7091593e.437098","type":"http request","z":"a82c65ac.c0b378","name":"auth","method":"POST","ret":"obj","paytoqs":"ignore","url":"https://localhost:1880/auth/token","tls":"b1a419c1.609c28","persist":false,"proxy":"","authType":"","x":1090,"y":1140,"wires":[["d38cd6c6.614d58"]]},{"id":"24787474.c20e1c","type":"change","z":"a82c65ac.c0b378","name":"auth payload","rules":[{"t":"set","p":"payload.client_id","pt":"msg","to":"node-red-editor","tot":"str"},{"t":"set","p":"payload.grant_type","pt":"msg","to":"password","tot":"str"},{"t":"set","p":"payload.scope","pt":"msg","to":"","tot":"str"},{"t":"set","p":"payload.username","pt":"msg","to":"NRADM_USER","tot":"env"},{"t":"set","p":"payload.password","pt":"msg","to":"NRADM_PASS","tot":"env"}],"action":"","property":"","from":"","to":"","reg":false,"x":930,"y":1140,"wires":[["7091593e.437098"]]},{"id":"2aca46fd.1bb94a","type":"change","z":"a82c65ac.c0b378","name":"","rules":[{"t":"set","p":"accessToken","pt":"msg","to":"payload.access_token","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":1420,"y":1140,"wires":[["4e214881.d8d968"]]},{"id":"4e214881.d8d968","type":"change","z":"a82c65ac.c0b378","name":"bearer","rules":[{"t":"set","p":"headers","pt":"msg","to":"{}","tot":"json"},{"t":"set","p":"headers.authorization","pt":"msg","to":"\"Bearer \" & msg.accessToken","tot":"jsonata"}],"action":"","property":"","from":"","to":"","reg":false,"x":1610,"y":1140,"wires":[["53ecbf1.74d724"]]},{"id":"5a0ab236.df401c","type":"http request","z":"a82c65ac.c0b378","name":"auth","method":"POST","ret":"obj","paytoqs":"ignore","url":"https://localhost:1880/auth/token","tls":"b1a419c1.609c28","persist":false,"proxy":"","authType":"","x":1090,"y":1240,"wires":[["58f489c5.a74e38"]]},{"id":"56658d0.a5a5974","type":"change","z":"a82c65ac.c0b378","name":"auth payload","rules":[{"t":"set","p":"payload","pt":"msg","to":"{}","tot":"json"},{"t":"set","p":"payload.client_id","pt":"msg","to":"node-red-editor","tot":"str"},{"t":"set","p":"payload.grant_type","pt":"msg","to":"password","tot":"str"},{"t":"set","p":"payload.scope","pt":"msg","to":"","tot":"str"},{"t":"set","p":"payload.username","pt":"msg","to":"NRADM_USER","tot":"env"},{"t":"set","p":"payload.password","pt":"msg","to":"NRADM_PASS","tot":"env"}],"action":"","property":"","from":"","to":"","reg":false,"x":930,"y":1240,"wires":[["5a0ab236.df401c"]]},{"id":"eb5e7d68.7a11c","type":"change","z":"a82c65ac.c0b378","name":"","rules":[{"t":"set","p":"accessToken","pt":"msg","to":"payload.access_token","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":1420,"y":1240,"wires":[["b3fd00bb.d6a77"]]},{"id":"b3fd00bb.d6a77","type":"change","z":"a82c65ac.c0b378","name":"bearer","rules":[{"t":"set","p":"headers","pt":"msg","to":"{}","tot":"json"},{"t":"set","p":"headers.authorization","pt":"msg","to":"\"Bearer \" & msg.accessToken","tot":"jsonata"}],"action":"","property":"","from":"","to":"","reg":false,"x":1610,"y":1240,"wires":[["c6c5bbb8.9c96b8"]]},{"id":"b216f228.01b7","type":"http request","z":"a82c65ac.c0b378","name":"auth","method":"POST","ret":"obj","paytoqs":"ignore","url":"https://localhost:1880/auth/token","tls":"b1a419c1.609c28","persist":false,"proxy":"","authType":"","x":1090,"y":1340,"wires":[["7d7f10b5.08432"]]},{"id":"5fa1bf59.9418d","type":"change","z":"a82c65ac.c0b378","name":"auth payload","rules":[{"t":"set","p":"payload.client_id","pt":"msg","to":"node-red-editor","tot":"str"},{"t":"set","p":"payload.grant_type","pt":"msg","to":"password","tot":"str"},{"t":"set","p":"payload.scope","pt":"msg","to":"","tot":"str"},{"t":"set","p":"payload.username","pt":"msg","to":"NRADM_USER","tot":"env"},{"t":"set","p":"payload.password","pt":"msg","to":"NRADM_PASS","tot":"env"}],"action":"","property":"","from":"","to":"","reg":false,"x":930,"y":1340,"wires":[["b216f228.01b7"]]},{"id":"7ca15b22.b01fc4","type":"change","z":"a82c65ac.c0b378","name":"","rules":[{"t":"set","p":"accessToken","pt":"msg","to":"payload.access_token","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":1420,"y":1340,"wires":[["3e651a3b.8d7a96"]]},{"id":"3e651a3b.8d7a96","type":"change","z":"a82c65ac.c0b378","name":"bearer","rules":[{"t":"set","p":"headers","pt":"msg","to":"{}","tot":"json"},{"t":"set","p":"headers.authorization","pt":"msg","to":"\"Bearer \" & msg.accessToken","tot":"jsonata"}],"action":"","property":"","from":"","to":"","reg":false,"x":1610,"y":1340,"wires":[["b04b44e9.2db3d8"]]},{"id":"820753a8.a7f31","type":"http request","z":"a82c65ac.c0b378","name":"auth","method":"POST","ret":"obj","paytoqs":"ignore","url":"https://localhost:1880/auth/token","tls":"b1a419c1.609c28","persist":false,"proxy":"","authType":"","x":1070,"y":1440,"wires":[["63dc7385.6e343c"]]},{"id":"e162661b.b45ef8","type":"change","z":"a82c65ac.c0b378","name":"auth payload","rules":[{"t":"set","p":"payload","pt":"msg","to":"{}","tot":"json"},{"t":"set","p":"payload.client_id","pt":"msg","to":"node-red-editor","tot":"str"},{"t":"set","p":"payload.grant_type","pt":"msg","to":"password","tot":"str"},{"t":"set","p":"payload.scope","pt":"msg","to":"","tot":"str"},{"t":"set","p":"payload.username","pt":"msg","to":"NRADM_USER","tot":"env"},{"t":"set","p":"payload.password","pt":"msg","to":"NRADM_PASS","tot":"env"}],"action":"","property":"","from":"","to":"","reg":false,"x":910,"y":1440,"wires":[["820753a8.a7f31"]]},{"id":"f23b1b22.ca0318","type":"change","z":"a82c65ac.c0b378","name":"","rules":[{"t":"set","p":"accessToken","pt":"msg","to":"payload.access_token","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":1400,"y":1440,"wires":[["3980222.7f550de"]]},{"id":"3980222.7f550de","type":"change","z":"a82c65ac.c0b378","name":"bearer","rules":[{"t":"set","p":"headers","pt":"msg","to":"{}","tot":"json"},{"t":"set","p":"headers.authorization","pt":"msg","to":"\"Bearer \" & msg.accessToken","tot":"jsonata"}],"action":"","property":"","from":"","to":"","reg":false,"x":1590,"y":1440,"wires":[["2ac60eb9.3866b2"]]},{"id":"1b8fd2eb.869e4d","type":"http request","z":"a82c65ac.c0b378","name":"auth","method":"POST","ret":"obj","paytoqs":"ignore","url":"https://localhost:1880/auth/token","tls":"b1a419c1.609c28","persist":false,"proxy":"","authType":"","x":1070,"y":1540,"wires":[["55c26b2d.e85f44"]]},{"id":"6618b2ca.0e401c","type":"change","z":"a82c65ac.c0b378","name":"auth payload","rules":[{"t":"set","p":"payload.client_id","pt":"msg","to":"node-red-editor","tot":"str"},{"t":"set","p":"payload.grant_type","pt":"msg","to":"password","tot":"str"},{"t":"set","p":"payload.scope","pt":"msg","to":"","tot":"str"},{"t":"set","p":"payload.username","pt":"msg","to":"NRADM_USER","tot":"env"},{"t":"set","p":"payload.password","pt":"msg","to":"NRADM_PASS","tot":"env"}],"action":"","property":"","from":"","to":"","reg":false,"x":910,"y":1540,"wires":[["1b8fd2eb.869e4d"]]},{"id":"ab91cfac.6190e","type":"change","z":"a82c65ac.c0b378","name":"","rules":[{"t":"set","p":"accessToken","pt":"msg","to":"payload.access_token","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":1400,"y":1540,"wires":[["85e7d8c.a66d828"]]},{"id":"85e7d8c.a66d828","type":"change","z":"a82c65ac.c0b378","name":"bearer","rules":[{"t":"set","p":"headers","pt":"msg","to":"{}","tot":"json"},{"t":"set","p":"headers.authorization","pt":"msg","to":"\"Bearer \" & msg.accessToken","tot":"jsonata"}],"action":"","property":"","from":"","to":"","reg":false,"x":1590,"y":1540,"wires":[["ab70a560.4db708"]]},{"id":"14bd7180.dc9e3f","type":"http request","z":"a82c65ac.c0b378","name":"auth","method":"POST","ret":"obj","paytoqs":"ignore","url":"https://localhost:1880/auth/token","tls":"b1a419c1.609c28","persist":false,"proxy":"","authType":"","x":1190,"y":1640,"wires":[["bcb4305b.00a1a"]]},{"id":"46877241.8f29dc","type":"change","z":"a82c65ac.c0b378","name":"auth payload","rules":[{"t":"set","p":"payload","pt":"msg","to":"{}","tot":"json"},{"t":"set","p":"payload.client_id","pt":"msg","to":"node-red-editor","tot":"str"},{"t":"set","p":"payload.grant_type","pt":"msg","to":"password","tot":"str"},{"t":"set","p":"payload.scope","pt":"msg","to":"","tot":"str"},{"t":"set","p":"payload.username","pt":"msg","to":"NRADM_USER","tot":"env"},{"t":"set","p":"payload.password","pt":"msg","to":"NRADM_PASS","tot":"env"}],"action":"","property":"","from":"","to":"","reg":false,"x":1030,"y":1640,"wires":[["14bd7180.dc9e3f"]]},{"id":"a6887de9.be273","type":"change","z":"a82c65ac.c0b378","name":"","rules":[{"t":"set","p":"accessToken","pt":"msg","to":"payload.access_token","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":1520,"y":1640,"wires":[["b27cdea5.34c56"]]},{"id":"b27cdea5.34c56","type":"change","z":"a82c65ac.c0b378","name":"bearer","rules":[{"t":"set","p":"headers","pt":"msg","to":"{}","tot":"json"},{"t":"set","p":"headers.authorization","pt":"msg","to":"\"Bearer \" & msg.accessToken","tot":"jsonata"}],"action":"","property":"","from":"","to":"","reg":false,"x":1710,"y":1640,"wires":[["9d284252.6278a"]]},{"id":"f330249f.0d4868","type":"http request","z":"a82c65ac.c0b378","name":"auth","method":"POST","ret":"obj","paytoqs":"ignore","url":"https://localhost:1880/auth/token","tls":"b1a419c1.609c28","persist":false,"proxy":"","authType":"","x":1250,"y":1740,"wires":[["7829de79.26354"]]},{"id":"d30d9e81.7e821","type":"change","z":"a82c65ac.c0b378","name":"auth payload","rules":[{"t":"set","p":"payload.client_id","pt":"msg","to":"node-red-editor","tot":"str"},{"t":"set","p":"payload.grant_type","pt":"msg","to":"password","tot":"str"},{"t":"set","p":"payload.scope","pt":"msg","to":"","tot":"str"},{"t":"set","p":"payload.username","pt":"msg","to":"NRADM_USER","tot":"env"},{"t":"set","p":"payload.password","pt":"msg","to":"NRADM_PASS","tot":"env"}],"action":"","property":"","from":"","to":"","reg":false,"x":1090,"y":1740,"wires":[["f330249f.0d4868"]]},{"id":"9028ef60.9a61b","type":"change","z":"a82c65ac.c0b378","name":"","rules":[{"t":"set","p":"accessToken","pt":"msg","to":"payload.access_token","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":1580,"y":1740,"wires":[["237d5ac1.8c97c6"]]},{"id":"237d5ac1.8c97c6","type":"change","z":"a82c65ac.c0b378","name":"bearer","rules":[{"t":"set","p":"headers","pt":"msg","to":"{}","tot":"json"},{"t":"set","p":"headers.authorization","pt":"msg","to":"\"Bearer \" & msg.accessToken","tot":"jsonata"}],"action":"","property":"","from":"","to":"","reg":false,"x":1770,"y":1740,"wires":[["a5fead04.064ec"]]},{"id":"3d6b7f4b.f7be9","type":"http request","z":"a82c65ac.c0b378","name":"auth","method":"POST","ret":"obj","paytoqs":"ignore","url":"https://localhost:1880/auth/token","tls":"b1a419c1.609c28","persist":false,"proxy":"","authType":"","x":1130,"y":1840,"wires":[["e348e99c.962108"]]},{"id":"101f3491.0e9d0b","type":"change","z":"a82c65ac.c0b378","name":"auth payload","rules":[{"t":"set","p":"payload","pt":"msg","to":"{}","tot":"json"},{"t":"set","p":"payload.client_id","pt":"msg","to":"node-red-editor","tot":"str"},{"t":"set","p":"payload.grant_type","pt":"msg","to":"password","tot":"str"},{"t":"set","p":"payload.scope","pt":"msg","to":"","tot":"str"},{"t":"set","p":"payload.username","pt":"msg","to":"NRADM_USER","tot":"env"},{"t":"set","p":"payload.password","pt":"msg","to":"NRADM_PASS","tot":"env"}],"action":"","property":"","from":"","to":"","reg":false,"x":970,"y":1840,"wires":[["3d6b7f4b.f7be9"]]},{"id":"e348e99c.962108","type":"change","z":"a82c65ac.c0b378","name":"","rules":[{"t":"set","p":"accessToken","pt":"msg","to":"payload.access_token","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":1320,"y":1840,"wires":[["a44634ae.7eda28"]]},{"id":"a44634ae.7eda28","type":"change","z":"a82c65ac.c0b378","name":"bearer","rules":[{"t":"set","p":"headers","pt":"msg","to":"{}","tot":"json"},{"t":"set","p":"headers.authorization","pt":"msg","to":"\"Bearer \" & msg.accessToken","tot":"jsonata"}],"action":"","property":"","from":"","to":"","reg":false,"x":1510,"y":1840,"wires":[["3868d3ff.4018dc"]]},{"id":"af395046.25e01","type":"http request","z":"a82c65ac.c0b378","name":"auth","method":"POST","ret":"obj","paytoqs":"ignore","url":"https://localhost:1880/auth/token","tls":"b1a419c1.609c28","persist":false,"proxy":"","authType":"","x":1130,"y":1940,"wires":[["4f35f3e2.f87e5c"]]},{"id":"169ee90.fd5f217","type":"change","z":"a82c65ac.c0b378","name":"auth payload","rules":[{"t":"set","p":"payload.client_id","pt":"msg","to":"node-red-editor","tot":"str"},{"t":"set","p":"payload.grant_type","pt":"msg","to":"password","tot":"str"},{"t":"set","p":"payload.scope","pt":"msg","to":"","tot":"str"},{"t":"set","p":"payload.username","pt":"msg","to":"NRADM_USER","tot":"env"},{"t":"set","p":"payload.password","pt":"msg","to":"NRADM_PASS","tot":"env"}],"action":"","property":"","from":"","to":"","reg":false,"x":970,"y":1940,"wires":[["af395046.25e01"]]},{"id":"eba2448b.f9b888","type":"change","z":"a82c65ac.c0b378","name":"","rules":[{"t":"set","p":"accessToken","pt":"msg","to":"payload.access_token","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":1460,"y":1940,"wires":[["9e9088e9.181ed8"]]},{"id":"9e9088e9.181ed8","type":"change","z":"a82c65ac.c0b378","name":"bearer","rules":[{"t":"set","p":"headers","pt":"msg","to":"{}","tot":"json"},{"t":"set","p":"headers.authorization","pt":"msg","to":"\"Bearer \" & msg.accessToken","tot":"jsonata"}],"action":"","property":"","from":"","to":"","reg":false,"x":1650,"y":1940,"wires":[["c890160e.b89058"]]},{"id":"e3453cd1.4dcad","type":"http request","z":"a82c65ac.c0b378","name":"auth","method":"POST","ret":"obj","paytoqs":"ignore","url":"https://localhost:1880/auth/token","tls":"b1a419c1.609c28","persist":false,"proxy":"","authType":"","x":1090,"y":2040,"wires":[["d6b58903.b01438"]]},{"id":"1cffa17c.8209cf","type":"change","z":"a82c65ac.c0b378","name":"auth payload","rules":[{"t":"set","p":"payload","pt":"msg","to":"{}","tot":"json"},{"t":"set","p":"payload.client_id","pt":"msg","to":"node-red-editor","tot":"str"},{"t":"set","p":"payload.grant_type","pt":"msg","to":"password","tot":"str"},{"t":"set","p":"payload.scope","pt":"msg","to":"","tot":"str"},{"t":"set","p":"payload.username","pt":"msg","to":"NRADM_USER","tot":"env"},{"t":"set","p":"payload.password","pt":"msg","to":"NRADM_PASS","tot":"env"}],"action":"","property":"","from":"","to":"","reg":false,"x":930,"y":2040,"wires":[["e3453cd1.4dcad"]]},{"id":"967f46d3.f4c9f8","type":"change","z":"a82c65ac.c0b378","name":"","rules":[{"t":"set","p":"accessToken","pt":"msg","to":"payload.access_token","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":1420,"y":2040,"wires":[["36905978.eb6706"]]},{"id":"36905978.eb6706","type":"change","z":"a82c65ac.c0b378","name":"bearer","rules":[{"t":"set","p":"headers","pt":"msg","to":"{}","tot":"json"},{"t":"set","p":"headers.authorization","pt":"msg","to":"\"Bearer \" & msg.accessToken","tot":"jsonata"}],"action":"","property":"","from":"","to":"","reg":false,"x":1610,"y":2040,"wires":[["afeeb653.f639f8"]]},{"id":"d984029c.029c3","type":"http request","z":"a82c65ac.c0b378","name":"auth","method":"POST","ret":"obj","paytoqs":"ignore","url":"https://localhost:1880/auth/token","tls":"b1a419c1.609c28","persist":false,"proxy":"","authType":"","x":1090,"y":2140,"wires":[["fdcf29e9.b25be8"]]},{"id":"65b45400.f921ac","type":"change","z":"a82c65ac.c0b378","name":"auth payload","rules":[{"t":"set","p":"payload.client_id","pt":"msg","to":"node-red-editor","tot":"str"},{"t":"set","p":"payload.grant_type","pt":"msg","to":"password","tot":"str"},{"t":"set","p":"payload.scope","pt":"msg","to":"","tot":"str"},{"t":"set","p":"payload.username","pt":"msg","to":"NRADM_USER","tot":"env"},{"t":"set","p":"payload.password","pt":"msg","to":"NRADM_PASS","tot":"env"}],"action":"","property":"","from":"","to":"","reg":false,"x":930,"y":2140,"wires":[["d984029c.029c3"]]},{"id":"61a45fbb.c709e","type":"change","z":"a82c65ac.c0b378","name":"","rules":[{"t":"set","p":"accessToken","pt":"msg","to":"payload.access_token","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":1420,"y":2140,"wires":[["5a7654bd.7243cc"]]},{"id":"5a7654bd.7243cc","type":"change","z":"a82c65ac.c0b378","name":"bearer","rules":[{"t":"set","p":"headers","pt":"msg","to":"{}","tot":"json"},{"t":"set","p":"headers.authorization","pt":"msg","to":"\"Bearer \" & msg.accessToken","tot":"jsonata"}],"action":"","property":"","from":"","to":"","reg":false,"x":1610,"y":2140,"wires":[["47a3df94.1c30e"]]},{"id":"8f9c8b92.0ca268","type":"http request","z":"a82c65ac.c0b378","name":"","method":"POST","ret":"obj","paytoqs":"ignore","url":"${CFG_ACL_ENDP}","tls":"51b09598.a1114c","persist":false,"proxy":"","authType":"","x":630,"y":40,"wires":[["c2d902a0.0b26f"]]},{"id":"c2d902a0.0b26f","type":"switch","z":"a82c65ac.c0b378","name":"","property":"statusCode","propertyType":"msg","rules":[{"t":"eq","v":"200","vt":"num"},{"t":"else"}],"checkall":"true","repair":false,"outputs":2,"x":790,"y":40,"wires":[["8804bdcd.5d43a"],["80346ac.0e4fd98"]]},{"id":"f7c1603c.c76a3","type":"http request","z":"a82c65ac.c0b378","name":"","method":"POST","ret":"obj","paytoqs":"ignore","url":"${CFG_ACL_ENDP}","tls":"51b09598.a1114c","persist":false,"proxy":"","authType":"","x":630,"y":140,"wires":[["e3dec45b.eb5618"]]},{"id":"e3dec45b.eb5618","type":"switch","z":"a82c65ac.c0b378","name":"","property":"statusCode","propertyType":"msg","rules":[{"t":"eq","v":"200","vt":"num"},{"t":"else"}],"checkall":"true","repair":false,"outputs":2,"x":790,"y":140,"wires":[["eb1f03da.b1eb6"],["a07c7a4e.83d448"]]},{"id":"32ed2d2d.cb4cb2","type":"change","z":"a82c65ac.c0b378","name":"acl req payload","rules":[{"t":"set","p":"headers","pt":"msg","to":"{}","tot":"json"},{"t":"set","p":"payload","pt":"msg","to":"{}","tot":"json"},{"t":"set","p":"payload.url","pt":"msg","to":"req.url","tot":"msg"},{"t":"set","p":"payload.method","pt":"msg","to":"req.method","tot":"msg"},{"t":"set","p":"payload.headers","pt":"msg","to":"req.headers","tot":"msg"},{"t":"set","p":"payload.params","pt":"msg","to":"req.params","tot":"msg"},{"t":"set","p":"payload.query","pt":"msg","to":"req.query","tot":"msg"},{"t":"set","p":"payload.body","pt":"msg","to":"req.body","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":440,"y":140,"wires":[["f7c1603c.c76a3"]]},{"id":"6afd1467.972c6c","type":"change","z":"a82c65ac.c0b378","name":"acl req payload","rules":[{"t":"set","p":"headers","pt":"msg","to":"{}","tot":"json"},{"t":"set","p":"payload","pt":"msg","to":"{}","tot":"json"},{"t":"set","p":"payload.url","pt":"msg","to":"req.url","tot":"msg"},{"t":"set","p":"payload.method","pt":"msg","to":"req.method","tot":"msg"},{"t":"set","p":"payload.headers","pt":"msg","to":"req.headers","tot":"msg"},{"t":"set","p":"payload.params","pt":"msg","to":"req.params","tot":"msg"},{"t":"set","p":"payload.query","pt":"msg","to":"req.query","tot":"msg"},{"t":"set","p":"payload.body","pt":"msg","to":"req.body","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":440,"y":40,"wires":[["8f9c8b92.0ca268"]]},{"id":"a07c7a4e.83d448","type":"http response","z":"a82c65ac.c0b378","name":"","statusCode":"","headers":{},"x":930,"y":180,"wires":[]},{"id":"56da5b17.b85314","type":"http request","z":"a82c65ac.c0b378","name":"","method":"POST","ret":"obj","paytoqs":"ignore","url":"${CFG_ACL_ENDP}","tls":"51b09598.a1114c","persist":false,"proxy":"","authType":"","x":610,"y":340,"wires":[["e73dbf1a.e32ff"]]},{"id":"e73dbf1a.e32ff","type":"switch","z":"a82c65ac.c0b378","name":"","property":"statusCode","propertyType":"msg","rules":[{"t":"eq","v":"200","vt":"num"},{"t":"else"}],"checkall":"true","repair":false,"outputs":2,"x":770,"y":340,"wires":[["af9d3574.d36228"],["27c8f458.5ce68c"]]},{"id":"eb371ab5.b615c8","type":"change","z":"a82c65ac.c0b378","name":"acl req payload","rules":[{"t":"set","p":"headers","pt":"msg","to":"{}","tot":"json"},{"t":"set","p":"payload","pt":"msg","to":"{}","tot":"json"},{"t":"set","p":"payload.url","pt":"msg","to":"req.url","tot":"msg"},{"t":"set","p":"payload.method","pt":"msg","to":"req.method","tot":"msg"},{"t":"set","p":"payload.headers","pt":"msg","to":"req.headers","tot":"msg"},{"t":"set","p":"payload.params","pt":"msg","to":"req.params","tot":"msg"},{"t":"set","p":"payload.query","pt":"msg","to":"req.query","tot":"msg"},{"t":"set","p":"payload.body","pt":"msg","to":"req.body","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":420,"y":340,"wires":[["56da5b17.b85314"]]},{"id":"27c8f458.5ce68c","type":"http response","z":"a82c65ac.c0b378","name":"","statusCode":"","headers":{},"x":910,"y":380,"wires":[]},{"id":"8b2c45b6.26d768","type":"http request","z":"a82c65ac.c0b378","name":"","method":"POST","ret":"obj","paytoqs":"ignore","url":"${CFG_ACL_ENDP}","tls":"51b09598.a1114c","persist":false,"proxy":"","authType":"","x":630,"y":240,"wires":[["fcf97d7c.feb6c"]]},{"id":"fcf97d7c.feb6c","type":"switch","z":"a82c65ac.c0b378","name":"","property":"statusCode","propertyType":"msg","rules":[{"t":"eq","v":"200","vt":"num"},{"t":"else"}],"checkall":"true","repair":false,"outputs":2,"x":790,"y":240,"wires":[["aebe1413.576a08"],["ba859c11.f50ea"]]},{"id":"4eab7273.ae375c","type":"change","z":"a82c65ac.c0b378","name":"acl req payload","rules":[{"t":"set","p":"headers","pt":"msg","to":"{}","tot":"json"},{"t":"set","p":"payload","pt":"msg","to":"{}","tot":"json"},{"t":"set","p":"payload.url","pt":"msg","to":"req.url","tot":"msg"},{"t":"set","p":"payload.method","pt":"msg","to":"req.method","tot":"msg"},{"t":"set","p":"payload.headers","pt":"msg","to":"req.headers","tot":"msg"},{"t":"set","p":"payload.params","pt":"msg","to":"req.params","tot":"msg"},{"t":"set","p":"payload.query","pt":"msg","to":"req.query","tot":"msg"},{"t":"set","p":"payload.body","pt":"msg","to":"req.body","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":440,"y":240,"wires":[["8b2c45b6.26d768"]]},{"id":"ba859c11.f50ea","type":"http response","z":"a82c65ac.c0b378","name":"","statusCode":"","headers":{},"x":930,"y":280,"wires":[]},{"id":"75d2ed42.9caca4","type":"http request","z":"a82c65ac.c0b378","name":"","method":"POST","ret":"obj","paytoqs":"ignore","url":"${CFG_ACL_ENDP}","tls":"51b09598.a1114c","persist":false,"proxy":"","authType":"","x":1010,"y":440,"wires":[["4a39dbfb.064ef4"]]},{"id":"4a39dbfb.064ef4","type":"switch","z":"a82c65ac.c0b378","name":"","property":"statusCode","propertyType":"msg","rules":[{"t":"eq","v":"200","vt":"num"},{"t":"else"}],"checkall":"true","repair":false,"outputs":2,"x":1170,"y":440,"wires":[["9da48f4e.4bc57"],["218072fe.cc715e"]]},{"id":"154f7e56.335e92","type":"change","z":"a82c65ac.c0b378","name":"acl req payload","rules":[{"t":"set","p":"headers","pt":"msg","to":"{}","tot":"json"},{"t":"set","p":"payload","pt":"msg","to":"{}","tot":"json"},{"t":"set","p":"payload.url","pt":"msg","to":"req.url","tot":"msg"},{"t":"set","p":"payload.method","pt":"msg","to":"req.method","tot":"msg"},{"t":"set","p":"payload.headers","pt":"msg","to":"req.headers","tot":"msg"},{"t":"set","p":"payload.params","pt":"msg","to":"req.params","tot":"msg"},{"t":"set","p":"payload.query","pt":"msg","to":"req.query","tot":"msg"},{"t":"set","p":"payload.body","pt":"msg","to":"req.body","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":820,"y":440,"wires":[["75d2ed42.9caca4"]]},{"id":"218072fe.cc715e","type":"http response","z":"a82c65ac.c0b378","name":"","statusCode":"","headers":{},"x":1310,"y":480,"wires":[]},{"id":"5c1aeb8d.9fb944","type":"http request","z":"a82c65ac.c0b378","name":"","method":"POST","ret":"obj","paytoqs":"ignore","url":"${CFG_ACL_ENDP}","tls":"51b09598.a1114c","persist":false,"proxy":"","authType":"","x":450,"y":540,"wires":[["896f868f.1a8728"]]},{"id":"896f868f.1a8728","type":"switch","z":"a82c65ac.c0b378","name":"","property":"statusCode","propertyType":"msg","rules":[{"t":"eq","v":"200","vt":"num"},{"t":"else"}],"checkall":"true","repair":false,"outputs":2,"x":610,"y":540,"wires":[["da8e4ae.b0bf4b8"],["a8a63b43.dd4da8"]]},{"id":"800b40ab.7c832","type":"change","z":"a82c65ac.c0b378","name":"acl req payload","rules":[{"t":"set","p":"headers","pt":"msg","to":"{}","tot":"json"},{"t":"set","p":"payload","pt":"msg","to":"{}","tot":"json"},{"t":"set","p":"payload.url","pt":"msg","to":"req.url","tot":"msg"},{"t":"set","p":"payload.method","pt":"msg","to":"req.method","tot":"msg"},{"t":"set","p":"payload.headers","pt":"msg","to":"req.headers","tot":"msg"},{"t":"set","p":"payload.params","pt":"msg","to":"req.params","tot":"msg"},{"t":"set","p":"payload.query","pt":"msg","to":"req.query","tot":"msg"},{"t":"set","p":"payload.body","pt":"msg","to":"req.body","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":260,"y":540,"wires":[["5c1aeb8d.9fb944"]]},{"id":"a8a63b43.dd4da8","type":"http response","z":"a82c65ac.c0b378","name":"","statusCode":"","headers":{},"x":750,"y":580,"wires":[]},{"id":"9451b080.acaad","type":"http request","z":"a82c65ac.c0b378","name":"","method":"POST","ret":"obj","paytoqs":"ignore","url":"${CFG_ACL_ENDP}","tls":"51b09598.a1114c","persist":false,"proxy":"","authType":"","x":750,"y":640,"wires":[["9d1dc341.6a091"]]},{"id":"9d1dc341.6a091","type":"switch","z":"a82c65ac.c0b378","name":"","property":"statusCode","propertyType":"msg","rules":[{"t":"eq","v":"200","vt":"num"},{"t":"else"}],"checkall":"true","repair":false,"outputs":2,"x":910,"y":640,"wires":[["f5bbe5e3.d44368"],["e8b800f5.dbb92"]]},{"id":"f47b20d.0842de","type":"change","z":"a82c65ac.c0b378","name":"acl req payload","rules":[{"t":"set","p":"headers","pt":"msg","to":"{}","tot":"json"},{"t":"set","p":"payload","pt":"msg","to":"{}","tot":"json"},{"t":"set","p":"payload.url","pt":"msg","to":"req.url","tot":"msg"},{"t":"set","p":"payload.method","pt":"msg","to":"req.method","tot":"msg"},{"t":"set","p":"payload.headers","pt":"msg","to":"req.headers","tot":"msg"},{"t":"set","p":"payload.params","pt":"msg","to":"req.params","tot":"msg"},{"t":"set","p":"payload.query","pt":"msg","to":"req.query","tot":"msg"},{"t":"set","p":"payload.body","pt":"msg","to":"req.body","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":560,"y":640,"wires":[["9451b080.acaad"]]},{"id":"e8b800f5.dbb92","type":"http response","z":"a82c65ac.c0b378","name":"","statusCode":"","headers":{},"x":1050,"y":680,"wires":[]},{"id":"ee93af8a.99f89","type":"http request","z":"a82c65ac.c0b378","name":"","method":"POST","ret":"obj","paytoqs":"ignore","url":"${CFG_ACL_ENDP}","tls":"51b09598.a1114c","persist":false,"proxy":"","authType":"","x":610,"y":740,"wires":[["c06b268.d405dd8"]]},{"id":"c06b268.d405dd8","type":"switch","z":"a82c65ac.c0b378","name":"","property":"statusCode","propertyType":"msg","rules":[{"t":"eq","v":"200","vt":"num"},{"t":"else"}],"checkall":"true","repair":false,"outputs":2,"x":770,"y":740,"wires":[["e406d85d.51abd8"],["91a1fb4d.766008"]]},{"id":"3b2353b4.315acc","type":"change","z":"a82c65ac.c0b378","name":"acl req payload","rules":[{"t":"set","p":"headers","pt":"msg","to":"{}","tot":"json"},{"t":"set","p":"payload","pt":"msg","to":"{}","tot":"json"},{"t":"set","p":"payload.url","pt":"msg","to":"req.url","tot":"msg"},{"t":"set","p":"payload.method","pt":"msg","to":"req.method","tot":"msg"},{"t":"set","p":"payload.headers","pt":"msg","to":"req.headers","tot":"msg"},{"t":"set","p":"payload.params","pt":"msg","to":"req.params","tot":"msg"},{"t":"set","p":"payload.query","pt":"msg","to":"req.query","tot":"msg"},{"t":"set","p":"payload.body","pt":"msg","to":"req.body","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":420,"y":740,"wires":[["ee93af8a.99f89"]]},{"id":"91a1fb4d.766008","type":"http response","z":"a82c65ac.c0b378","name":"","statusCode":"","headers":{},"x":910,"y":780,"wires":[]},{"id":"90efce31.26abc","type":"http request","z":"a82c65ac.c0b378","name":"","method":"POST","ret":"obj","paytoqs":"ignore","url":"${CFG_ACL_ENDP}","tls":"51b09598.a1114c","persist":false,"proxy":"","authType":"","x":610,"y":840,"wires":[["692f144f.e78f1c"]]},{"id":"692f144f.e78f1c","type":"switch","z":"a82c65ac.c0b378","name":"","property":"statusCode","propertyType":"msg","rules":[{"t":"eq","v":"200","vt":"num"},{"t":"else"}],"checkall":"true","repair":false,"outputs":2,"x":770,"y":840,"wires":[["fa883453.9c63c8"],["1dc8c0ba.9cbedf"]]},{"id":"283ab7a4.cbe788","type":"change","z":"a82c65ac.c0b378","name":"acl req payload","rules":[{"t":"set","p":"headers","pt":"msg","to":"{}","tot":"json"},{"t":"set","p":"payload","pt":"msg","to":"{}","tot":"json"},{"t":"set","p":"payload.url","pt":"msg","to":"req.url","tot":"msg"},{"t":"set","p":"payload.method","pt":"msg","to":"req.method","tot":"msg"},{"t":"set","p":"payload.headers","pt":"msg","to":"req.headers","tot":"msg"},{"t":"set","p":"payload.params","pt":"msg","to":"req.params","tot":"msg"},{"t":"set","p":"payload.query","pt":"msg","to":"req.query","tot":"msg"},{"t":"set","p":"payload.body","pt":"msg","to":"req.body","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":420,"y":840,"wires":[["90efce31.26abc"]]},{"id":"1dc8c0ba.9cbedf","type":"http response","z":"a82c65ac.c0b378","name":"","statusCode":"","headers":{},"x":910,"y":880,"wires":[]},{"id":"a4de4115.bd759","type":"http request","z":"a82c65ac.c0b378","name":"","method":"POST","ret":"obj","paytoqs":"ignore","url":"${CFG_ACL_ENDP}","tls":"51b09598.a1114c","persist":false,"proxy":"","authType":"","x":610,"y":940,"wires":[["b48325a8.e4a668"]]},{"id":"b48325a8.e4a668","type":"switch","z":"a82c65ac.c0b378","name":"","property":"statusCode","propertyType":"msg","rules":[{"t":"eq","v":"200","vt":"num"},{"t":"else"}],"checkall":"true","repair":false,"outputs":2,"x":770,"y":940,"wires":[["fa899f5f.39c3e"],["1bdca1cd.e5642e"]]},{"id":"49df5ab3.ba8cb4","type":"change","z":"a82c65ac.c0b378","name":"acl req payload","rules":[{"t":"set","p":"headers","pt":"msg","to":"{}","tot":"json"},{"t":"set","p":"payload","pt":"msg","to":"{}","tot":"json"},{"t":"set","p":"payload.url","pt":"msg","to":"req.url","tot":"msg"},{"t":"set","p":"payload.method","pt":"msg","to":"req.method","tot":"msg"},{"t":"set","p":"payload.headers","pt":"msg","to":"req.headers","tot":"msg"},{"t":"set","p":"payload.params","pt":"msg","to":"req.params","tot":"msg"},{"t":"set","p":"payload.query","pt":"msg","to":"req.query","tot":"msg"},{"t":"set","p":"payload.body","pt":"msg","to":"req.body","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":420,"y":940,"wires":[["a4de4115.bd759"]]},{"id":"1bdca1cd.e5642e","type":"http response","z":"a82c65ac.c0b378","name":"","statusCode":"","headers":{},"x":910,"y":980,"wires":[]},{"id":"1f0df4e5.64541b","type":"http request","z":"a82c65ac.c0b378","name":"","method":"POST","ret":"obj","paytoqs":"ignore","url":"${CFG_ACL_ENDP}","tls":"51b09598.a1114c","persist":false,"proxy":"","authType":"","x":610,"y":1040,"wires":[["1a7ee629.7e97aa"]]},{"id":"1a7ee629.7e97aa","type":"switch","z":"a82c65ac.c0b378","name":"","property":"statusCode","propertyType":"msg","rules":[{"t":"eq","v":"200","vt":"num"},{"t":"else"}],"checkall":"true","repair":false,"outputs":2,"x":770,"y":1040,"wires":[["5f8fc5cd.de45dc"],["f6c4a3e0.7e146"]]},{"id":"1c802a34.c9f456","type":"change","z":"a82c65ac.c0b378","name":"acl req payload","rules":[{"t":"set","p":"headers","pt":"msg","to":"{}","tot":"json"},{"t":"set","p":"payload","pt":"msg","to":"{}","tot":"json"},{"t":"set","p":"payload.url","pt":"msg","to":"req.url","tot":"msg"},{"t":"set","p":"payload.method","pt":"msg","to":"req.method","tot":"msg"},{"t":"set","p":"payload.headers","pt":"msg","to":"req.headers","tot":"msg"},{"t":"set","p":"payload.params","pt":"msg","to":"req.params","tot":"msg"},{"t":"set","p":"payload.query","pt":"msg","to":"req.query","tot":"msg"},{"t":"set","p":"payload.body","pt":"msg","to":"req.body","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":420,"y":1040,"wires":[["1f0df4e5.64541b"]]},{"id":"f6c4a3e0.7e146","type":"http response","z":"a82c65ac.c0b378","name":"","statusCode":"","headers":{},"x":910,"y":1080,"wires":[]},{"id":"fd3d03d2.2857a","type":"http request","z":"a82c65ac.c0b378","name":"","method":"POST","ret":"obj","paytoqs":"ignore","url":"${CFG_ACL_ENDP}","tls":"51b09598.a1114c","persist":false,"proxy":"","authType":"","x":610,"y":1140,"wires":[["7920acf0.a6a4c4"]]},{"id":"7920acf0.a6a4c4","type":"switch","z":"a82c65ac.c0b378","name":"","property":"statusCode","propertyType":"msg","rules":[{"t":"eq","v":"200","vt":"num"},{"t":"else"}],"checkall":"true","repair":false,"outputs":2,"x":770,"y":1140,"wires":[["24787474.c20e1c"],["2f9c9343.af2b8c"]]},{"id":"f7d31ce7.a6108","type":"change","z":"a82c65ac.c0b378","name":"acl req payload","rules":[{"t":"set","p":"headers","pt":"msg","to":"{}","tot":"json"},{"t":"set","p":"payload","pt":"msg","to":"{}","tot":"json"},{"t":"set","p":"payload.url","pt":"msg","to":"req.url","tot":"msg"},{"t":"set","p":"payload.method","pt":"msg","to":"req.method","tot":"msg"},{"t":"set","p":"payload.headers","pt":"msg","to":"req.headers","tot":"msg"},{"t":"set","p":"payload.params","pt":"msg","to":"req.params","tot":"msg"},{"t":"set","p":"payload.query","pt":"msg","to":"req.query","tot":"msg"},{"t":"set","p":"payload.body","pt":"msg","to":"req.body","tot":"msg"},{"t":"set","p":"CFG_ACL_ENDP","pt":"msg","to":"CFG_ACL_ENDP","tot":"env"}],"action":"","property":"","from":"","to":"","reg":false,"x":420,"y":1140,"wires":[["fd3d03d2.2857a"]]},{"id":"2f9c9343.af2b8c","type":"http response","z":"a82c65ac.c0b378","name":"","statusCode":"","headers":{},"x":910,"y":1180,"wires":[]},{"id":"f6e4093b.5cdc48","type":"http request","z":"a82c65ac.c0b378","name":"","method":"POST","ret":"obj","paytoqs":"ignore","url":"${CFG_ACL_ENDP}","tls":"51b09598.a1114c","persist":false,"proxy":"","authType":"","x":610,"y":1240,"wires":[["2cad0347.8cba3c"]]},{"id":"2cad0347.8cba3c","type":"switch","z":"a82c65ac.c0b378","name":"","property":"statusCode","propertyType":"msg","rules":[{"t":"eq","v":"200","vt":"num"},{"t":"else"}],"checkall":"true","repair":false,"outputs":2,"x":770,"y":1240,"wires":[["56658d0.a5a5974"],["7132cb26.dbc014"]]},{"id":"ceb9c02a.12953","type":"change","z":"a82c65ac.c0b378","name":"acl req payload","rules":[{"t":"set","p":"headers","pt":"msg","to":"{}","tot":"json"},{"t":"set","p":"payload","pt":"msg","to":"{}","tot":"json"},{"t":"set","p":"payload.url","pt":"msg","to":"req.url","tot":"msg"},{"t":"set","p":"payload.method","pt":"msg","to":"req.method","tot":"msg"},{"t":"set","p":"payload.headers","pt":"msg","to":"req.headers","tot":"msg"},{"t":"set","p":"payload.params","pt":"msg","to":"req.params","tot":"msg"},{"t":"set","p":"payload.query","pt":"msg","to":"req.query","tot":"msg"},{"t":"set","p":"payload.body","pt":"msg","to":"req.body","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":420,"y":1240,"wires":[["f6e4093b.5cdc48"]]},{"id":"7132cb26.dbc014","type":"http response","z":"a82c65ac.c0b378","name":"","statusCode":"","headers":{},"x":910,"y":1280,"wires":[]},{"id":"165edea3.528941","type":"http request","z":"a82c65ac.c0b378","name":"","method":"POST","ret":"obj","paytoqs":"ignore","url":"${CFG_ACL_ENDP}","tls":"51b09598.a1114c","persist":false,"proxy":"","authType":"","x":610,"y":1340,"wires":[["9927462c.9d1658"]]},{"id":"9927462c.9d1658","type":"switch","z":"a82c65ac.c0b378","name":"","property":"statusCode","propertyType":"msg","rules":[{"t":"eq","v":"200","vt":"num"},{"t":"else"}],"checkall":"true","repair":false,"outputs":2,"x":770,"y":1340,"wires":[["5fa1bf59.9418d"],["ddba1bb9.bb5028"]]},{"id":"9851d82e.b7bc98","type":"change","z":"a82c65ac.c0b378","name":"acl req payload","rules":[{"t":"set","p":"headers","pt":"msg","to":"{}","tot":"json"},{"t":"set","p":"payload","pt":"msg","to":"{}","tot":"json"},{"t":"set","p":"payload.url","pt":"msg","to":"req.url","tot":"msg"},{"t":"set","p":"payload.method","pt":"msg","to":"req.method","tot":"msg"},{"t":"set","p":"payload.headers","pt":"msg","to":"req.headers","tot":"msg"},{"t":"set","p":"payload.params","pt":"msg","to":"req.params","tot":"msg"},{"t":"set","p":"payload.query","pt":"msg","to":"req.query","tot":"msg"},{"t":"set","p":"payload.body","pt":"msg","to":"req.body","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":420,"y":1340,"wires":[["165edea3.528941"]]},{"id":"ddba1bb9.bb5028","type":"http response","z":"a82c65ac.c0b378","name":"","statusCode":"","headers":{},"x":910,"y":1380,"wires":[]},{"id":"ca6e45a.ebf74b8","type":"http request","z":"a82c65ac.c0b378","name":"","method":"POST","ret":"obj","paytoqs":"ignore","url":"${CFG_ACL_ENDP}","tls":"51b09598.a1114c","persist":false,"proxy":"","authType":"","x":590,"y":1440,"wires":[["d3cca7bc.31b7c8"]]},{"id":"d3cca7bc.31b7c8","type":"switch","z":"a82c65ac.c0b378","name":"","property":"statusCode","propertyType":"msg","rules":[{"t":"eq","v":"200","vt":"num"},{"t":"else"}],"checkall":"true","repair":false,"outputs":2,"x":750,"y":1440,"wires":[["e162661b.b45ef8"],["7d53f057.79cce"]]},{"id":"85e4ecb5.979cb","type":"change","z":"a82c65ac.c0b378","name":"acl req payload","rules":[{"t":"set","p":"headers","pt":"msg","to":"{}","tot":"json"},{"t":"set","p":"payload","pt":"msg","to":"{}","tot":"json"},{"t":"set","p":"payload.url","pt":"msg","to":"req.url","tot":"msg"},{"t":"set","p":"payload.method","pt":"msg","to":"req.method","tot":"msg"},{"t":"set","p":"payload.headers","pt":"msg","to":"req.headers","tot":"msg"},{"t":"set","p":"payload.params","pt":"msg","to":"req.params","tot":"msg"},{"t":"set","p":"payload.query","pt":"msg","to":"req.query","tot":"msg"},{"t":"set","p":"payload.body","pt":"msg","to":"req.body","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":400,"y":1440,"wires":[["ca6e45a.ebf74b8"]]},{"id":"7d53f057.79cce","type":"http response","z":"a82c65ac.c0b378","name":"","statusCode":"","headers":{},"x":890,"y":1480,"wires":[]},{"id":"4af942f5.0b6d8c","type":"http request","z":"a82c65ac.c0b378","name":"","method":"POST","ret":"obj","paytoqs":"ignore","url":"${CFG_ACL_ENDP}","tls":"51b09598.a1114c","persist":false,"proxy":"","authType":"","x":590,"y":1540,"wires":[["d32b3558.20f858"]]},{"id":"d32b3558.20f858","type":"switch","z":"a82c65ac.c0b378","name":"","property":"statusCode","propertyType":"msg","rules":[{"t":"eq","v":"200","vt":"num"},{"t":"else"}],"checkall":"true","repair":false,"outputs":2,"x":750,"y":1540,"wires":[["6618b2ca.0e401c"],["ec06eda2.a1c61"]]},{"id":"ee6b20ef.83cc","type":"change","z":"a82c65ac.c0b378","name":"acl req payload","rules":[{"t":"set","p":"headers","pt":"msg","to":"{}","tot":"json"},{"t":"set","p":"payload","pt":"msg","to":"{}","tot":"json"},{"t":"set","p":"payload.url","pt":"msg","to":"req.url","tot":"msg"},{"t":"set","p":"payload.method","pt":"msg","to":"req.method","tot":"msg"},{"t":"set","p":"payload.headers","pt":"msg","to":"req.headers","tot":"msg"},{"t":"set","p":"payload.params","pt":"msg","to":"req.params","tot":"msg"},{"t":"set","p":"payload.query","pt":"msg","to":"req.query","tot":"msg"},{"t":"set","p":"payload.body","pt":"msg","to":"req.body","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":400,"y":1540,"wires":[["4af942f5.0b6d8c"]]},{"id":"ec06eda2.a1c61","type":"http response","z":"a82c65ac.c0b378","name":"","statusCode":"","headers":{},"x":890,"y":1580,"wires":[]},{"id":"68a399ac.3cdbc8","type":"http request","z":"a82c65ac.c0b378","name":"","method":"POST","ret":"obj","paytoqs":"ignore","url":"${CFG_ACL_ENDP}","tls":"51b09598.a1114c","persist":false,"proxy":"","authType":"","x":710,"y":1640,"wires":[["2d85ccd6.437f94"]]},{"id":"2d85ccd6.437f94","type":"switch","z":"a82c65ac.c0b378","name":"","property":"statusCode","propertyType":"msg","rules":[{"t":"eq","v":"200","vt":"num"},{"t":"else"}],"checkall":"true","repair":false,"outputs":2,"x":870,"y":1640,"wires":[["46877241.8f29dc"],["994b133e.7a612"]]},{"id":"2bc70ade.973366","type":"change","z":"a82c65ac.c0b378","name":"acl req payload","rules":[{"t":"set","p":"headers","pt":"msg","to":"{}","tot":"json"},{"t":"set","p":"payload","pt":"msg","to":"{}","tot":"json"},{"t":"set","p":"payload.url","pt":"msg","to":"req.url","tot":"msg"},{"t":"set","p":"payload.method","pt":"msg","to":"req.method","tot":"msg"},{"t":"set","p":"payload.headers","pt":"msg","to":"req.headers","tot":"msg"},{"t":"set","p":"payload.params","pt":"msg","to":"req.params","tot":"msg"},{"t":"set","p":"payload.query","pt":"msg","to":"req.query","tot":"msg"},{"t":"set","p":"payload.body","pt":"msg","to":"req.body","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":520,"y":1640,"wires":[["68a399ac.3cdbc8"]]},{"id":"994b133e.7a612","type":"http response","z":"a82c65ac.c0b378","name":"","statusCode":"","headers":{},"x":1010,"y":1680,"wires":[]},{"id":"c99e0c4.02536f","type":"http request","z":"a82c65ac.c0b378","name":"","method":"POST","ret":"obj","paytoqs":"ignore","url":"${CFG_ACL_ENDP}","tls":"51b09598.a1114c","persist":false,"proxy":"","authType":"","x":770,"y":1740,"wires":[["f065f703.895c58"]]},{"id":"f065f703.895c58","type":"switch","z":"a82c65ac.c0b378","name":"","property":"statusCode","propertyType":"msg","rules":[{"t":"eq","v":"200","vt":"num"},{"t":"else"}],"checkall":"true","repair":false,"outputs":2,"x":930,"y":1740,"wires":[["d30d9e81.7e821"],["d6a5ebc1.8b2928"]]},{"id":"c670e075.52a3","type":"change","z":"a82c65ac.c0b378","name":"acl req payload","rules":[{"t":"set","p":"headers","pt":"msg","to":"{}","tot":"json"},{"t":"set","p":"payload","pt":"msg","to":"{}","tot":"json"},{"t":"set","p":"payload.url","pt":"msg","to":"req.url","tot":"msg"},{"t":"set","p":"payload.method","pt":"msg","to":"req.method","tot":"msg"},{"t":"set","p":"payload.headers","pt":"msg","to":"req.headers","tot":"msg"},{"t":"set","p":"payload.params","pt":"msg","to":"req.params","tot":"msg"},{"t":"set","p":"payload.query","pt":"msg","to":"req.query","tot":"msg"},{"t":"set","p":"payload.body","pt":"msg","to":"req.body","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":580,"y":1740,"wires":[["c99e0c4.02536f"]]},{"id":"d6a5ebc1.8b2928","type":"http response","z":"a82c65ac.c0b378","name":"","statusCode":"","headers":{},"x":1070,"y":1780,"wires":[]},{"id":"e4cba930.d35ee8","type":"http request","z":"a82c65ac.c0b378","name":"","method":"POST","ret":"obj","paytoqs":"ignore","url":"${CFG_ACL_ENDP}","tls":"51b09598.a1114c","persist":false,"proxy":"","authType":"","x":650,"y":1840,"wires":[["76797731.6f7cb8"]]},{"id":"76797731.6f7cb8","type":"switch","z":"a82c65ac.c0b378","name":"","property":"statusCode","propertyType":"msg","rules":[{"t":"eq","v":"200","vt":"num"},{"t":"else"}],"checkall":"true","repair":false,"outputs":2,"x":810,"y":1840,"wires":[["101f3491.0e9d0b"],["840fdc16.77458"]]},{"id":"f88b46d4.7b17d8","type":"change","z":"a82c65ac.c0b378","name":"acl req payload","rules":[{"t":"set","p":"headers","pt":"msg","to":"{}","tot":"json"},{"t":"set","p":"payload","pt":"msg","to":"{}","tot":"json"},{"t":"set","p":"payload.url","pt":"msg","to":"req.url","tot":"msg"},{"t":"set","p":"payload.method","pt":"msg","to":"req.method","tot":"msg"},{"t":"set","p":"payload.headers","pt":"msg","to":"req.headers","tot":"msg"},{"t":"set","p":"payload.params","pt":"msg","to":"req.params","tot":"msg"},{"t":"set","p":"payload.query","pt":"msg","to":"req.query","tot":"msg"},{"t":"set","p":"payload.body","pt":"msg","to":"req.body","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":460,"y":1840,"wires":[["e4cba930.d35ee8"]]},{"id":"840fdc16.77458","type":"http response","z":"a82c65ac.c0b378","name":"","statusCode":"401","headers":{},"x":960,"y":1880,"wires":[]},{"id":"9e775fdb.6db94","type":"http request","z":"a82c65ac.c0b378","name":"","method":"POST","ret":"obj","paytoqs":"ignore","url":"${CFG_ACL_ENDP}","tls":"51b09598.a1114c","persist":false,"proxy":"","authType":"","x":650,"y":1940,"wires":[["2c8971ed.534a3e"]]},{"id":"2c8971ed.534a3e","type":"switch","z":"a82c65ac.c0b378","name":"","property":"statusCode","propertyType":"msg","rules":[{"t":"eq","v":"200","vt":"num"},{"t":"else"}],"checkall":"true","repair":false,"outputs":2,"x":810,"y":1940,"wires":[["169ee90.fd5f217"],["d32be6b0.89a9c8"]]},{"id":"a78cb82b.3e1218","type":"change","z":"a82c65ac.c0b378","name":"acl req payload","rules":[{"t":"set","p":"headers","pt":"msg","to":"{}","tot":"json"},{"t":"set","p":"payload","pt":"msg","to":"{}","tot":"json"},{"t":"set","p":"payload.url","pt":"msg","to":"req.url","tot":"msg"},{"t":"set","p":"payload.method","pt":"msg","to":"req.method","tot":"msg"},{"t":"set","p":"payload.headers","pt":"msg","to":"req.headers","tot":"msg"},{"t":"set","p":"payload.params","pt":"msg","to":"req.params","tot":"msg"},{"t":"set","p":"payload.query","pt":"msg","to":"req.query","tot":"msg"},{"t":"set","p":"payload.body","pt":"msg","to":"req.body","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":460,"y":1940,"wires":[["9e775fdb.6db94"]]},{"id":"d32be6b0.89a9c8","type":"http response","z":"a82c65ac.c0b378","name":"","statusCode":"","headers":{},"x":950,"y":1980,"wires":[]},{"id":"9062a23e.6369d","type":"http request","z":"a82c65ac.c0b378","name":"","method":"POST","ret":"obj","paytoqs":"ignore","url":"${CFG_ACL_ENDP}","tls":"51b09598.a1114c","persist":false,"proxy":"","authType":"","x":610,"y":2040,"wires":[["4574d339.dc5cac"]]},{"id":"4574d339.dc5cac","type":"switch","z":"a82c65ac.c0b378","name":"","property":"statusCode","propertyType":"msg","rules":[{"t":"eq","v":"200","vt":"num"},{"t":"else"}],"checkall":"true","repair":false,"outputs":2,"x":770,"y":2040,"wires":[["1cffa17c.8209cf"],["8f274943.210708"]]},{"id":"6b0b9a74.b0a1c4","type":"change","z":"a82c65ac.c0b378","name":"acl req payload","rules":[{"t":"set","p":"headers","pt":"msg","to":"{}","tot":"json"},{"t":"set","p":"payload","pt":"msg","to":"{}","tot":"json"},{"t":"set","p":"payload.url","pt":"msg","to":"req.url","tot":"msg"},{"t":"set","p":"payload.method","pt":"msg","to":"req.method","tot":"msg"},{"t":"set","p":"payload.headers","pt":"msg","to":"req.headers","tot":"msg"},{"t":"set","p":"payload.params","pt":"msg","to":"req.params","tot":"msg"},{"t":"set","p":"payload.query","pt":"msg","to":"req.query","tot":"msg"},{"t":"set","p":"payload.body","pt":"msg","to":"req.body","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":420,"y":2040,"wires":[["9062a23e.6369d"]]},{"id":"8f274943.210708","type":"http response","z":"a82c65ac.c0b378","name":"","statusCode":"","headers":{},"x":910,"y":2080,"wires":[]},{"id":"d4839869.9f9fb8","type":"http request","z":"a82c65ac.c0b378","name":"","method":"POST","ret":"obj","paytoqs":"ignore","url":"${CFG_ACL_ENDP}","tls":"51b09598.a1114c","persist":false,"proxy":"","authType":"","x":610,"y":2140,"wires":[["e353ffd6.b630a"]]},{"id":"e353ffd6.b630a","type":"switch","z":"a82c65ac.c0b378","name":"","property":"statusCode","propertyType":"msg","rules":[{"t":"eq","v":"200","vt":"num"},{"t":"else"}],"checkall":"true","repair":false,"outputs":2,"x":770,"y":2140,"wires":[["65b45400.f921ac"],["e0b2a9c5.0c0718"]]},{"id":"e1970bac.ad5878","type":"change","z":"a82c65ac.c0b378","name":"acl req payload","rules":[{"t":"set","p":"headers","pt":"msg","to":"{}","tot":"json"},{"t":"set","p":"payload","pt":"msg","to":"{}","tot":"json"},{"t":"set","p":"payload.url","pt":"msg","to":"req.url","tot":"msg"},{"t":"set","p":"payload.method","pt":"msg","to":"req.method","tot":"msg"},{"t":"set","p":"payload.headers","pt":"msg","to":"req.headers","tot":"msg"},{"t":"set","p":"payload.params","pt":"msg","to":"req.params","tot":"msg"},{"t":"set","p":"payload.query","pt":"msg","to":"req.query","tot":"msg"},{"t":"set","p":"payload.body","pt":"msg","to":"req.body","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":420,"y":2140,"wires":[["d4839869.9f9fb8"]]},{"id":"e0b2a9c5.0c0718","type":"http response","z":"a82c65ac.c0b378","name":"","statusCode":"","headers":{},"x":910,"y":2180,"wires":[]},{"id":"d01b59a8.5566f8","type":"change","z":"a82c65ac.c0b378","name":"","rules":[{"t":"set","p":"payload","pt":"msg","to":"*[name = $$.nodeName & \" broker\"].broker","tot":"jsonata"}],"action":"","property":"","from":"","to":"","reg":false,"x":2100,"y":140,"wires":[["b10f52ff.348f7"]]},{"id":"9d61b11e.90a83","type":"change","z":"a82c65ac.c0b378","name":"edit","rules":[{"t":"set","p":"old","pt":"msg","to":"*[name = $$.nodeName & \" broker\"]","tot":"jsonata"},{"t":"set","p":"new","pt":"msg","to":"old","tot":"msg"},{"t":"set","p":"new.broker","pt":"msg","to":"broker","tot":"msg"},{"t":"set","p":"payload","pt":"msg","to":"$eval($replace($string(payload),$string(old),$string(new)))","tot":"jsonata"}],"action":"","property":"","from":"","to":"","reg":false,"x":2070,"y":40,"wires":[["1de2fa49.48ae06"]]},{"id":"4e63f112.cac73","type":"change","z":"a82c65ac.c0b378","name":"edit","rules":[{"t":"set","p":"old","pt":"msg","to":"*[name = $$.nodeName & \" broker\"]","tot":"jsonata"},{"t":"set","p":"new","pt":"msg","to":"old","tot":"msg"},{"t":"set","p":"new.usetls","pt":"msg","to":"false","tot":"bool"},{"t":"set","p":"payload","pt":"msg","to":"$eval($replace($string(payload),$string(old),$string(new)))","tot":"jsonata"}],"action":"","property":"","from":"","to":"","reg":false,"x":2190,"y":820,"wires":[["a35b17f.1c874e8"]]},{"id":"75bdd19c.e2c1b","type":"change","z":"a82c65ac.c0b378","name":"edit","rules":[{"t":"set","p":"old","pt":"msg","to":"*[name = $$.nodeName & \" broker\"]","tot":"jsonata"},{"t":"set","p":"new","pt":"msg","to":"old","tot":"msg"},{"t":"set","p":"new.usetls","pt":"msg","to":"true","tot":"bool"},{"t":"set","p":"payload","pt":"msg","to":"$eval($replace($string(payload),$string(old),$string(new)))","tot":"jsonata"}],"action":"","property":"","from":"","to":"","reg":false,"x":2190,"y":860,"wires":[["a35b17f.1c874e8"]]},{"id":"86f9cf55.6942","type":"change","z":"a82c65ac.c0b378","name":"edit","rules":[{"t":"set","p":"old","pt":"msg","to":"*[name = $$.nodeName & \" tls config\"]","tot":"jsonata"},{"t":"set","p":"new","pt":"msg","to":"old","tot":"msg"},{"t":"set","p":"new.cert","pt":"msg","to":"cert","tot":"msg"},{"t":"set","p":"payload","pt":"msg","to":"$eval($replace($string(payload),$string(old),$string(new)))","tot":"jsonata"}],"action":"","property":"","from":"","to":"","reg":false,"x":2050,"y":1040,"wires":[["6fd6ecf6.6076e4"]]},{"id":"dc8e7bef.8af938","type":"change","z":"a82c65ac.c0b378","name":"edit","rules":[{"t":"set","p":"old","pt":"msg","to":"*[name = $$.nodeName & \" tls config\"]","tot":"jsonata"},{"t":"set","p":"new","pt":"msg","to":"old","tot":"msg"},{"t":"set","p":"new.key","pt":"msg","to":"key","tot":"msg"},{"t":"set","p":"payload","pt":"msg","to":"$eval($replace($string(payload),$string(old),$string(new)))","tot":"jsonata"}],"action":"","property":"","from":"","to":"","reg":false,"x":2050,"y":1240,"wires":[["87e0b066.bcf57"]]},{"id":"8e146793.5bf528","type":"change","z":"a82c65ac.c0b378","name":"edit","rules":[{"t":"set","p":"old","pt":"msg","to":"*[name = $$.nodeName & \" tls config\"]","tot":"jsonata"},{"t":"set","p":"new","pt":"msg","to":"old","tot":"msg"},{"t":"set","p":"new.ca","pt":"msg","to":"ca","tot":"msg"},{"t":"set","p":"payload","pt":"msg","to":"$eval($replace($string(payload),$string(old),$string(new)))","tot":"jsonata"}],"action":"","property":"","from":"","to":"","reg":false,"x":2030,"y":1440,"wires":[["9d49e261.dec4"]]},{"id":"b7e87212.5eab","type":"change","z":"a82c65ac.c0b378","name":"edit","rules":[{"t":"set","p":"old","pt":"msg","to":"*[name = $$.nodeName & \" tls config\"]","tot":"jsonata"},{"t":"set","p":"new","pt":"msg","to":"old","tot":"msg"},{"t":"set","p":"new.verifyservercert","pt":"msg","to":"false","tot":"bool"},{"t":"set","p":"payload","pt":"msg","to":"$eval($replace($string(payload),$string(old),$string(new)))","tot":"jsonata"}],"action":"","property":"","from":"","to":"","reg":false,"x":2290,"y":1600,"wires":[["6450c902.07d4e8"]]},{"id":"a37883b6.d9a2b","type":"change","z":"a82c65ac.c0b378","name":"edit","rules":[{"t":"set","p":"old","pt":"msg","to":"*[name = $$.nodeName & \" tls config\"]","tot":"jsonata"},{"t":"set","p":"new","pt":"msg","to":"old","tot":"msg"},{"t":"set","p":"new.verifyservercert","pt":"msg","to":"true","tot":"bool"},{"t":"set","p":"payload","pt":"msg","to":"$eval($replace($string(payload),$string(old),$string(new)))","tot":"jsonata"}],"action":"","property":"","from":"","to":"","reg":false,"x":2290,"y":1640,"wires":[["6450c902.07d4e8"]]},{"id":"81c808b9.24a5b8","type":"change","z":"a82c65ac.c0b378","name":"edit","rules":[{"t":"set","p":"old","pt":"msg","to":"*[name = $$.nodeName & \" tls config\"]","tot":"jsonata"},{"t":"set","p":"new","pt":"msg","to":"old","tot":"msg"},{"t":"set","p":"new.servername","pt":"msg","to":"servername","tot":"msg"},{"t":"set","p":"payload","pt":"msg","to":"$eval($replace($string(payload),$string(old),$string(new)))","tot":"jsonata"}],"action":"","property":"","from":"","to":"","reg":false,"x":1810,"y":1840,"wires":[["2916f613.1c383a"]]},{"id":"d9bb9662.2b24d8","type":"change","z":"a82c65ac.c0b378","name":"edit","rules":[{"t":"set","p":"old","pt":"msg","to":"*[name = $$.nodeName & \" broker\"]","tot":"jsonata"},{"t":"set","p":"new","pt":"msg","to":"old","tot":"msg"},{"t":"set","p":"new.port","pt":"msg","to":"port","tot":"msg"},{"t":"set","p":"payload","pt":"msg","to":"$eval($replace($string(payload),$string(old),$string(new)))","tot":"jsonata"}],"action":"","property":"","from":"","to":"","reg":false,"x":2050,"y":2040,"wires":[["ad4fce90.4ff09"]]},{"id":"80346ac.0e4fd98","type":"http response","z":"a82c65ac.c0b378","name":"","statusCode":"","headers":{},"x":930,"y":80,"wires":[]},{"id":"f65d1ce4.84539","type":"switch","z":"a82c65ac.c0b378","name":"","property":"statusCode","propertyType":"msg","rules":[{"t":"eq","v":"200","vt":"num"},{"t":"else"}],"checkall":"true","repair":false,"outputs":2,"x":1250,"y":40,"wires":[["2a43ee3.8976412"],["ad4fcb0a.ad0798"]]},{"id":"ad4fcb0a.ad0798","type":"http response","z":"a82c65ac.c0b378","name":"","statusCode":"","headers":{},"x":1390,"y":80,"wires":[]},{"id":"9c3dc051.ac56e","type":"switch","z":"a82c65ac.c0b378","name":"","property":"statusCode","propertyType":"msg","rules":[{"t":"eq","v":"200","vt":"num"},{"t":"else"}],"checkall":"true","repair":false,"outputs":2,"x":1930,"y":40,"wires":[["9d61b11e.90a83"],["6f8d4ddf.b1bc04"]]},{"id":"6f8d4ddf.b1bc04","type":"http response","z":"a82c65ac.c0b378","name":"","statusCode":"","headers":{},"x":2070,"y":80,"wires":[]},{"id":"1de2fa49.48ae06","type":"function","z":"a82c65ac.c0b378","name":"update flows","func":"const http = global.get('https');\nconst data = JSON.stringify(msg.payload);\nconst options = {\n  hostname: 'localhost',\n  port: 1880,\n  path: '/flows',\n  method: 'POST',\n  headers: {\n    'Content-Type': 'application/json',\n    'Content-Length': data.length,\n    'Authorization': 'Bearer '+msg.accessToken\n  },\n  rejectUnauthorized: false\n};\nconst req = http.request(options);\nreq.write(data);\nreq.end();\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":2230,"y":40,"wires":[["a40eecc9.1106f"]]},{"id":"71f7a3fe.8bdf4c","type":"switch","z":"a82c65ac.c0b378","name":"","property":"statusCode","propertyType":"msg","rules":[{"t":"eq","v":"200","vt":"num"},{"t":"else"}],"checkall":"true","repair":false,"outputs":2,"x":1250,"y":140,"wires":[["514afb7f.5275e4"],["55f0d95b.24a528"]]},{"id":"55f0d95b.24a528","type":"http response","z":"a82c65ac.c0b378","name":"","statusCode":"","headers":{},"x":1390,"y":180,"wires":[]},{"id":"7779a238.df428c","type":"switch","z":"a82c65ac.c0b378","name":"","property":"statusCode","propertyType":"msg","rules":[{"t":"eq","v":"200","vt":"num"},{"t":"else"}],"checkall":"true","repair":false,"outputs":2,"x":1930,"y":140,"wires":[["d01b59a8.5566f8"],["9198269.c4df8d8"]]},{"id":"9198269.c4df8d8","type":"http response","z":"a82c65ac.c0b378","name":"","statusCode":"","headers":{},"x":2070,"y":180,"wires":[]},{"id":"bcf9dcda.f3096","type":"switch","z":"a82c65ac.c0b378","name":"","property":"statusCode","propertyType":"msg","rules":[{"t":"eq","v":"200","vt":"num"},{"t":"else"}],"checkall":"true","repair":false,"outputs":2,"x":1250,"y":240,"wires":[["ffeb72f1.d7f23"],["3c0db0a5.e4a09"]]},{"id":"3c0db0a5.e4a09","type":"http response","z":"a82c65ac.c0b378","name":"","statusCode":"","headers":{},"x":1390,"y":280,"wires":[]},{"id":"471d5852.a248a8","type":"switch","z":"a82c65ac.c0b378","name":"","property":"statusCode","propertyType":"msg","rules":[{"t":"eq","v":"200","vt":"num"},{"t":"else"}],"checkall":"true","repair":false,"outputs":2,"x":1930,"y":240,"wires":[["cf0df05b.4f825"],["6839309c.c9232"]]},{"id":"6839309c.c9232","type":"http response","z":"a82c65ac.c0b378","name":"","statusCode":"","headers":{},"x":2070,"y":280,"wires":[]},{"id":"680a33d2.d46c9c","type":"switch","z":"a82c65ac.c0b378","name":"","property":"statusCode","propertyType":"msg","rules":[{"t":"eq","v":"200","vt":"num"},{"t":"else"}],"checkall":"true","repair":false,"outputs":2,"x":2630,"y":240,"wires":[["19161682.49e1e9"],["9c853dd0.f9f3c"]]},{"id":"9c853dd0.f9f3c","type":"http response","z":"a82c65ac.c0b378","name":"","statusCode":"","headers":{},"x":2770,"y":280,"wires":[]},{"id":"5f96bfb4.e3334","type":"switch","z":"a82c65ac.c0b378","name":"","property":"statusCode","propertyType":"msg","rules":[{"t":"eq","v":"200","vt":"num"},{"t":"else"}],"checkall":"true","repair":false,"outputs":2,"x":3230,"y":240,"wires":[["8df4b3f2.2aec7"],["8397e270.9a6b"]]},{"id":"8397e270.9a6b","type":"http response","z":"a82c65ac.c0b378","name":"","statusCode":"","headers":{},"x":3370,"y":280,"wires":[]},{"id":"8905a8e6.a55938","type":"switch","z":"a82c65ac.c0b378","name":"","property":"statusCode","propertyType":"msg","rules":[{"t":"eq","v":"200","vt":"num"},{"t":"else"}],"checkall":"true","repair":false,"outputs":2,"x":1230,"y":340,"wires":[["2c6cad62.e52f92"],["243d64c9.93c49c"]]},{"id":"243d64c9.93c49c","type":"http response","z":"a82c65ac.c0b378","name":"","statusCode":"","headers":{},"x":1370,"y":380,"wires":[]},{"id":"556f76f3.4ee148","type":"switch","z":"a82c65ac.c0b378","name":"","property":"statusCode","propertyType":"msg","rules":[{"t":"eq","v":"200","vt":"num"},{"t":"else"}],"checkall":"true","repair":false,"outputs":2,"x":1910,"y":340,"wires":[["ad449bc8.8b3608"],["afcce6c3.949aa8"]]},{"id":"afcce6c3.949aa8","type":"http response","z":"a82c65ac.c0b378","name":"","statusCode":"","headers":{},"x":2050,"y":380,"wires":[]},{"id":"3c7291c0.293d9e","type":"switch","z":"a82c65ac.c0b378","name":"","property":"statusCode","propertyType":"msg","rules":[{"t":"eq","v":"200","vt":"num"},{"t":"else"}],"checkall":"true","repair":false,"outputs":2,"x":2610,"y":340,"wires":[["209aabd.dc53d54"],["711f346a.8fef5c"]]},{"id":"711f346a.8fef5c","type":"http response","z":"a82c65ac.c0b378","name":"","statusCode":"","headers":{},"x":2750,"y":380,"wires":[]},{"id":"9548c989.cfdef8","type":"switch","z":"a82c65ac.c0b378","name":"","property":"statusCode","propertyType":"msg","rules":[{"t":"eq","v":"200","vt":"num"},{"t":"else"}],"checkall":"true","repair":false,"outputs":2,"x":1630,"y":440,"wires":[["209be672.98a1ea"],["a534df12.b102d"]]},{"id":"a534df12.b102d","type":"http response","z":"a82c65ac.c0b378","name":"","statusCode":"","headers":{},"x":1770,"y":480,"wires":[]},{"id":"e4c2bd92.78eec","type":"switch","z":"a82c65ac.c0b378","name":"","property":"statusCode","propertyType":"msg","rules":[{"t":"eq","v":"200","vt":"num"},{"t":"else"}],"checkall":"true","repair":false,"outputs":2,"x":2310,"y":440,"wires":[["fd1c84bb.5a01e8"],["3050e06f.a6eb5"]]},{"id":"3050e06f.a6eb5","type":"http response","z":"a82c65ac.c0b378","name":"","statusCode":"","headers":{},"x":2450,"y":480,"wires":[]},{"id":"7ce41ee8.19cc","type":"switch","z":"a82c65ac.c0b378","name":"","property":"statusCode","propertyType":"msg","rules":[{"t":"eq","v":"200","vt":"num"},{"t":"else"}],"checkall":"true","repair":false,"outputs":2,"x":3010,"y":440,"wires":[["64337c3b.76af44"],["e159a60.e116b58"]]},{"id":"e159a60.e116b58","type":"http response","z":"a82c65ac.c0b378","name":"","statusCode":"","headers":{},"x":3150,"y":480,"wires":[]},{"id":"92ce3886.99c0d8","type":"switch","z":"a82c65ac.c0b378","name":"","property":"statusCode","propertyType":"msg","rules":[{"t":"eq","v":"200","vt":"num"},{"t":"else"}],"checkall":"true","repair":false,"outputs":2,"x":3730,"y":440,"wires":[["96c43b53.ec4998"],["782d8ef0.10fe7"]]},{"id":"782d8ef0.10fe7","type":"http response","z":"a82c65ac.c0b378","name":"","statusCode":"","headers":{},"x":3870,"y":480,"wires":[]},{"id":"1e037971.3b87c7","type":"switch","z":"a82c65ac.c0b378","name":"","property":"statusCode","propertyType":"msg","rules":[{"t":"eq","v":"200","vt":"num"},{"t":"else"}],"checkall":"true","repair":false,"outputs":2,"x":1070,"y":540,"wires":[["8f9c48cb.a70ee8"],["37ac81da.ccf35e"]]},{"id":"37ac81da.ccf35e","type":"http response","z":"a82c65ac.c0b378","name":"","statusCode":"","headers":{},"x":1210,"y":580,"wires":[]},{"id":"eb77abac.1d4e68","type":"switch","z":"a82c65ac.c0b378","name":"","property":"statusCode","propertyType":"msg","rules":[{"t":"eq","v":"200","vt":"num"},{"t":"else"}],"checkall":"true","repair":false,"outputs":2,"x":1750,"y":540,"wires":[["6866a249.5e051c"],["53237b56.3cfcc4"]]},{"id":"53237b56.3cfcc4","type":"http response","z":"a82c65ac.c0b378","name":"","statusCode":"","headers":{},"x":1890,"y":580,"wires":[]},{"id":"11f0741b.48092c","type":"switch","z":"a82c65ac.c0b378","name":"","property":"statusCode","propertyType":"msg","rules":[{"t":"eq","v":"200","vt":"num"},{"t":"else"}],"checkall":"true","repair":false,"outputs":2,"x":2450,"y":540,"wires":[["f08534a3.cc1738"],["764dfaca.83bd04"]]},{"id":"764dfaca.83bd04","type":"http response","z":"a82c65ac.c0b378","name":"","statusCode":"","headers":{},"x":2590,"y":580,"wires":[]},{"id":"b3366c2.8b0c39","type":"http response","z":"a82c65ac.c0b378","name":"","statusCode":"400","headers":{},"x":580,"y":500,"wires":[]},{"id":"4a781f93.b2d9e","type":"switch","z":"a82c65ac.c0b378","name":"","property":"statusCode","propertyType":"msg","rules":[{"t":"eq","v":"200","vt":"num"},{"t":"else"}],"checkall":"true","repair":false,"outputs":2,"x":1370,"y":640,"wires":[["a454070d.8ca288"],["be44af9.e70e05"]]},{"id":"be44af9.e70e05","type":"http response","z":"a82c65ac.c0b378","name":"","statusCode":"","headers":{},"x":1510,"y":680,"wires":[]},{"id":"cc00d73a.e68fd8","type":"switch","z":"a82c65ac.c0b378","name":"","property":"statusCode","propertyType":"msg","rules":[{"t":"eq","v":"200","vt":"num"},{"t":"else"}],"checkall":"true","repair":false,"outputs":2,"x":2050,"y":640,"wires":[["f9844cbd.d5368"],["d2efb9dd.edc768"]]},{"id":"d2efb9dd.edc768","type":"http response","z":"a82c65ac.c0b378","name":"","statusCode":"","headers":{},"x":2190,"y":680,"wires":[]},{"id":"498f9036.dfb4b","type":"switch","z":"a82c65ac.c0b378","name":"","property":"statusCode","propertyType":"msg","rules":[{"t":"eq","v":"200","vt":"num"},{"t":"else"}],"checkall":"true","repair":false,"outputs":2,"x":2750,"y":640,"wires":[["9b76f2fd.89e82"],["d1bfe4b1.606cb8"]]},{"id":"d1bfe4b1.606cb8","type":"http response","z":"a82c65ac.c0b378","name":"","statusCode":"","headers":{},"x":2890,"y":680,"wires":[]},{"id":"f51986f8.226ef8","type":"switch","z":"a82c65ac.c0b378","name":"","property":"statusCode","propertyType":"msg","rules":[{"t":"eq","v":"200","vt":"num"},{"t":"else"}],"checkall":"true","repair":false,"outputs":2,"x":3350,"y":640,"wires":[["7126dd4a.e72b94"],["2c5d0901.26ad86"]]},{"id":"2c5d0901.26ad86","type":"http response","z":"a82c65ac.c0b378","name":"","statusCode":"","headers":{},"x":3490,"y":680,"wires":[]},{"id":"c0a65dd5.dc77f","type":"switch","z":"a82c65ac.c0b378","name":"","property":"statusCode","propertyType":"msg","rules":[{"t":"eq","v":"200","vt":"num"},{"t":"else"}],"checkall":"true","repair":false,"outputs":2,"x":1230,"y":740,"wires":[["e2c0f823.930488"],["86eab4d9.930278"]]},{"id":"86eab4d9.930278","type":"http response","z":"a82c65ac.c0b378","name":"","statusCode":"","headers":{},"x":1370,"y":780,"wires":[]},{"id":"a040fb34.0528f8","type":"switch","z":"a82c65ac.c0b378","name":"","property":"statusCode","propertyType":"msg","rules":[{"t":"eq","v":"200","vt":"num"},{"t":"else"}],"checkall":"true","repair":false,"outputs":2,"x":1890,"y":740,"wires":[["1df58ba5.203df4"],["2ff1c862.63c458"]]},{"id":"2ff1c862.63c458","type":"http response","z":"a82c65ac.c0b378","name":"","statusCode":"","headers":{},"x":2030,"y":780,"wires":[]},{"id":"6548b748.57eb28","type":"switch","z":"a82c65ac.c0b378","name":"","property":"statusCode","propertyType":"msg","rules":[{"t":"eq","v":"200","vt":"num"},{"t":"else"}],"checkall":"true","repair":false,"outputs":2,"x":2590,"y":740,"wires":[["94212df3.62863"],["c40c2bec.108af8"]]},{"id":"c40c2bec.108af8","type":"http response","z":"a82c65ac.c0b378","name":"","statusCode":"","headers":{},"x":2730,"y":780,"wires":[]},{"id":"d1fe3d70.b7117","type":"switch","z":"a82c65ac.c0b378","name":"","property":"statusCode","propertyType":"msg","rules":[{"t":"eq","v":"200","vt":"num"},{"t":"else"}],"checkall":"true","repair":false,"outputs":2,"x":1230,"y":840,"wires":[["9da0d200.493ba"],["281d7d6f.044a02"]]},{"id":"281d7d6f.044a02","type":"http response","z":"a82c65ac.c0b378","name":"","statusCode":"","headers":{},"x":1370,"y":880,"wires":[]},{"id":"ba8c75f6.693a98","type":"switch","z":"a82c65ac.c0b378","name":"","property":"statusCode","propertyType":"msg","rules":[{"t":"eq","v":"200","vt":"num"},{"t":"else"}],"checkall":"true","repair":false,"outputs":2,"x":1910,"y":840,"wires":[["fe3a5100.73e9f"],["d1c58a.ddc47a78"]]},{"id":"d1c58a.ddc47a78","type":"http response","z":"a82c65ac.c0b378","name":"","statusCode":"","headers":{},"x":2050,"y":880,"wires":[]},{"id":"3db8931.c4ec96c","type":"switch","z":"a82c65ac.c0b378","name":"","property":"statusCode","propertyType":"msg","rules":[{"t":"eq","v":"200","vt":"num"},{"t":"else"}],"checkall":"true","repair":false,"outputs":2,"x":1230,"y":940,"wires":[["74d74735.8067e8"],["8b156255.b959"]]},{"id":"8b156255.b959","type":"http response","z":"a82c65ac.c0b378","name":"","statusCode":"","headers":{},"x":1370,"y":980,"wires":[]},{"id":"dbcb00fa.90302","type":"switch","z":"a82c65ac.c0b378","name":"","property":"statusCode","propertyType":"msg","rules":[{"t":"eq","v":"200","vt":"num"},{"t":"else"}],"checkall":"true","repair":false,"outputs":2,"x":1910,"y":940,"wires":[["36381449.d5b7ec"],["ba9ab4d2.28bc28"]]},{"id":"ba9ab4d2.28bc28","type":"http response","z":"a82c65ac.c0b378","name":"","statusCode":"","headers":{},"x":2050,"y":980,"wires":[]},{"id":"c0785151.6b4bc","type":"http response","z":"a82c65ac.c0b378","name":"","statusCode":"400","headers":{},"x":2400,"y":900,"wires":[]},{"id":"c9b66c3f.c5bab","type":"change","z":"a82c65ac.c0b378","name":"","rules":[{"t":"set","p":"payload","pt":"msg","to":"sensorUseTLS","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":2220,"y":900,"wires":[["c0785151.6b4bc"]]},{"id":"bd816e3c.1e3f9","type":"switch","z":"a82c65ac.c0b378","name":"","property":"payload","propertyType":"msg","rules":[{"t":"btwn","v":"0","vt":"num","v2":"2","v2t":"num"},{"t":"else"}],"checkall":"true","repair":false,"outputs":2,"x":230,"y":640,"wires":[["b9815beb.3c4a78"],["1b812c68.46aa24"]]},{"id":"1b812c68.46aa24","type":"http response","z":"a82c65ac.c0b378","name":"","statusCode":"400","headers":{},"x":380,"y":680,"wires":[]},{"id":"d6b58903.b01438","type":"switch","z":"a82c65ac.c0b378","name":"","property":"statusCode","propertyType":"msg","rules":[{"t":"eq","v":"200","vt":"num"},{"t":"else"}],"checkall":"true","repair":false,"outputs":2,"x":1230,"y":2040,"wires":[["967f46d3.f4c9f8"],["371f4ab4.9f2276"]]},{"id":"371f4ab4.9f2276","type":"http response","z":"a82c65ac.c0b378","name":"","statusCode":"","headers":{},"x":1370,"y":2080,"wires":[]},{"id":"8817df08.39db4","type":"switch","z":"a82c65ac.c0b378","name":"","property":"statusCode","propertyType":"msg","rules":[{"t":"eq","v":"200","vt":"num"},{"t":"else"}],"checkall":"true","repair":false,"outputs":2,"x":1910,"y":2040,"wires":[["d9bb9662.2b24d8"],["addba73c.41dba8"]]},{"id":"addba73c.41dba8","type":"http response","z":"a82c65ac.c0b378","name":"","statusCode":"","headers":{},"x":2050,"y":2080,"wires":[]},{"id":"fdcf29e9.b25be8","type":"switch","z":"a82c65ac.c0b378","name":"","property":"statusCode","propertyType":"msg","rules":[{"t":"eq","v":"200","vt":"num"},{"t":"else"}],"checkall":"true","repair":false,"outputs":2,"x":1230,"y":2140,"wires":[["61a45fbb.c709e"],["c15518eb.f06c68"]]},{"id":"c15518eb.f06c68","type":"http response","z":"a82c65ac.c0b378","name":"","statusCode":"","headers":{},"x":1370,"y":2180,"wires":[]},{"id":"9e5b844e.5518c8","type":"switch","z":"a82c65ac.c0b378","name":"","property":"statusCode","propertyType":"msg","rules":[{"t":"eq","v":"200","vt":"num"},{"t":"else"}],"checkall":"true","repair":false,"outputs":2,"x":1910,"y":2140,"wires":[["2a6551af.d53b2e"],["aa1f1f9b.e63ab"]]},{"id":"aa1f1f9b.e63ab","type":"http response","z":"a82c65ac.c0b378","name":"","statusCode":"","headers":{},"x":2050,"y":2180,"wires":[]},{"id":"2fe01ccd.5e7d14","type":"switch","z":"a82c65ac.c0b378","name":"","property":"statusCode","propertyType":"msg","rules":[{"t":"eq","v":"200","vt":"num"},{"t":"else"}],"checkall":"true","repair":false,"outputs":2,"x":1230,"y":1040,"wires":[["2baeb9d.c9d8546"],["725311b1.55791"]]},{"id":"725311b1.55791","type":"http response","z":"a82c65ac.c0b378","name":"","statusCode":"","headers":{},"x":1370,"y":1080,"wires":[]},{"id":"3f9144a2.dd939c","type":"switch","z":"a82c65ac.c0b378","name":"","property":"statusCode","propertyType":"msg","rules":[{"t":"eq","v":"200","vt":"num"},{"t":"else"}],"checkall":"true","repair":false,"outputs":2,"x":1910,"y":1040,"wires":[["86f9cf55.6942"],["976f352a.8eabb8"]]},{"id":"976f352a.8eabb8","type":"http response","z":"a82c65ac.c0b378","name":"","statusCode":"","headers":{},"x":2050,"y":1080,"wires":[]},{"id":"d38cd6c6.614d58","type":"switch","z":"a82c65ac.c0b378","name":"","property":"statusCode","propertyType":"msg","rules":[{"t":"eq","v":"200","vt":"num"},{"t":"else"}],"checkall":"true","repair":false,"outputs":2,"x":1230,"y":1140,"wires":[["2aca46fd.1bb94a"],["be807ee4.cc079"]]},{"id":"be807ee4.cc079","type":"http response","z":"a82c65ac.c0b378","name":"","statusCode":"","headers":{},"x":1370,"y":1180,"wires":[]},{"id":"1c1cc6b1.373ed9","type":"switch","z":"a82c65ac.c0b378","name":"","property":"statusCode","propertyType":"msg","rules":[{"t":"eq","v":"200","vt":"num"},{"t":"else"}],"checkall":"true","repair":false,"outputs":2,"x":1910,"y":1140,"wires":[["39a36245.dd33ce"],["de33e745.7464a8"]]},{"id":"de33e745.7464a8","type":"http response","z":"a82c65ac.c0b378","name":"","statusCode":"","headers":{},"x":2050,"y":1180,"wires":[]},{"id":"58f489c5.a74e38","type":"switch","z":"a82c65ac.c0b378","name":"","property":"statusCode","propertyType":"msg","rules":[{"t":"eq","v":"200","vt":"num"},{"t":"else"}],"checkall":"true","repair":false,"outputs":2,"x":1230,"y":1240,"wires":[["eb5e7d68.7a11c"],["1455feab.f361c1"]]},{"id":"1455feab.f361c1","type":"http response","z":"a82c65ac.c0b378","name":"","statusCode":"","headers":{},"x":1370,"y":1280,"wires":[]},{"id":"a55d99e6.84af48","type":"switch","z":"a82c65ac.c0b378","name":"","property":"statusCode","propertyType":"msg","rules":[{"t":"eq","v":"200","vt":"num"},{"t":"else"}],"checkall":"true","repair":false,"outputs":2,"x":1910,"y":1240,"wires":[["dc8e7bef.8af938"],["b1a4dfd9.cdc5b"]]},{"id":"b1a4dfd9.cdc5b","type":"http response","z":"a82c65ac.c0b378","name":"","statusCode":"","headers":{},"x":2050,"y":1280,"wires":[]},{"id":"7d7f10b5.08432","type":"switch","z":"a82c65ac.c0b378","name":"","property":"statusCode","propertyType":"msg","rules":[{"t":"eq","v":"200","vt":"num"},{"t":"else"}],"checkall":"true","repair":false,"outputs":2,"x":1230,"y":1340,"wires":[["7ca15b22.b01fc4"],["23aed2f0.33883e"]]},{"id":"23aed2f0.33883e","type":"http response","z":"a82c65ac.c0b378","name":"","statusCode":"","headers":{},"x":1370,"y":1380,"wires":[]},{"id":"18eb92b5.7cc06d","type":"switch","z":"a82c65ac.c0b378","name":"","property":"statusCode","propertyType":"msg","rules":[{"t":"eq","v":"200","vt":"num"},{"t":"else"}],"checkall":"true","repair":false,"outputs":2,"x":1910,"y":1340,"wires":[["aca85c75.32529"],["4a98106.38c34f"]]},{"id":"4a98106.38c34f","type":"http response","z":"a82c65ac.c0b378","name":"","statusCode":"","headers":{},"x":2050,"y":1380,"wires":[]},{"id":"63dc7385.6e343c","type":"switch","z":"a82c65ac.c0b378","name":"","property":"statusCode","propertyType":"msg","rules":[{"t":"eq","v":"200","vt":"num"},{"t":"else"}],"checkall":"true","repair":false,"outputs":2,"x":1210,"y":1440,"wires":[["f23b1b22.ca0318"],["2b033ad3.e3eb36"]]},{"id":"2b033ad3.e3eb36","type":"http response","z":"a82c65ac.c0b378","name":"","statusCode":"","headers":{},"x":1350,"y":1480,"wires":[]},{"id":"16094e0d.98daa2","type":"switch","z":"a82c65ac.c0b378","name":"","property":"statusCode","propertyType":"msg","rules":[{"t":"eq","v":"200","vt":"num"},{"t":"else"}],"checkall":"true","repair":false,"outputs":2,"x":1890,"y":1440,"wires":[["8e146793.5bf528"],["c21ee35c.73ea5"]]},{"id":"c21ee35c.73ea5","type":"http response","z":"a82c65ac.c0b378","name":"","statusCode":"","headers":{},"x":2030,"y":1480,"wires":[]},{"id":"55c26b2d.e85f44","type":"switch","z":"a82c65ac.c0b378","name":"","property":"statusCode","propertyType":"msg","rules":[{"t":"eq","v":"200","vt":"num"},{"t":"else"}],"checkall":"true","repair":false,"outputs":2,"x":1210,"y":1540,"wires":[["ab91cfac.6190e"],["47effb6a.0f3404"]]},{"id":"47effb6a.0f3404","type":"http response","z":"a82c65ac.c0b378","name":"","statusCode":"","headers":{},"x":1350,"y":1580,"wires":[]},{"id":"c16dfa5f.915468","type":"switch","z":"a82c65ac.c0b378","name":"","property":"statusCode","propertyType":"msg","rules":[{"t":"eq","v":"200","vt":"num"},{"t":"else"}],"checkall":"true","repair":false,"outputs":2,"x":1890,"y":1540,"wires":[["a7d47f64.3f8bc"],["cc15ae70.54e49"]]},{"id":"cc15ae70.54e49","type":"http response","z":"a82c65ac.c0b378","name":"","statusCode":"","headers":{},"x":2030,"y":1580,"wires":[]},{"id":"bcb4305b.00a1a","type":"switch","z":"a82c65ac.c0b378","name":"","property":"statusCode","propertyType":"msg","rules":[{"t":"eq","v":"200","vt":"num"},{"t":"else"}],"checkall":"true","repair":false,"outputs":2,"x":1330,"y":1640,"wires":[["a6887de9.be273"],["6e954e54.c16aa"]]},{"id":"6e954e54.c16aa","type":"http response","z":"a82c65ac.c0b378","name":"","statusCode":"","headers":{},"x":1470,"y":1680,"wires":[]},{"id":"dd6dad63.c519b","type":"switch","z":"a82c65ac.c0b378","name":"","property":"statusCode","propertyType":"msg","rules":[{"t":"eq","v":"200","vt":"num"},{"t":"else"}],"checkall":"true","repair":false,"outputs":2,"x":2010,"y":1640,"wires":[["a733f9b6.dd2228"],["77370e9f.5064b"]]},{"id":"77370e9f.5064b","type":"http response","z":"a82c65ac.c0b378","name":"","statusCode":"","headers":{},"x":2150,"y":1680,"wires":[]},{"id":"7829de79.26354","type":"switch","z":"a82c65ac.c0b378","name":"","property":"statusCode","propertyType":"msg","rules":[{"t":"eq","v":"200","vt":"num"},{"t":"else"}],"checkall":"true","repair":false,"outputs":2,"x":1390,"y":1740,"wires":[["9028ef60.9a61b"],["e490a7be.6c8c78"]]},{"id":"e490a7be.6c8c78","type":"http response","z":"a82c65ac.c0b378","name":"","statusCode":"","headers":{},"x":1530,"y":1780,"wires":[]},{"id":"67455b1e.84dd54","type":"switch","z":"a82c65ac.c0b378","name":"","property":"statusCode","propertyType":"msg","rules":[{"t":"eq","v":"200","vt":"num"},{"t":"else"}],"checkall":"true","repair":false,"outputs":2,"x":2070,"y":1740,"wires":[["5cb223ab.67bf9c"],["854a3ba5.41f418"]]},{"id":"854a3ba5.41f418","type":"http response","z":"a82c65ac.c0b378","name":"","statusCode":"","headers":{},"x":2210,"y":1780,"wires":[]},{"id":"4f35f3e2.f87e5c","type":"switch","z":"a82c65ac.c0b378","name":"","property":"statusCode","propertyType":"msg","rules":[{"t":"eq","v":"200","vt":"num"},{"t":"else"}],"checkall":"true","repair":false,"outputs":2,"x":1270,"y":1940,"wires":[["eba2448b.f9b888"],["9f01782c.8dcf58"]]},{"id":"9f01782c.8dcf58","type":"http response","z":"a82c65ac.c0b378","name":"","statusCode":"","headers":{},"x":1410,"y":1980,"wires":[]},{"id":"227eda1c.2342e6","type":"switch","z":"a82c65ac.c0b378","name":"","property":"statusCode","propertyType":"msg","rules":[{"t":"eq","v":"200","vt":"num"},{"t":"else"}],"checkall":"true","repair":false,"outputs":2,"x":1950,"y":1940,"wires":[["cbdfd5a9.2a7008"],["4c03fd63.e769b4"]]},{"id":"4c03fd63.e769b4","type":"http response","z":"a82c65ac.c0b378","name":"","statusCode":"","headers":{},"x":2090,"y":1980,"wires":[]},{"id":"546fe650.814478","type":"subflow:3293da1d.80b076","z":"d4b094b8.7dbbe8","name":"transformation","env":[],"x":300,"y":40,"wires":[]},{"id":"37a672b3.29ad8e","type":"http in","z":"a82c65ac.c0b378","name":"PUT transformation","url":"/node/transformation","method":"put","upload":false,"swaggerDoc":"","x":110,"y":2280,"wires":[["eead0d38.71e2d"]]},{"id":"4844075.459c5f8","type":"change","z":"a82c65ac.c0b378","name":"auth payload","rules":[{"t":"set","p":"payload.client_id","pt":"msg","to":"node-red-editor","tot":"str"},{"t":"set","p":"payload.grant_type","pt":"msg","to":"password","tot":"str"},{"t":"set","p":"payload.scope","pt":"msg","to":"","tot":"str"},{"t":"set","p":"payload.username","pt":"msg","to":"NRLIB_USER","tot":"env"},{"t":"set","p":"payload.password","pt":"msg","to":"NRLIB_PASS","tot":"env"},{"t":"set","p":"url","pt":"msg","to":"$env('NRLIB_ENDP') & 'auth/token'","tot":"jsonata"}],"action":"","property":"","from":"","to":"","reg":false,"x":1070,"y":2280,"wires":[["5a0787c7.caecd8"]]},{"id":"3c2e99a4.e513c6","type":"http request","z":"a82c65ac.c0b378","name":"","method":"POST","ret":"obj","paytoqs":"ignore","url":"${CFG_ACL_ENDP}","tls":"51b09598.a1114c","persist":false,"proxy":"","authType":"","x":750,"y":2280,"wires":[["978e055e.b1f398"]]},{"id":"978e055e.b1f398","type":"switch","z":"a82c65ac.c0b378","name":"","property":"statusCode","propertyType":"msg","rules":[{"t":"eq","v":"200","vt":"num"},{"t":"else"}],"checkall":"true","repair":false,"outputs":2,"x":910,"y":2280,"wires":[["4844075.459c5f8"],["b1d720a3.2424e"]]},{"id":"7733abb9.af91b4","type":"change","z":"a82c65ac.c0b378","name":"acl req payload","rules":[{"t":"set","p":"headers","pt":"msg","to":"{}","tot":"json"},{"t":"set","p":"payload","pt":"msg","to":"{}","tot":"json"},{"t":"set","p":"payload.url","pt":"msg","to":"req.url","tot":"msg"},{"t":"set","p":"payload.method","pt":"msg","to":"req.method","tot":"msg"},{"t":"set","p":"payload.headers","pt":"msg","to":"req.headers","tot":"msg"},{"t":"set","p":"payload.params","pt":"msg","to":"req.params","tot":"msg"},{"t":"set","p":"payload.query","pt":"msg","to":"req.query","tot":"msg"},{"t":"set","p":"payload.body","pt":"msg","to":"req.body","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":560,"y":2280,"wires":[["3c2e99a4.e513c6"]]},{"id":"b1d720a3.2424e","type":"http response","z":"a82c65ac.c0b378","name":"","statusCode":"","headers":{},"x":1050,"y":2320,"wires":[]},{"id":"5a0787c7.caecd8","type":"http request","z":"a82c65ac.c0b378","name":"auth","method":"POST","ret":"obj","paytoqs":"ignore","url":"","tls":"76b04a6c.232224","persist":false,"proxy":"","authType":"","x":1230,"y":2280,"wires":[["1d203d5.e5bf1c3"]]},{"id":"a2b097e2.48c078","type":"change","z":"a82c65ac.c0b378","name":"","rules":[{"t":"set","p":"libAccessToken","pt":"msg","to":"payload.access_token","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":1570,"y":2280,"wires":[["49112964.037938"]]},{"id":"49112964.037938","type":"change","z":"a82c65ac.c0b378","name":"bearer","rules":[{"t":"set","p":"headers","pt":"msg","to":"{}","tot":"json"},{"t":"set","p":"headers.authorization","pt":"msg","to":"\"Bearer \" & msg.libAccessToken","tot":"jsonata"},{"t":"set","p":"url","pt":"msg","to":"$env('NRLIB_ENDP') & 'flows'","tot":"jsonata"}],"action":"","property":"","from":"","to":"","reg":false,"x":1770,"y":2280,"wires":[["3401a6b4.c68b0a"]]},{"id":"1d203d5.e5bf1c3","type":"switch","z":"a82c65ac.c0b378","name":"","property":"statusCode","propertyType":"msg","rules":[{"t":"eq","v":"200","vt":"num"},{"t":"else"}],"checkall":"true","repair":false,"outputs":2,"x":1370,"y":2280,"wires":[["a2b097e2.48c078"],["4837699.7c6d198"]]},{"id":"4837699.7c6d198","type":"http response","z":"a82c65ac.c0b378","name":"","statusCode":"","headers":{},"x":1510,"y":2320,"wires":[]},{"id":"3401a6b4.c68b0a","type":"http request","z":"a82c65ac.c0b378","name":"get flows","method":"GET","ret":"obj","paytoqs":"ignore","url":"","tls":"76b04a6c.232224","persist":false,"proxy":"","authType":"","x":1920,"y":2280,"wires":[["f41bf7f4.8e8b68"]]},{"id":"f41bf7f4.8e8b68","type":"switch","z":"a82c65ac.c0b378","name":"","property":"statusCode","propertyType":"msg","rules":[{"t":"eq","v":"200","vt":"num"},{"t":"else"}],"checkall":"true","repair":false,"outputs":2,"x":2070,"y":2280,"wires":[["df012a91.71aa58"],["74c4c6b7.41c4b8"]]},{"id":"74c4c6b7.41c4b8","type":"http response","z":"a82c65ac.c0b378","name":"","statusCode":"","headers":{},"x":2210,"y":2320,"wires":[]},{"id":"85127255.c4944","type":"change","z":"a82c65ac.c0b378","name":"","rules":[{"t":"set","p":"transformation","pt":"msg","to":"payload","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":360,"y":2280,"wires":[["7733abb9.af91b4"]]},{"id":"2158ed3d.e986b2","type":"http response","z":"a82c65ac.c0b378","name":"","statusCode":"","headers":{},"x":4070,"y":2320,"wires":[]},{"id":"dd5e1541.e502f8","type":"http request","z":"a82c65ac.c0b378","name":"auth","method":"POST","ret":"obj","paytoqs":"ignore","url":"https://localhost:1880/auth/token","tls":"b1a419c1.609c28","persist":false,"proxy":"","authType":"","x":990,"y":2380,"wires":[["622ca36b.a69f6c"]]},{"id":"10fa8c39.7de5d4","type":"change","z":"a82c65ac.c0b378","name":"auth payload","rules":[{"t":"set","p":"payload.client_id","pt":"msg","to":"node-red-editor","tot":"str"},{"t":"set","p":"payload.grant_type","pt":"msg","to":"password","tot":"str"},{"t":"set","p":"payload.scope","pt":"msg","to":"","tot":"str"},{"t":"set","p":"payload.username","pt":"msg","to":"NRADM_USER","tot":"env"},{"t":"set","p":"payload.password","pt":"msg","to":"NRADM_PASS","tot":"env"}],"action":"","property":"","from":"","to":"","reg":false,"x":830,"y":2380,"wires":[["dd5e1541.e502f8"]]},{"id":"6b82697c.d522b8","type":"change","z":"a82c65ac.c0b378","name":"","rules":[{"t":"set","p":"locAccessToken","pt":"msg","to":"payload.access_token","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":1330,"y":2380,"wires":[["bc2ac7e4.7e3e78"]]},{"id":"bc2ac7e4.7e3e78","type":"change","z":"a82c65ac.c0b378","name":"bearer","rules":[{"t":"set","p":"headers","pt":"msg","to":"{}","tot":"json"},{"t":"set","p":"headers.authorization","pt":"msg","to":"\"Bearer \" & msg.locAccessToken","tot":"jsonata"}],"action":"","property":"","from":"","to":"","reg":false,"x":1530,"y":2380,"wires":[["e2332878.8814a8"]]},{"id":"622ca36b.a69f6c","type":"switch","z":"a82c65ac.c0b378","name":"","property":"statusCode","propertyType":"msg","rules":[{"t":"eq","v":"200","vt":"num"},{"t":"else"}],"checkall":"true","repair":false,"outputs":2,"x":1130,"y":2380,"wires":[["6b82697c.d522b8"],["7bb478fe.cfb298"]]},{"id":"e2332878.8814a8","type":"http request","z":"a82c65ac.c0b378","name":"get flows","method":"GET","ret":"obj","paytoqs":"ignore","url":"https://localhost:1880/flows","tls":"b1a419c1.609c28","persist":false,"proxy":"","authType":"","x":1680,"y":2380,"wires":[["e680e2cd.57d2f"]]},{"id":"e680e2cd.57d2f","type":"switch","z":"a82c65ac.c0b378","name":"","property":"statusCode","propertyType":"msg","rules":[{"t":"eq","v":"200","vt":"num"},{"t":"else"}],"checkall":"true","repair":false,"outputs":2,"x":1830,"y":2380,"wires":[["4f7dffae.6242a"],["e2112bcd.63b508"]]},{"id":"e2112bcd.63b508","type":"http response","z":"a82c65ac.c0b378","name":"","statusCode":"","headers":{},"x":1970,"y":2420,"wires":[]},{"id":"7bb478fe.cfb298","type":"http response","z":"a82c65ac.c0b378","name":"","statusCode":"","headers":{},"x":1270,"y":2420,"wires":[]},{"id":"4f7dffae.6242a","type":"change","z":"a82c65ac.c0b378","name":"prepare","rules":[{"t":"set","p":"payload","pt":"msg","to":"*[type = 'subflow'].name","tot":"jsonata"},{"t":"set","p":"header","pt":"msg","to":"{\"Content-Type\":\"text/plain\"}","tot":"json"}],"action":"","property":"","from":"","to":"","reg":false,"x":1980,"y":2380,"wires":[["ab20f06b.a0156"]]},{"id":"f57a972a.a946a8","type":"http in","z":"a82c65ac.c0b378","name":"GET transformation","url":"/node/transformation","method":"get","upload":false,"swaggerDoc":"","x":110,"y":2380,"wires":[["41556569.252b6c"]]},{"id":"ab20f06b.a0156","type":"http response","z":"a82c65ac.c0b378","name":"","statusCode":"","headers":{},"x":2130,"y":2380,"wires":[]},{"id":"b74eb.71155b158","type":"http request","z":"a82c65ac.c0b378","name":"auth","method":"POST","ret":"obj","paytoqs":"ignore","url":"https://localhost:1880/auth/token","tls":"b1a419c1.609c28","persist":false,"proxy":"","authType":"","x":3110,"y":2280,"wires":[["75df614d.2aef1"]]},{"id":"eaedd316.e75e5","type":"change","z":"a82c65ac.c0b378","name":"auth payload","rules":[{"t":"set","p":"payload","pt":"msg","to":"{}","tot":"json"},{"t":"set","p":"payload.client_id","pt":"msg","to":"node-red-editor","tot":"str"},{"t":"set","p":"payload.grant_type","pt":"msg","to":"password","tot":"str"},{"t":"set","p":"payload.scope","pt":"msg","to":"","tot":"str"},{"t":"set","p":"payload.username","pt":"msg","to":"NRADM_USER","tot":"env"},{"t":"set","p":"payload.password","pt":"msg","to":"NRADM_PASS","tot":"env"},{"t":"delete","p":"statusCode","pt":"msg"},{"t":"delete","p":"responseUrl","pt":"msg"},{"t":"delete","p":"redirectList","pt":"msg"},{"t":"delete","p":"url","pt":"msg"},{"t":"delete","p":"headers","pt":"msg"},{"t":"delete","p":"libAccessToken","pt":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":2950,"y":2280,"wires":[["b74eb.71155b158"]]},{"id":"10a5b3f5.761ccc","type":"change","z":"a82c65ac.c0b378","name":"","rules":[{"t":"set","p":"accessToken","pt":"msg","to":"payload.access_token","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":3440,"y":2280,"wires":[["c32adc73.02588"]]},{"id":"c32adc73.02588","type":"change","z":"a82c65ac.c0b378","name":"bearer","rules":[{"t":"set","p":"payload","pt":"msg","to":"{}","tot":"json"},{"t":"set","p":"headers","pt":"msg","to":"{}","tot":"json"},{"t":"set","p":"headers.authorization","pt":"msg","to":"\"Bearer \" & msg.accessToken","tot":"jsonata"}],"action":"","property":"","from":"","to":"","reg":false,"x":3630,"y":2280,"wires":[["f4767a85.12c338"]]},{"id":"75df614d.2aef1","type":"switch","z":"a82c65ac.c0b378","name":"","property":"statusCode","propertyType":"msg","rules":[{"t":"eq","v":"200","vt":"num"},{"t":"else"}],"checkall":"true","repair":false,"outputs":2,"x":3250,"y":2280,"wires":[["10a5b3f5.761ccc"],["140da947.cc8347"]]},{"id":"f4767a85.12c338","type":"http request","z":"a82c65ac.c0b378","name":"get flows","method":"GET","ret":"obj","paytoqs":"ignore","url":"https://localhost:1880/flows","tls":"b1a419c1.609c28","persist":false,"proxy":"","authType":"","x":3780,"y":2280,"wires":[["4baba794.ba4db8"]]},{"id":"4baba794.ba4db8","type":"switch","z":"a82c65ac.c0b378","name":"","property":"statusCode","propertyType":"msg","rules":[{"t":"eq","v":"200","vt":"num"},{"t":"else"}],"checkall":"true","repair":false,"outputs":2,"x":3930,"y":2280,"wires":[["fe32a683.969408"],["2158ed3d.e986b2"]]},{"id":"140da947.cc8347","type":"http response","z":"a82c65ac.c0b378","name":"","statusCode":"","headers":{},"x":3390,"y":2320,"wires":[]},{"id":"df012a91.71aa58","type":"change","z":"a82c65ac.c0b378","name":"get new subflow","rules":[{"t":"set","p":"newSubflow","pt":"msg","to":"payload[type=\"subflow\" and name = $$.transformation ]","tot":"jsonata"}],"action":"","property":"","from":"","to":"","reg":false,"x":2240,"y":2280,"wires":[["f3634559.57e758"]]},{"id":"11999911.9ee4d7","type":"change","z":"a82c65ac.c0b378","name":"get new nodes","rules":[{"t":"set","p":"newNodes","pt":"msg","to":"$append([],payload[ z =  $$.newSubflow.id ])","tot":"jsonata"}],"action":"","property":"","from":"","to":"","reg":false,"x":2580,"y":2280,"wires":[["cd3879d8.9a86f8"]]},{"id":"fe32a683.969408","type":"change","z":"a82c65ac.c0b378","name":"edit subflow","rules":[{"t":"set","p":"oldSubflow","pt":"msg","to":"payload[type=\"subflow\"]","tot":"jsonata"},{"t":"set","p":"newSubflow.id","pt":"msg","to":"oldSubflow.id","tot":"msg"},{"t":"set","p":"payload","pt":"msg","to":"$eval($replace($string(payload),$string(oldSubflow),$string(newSubflow)))","tot":"jsonata"}],"action":"","property":"","from":"","to":"","reg":false,"x":4090,"y":2280,"wires":[["9e0f3283.e71ad"]]},{"id":"9e0f3283.e71ad","type":"function","z":"a82c65ac.c0b378","name":"edit nodes","func":"msg.oldNodes = msg.payload.filter(x => x.z == msg.oldSubflow.id );\nfor(var s = 0; s < 10; s++ ) {\n    var linked = [];\n    msg.oldNodes.forEach(function(oldNode,index){\n        for(var oldNodeProp in oldNode) {\n            linked.push(...msg.payload.filter(x => x.id == oldNode[oldNodeProp] && x.type != \"subflow\" && linked.filter(l => l.id == x.id).length == 0 && msg.oldNodes.filter(y => y.id == x.id).length == 0 ));\n        }\n    });\n    msg.oldNodes.push(...linked);\n    if(linked.length == 0) break;\n}\nmsg.newNodes.forEach(function(n){ if(\"z\" in n) n.z = msg.newSubflow.id });\nmsg.payload = msg.payload.filter(x => !msg.oldNodes.includes(x));\nmsg.payload.push(...msg.newNodes);\nmsg.payload.forEach(function(part, index, payload) {\n    if(payload[index].type == \"subflow:\"+msg.newSubflow.id) {\n        payload[index].name=msg.newSubflow.name\n    }\n});\nmsg.flowsAtNow = msg.payload;\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":4270,"y":2280,"wires":[["3ee5b1f8.31f2de"]]},{"id":"7316c554.72c1fc","type":"function","z":"a82c65ac.c0b378","name":"update flows","func":"const http = global.get('https');\nconst data = JSON.stringify(msg.payload);\nconst options = {\n  hostname: 'localhost',\n  port: 1880,\n  path: '/flows',\n  method: 'POST',\n  headers: {\n    'Content-Type': 'application/json',\n    'Content-Length': data.length,\n    'Authorization': 'Bearer '+msg.accessToken\n  },\n  rejectUnauthorized: false\n};\nconst req = http.request(options);\nreq.write(data);\nreq.end();\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":4310,"y":1660,"wires":[["a3365a71.3fa758"]]},{"id":"a3365a71.3fa758","type":"change","z":"a82c65ac.c0b378","name":"","rules":[{"t":"set","p":"payload","pt":"msg","to":"transformation","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":4520,"y":1660,"wires":[["2e397605.5f842a"]]},{"id":"2e397605.5f842a","type":"change","z":"a82c65ac.c0b378","name":"","rules":[{"t":"set","p":"headers","pt":"msg","to":"{\"Content-Type\":\"text/plain\"}","tot":"json"}],"action":"","property":"","from":"","to":"","reg":false,"x":4720,"y":1660,"wires":[["9f1cca24.8824e8"]]},{"id":"9f1cca24.8824e8","type":"http response","z":"a82c65ac.c0b378","name":"","statusCode":"","headers":{},"x":4890,"y":1620,"wires":[]},{"id":"f3634559.57e758","type":"switch","z":"a82c65ac.c0b378","name":"","property":"newSubflow","propertyType":"msg","rules":[{"t":"nempty"},{"t":"else"}],"checkall":"true","repair":false,"outputs":2,"x":2410,"y":2280,"wires":[["11999911.9ee4d7"],["bc4e0f12.9c047"]]},{"id":"549de2b7.a7b2ac","type":"http response","z":"a82c65ac.c0b378","name":"","statusCode":"404","headers":{},"x":2960,"y":2320,"wires":[]},{"id":"bc4e0f12.9c047","type":"change","z":"a82c65ac.c0b378","name":"","rules":[{"t":"set","p":"payload","pt":"msg","to":"transformation","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":2580,"y":2320,"wires":[["f5aa79d4.0f8de8"]]},{"id":"f5aa79d4.0f8de8","type":"change","z":"a82c65ac.c0b378","name":"","rules":[{"t":"set","p":"headers","pt":"msg","to":"{\"Content-Type\":\"text/plain\"}","tot":"json"}],"action":"","property":"","from":"","to":"","reg":false,"x":2780,"y":2320,"wires":[["549de2b7.a7b2ac"]]},{"id":"5424a378.6c29cc","type":"http in","z":"a82c65ac.c0b378","name":"POST input","url":"/node/input","method":"post","upload":false,"swaggerDoc":"","x":90,"y":2480,"wires":[["a479a49d.483388"]]},{"id":"a479a49d.483388","type":"change","z":"a82c65ac.c0b378","name":"","rules":[{"t":"set","p":"name","pt":"msg","to":"payload","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":280,"y":2480,"wires":[["33339358.c5d56c"]]},{"id":"db32758d.7eafc8","type":"http request","z":"a82c65ac.c0b378","name":"auth","method":"POST","ret":"obj","paytoqs":"ignore","url":"https://localhost:1880/auth/token","tls":"b1a419c1.609c28","persist":false,"proxy":"","authType":"","x":1150,"y":2480,"wires":[["2980b539.49af4a"]]},{"id":"6e8b0271.99045c","type":"change","z":"a82c65ac.c0b378","name":"auth payload","rules":[{"t":"set","p":"payload.client_id","pt":"msg","to":"node-red-editor","tot":"str"},{"t":"set","p":"payload.grant_type","pt":"msg","to":"password","tot":"str"},{"t":"set","p":"payload.scope","pt":"msg","to":"","tot":"str"},{"t":"set","p":"payload.username","pt":"msg","to":"NRADM_USER","tot":"env"},{"t":"set","p":"payload.password","pt":"msg","to":"NRADM_PASS","tot":"env"}],"action":"","property":"","from":"","to":"","reg":false,"x":990,"y":2480,"wires":[["db32758d.7eafc8"]]},{"id":"2980b539.49af4a","type":"switch","z":"a82c65ac.c0b378","name":"","property":"statusCode","propertyType":"msg","rules":[{"t":"eq","v":"200","vt":"num"},{"t":"else"}],"checkall":"true","repair":false,"outputs":2,"x":1290,"y":2480,"wires":[["1f42ef12.1efea1"],["173080e5.53d5af"]]},{"id":"1f42ef12.1efea1","type":"change","z":"a82c65ac.c0b378","name":"","rules":[{"t":"set","p":"accessToken","pt":"msg","to":"payload.access_token","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":1480,"y":2480,"wires":[["81e3a37e.8d66"]]},{"id":"81e3a37e.8d66","type":"change","z":"a82c65ac.c0b378","name":"bearer","rules":[{"t":"set","p":"headers","pt":"msg","to":"{}","tot":"json"},{"t":"set","p":"headers.authorization","pt":"msg","to":"\"Bearer \" & msg.accessToken","tot":"jsonata"}],"action":"","property":"","from":"","to":"","reg":false,"x":1670,"y":2480,"wires":[["d1b4b49e.59ba48"]]},{"id":"d1b4b49e.59ba48","type":"http request","z":"a82c65ac.c0b378","name":"get flows","method":"GET","ret":"obj","paytoqs":"ignore","url":"https://localhost:1880/flows","tls":"b1a419c1.609c28","persist":false,"proxy":"","authType":"","x":1820,"y":2480,"wires":[["b4b185ca.18c2d8"]]},{"id":"b4b185ca.18c2d8","type":"switch","z":"a82c65ac.c0b378","name":"","property":"statusCode","propertyType":"msg","rules":[{"t":"eq","v":"200","vt":"num"},{"t":"else"}],"checkall":"true","repair":false,"outputs":2,"x":1970,"y":2480,"wires":[["e179f8fe.b68658"],["64d04034.a8445"]]},{"id":"173080e5.53d5af","type":"http response","z":"a82c65ac.c0b378","name":"","statusCode":"","headers":{},"x":1430,"y":2520,"wires":[]},{"id":"64d04034.a8445","type":"http response","z":"a82c65ac.c0b378","name":"","statusCode":"","headers":{},"x":2110,"y":2520,"wires":[]},{"id":"9f50de29.eea18","type":"change","z":"a82c65ac.c0b378","name":"add","rules":[{"t":"set","p":"newNode","pt":"msg","to":"[{\"id\":\"\",\"type\":\"mqtt in\",\"z\":\"\",\"name\":\"\",\"topic\":\"\",\"qos\":\"2\",\"datatype\":\"auto\",\"broker\":\"\",\"nl\":false,\"rap\":true,\"rh\":0,\"x\":90,\"y\":40,\"wires\":[[]]}]","tot":"json"},{"t":"set","p":"newNode[0].z","pt":"msg","to":"*[type = 'tab' and label ='Business Logic'].id","tot":"jsonata"},{"t":"set","p":"newNode[0].name","pt":"msg","to":"name","tot":"msg"},{"t":"set","p":"newNode[0].topic","pt":"msg","to":"name","tot":"msg"},{"t":"set","p":"newNode[0].id","pt":"msg","to":"newNodeId","tot":"msg"},{"t":"set","p":"newNode[0].broker","pt":"msg","to":"newBrokerId","tot":"msg"},{"t":"set","p":"payload","pt":"msg","to":"$append(payload,newNode)","tot":"jsonata"},{"t":"set","p":"newBroker","pt":"msg","to":"[{\"id\":\"\",\"type\":\"mqtt-broker\",\"name\":\"\",\"broker\":\"localhost\",\"port\":\"\",\"tls\":\"\",\"clientid\":\"\",\"usetls\":false,\"protocolVersion\":\"4\",\"keepalive\":\"60\",\"cleansession\":true,\"birthTopic\":\"\",\"birthQos\":\"0\",\"birthPayload\":\"\",\"birthMsg\":{},\"closeTopic\":\"\",\"closeQos\":\"0\",\"closePayload\":\"\",\"closeMsg\":{},\"willTopic\":\"\",\"willQos\":\"0\",\"willPayload\":\"\",\"willMsg\":{},\"sessionExpiry\":\"\"}]","tot":"json"},{"t":"set","p":"newBroker[0].id","pt":"msg","to":"newBrokerId","tot":"msg"},{"t":"set","p":"newBroker[0].name","pt":"msg","to":"name & \" broker\"","tot":"jsonata"},{"t":"set","p":"newBroker[0].tls","pt":"msg","to":"newTlsId","tot":"msg"},{"t":"set","p":"payload","pt":"msg","to":"$append(payload,newBroker)","tot":"jsonata"},{"t":"set","p":"newTlsConfig","pt":"msg","to":"[{\"id\":\"\",\"type\":\"tls-config\",\"name\":\"\",\"cert\":\"\",\"key\":\"\",\"ca\":\"\",\"certname\":\"\",\"keyname\":\"\",\"caname\":\"\",\"servername\":\"\",\"verifyservercert\":false}]","tot":"json"},{"t":"set","p":"newTlsConfig[0].id","pt":"msg","to":"newTlsId","tot":"msg"},{"t":"set","p":"newTlsConfig[0].name","pt":"msg","to":"name & \" tls config\"","tot":"jsonata"},{"t":"set","p":"payload","pt":"msg","to":"$append(payload,newTlsConfig)","tot":"jsonata"}],"action":"","property":"","from":"","to":"","reg":false,"x":2710,"y":2480,"wires":[["df9ad482.a0d218"]]},{"id":"4157dc28.6cb4c4","type":"http request","z":"a82c65ac.c0b378","name":"","method":"POST","ret":"obj","paytoqs":"ignore","url":"${CFG_ACL_ENDP}","tls":"51b09598.a1114c","persist":false,"proxy":"","authType":"","x":510,"y":2380,"wires":[["b43183be.a73de"]]},{"id":"b43183be.a73de","type":"switch","z":"a82c65ac.c0b378","name":"","property":"statusCode","propertyType":"msg","rules":[{"t":"eq","v":"200","vt":"num"},{"t":"else"}],"checkall":"true","repair":false,"outputs":2,"x":670,"y":2380,"wires":[["10fa8c39.7de5d4"],["14c2ba29.8b6ae6"]]},{"id":"41556569.252b6c","type":"change","z":"a82c65ac.c0b378","name":"acl req payload","rules":[{"t":"set","p":"headers","pt":"msg","to":"{}","tot":"json"},{"t":"set","p":"payload","pt":"msg","to":"{}","tot":"json"},{"t":"set","p":"payload.url","pt":"msg","to":"req.url","tot":"msg"},{"t":"set","p":"payload.method","pt":"msg","to":"req.method","tot":"msg"},{"t":"set","p":"payload.headers","pt":"msg","to":"req.headers","tot":"msg"},{"t":"set","p":"payload.params","pt":"msg","to":"req.params","tot":"msg"},{"t":"set","p":"payload.query","pt":"msg","to":"req.query","tot":"msg"},{"t":"set","p":"payload.body","pt":"msg","to":"req.body","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":320,"y":2380,"wires":[["4157dc28.6cb4c4"]]},{"id":"14c2ba29.8b6ae6","type":"http response","z":"a82c65ac.c0b378","name":"","statusCode":"","headers":{},"x":810,"y":2420,"wires":[]},{"id":"f7c0adb0.78a7e","type":"http request","z":"a82c65ac.c0b378","name":"","method":"POST","ret":"obj","paytoqs":"ignore","url":"${CFG_ACL_ENDP}","tls":"51b09598.a1114c","persist":false,"proxy":"","authType":"","x":670,"y":2480,"wires":[["6f0ff61b.d767a8"]]},{"id":"6f0ff61b.d767a8","type":"switch","z":"a82c65ac.c0b378","name":"","property":"statusCode","propertyType":"msg","rules":[{"t":"eq","v":"200","vt":"num"},{"t":"else"}],"checkall":"true","repair":false,"outputs":2,"x":830,"y":2480,"wires":[["6e8b0271.99045c"],["616639ea.da7c78"]]},{"id":"33339358.c5d56c","type":"change","z":"a82c65ac.c0b378","name":"acl req payload","rules":[{"t":"set","p":"headers","pt":"msg","to":"{}","tot":"json"},{"t":"set","p":"payload","pt":"msg","to":"{}","tot":"json"},{"t":"set","p":"payload.url","pt":"msg","to":"req.url","tot":"msg"},{"t":"set","p":"payload.method","pt":"msg","to":"req.method","tot":"msg"},{"t":"set","p":"payload.headers","pt":"msg","to":"req.headers","tot":"msg"},{"t":"set","p":"payload.params","pt":"msg","to":"req.params","tot":"msg"},{"t":"set","p":"payload.query","pt":"msg","to":"req.query","tot":"msg"},{"t":"set","p":"payload.body","pt":"msg","to":"req.body","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":480,"y":2480,"wires":[["f7c0adb0.78a7e"]]},{"id":"616639ea.da7c78","type":"http response","z":"a82c65ac.c0b378","name":"","statusCode":"","headers":{},"x":970,"y":2520,"wires":[]},{"id":"df9ad482.a0d218","type":"function","z":"a82c65ac.c0b378","name":"update flows","func":"const http = global.get('https');\nconst data = JSON.stringify(msg.payload);\nconst options = {\n  hostname: 'localhost',\n  port: 1880,\n  path: '/flows',\n  method: 'POST',\n  headers: {\n    'Content-Type': 'application/json',\n    'Content-Length': data.length,\n    'Authorization': 'Bearer '+msg.accessToken\n  },\n  rejectUnauthorized: false\n};\nconst req = http.request(options);\nreq.write(data);\nreq.end();\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":2870,"y":2480,"wires":[["d0c62b2e.415698"]]},{"id":"d0c62b2e.415698","type":"change","z":"a82c65ac.c0b378","name":"","rules":[{"t":"set","p":"payload","pt":"msg","to":"name","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":3060,"y":2480,"wires":[["28734212.d2c46e"]]},{"id":"28734212.d2c46e","type":"change","z":"a82c65ac.c0b378","name":"","rules":[{"t":"set","p":"headers","pt":"msg","to":"{\"Content-Type\":\"text/plain\"}","tot":"json"}],"action":"","property":"","from":"","to":"","reg":false,"x":3260,"y":2480,"wires":[["5f97734e.e534cc"]]},{"id":"5f97734e.e534cc","type":"http response","z":"a82c65ac.c0b378","name":"","statusCode":"","headers":{},"x":3450,"y":2480,"wires":[]},{"id":"7c5631c9.f8fb9","type":"function","z":"a82c65ac.c0b378","name":"id","func":"msg.newNodeId = (1 + Math.random () * 4294967295).toString(16);\nmsg.newBrokerId = (1 + Math.random () * 4294967295).toString(16);\nmsg.newTlsId = (1 + Math.random () * 4294967295).toString(16);\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":2570,"y":2480,"wires":[["9f50de29.eea18"]]},{"id":"e179f8fe.b68658","type":"change","z":"a82c65ac.c0b378","name":"","rules":[{"t":"set","p":"existing","pt":"msg","to":"*[name=$$.name]","tot":"jsonata"}],"action":"","property":"","from":"","to":"","reg":false,"x":2130,"y":2480,"wires":[["95593af0.0e5308"]]},{"id":"95593af0.0e5308","type":"switch","z":"a82c65ac.c0b378","name":"","property":"existing","propertyType":"msg","rules":[{"t":"null"},{"t":"else"}],"checkall":"true","repair":false,"outputs":2,"x":2290,"y":2480,"wires":[["59e6ba06.804944"],["86042fe1.1b344"]]},{"id":"49da2f3b.929a5","type":"http response","z":"a82c65ac.c0b378","name":"","statusCode":"400","headers":{},"x":2640,"y":2520,"wires":[]},{"id":"86042fe1.1b344","type":"change","z":"a82c65ac.c0b378","name":"","rules":[{"t":"set","p":"payload","pt":"msg","to":"\"One element already exists that is named \" & name & $string(*[name=$$.name])","tot":"jsonata"}],"action":"","property":"","from":"","to":"","reg":false,"x":2460,"y":2520,"wires":[["49da2f3b.929a5"]]},{"id":"41c55b2f.b732a4","type":"http in","z":"a82c65ac.c0b378","name":"DELETE input","url":"/node/input/:name","method":"delete","upload":false,"swaggerDoc":"","x":90,"y":2580,"wires":[["f5adca10.48f658"]]},{"id":"f5adca10.48f658","type":"change","z":"a82c65ac.c0b378","name":"","rules":[{"t":"set","p":"name","pt":"msg","to":"req.params.name","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":280,"y":2580,"wires":[["e417ca56.a314c8"]]},{"id":"7d3f9193.3175b","type":"http request","z":"a82c65ac.c0b378","name":"auth","method":"POST","ret":"obj","paytoqs":"ignore","url":"https://localhost:1880/auth/token","tls":"b1a419c1.609c28","persist":false,"proxy":"","authType":"","x":1150,"y":2580,"wires":[["9c6616b5.7b0218"]]},{"id":"bbd25066.c4cd1","type":"change","z":"a82c65ac.c0b378","name":"auth payload","rules":[{"t":"set","p":"payload.client_id","pt":"msg","to":"node-red-editor","tot":"str"},{"t":"set","p":"payload.grant_type","pt":"msg","to":"password","tot":"str"},{"t":"set","p":"payload.scope","pt":"msg","to":"","tot":"str"},{"t":"set","p":"payload.username","pt":"msg","to":"NRADM_USER","tot":"env"},{"t":"set","p":"payload.password","pt":"msg","to":"NRADM_PASS","tot":"env"}],"action":"","property":"","from":"","to":"","reg":false,"x":990,"y":2580,"wires":[["7d3f9193.3175b"]]},{"id":"9c6616b5.7b0218","type":"switch","z":"a82c65ac.c0b378","name":"","property":"statusCode","propertyType":"msg","rules":[{"t":"eq","v":"200","vt":"num"},{"t":"else"}],"checkall":"true","repair":false,"outputs":2,"x":1290,"y":2580,"wires":[["da8de7fa.98d7b8"],["2c87f54e.e86e1a"]]},{"id":"da8de7fa.98d7b8","type":"change","z":"a82c65ac.c0b378","name":"","rules":[{"t":"set","p":"accessToken","pt":"msg","to":"payload.access_token","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":1480,"y":2580,"wires":[["dc702b35.5b8248"]]},{"id":"dc702b35.5b8248","type":"change","z":"a82c65ac.c0b378","name":"bearer","rules":[{"t":"set","p":"headers","pt":"msg","to":"{}","tot":"json"},{"t":"set","p":"headers.authorization","pt":"msg","to":"\"Bearer \" & msg.accessToken","tot":"jsonata"}],"action":"","property":"","from":"","to":"","reg":false,"x":1670,"y":2580,"wires":[["57fde0a2.a8606"]]},{"id":"57fde0a2.a8606","type":"http request","z":"a82c65ac.c0b378","name":"get flows","method":"GET","ret":"obj","paytoqs":"ignore","url":"https://localhost:1880/flows","tls":"b1a419c1.609c28","persist":false,"proxy":"","authType":"","x":1820,"y":2580,"wires":[["9f398ef.1574d7"]]},{"id":"2c87f54e.e86e1a","type":"http response","z":"a82c65ac.c0b378","name":"","statusCode":"","headers":{},"x":1430,"y":2620,"wires":[]},{"id":"51f6d455.c8013c","type":"http request","z":"a82c65ac.c0b378","name":"","method":"POST","ret":"obj","paytoqs":"ignore","url":"${CFG_ACL_ENDP}","tls":"51b09598.a1114c","persist":false,"proxy":"","authType":"","x":670,"y":2580,"wires":[["9ea2efc8.093df"]]},{"id":"9ea2efc8.093df","type":"switch","z":"a82c65ac.c0b378","name":"","property":"statusCode","propertyType":"msg","rules":[{"t":"eq","v":"200","vt":"num"},{"t":"else"}],"checkall":"true","repair":false,"outputs":2,"x":830,"y":2580,"wires":[["bbd25066.c4cd1"],["ef52bb2b.dff4f8"]]},{"id":"e417ca56.a314c8","type":"change","z":"a82c65ac.c0b378","name":"acl req payload","rules":[{"t":"set","p":"headers","pt":"msg","to":"{}","tot":"json"},{"t":"set","p":"payload","pt":"msg","to":"{}","tot":"json"},{"t":"set","p":"payload.url","pt":"msg","to":"req.url","tot":"msg"},{"t":"set","p":"payload.method","pt":"msg","to":"req.method","tot":"msg"},{"t":"set","p":"payload.headers","pt":"msg","to":"req.headers","tot":"msg"},{"t":"set","p":"payload.params","pt":"msg","to":"req.params","tot":"msg"},{"t":"set","p":"payload.query","pt":"msg","to":"req.query","tot":"msg"},{"t":"set","p":"payload.body","pt":"msg","to":"req.body","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":480,"y":2580,"wires":[["51f6d455.c8013c"]]},{"id":"ef52bb2b.dff4f8","type":"http response","z":"a82c65ac.c0b378","name":"","statusCode":"","headers":{},"x":970,"y":2620,"wires":[]},{"id":"9f398ef.1574d7","type":"switch","z":"a82c65ac.c0b378","name":"","property":"statusCode","propertyType":"msg","rules":[{"t":"eq","v":"200","vt":"num"},{"t":"else"}],"checkall":"true","repair":false,"outputs":2,"x":1970,"y":2580,"wires":[["fb306543.cef398"],["806f20a5.e8497"]]},{"id":"806f20a5.e8497","type":"http response","z":"a82c65ac.c0b378","name":"","statusCode":"","headers":{},"x":2110,"y":2620,"wires":[]},{"id":"59e6ba06.804944","type":"switch","z":"a82c65ac.c0b378","name":"","property":"name","propertyType":"msg","rules":[{"t":"cont","v":" ","vt":"str"},{"t":"else"}],"checkall":"true","repair":false,"outputs":2,"x":2430,"y":2480,"wires":[["fe8b5167.298ca"],["7c5631c9.f8fb9"]]},{"id":"fe8b5167.298ca","type":"change","z":"a82c65ac.c0b378","name":"","rules":[{"t":"set","p":"payload","pt":"msg","to":"Spaces not allowed","tot":"str"}],"action":"","property":"","from":"","to":"","reg":false,"x":2600,"y":2440,"wires":[["a7c9d40.ba31e3"]]},{"id":"a7c9d40.ba31e3","type":"http response","z":"a82c65ac.c0b378","name":"","statusCode":"400","headers":{},"x":2780,"y":2440,"wires":[]},{"id":"8aa8c668.550ae8","type":"function","z":"a82c65ac.c0b378","name":"delete","func":"msg.payload = msg.payload.filter(x => x.name != msg.name && x.name != msg.name + \" broker\" && x.name != msg.name + \" tls config\" )\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":2410,"y":2580,"wires":[["75e2d97a.aa49e8"]]},{"id":"75e2d97a.aa49e8","type":"function","z":"a82c65ac.c0b378","name":"update flows","func":"const http = global.get('https');\nconst data = JSON.stringify(msg.payload);\nconst options = {\n  hostname: 'localhost',\n  port: 1880,\n  path: '/flows',\n  method: 'POST',\n  headers: {\n    'Content-Type': 'application/json',\n    'Content-Length': data.length,\n    'Authorization': 'Bearer '+msg.accessToken\n  },\n  rejectUnauthorized: false\n};\nconst req = http.request(options);\nreq.write(data);\nreq.end();\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":2590,"y":2580,"wires":[["61869fd.c63986"]]},{"id":"61869fd.c63986","type":"change","z":"a82c65ac.c0b378","name":"","rules":[{"t":"set","p":"payload","pt":"msg","to":"name","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":2780,"y":2580,"wires":[["59506455.fc89ec"]]},{"id":"59506455.fc89ec","type":"change","z":"a82c65ac.c0b378","name":"","rules":[{"t":"set","p":"headers","pt":"msg","to":"{\"Content-Type\":\"text/plain\"}","tot":"json"}],"action":"","property":"","from":"","to":"","reg":false,"x":2980,"y":2580,"wires":[["84f66db7.f7a8e"]]},{"id":"84f66db7.f7a8e","type":"http response","z":"a82c65ac.c0b378","name":"","statusCode":"","headers":{},"x":3150,"y":2580,"wires":[]},{"id":"595654b0.6d560c","type":"http in","z":"a82c65ac.c0b378","name":"POST output","url":"/node/output","method":"post","upload":false,"swaggerDoc":"","x":90,"y":2680,"wires":[["e1e80393.bf3de"]]},{"id":"e1e80393.bf3de","type":"change","z":"a82c65ac.c0b378","name":"","rules":[{"t":"set","p":"name","pt":"msg","to":"payload","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":280,"y":2680,"wires":[["6eda9fd8.3f3fb"]]},{"id":"2dcf992b.b55546","type":"http request","z":"a82c65ac.c0b378","name":"auth","method":"POST","ret":"obj","paytoqs":"ignore","url":"https://localhost:1880/auth/token","tls":"b1a419c1.609c28","persist":false,"proxy":"","authType":"","x":1150,"y":2680,"wires":[["5227a216.3d389c"]]},{"id":"752fa772.9b87f8","type":"change","z":"a82c65ac.c0b378","name":"auth payload","rules":[{"t":"set","p":"payload.client_id","pt":"msg","to":"node-red-editor","tot":"str"},{"t":"set","p":"payload.grant_type","pt":"msg","to":"password","tot":"str"},{"t":"set","p":"payload.scope","pt":"msg","to":"","tot":"str"},{"t":"set","p":"payload.username","pt":"msg","to":"NRADM_USER","tot":"env"},{"t":"set","p":"payload.password","pt":"msg","to":"NRADM_PASS","tot":"env"}],"action":"","property":"","from":"","to":"","reg":false,"x":990,"y":2680,"wires":[["2dcf992b.b55546"]]},{"id":"5227a216.3d389c","type":"switch","z":"a82c65ac.c0b378","name":"","property":"statusCode","propertyType":"msg","rules":[{"t":"eq","v":"200","vt":"num"},{"t":"else"}],"checkall":"true","repair":false,"outputs":2,"x":1290,"y":2680,"wires":[["67867481.b53e6c"],["3615761.469618a"]]},{"id":"67867481.b53e6c","type":"change","z":"a82c65ac.c0b378","name":"","rules":[{"t":"set","p":"accessToken","pt":"msg","to":"payload.access_token","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":1480,"y":2680,"wires":[["cae707fe.c2b038"]]},{"id":"cae707fe.c2b038","type":"change","z":"a82c65ac.c0b378","name":"bearer","rules":[{"t":"set","p":"headers","pt":"msg","to":"{}","tot":"json"},{"t":"set","p":"headers.authorization","pt":"msg","to":"\"Bearer \" & msg.accessToken","tot":"jsonata"}],"action":"","property":"","from":"","to":"","reg":false,"x":1670,"y":2680,"wires":[["719553ba.77572c"]]},{"id":"719553ba.77572c","type":"http request","z":"a82c65ac.c0b378","name":"get flows","method":"GET","ret":"obj","paytoqs":"ignore","url":"https://localhost:1880/flows","tls":"b1a419c1.609c28","persist":false,"proxy":"","authType":"","x":1820,"y":2680,"wires":[["c2d0a6f3.828d78"]]},{"id":"c2d0a6f3.828d78","type":"switch","z":"a82c65ac.c0b378","name":"","property":"statusCode","propertyType":"msg","rules":[{"t":"eq","v":"200","vt":"num"},{"t":"else"}],"checkall":"true","repair":false,"outputs":2,"x":1970,"y":2680,"wires":[["501e56ca.029348"],["2553fdca.9f8502"]]},{"id":"3615761.469618a","type":"http response","z":"a82c65ac.c0b378","name":"","statusCode":"","headers":{},"x":1430,"y":2720,"wires":[]},{"id":"2553fdca.9f8502","type":"http response","z":"a82c65ac.c0b378","name":"","statusCode":"","headers":{},"x":2110,"y":2720,"wires":[]},{"id":"8be2bf5c.142b","type":"change","z":"a82c65ac.c0b378","name":"add","rules":[{"t":"set","p":"newNode","pt":"msg","to":"[{\"id\":\"\",\"type\":\"mqtt out\",\"z\":\"\",\"name\":\"\",\"topic\":\"\",\"qos\":\"2\",\"datatype\":\"auto\",\"broker\":\"\",\"nl\":false,\"rap\":true,\"rh\":0,\"x\":490,\"y\":40,\"wires\":[[]]}]","tot":"json"},{"t":"set","p":"newNode[0].z","pt":"msg","to":"*[type = 'tab' and label ='Business Logic'].id","tot":"jsonata"},{"t":"set","p":"newNode[0].name","pt":"msg","to":"name","tot":"msg"},{"t":"set","p":"newNode[0].topic","pt":"msg","to":"name","tot":"msg"},{"t":"set","p":"newNode[0].id","pt":"msg","to":"newNodeId","tot":"msg"},{"t":"set","p":"newNode[0].broker","pt":"msg","to":"newBrokerId","tot":"msg"},{"t":"set","p":"payload","pt":"msg","to":"$append(payload,newNode)","tot":"jsonata"},{"t":"set","p":"newBroker","pt":"msg","to":"[{\"id\":\"\",\"type\":\"mqtt-broker\",\"name\":\"\",\"broker\":\"localhost\",\"port\":\"\",\"tls\":\"\",\"clientid\":\"\",\"usetls\":false,\"protocolVersion\":\"4\",\"keepalive\":\"60\",\"cleansession\":true,\"birthTopic\":\"\",\"birthQos\":\"0\",\"birthPayload\":\"\",\"birthMsg\":{},\"closeTopic\":\"\",\"closeQos\":\"0\",\"closePayload\":\"\",\"closeMsg\":{},\"willTopic\":\"\",\"willQos\":\"0\",\"willPayload\":\"\",\"willMsg\":{},\"sessionExpiry\":\"\"}]","tot":"json"},{"t":"set","p":"newBroker[0].id","pt":"msg","to":"newBrokerId","tot":"msg"},{"t":"set","p":"newBroker[0].name","pt":"msg","to":"name & \" broker\"","tot":"jsonata"},{"t":"set","p":"newBroker[0].tls","pt":"msg","to":"newTlsId","tot":"msg"},{"t":"set","p":"payload","pt":"msg","to":"$append(payload,newBroker)","tot":"jsonata"},{"t":"set","p":"newTlsConfig","pt":"msg","to":"[{\"id\":\"\",\"type\":\"tls-config\",\"name\":\"\",\"cert\":\"\",\"key\":\"\",\"ca\":\"\",\"certname\":\"\",\"keyname\":\"\",\"caname\":\"\",\"servername\":\"\",\"verifyservercert\":false}]","tot":"json"},{"t":"set","p":"newTlsConfig[0].id","pt":"msg","to":"newTlsId","tot":"msg"},{"t":"set","p":"newTlsConfig[0].name","pt":"msg","to":"name & \" tls config\"","tot":"jsonata"},{"t":"set","p":"payload","pt":"msg","to":"$append(payload,newTlsConfig)","tot":"jsonata"}],"action":"","property":"","from":"","to":"","reg":false,"x":2710,"y":2680,"wires":[["8e991043.d265a"]]},{"id":"9daf5266.9edfc","type":"http request","z":"a82c65ac.c0b378","name":"","method":"POST","ret":"obj","paytoqs":"ignore","url":"${CFG_ACL_ENDP}","tls":"51b09598.a1114c","persist":false,"proxy":"","authType":"","x":670,"y":2680,"wires":[["18a2821e.c625be"]]},{"id":"18a2821e.c625be","type":"switch","z":"a82c65ac.c0b378","name":"","property":"statusCode","propertyType":"msg","rules":[{"t":"eq","v":"200","vt":"num"},{"t":"else"}],"checkall":"true","repair":false,"outputs":2,"x":830,"y":2680,"wires":[["752fa772.9b87f8"],["c1f3a76f.550f58"]]},{"id":"6eda9fd8.3f3fb","type":"change","z":"a82c65ac.c0b378","name":"acl req payload","rules":[{"t":"set","p":"headers","pt":"msg","to":"{}","tot":"json"},{"t":"set","p":"payload","pt":"msg","to":"{}","tot":"json"},{"t":"set","p":"payload.url","pt":"msg","to":"req.url","tot":"msg"},{"t":"set","p":"payload.method","pt":"msg","to":"req.method","tot":"msg"},{"t":"set","p":"payload.headers","pt":"msg","to":"req.headers","tot":"msg"},{"t":"set","p":"payload.params","pt":"msg","to":"req.params","tot":"msg"},{"t":"set","p":"payload.query","pt":"msg","to":"req.query","tot":"msg"},{"t":"set","p":"payload.body","pt":"msg","to":"req.body","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":480,"y":2680,"wires":[["9daf5266.9edfc"]]},{"id":"c1f3a76f.550f58","type":"http response","z":"a82c65ac.c0b378","name":"","statusCode":"","headers":{},"x":970,"y":2720,"wires":[]},{"id":"8e991043.d265a","type":"function","z":"a82c65ac.c0b378","name":"update flows","func":"const http = global.get('https');\nconst data = JSON.stringify(msg.payload);\nconst options = {\n  hostname: 'localhost',\n  port: 1880,\n  path: '/flows',\n  method: 'POST',\n  headers: {\n    'Content-Type': 'application/json',\n    'Content-Length': data.length,\n    'Authorization': 'Bearer '+msg.accessToken\n  },\n  rejectUnauthorized: false\n};\nconst req = http.request(options);\nreq.write(data);\nreq.end();\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":2870,"y":2680,"wires":[["2bc4a2ca.30a03e"]]},{"id":"2bc4a2ca.30a03e","type":"change","z":"a82c65ac.c0b378","name":"","rules":[{"t":"set","p":"payload","pt":"msg","to":"name","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":3060,"y":2680,"wires":[["cf09f2d4.d91c"]]},{"id":"cf09f2d4.d91c","type":"change","z":"a82c65ac.c0b378","name":"","rules":[{"t":"set","p":"headers","pt":"msg","to":"{\"Content-Type\":\"text/plain\"}","tot":"json"}],"action":"","property":"","from":"","to":"","reg":false,"x":3260,"y":2680,"wires":[["bd9f2eb2.e67ac"]]},{"id":"bd9f2eb2.e67ac","type":"http response","z":"a82c65ac.c0b378","name":"","statusCode":"","headers":{},"x":3430,"y":2680,"wires":[]},{"id":"7cac346.aed24cc","type":"function","z":"a82c65ac.c0b378","name":"id","func":"msg.newNodeId = (1 + Math.random () * 4294967295).toString(16);\nmsg.newBrokerId = (1 + Math.random () * 4294967295).toString(16);\nmsg.newTlsId = (1 + Math.random () * 4294967295).toString(16);\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":2570,"y":2680,"wires":[["8be2bf5c.142b"]]},{"id":"501e56ca.029348","type":"change","z":"a82c65ac.c0b378","name":"","rules":[{"t":"set","p":"existing","pt":"msg","to":"*[name=$$.name]","tot":"jsonata"}],"action":"","property":"","from":"","to":"","reg":false,"x":2130,"y":2680,"wires":[["7bf8be58.dc079"]]},{"id":"7bf8be58.dc079","type":"switch","z":"a82c65ac.c0b378","name":"","property":"existing","propertyType":"msg","rules":[{"t":"null"},{"t":"else"}],"checkall":"true","repair":false,"outputs":2,"x":2290,"y":2680,"wires":[["5e4df7b4.afdbb8"],["31db2bab.e8b9f4"]]},{"id":"9faead68.f0f17","type":"http response","z":"a82c65ac.c0b378","name":"","statusCode":"400","headers":{},"x":2640,"y":2720,"wires":[]},{"id":"31db2bab.e8b9f4","type":"change","z":"a82c65ac.c0b378","name":"","rules":[{"t":"set","p":"payload","pt":"msg","to":"\"One element already exists that is named \" & name & $string(*[name=$$.name])","tot":"jsonata"}],"action":"","property":"","from":"","to":"","reg":false,"x":2460,"y":2720,"wires":[["9faead68.f0f17"]]},{"id":"d471347.583e4c8","type":"http in","z":"a82c65ac.c0b378","name":"DELETE output","url":"/node/output/:name","method":"delete","upload":false,"swaggerDoc":"","x":100,"y":2780,"wires":[["4d6864e4.9b1c1c"]]},{"id":"4d6864e4.9b1c1c","type":"change","z":"a82c65ac.c0b378","name":"","rules":[{"t":"set","p":"name","pt":"msg","to":"req.params.name","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":280,"y":2780,"wires":[["c5784e7a.55a9b"]]},{"id":"8964f393.0de37","type":"http request","z":"a82c65ac.c0b378","name":"auth","method":"POST","ret":"obj","paytoqs":"ignore","url":"https://localhost:1880/auth/token","tls":"b1a419c1.609c28","persist":false,"proxy":"","authType":"","x":1150,"y":2780,"wires":[["3326b0fd.88d51"]]},{"id":"c41f9800.62bb08","type":"change","z":"a82c65ac.c0b378","name":"auth payload","rules":[{"t":"set","p":"payload.client_id","pt":"msg","to":"node-red-editor","tot":"str"},{"t":"set","p":"payload.grant_type","pt":"msg","to":"password","tot":"str"},{"t":"set","p":"payload.scope","pt":"msg","to":"","tot":"str"},{"t":"set","p":"payload.username","pt":"msg","to":"NRADM_USER","tot":"env"},{"t":"set","p":"payload.password","pt":"msg","to":"NRADM_PASS","tot":"env"}],"action":"","property":"","from":"","to":"","reg":false,"x":990,"y":2780,"wires":[["8964f393.0de37"]]},{"id":"3326b0fd.88d51","type":"switch","z":"a82c65ac.c0b378","name":"","property":"statusCode","propertyType":"msg","rules":[{"t":"eq","v":"200","vt":"num"},{"t":"else"}],"checkall":"true","repair":false,"outputs":2,"x":1290,"y":2780,"wires":[["8ac3cefc.6a775"],["ae16dd49.6ab45"]]},{"id":"8ac3cefc.6a775","type":"change","z":"a82c65ac.c0b378","name":"","rules":[{"t":"set","p":"accessToken","pt":"msg","to":"payload.access_token","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":1480,"y":2780,"wires":[["ead74ea6.7a019"]]},{"id":"ead74ea6.7a019","type":"change","z":"a82c65ac.c0b378","name":"bearer","rules":[{"t":"set","p":"headers","pt":"msg","to":"{}","tot":"json"},{"t":"set","p":"headers.authorization","pt":"msg","to":"\"Bearer \" & msg.accessToken","tot":"jsonata"}],"action":"","property":"","from":"","to":"","reg":false,"x":1670,"y":2780,"wires":[["e04df300.d238e"]]},{"id":"e04df300.d238e","type":"http request","z":"a82c65ac.c0b378","name":"get flows","method":"GET","ret":"obj","paytoqs":"ignore","url":"https://localhost:1880/flows","tls":"b1a419c1.609c28","persist":false,"proxy":"","authType":"","x":1820,"y":2780,"wires":[["eb4eb4e2.2d1158"]]},{"id":"ae16dd49.6ab45","type":"http response","z":"a82c65ac.c0b378","name":"","statusCode":"","headers":{},"x":1430,"y":2820,"wires":[]},{"id":"b3d327fb.5c8a38","type":"http request","z":"a82c65ac.c0b378","name":"","method":"POST","ret":"obj","paytoqs":"ignore","url":"${CFG_ACL_ENDP}","tls":"51b09598.a1114c","persist":false,"proxy":"","authType":"","x":670,"y":2780,"wires":[["4ba684ad.7b3b1c"]]},{"id":"4ba684ad.7b3b1c","type":"switch","z":"a82c65ac.c0b378","name":"","property":"statusCode","propertyType":"msg","rules":[{"t":"eq","v":"200","vt":"num"},{"t":"else"}],"checkall":"true","repair":false,"outputs":2,"x":830,"y":2780,"wires":[["c41f9800.62bb08"],["5f3a87a4.68d9c8"]]},{"id":"c5784e7a.55a9b","type":"change","z":"a82c65ac.c0b378","name":"acl req payload","rules":[{"t":"set","p":"headers","pt":"msg","to":"{}","tot":"json"},{"t":"set","p":"payload","pt":"msg","to":"{}","tot":"json"},{"t":"set","p":"payload.url","pt":"msg","to":"req.url","tot":"msg"},{"t":"set","p":"payload.method","pt":"msg","to":"req.method","tot":"msg"},{"t":"set","p":"payload.headers","pt":"msg","to":"req.headers","tot":"msg"},{"t":"set","p":"payload.params","pt":"msg","to":"req.params","tot":"msg"},{"t":"set","p":"payload.query","pt":"msg","to":"req.query","tot":"msg"},{"t":"set","p":"payload.body","pt":"msg","to":"req.body","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":480,"y":2780,"wires":[["b3d327fb.5c8a38"]]},{"id":"5f3a87a4.68d9c8","type":"http response","z":"a82c65ac.c0b378","name":"","statusCode":"","headers":{},"x":970,"y":2820,"wires":[]},{"id":"eb4eb4e2.2d1158","type":"switch","z":"a82c65ac.c0b378","name":"","property":"statusCode","propertyType":"msg","rules":[{"t":"eq","v":"200","vt":"num"},{"t":"else"}],"checkall":"true","repair":false,"outputs":2,"x":1970,"y":2780,"wires":[["e046cbda.33eb58"],["6f0415b7.71f5cc"]]},{"id":"6f0415b7.71f5cc","type":"http response","z":"a82c65ac.c0b378","name":"","statusCode":"","headers":{},"x":2110,"y":2820,"wires":[]},{"id":"5e4df7b4.afdbb8","type":"switch","z":"a82c65ac.c0b378","name":"","property":"name","propertyType":"msg","rules":[{"t":"cont","v":" ","vt":"str"},{"t":"else"}],"checkall":"true","repair":false,"outputs":2,"x":2430,"y":2680,"wires":[["907a415.6ba0bc"],["7cac346.aed24cc"]]},{"id":"361f000f.77d67","type":"function","z":"a82c65ac.c0b378","name":"delete","func":"msg.payload = msg.payload.filter(x => x.name != msg.name && x.name != msg.name + \" broker\" && x.name != msg.name + \" tls config\" )\nmsg.payload.forEach(function(part, index, payload) {\n  if(\"wires\" in payload[index]) {\n    payload[index].wires.forEach(function(wPart,wIndex,wArray){\n       while(wArray[wIndex].indexOf(msg.oldNode.id) !== -1) {\n           wArray[wIndex].splice(wArray[wIndex].indexOf(msg.oldNode.id), 1);\n       }\n    });\n  }\n});\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":2410,"y":2780,"wires":[["5f952a70.303eb4"]]},{"id":"5f952a70.303eb4","type":"function","z":"a82c65ac.c0b378","name":"update flows","func":"const http = global.get('https');\nconst data = JSON.stringify(msg.payload);\nconst options = {\n  hostname: 'localhost',\n  port: 1880,\n  path: '/flows',\n  method: 'POST',\n  headers: {\n    'Content-Type': 'application/json',\n    'Content-Length': data.length,\n    'Authorization': 'Bearer '+msg.accessToken\n  },\n  rejectUnauthorized: false\n};\nconst req = http.request(options);\nreq.write(data);\nreq.end();\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":2590,"y":2780,"wires":[["48e3c443.8ad21c"]]},{"id":"48e3c443.8ad21c","type":"change","z":"a82c65ac.c0b378","name":"","rules":[{"t":"set","p":"payload","pt":"msg","to":"name","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":2780,"y":2780,"wires":[["93f28f09.74e28"]]},{"id":"93f28f09.74e28","type":"change","z":"a82c65ac.c0b378","name":"","rules":[{"t":"set","p":"headers","pt":"msg","to":"{\"Content-Type\":\"text/plain\"}","tot":"json"}],"action":"","property":"","from":"","to":"","reg":false,"x":2980,"y":2780,"wires":[["90cf7e98.2be16"]]},{"id":"90cf7e98.2be16","type":"http response","z":"a82c65ac.c0b378","name":"","statusCode":"","headers":{},"x":3150,"y":2780,"wires":[]},{"id":"907a415.6ba0bc","type":"change","z":"a82c65ac.c0b378","name":"","rules":[{"t":"set","p":"payload","pt":"msg","to":"Spaces not allowed","tot":"str"}],"action":"","property":"","from":"","to":"","reg":false,"x":2600,"y":2640,"wires":[["723777d8.8d8be8"]]},{"id":"723777d8.8d8be8","type":"http response","z":"a82c65ac.c0b378","name":"","statusCode":"400","headers":{},"x":2780,"y":2640,"wires":[]},{"id":"e046cbda.33eb58","type":"change","z":"a82c65ac.c0b378","name":"retrieve","rules":[{"t":"set","p":"oldNode","pt":"msg","to":"*[name=$$.name]","tot":"jsonata"}],"action":"","property":"","from":"","to":"","reg":false,"x":2120,"y":2780,"wires":[["cfa86301.71a6d"]]},{"id":"cfa86301.71a6d","type":"switch","z":"a82c65ac.c0b378","name":"","property":"oldNode","propertyType":"msg","rules":[{"t":"nempty"},{"t":"else"}],"checkall":"true","repair":false,"outputs":2,"x":2270,"y":2780,"wires":[["361f000f.77d67"],["bf8e2dda.7179"]]},{"id":"44fe2134.9ffef","type":"http response","z":"a82c65ac.c0b378","name":"","statusCode":"404","headers":{},"x":2620,"y":2820,"wires":[]},{"id":"fb306543.cef398","type":"change","z":"a82c65ac.c0b378","name":"retrieve","rules":[{"t":"set","p":"oldNode","pt":"msg","to":"*[name=$$.name]","tot":"jsonata"}],"action":"","property":"","from":"","to":"","reg":false,"x":2120,"y":2580,"wires":[["831613df.524db"]]},{"id":"831613df.524db","type":"switch","z":"a82c65ac.c0b378","name":"","property":"oldNode","propertyType":"msg","rules":[{"t":"nempty"},{"t":"else"}],"checkall":"true","repair":false,"outputs":2,"x":2270,"y":2580,"wires":[["8aa8c668.550ae8"],["658f3fbb.21304"]]},{"id":"9178f6d.c66f808","type":"http response","z":"a82c65ac.c0b378","name":"","statusCode":"404","headers":{},"x":2440,"y":2620,"wires":[]},{"id":"bf8e2dda.7179","type":"change","z":"a82c65ac.c0b378","name":"","rules":[{"t":"set","p":"payload","pt":"msg","to":"Not found","tot":"str"}],"action":"","property":"","from":"","to":"","reg":false,"x":2440,"y":2820,"wires":[["44fe2134.9ffef"]]},{"id":"658f3fbb.21304","type":"change","z":"a82c65ac.c0b378","name":"","rules":[{"t":"set","p":"payload","pt":"msg","to":"Not found","tot":"str"}],"action":"","property":"","from":"","to":"","reg":false,"x":2280,"y":2620,"wires":[["9178f6d.c66f808"]]},{"id":"5e69e42c.8f779c","type":"http in","z":"a82c65ac.c0b378","name":"POST wire","url":"/node/wire/:from/:num","method":"post","upload":false,"swaggerDoc":"","x":80,"y":2880,"wires":[["1e5ae8d7.cf0da7"]]},{"id":"1e5ae8d7.cf0da7","type":"change","z":"a82c65ac.c0b378","name":"get input params","rules":[{"t":"set","p":"from","pt":"msg","to":"req.params.from","tot":"msg"},{"t":"set","p":"num","pt":"msg","to":"$number(req.params.num)","tot":"jsonata"},{"t":"set","p":"to","pt":"msg","to":"payload","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":270,"y":2880,"wires":[["e278647c.79ff08"]]},{"id":"d7f45983.2d4178","type":"http request","z":"a82c65ac.c0b378","name":"auth","method":"POST","ret":"obj","paytoqs":"ignore","url":"https://localhost:1880/auth/token","tls":"b1a419c1.609c28","persist":false,"proxy":"","authType":"","x":1130,"y":2880,"wires":[["8ad84d37.e1acc"]]},{"id":"c69a5eb9.20df6","type":"change","z":"a82c65ac.c0b378","name":"auth payload","rules":[{"t":"set","p":"payload.client_id","pt":"msg","to":"node-red-editor","tot":"str"},{"t":"set","p":"payload.grant_type","pt":"msg","to":"password","tot":"str"},{"t":"set","p":"payload.scope","pt":"msg","to":"","tot":"str"},{"t":"set","p":"payload.username","pt":"msg","to":"NRADM_USER","tot":"env"},{"t":"set","p":"payload.password","pt":"msg","to":"NRADM_PASS","tot":"env"}],"action":"","property":"","from":"","to":"","reg":false,"x":970,"y":2880,"wires":[["d7f45983.2d4178"]]},{"id":"8ad84d37.e1acc","type":"switch","z":"a82c65ac.c0b378","name":"","property":"statusCode","propertyType":"msg","rules":[{"t":"eq","v":"200","vt":"num"},{"t":"else"}],"checkall":"true","repair":false,"outputs":2,"x":1270,"y":2880,"wires":[["1f2e91db.5acd1e"],["925ab6fb.989388"]]},{"id":"e82ca148.f4fce","type":"http request","z":"a82c65ac.c0b378","name":"","method":"POST","ret":"obj","paytoqs":"ignore","url":"${CFG_ACL_ENDP}","tls":"51b09598.a1114c","persist":false,"proxy":"","authType":"","x":650,"y":2880,"wires":[["347a90ad.e8209"]]},{"id":"347a90ad.e8209","type":"switch","z":"a82c65ac.c0b378","name":"","property":"statusCode","propertyType":"msg","rules":[{"t":"eq","v":"200","vt":"num"},{"t":"else"}],"checkall":"true","repair":false,"outputs":2,"x":810,"y":2880,"wires":[["c69a5eb9.20df6"],["611ddf6e.dd632"]]},{"id":"e278647c.79ff08","type":"change","z":"a82c65ac.c0b378","name":"acl req payload","rules":[{"t":"set","p":"headers","pt":"msg","to":"{}","tot":"json"},{"t":"set","p":"payload","pt":"msg","to":"{}","tot":"json"},{"t":"set","p":"payload.url","pt":"msg","to":"req.url","tot":"msg"},{"t":"set","p":"payload.method","pt":"msg","to":"req.method","tot":"msg"},{"t":"set","p":"payload.headers","pt":"msg","to":"req.headers","tot":"msg"},{"t":"set","p":"payload.params","pt":"msg","to":"req.params","tot":"msg"},{"t":"set","p":"payload.query","pt":"msg","to":"req.query","tot":"msg"},{"t":"set","p":"payload.body","pt":"msg","to":"req.body","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":460,"y":2880,"wires":[["e82ca148.f4fce"]]},{"id":"611ddf6e.dd632","type":"http response","z":"a82c65ac.c0b378","name":"","statusCode":"","headers":{},"x":950,"y":2920,"wires":[]},{"id":"1f2e91db.5acd1e","type":"change","z":"a82c65ac.c0b378","name":"","rules":[{"t":"set","p":"accessToken","pt":"msg","to":"payload.access_token","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":1460,"y":2880,"wires":[["a5005dcf.f38c4"]]},{"id":"a5005dcf.f38c4","type":"change","z":"a82c65ac.c0b378","name":"bearer","rules":[{"t":"set","p":"headers","pt":"msg","to":"{}","tot":"json"},{"t":"set","p":"headers.authorization","pt":"msg","to":"\"Bearer \" & msg.accessToken","tot":"jsonata"}],"action":"","property":"","from":"","to":"","reg":false,"x":1650,"y":2880,"wires":[["4acfebe2.7825a4"]]},{"id":"4acfebe2.7825a4","type":"http request","z":"a82c65ac.c0b378","name":"get flows","method":"GET","ret":"obj","paytoqs":"ignore","url":"https://localhost:1880/flows","tls":"b1a419c1.609c28","persist":false,"proxy":"","authType":"","x":1800,"y":2880,"wires":[["64917778.a3fa98"]]},{"id":"925ab6fb.989388","type":"http response","z":"a82c65ac.c0b378","name":"","statusCode":"","headers":{},"x":1410,"y":2920,"wires":[]},{"id":"64917778.a3fa98","type":"switch","z":"a82c65ac.c0b378","name":"","property":"statusCode","propertyType":"msg","rules":[{"t":"eq","v":"200","vt":"num"},{"t":"else"}],"checkall":"true","repair":false,"outputs":2,"x":1950,"y":2880,"wires":[["66895686.3dc518"],["c9a50aff.8933f8"]]},{"id":"2d9b8a44.1f47b6","type":"http response","z":"a82c65ac.c0b378","name":"","statusCode":"","headers":{},"x":2790,"y":2920,"wires":[]},{"id":"b51447b.8d9a0b8","type":"change","z":"a82c65ac.c0b378","name":"retrieve","rules":[{"t":"set","p":"fromNode","pt":"msg","to":"payload.nodes[name=$$.from]","tot":"jsonata"},{"t":"set","p":"toNode","pt":"msg","to":"payload.nodes[name=$$.to]","tot":"jsonata"},{"t":"set","p":"wiresCount","pt":"msg","to":"$count(payload.nodes[name=$$.from].wires)","tot":"jsonata"}],"action":"","property":"","from":"","to":"","reg":false,"x":2800,"y":2880,"wires":[["674c3557.cb150c"]]},{"id":"674c3557.cb150c","type":"switch","z":"a82c65ac.c0b378","name":"","property":"fromNode","propertyType":"msg","rules":[{"t":"nempty"},{"t":"else"}],"checkall":"true","repair":false,"outputs":2,"x":2950,"y":2880,"wires":[["6a3e6d69.996c94"],["2610ba32.9819b6"]]},{"id":"6a3e6d69.996c94","type":"switch","z":"a82c65ac.c0b378","name":"","property":"toNode","propertyType":"msg","rules":[{"t":"nempty"},{"t":"else"}],"checkall":"true","repair":false,"outputs":2,"x":3090,"y":2880,"wires":[["11bdd3e8.5c1a0c"],["fcd22cec.d181e"]]},{"id":"11bdd3e8.5c1a0c","type":"switch","z":"a82c65ac.c0b378","name":"","property":"wiresCount","propertyType":"msg","rules":[{"t":"gt","v":"num","vt":"msg"},{"t":"else"}],"checkall":"true","repair":false,"outputs":2,"x":3230,"y":2880,"wires":[["8288c30.16e384"],["2203afef.a48d"]]},{"id":"8288c30.16e384","type":"function","z":"a82c65ac.c0b378","name":"add","func":"msg.payload.nodes.forEach(function(part, index, nodes) {\n    if(nodes[index].id == msg.fromNode.id) {\n        nodes[index].wires[msg.num].push(msg.toNode.id);\n    }\n});\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":3370,"y":2880,"wires":[["e00c3242.9929c"]]},{"id":"2610ba32.9819b6","type":"change","z":"a82c65ac.c0b378","name":"","rules":[{"t":"set","p":"payload","pt":"msg","to":"\"Node \" & from & \" not found\"","tot":"jsonata"}],"action":"","property":"","from":"","to":"","reg":false,"x":2980,"y":2920,"wires":[["a48cd6b7.65e208"]]},{"id":"fcd22cec.d181e","type":"change","z":"a82c65ac.c0b378","name":"","rules":[{"t":"set","p":"payload","pt":"msg","to":"\"Node \" & to & \" not found\"","tot":"jsonata"}],"action":"","property":"","from":"","to":"","reg":false,"x":3180,"y":2920,"wires":[["a48cd6b7.65e208"]]},{"id":"2203afef.a48d","type":"change","z":"a82c65ac.c0b378","name":"","rules":[{"t":"set","p":"payload","pt":"msg","to":"\"Output \" & num & \" not found on node \" & from","tot":"jsonata"}],"action":"","property":"","from":"","to":"","reg":false,"x":3380,"y":2920,"wires":[["a48cd6b7.65e208"]]},{"id":"a48cd6b7.65e208","type":"http response","z":"a82c65ac.c0b378","name":"","statusCode":"404","headers":{},"x":3560,"y":2920,"wires":[]},{"id":"c6f03c2c.8bd64","type":"http request","z":"a82c65ac.c0b378","name":"get single flow","method":"GET","ret":"obj","paytoqs":"ignore","url":"https://localhost:1880/flow/{{flowId}}","tls":"b1a419c1.609c28","persist":false,"proxy":"","authType":"","x":2480,"y":2880,"wires":[["765b3073.ee91"]]},{"id":"66895686.3dc518","type":"change","z":"a82c65ac.c0b378","name":"get flowId by name","rules":[{"t":"set","p":"flowId","pt":"msg","to":"*[type = 'tab' and label ='Business Logic'].id","tot":"jsonata"}],"action":"","property":"","from":"","to":"","reg":false,"x":2130,"y":2880,"wires":[["29603713.08baf8"]]},{"id":"29603713.08baf8","type":"change","z":"a82c65ac.c0b378","name":"bearer","rules":[{"t":"set","p":"headers","pt":"msg","to":"{}","tot":"json"},{"t":"set","p":"headers.authorization","pt":"msg","to":"\"Bearer \" & msg.accessToken","tot":"jsonata"}],"action":"","property":"","from":"","to":"","reg":false,"x":2310,"y":2880,"wires":[["c6f03c2c.8bd64"]]},{"id":"765b3073.ee91","type":"switch","z":"a82c65ac.c0b378","name":"","property":"statusCode","propertyType":"msg","rules":[{"t":"eq","v":"200","vt":"num"},{"t":"else"}],"checkall":"true","repair":false,"outputs":2,"x":2650,"y":2880,"wires":[["b51447b.8d9a0b8"],["2d9b8a44.1f47b6"]]},{"id":"c9a50aff.8933f8","type":"http response","z":"a82c65ac.c0b378","name":"","statusCode":"","headers":{},"x":2090,"y":2920,"wires":[]},{"id":"575677aa.8f91e8","type":"http response","z":"a82c65ac.c0b378","name":"","statusCode":"","headers":{},"x":4370,"y":2880,"wires":[]},{"id":"65c5d324.d7997c","type":"change","z":"a82c65ac.c0b378","name":"","rules":[{"t":"set","p":"headers","pt":"msg","to":"{\"Content-Type\":\"text/plain\"}","tot":"json"}],"action":"","property":"","from":"","to":"","reg":false,"x":4200,"y":2880,"wires":[["575677aa.8f91e8"]]},{"id":"8d2cab7f.f10098","type":"change","z":"a82c65ac.c0b378","name":"","rules":[{"t":"set","p":"payload","pt":"msg","to":"to","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":4000,"y":2880,"wires":[["65c5d324.d7997c"]]},{"id":"4c1c634a.9ec21c","type":"http request","z":"a82c65ac.c0b378","name":"update flow","method":"PUT","ret":"obj","paytoqs":"ignore","url":"https://localhost:1880/flow/{{payload.id}}","tls":"b1a419c1.609c28","persist":false,"proxy":"","authType":"","x":3670,"y":2880,"wires":[["bafc7a2e.1dfda8"]]},{"id":"e00c3242.9929c","type":"change","z":"a82c65ac.c0b378","name":"bearer","rules":[{"t":"set","p":"headers","pt":"msg","to":"{}","tot":"json"},{"t":"set","p":"headers.authorization","pt":"msg","to":"\"Bearer \" & msg.accessToken","tot":"jsonata"}],"action":"","property":"","from":"","to":"","reg":false,"x":3510,"y":2880,"wires":[["4c1c634a.9ec21c"]]},{"id":"bafc7a2e.1dfda8","type":"switch","z":"a82c65ac.c0b378","name":"","property":"statusCode","propertyType":"msg","rules":[{"t":"eq","v":"200","vt":"num"},{"t":"else"}],"checkall":"true","repair":false,"outputs":2,"x":3830,"y":2880,"wires":[["8d2cab7f.f10098"],["b5c8c3de.bb85"]]},{"id":"b5c8c3de.bb85","type":"http response","z":"a82c65ac.c0b378","name":"","statusCode":"","headers":{},"x":3970,"y":2920,"wires":[]},{"id":"eead0d38.71e2d","type":"switch","z":"a82c65ac.c0b378","name":"","property":"payload","propertyType":"msg","rules":[{"t":"cont","v":" ","vt":"str"},{"t":"eq","v":"node","vt":"str"},{"t":"else"}],"checkall":"true","repair":false,"outputs":3,"x":190,"y":2240,"wires":[["f258312.c70bad"],["852f38aa.d018c8"],["85127255.c4944"]]},{"id":"f258312.c70bad","type":"change","z":"a82c65ac.c0b378","name":"","rules":[{"t":"set","p":"payload","pt":"msg","to":"Spaces not allowed","tot":"str"}],"action":"","property":"","from":"","to":"","reg":false,"x":360,"y":2200,"wires":[["49d32a36.71ce74"]]},{"id":"49d32a36.71ce74","type":"http response","z":"a82c65ac.c0b378","name":"","statusCode":"400","headers":{},"x":540,"y":2200,"wires":[]},{"id":"a38d572.c0c1ba8","type":"http in","z":"a82c65ac.c0b378","name":"DELETE wire","url":"/node/wire/:from/:num","method":"delete","upload":false,"swaggerDoc":"","x":90,"y":2980,"wires":[["7ea774f.574ec8c"]]},{"id":"7ea774f.574ec8c","type":"change","z":"a82c65ac.c0b378","name":"get input params","rules":[{"t":"set","p":"from","pt":"msg","to":"req.params.from","tot":"msg"},{"t":"set","p":"num","pt":"msg","to":"$number(req.params.num)","tot":"jsonata"},{"t":"set","p":"to","pt":"msg","to":"payload","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":270,"y":2980,"wires":[["a9331329.77092"]]},{"id":"25e7e20.175711e","type":"http request","z":"a82c65ac.c0b378","name":"auth","method":"POST","ret":"obj","paytoqs":"ignore","url":"https://localhost:1880/auth/token","tls":"b1a419c1.609c28","persist":false,"proxy":"","authType":"","x":1130,"y":2980,"wires":[["87c553d3.a5af"]]},{"id":"6c0da0d4.07491","type":"change","z":"a82c65ac.c0b378","name":"auth payload","rules":[{"t":"set","p":"payload.client_id","pt":"msg","to":"node-red-editor","tot":"str"},{"t":"set","p":"payload.grant_type","pt":"msg","to":"password","tot":"str"},{"t":"set","p":"payload.scope","pt":"msg","to":"","tot":"str"},{"t":"set","p":"payload.username","pt":"msg","to":"NRADM_USER","tot":"env"},{"t":"set","p":"payload.password","pt":"msg","to":"NRADM_PASS","tot":"env"}],"action":"","property":"","from":"","to":"","reg":false,"x":970,"y":2980,"wires":[["25e7e20.175711e"]]},{"id":"87c553d3.a5af","type":"switch","z":"a82c65ac.c0b378","name":"","property":"statusCode","propertyType":"msg","rules":[{"t":"eq","v":"200","vt":"num"},{"t":"else"}],"checkall":"true","repair":false,"outputs":2,"x":1270,"y":2980,"wires":[["3a15f7bf.0f6b98"],["3165c57.123253a"]]},{"id":"b3050cb1.e80fd","type":"http request","z":"a82c65ac.c0b378","name":"","method":"POST","ret":"obj","paytoqs":"ignore","url":"${CFG_ACL_ENDP}","tls":"51b09598.a1114c","persist":false,"proxy":"","authType":"","x":650,"y":2980,"wires":[["8ea61f75.3e0e9"]]},{"id":"8ea61f75.3e0e9","type":"switch","z":"a82c65ac.c0b378","name":"","property":"statusCode","propertyType":"msg","rules":[{"t":"eq","v":"200","vt":"num"},{"t":"else"}],"checkall":"true","repair":false,"outputs":2,"x":810,"y":2980,"wires":[["6c0da0d4.07491"],["4c0256d7.e29078"]]},{"id":"a9331329.77092","type":"change","z":"a82c65ac.c0b378","name":"acl req payload","rules":[{"t":"set","p":"headers","pt":"msg","to":"{}","tot":"json"},{"t":"set","p":"payload","pt":"msg","to":"{}","tot":"json"},{"t":"set","p":"payload.url","pt":"msg","to":"req.url","tot":"msg"},{"t":"set","p":"payload.method","pt":"msg","to":"req.method","tot":"msg"},{"t":"set","p":"payload.headers","pt":"msg","to":"req.headers","tot":"msg"},{"t":"set","p":"payload.params","pt":"msg","to":"req.params","tot":"msg"},{"t":"set","p":"payload.query","pt":"msg","to":"req.query","tot":"msg"},{"t":"set","p":"payload.body","pt":"msg","to":"req.body","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":460,"y":2980,"wires":[["b3050cb1.e80fd"]]},{"id":"4c0256d7.e29078","type":"http response","z":"a82c65ac.c0b378","name":"","statusCode":"","headers":{},"x":950,"y":3020,"wires":[]},{"id":"3a15f7bf.0f6b98","type":"change","z":"a82c65ac.c0b378","name":"","rules":[{"t":"set","p":"accessToken","pt":"msg","to":"payload.access_token","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":1460,"y":2980,"wires":[["6ee13632.7e7778"]]},{"id":"6ee13632.7e7778","type":"change","z":"a82c65ac.c0b378","name":"bearer","rules":[{"t":"set","p":"headers","pt":"msg","to":"{}","tot":"json"},{"t":"set","p":"headers.authorization","pt":"msg","to":"\"Bearer \" & msg.accessToken","tot":"jsonata"}],"action":"","property":"","from":"","to":"","reg":false,"x":1650,"y":2980,"wires":[["46fdda24.cb65b4"]]},{"id":"46fdda24.cb65b4","type":"http request","z":"a82c65ac.c0b378","name":"get flows","method":"GET","ret":"obj","paytoqs":"ignore","url":"https://localhost:1880/flows","tls":"b1a419c1.609c28","persist":false,"proxy":"","authType":"","x":1800,"y":2980,"wires":[["ea345b5f.d5cb58"]]},{"id":"3165c57.123253a","type":"http response","z":"a82c65ac.c0b378","name":"","statusCode":"","headers":{},"x":1410,"y":3020,"wires":[]},{"id":"ea345b5f.d5cb58","type":"switch","z":"a82c65ac.c0b378","name":"","property":"statusCode","propertyType":"msg","rules":[{"t":"eq","v":"200","vt":"num"},{"t":"else"}],"checkall":"true","repair":false,"outputs":2,"x":1950,"y":2980,"wires":[["6bad8df7.b87724"],["41a9d764.2358a8"]]},{"id":"c5b8bcb.e79544","type":"http response","z":"a82c65ac.c0b378","name":"","statusCode":"","headers":{},"x":2790,"y":3020,"wires":[]},{"id":"6343fd0a.f57954","type":"change","z":"a82c65ac.c0b378","name":"retrieve","rules":[{"t":"set","p":"fromNode","pt":"msg","to":"payload.nodes[name=$$.from]","tot":"jsonata"},{"t":"set","p":"toNode","pt":"msg","to":"payload.nodes[name=$$.to]","tot":"jsonata"},{"t":"set","p":"wires","pt":"msg","to":"payload.nodes[name=$$.from].wires[$$.num]","tot":"jsonata"}],"action":"","property":"","from":"","to":"","reg":false,"x":2800,"y":2980,"wires":[["ff6c4d20.e8ac9"]]},{"id":"ff6c4d20.e8ac9","type":"switch","z":"a82c65ac.c0b378","name":"","property":"fromNode","propertyType":"msg","rules":[{"t":"nempty"},{"t":"else"}],"checkall":"true","repair":false,"outputs":2,"x":2950,"y":2980,"wires":[["724da5dd.526a0c"],["3dc31e09.189702"]]},{"id":"724da5dd.526a0c","type":"switch","z":"a82c65ac.c0b378","name":"","property":"toNode","propertyType":"msg","rules":[{"t":"nempty"},{"t":"else"}],"checkall":"true","repair":false,"outputs":2,"x":3090,"y":2980,"wires":[["30b7d17b.fc463e"],["50e8a8c9.97bb78"]]},{"id":"30b7d17b.fc463e","type":"switch","z":"a82c65ac.c0b378","name":"","property":"wires","propertyType":"msg","rules":[{"t":"cont","v":"toNode.id","vt":"msg"},{"t":"else"}],"checkall":"true","repair":false,"outputs":2,"x":3230,"y":2980,"wires":[["95ffe98.41f6818"],["6bda3a0e.779a54"]]},{"id":"95ffe98.41f6818","type":"function","z":"a82c65ac.c0b378","name":"delete","func":"msg.payload.nodes.forEach(function(part, index, nodes) {\n    if(nodes[index].id == msg.fromNode.id) {\n        nodes[index].wires[msg.num].splice(nodes[index].wires[msg.num].indexOf(msg.toNode.id),1);\n    }\n});\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":3370,"y":2980,"wires":[["bbf4a156.cb52"]]},{"id":"3dc31e09.189702","type":"change","z":"a82c65ac.c0b378","name":"","rules":[{"t":"set","p":"payload","pt":"msg","to":"\"Node \" & from & \" not found\"","tot":"jsonata"}],"action":"","property":"","from":"","to":"","reg":false,"x":2980,"y":3020,"wires":[["17884f9a.0406e"]]},{"id":"50e8a8c9.97bb78","type":"change","z":"a82c65ac.c0b378","name":"","rules":[{"t":"set","p":"payload","pt":"msg","to":"\"Node \" & to & \" not found\"","tot":"jsonata"}],"action":"","property":"","from":"","to":"","reg":false,"x":3180,"y":3020,"wires":[["17884f9a.0406e"]]},{"id":"6bda3a0e.779a54","type":"change","z":"a82c65ac.c0b378","name":"","rules":[{"t":"set","p":"payload","pt":"msg","to":"\"Wire not found from output \" & num & \" of \" & from & \" to \" & to","tot":"jsonata"}],"action":"","property":"","from":"","to":"","reg":false,"x":3380,"y":3020,"wires":[["17884f9a.0406e"]]},{"id":"17884f9a.0406e","type":"http response","z":"a82c65ac.c0b378","name":"","statusCode":"404","headers":{},"x":3560,"y":3020,"wires":[]},{"id":"87b79808.d9e288","type":"http request","z":"a82c65ac.c0b378","name":"get single flow","method":"GET","ret":"obj","paytoqs":"ignore","url":"https://localhost:1880/flow/{{flowId}}","tls":"b1a419c1.609c28","persist":false,"proxy":"","authType":"","x":2480,"y":2980,"wires":[["83e39937.e97bf8"]]},{"id":"6bad8df7.b87724","type":"change","z":"a82c65ac.c0b378","name":"get flowId by name","rules":[{"t":"set","p":"flowId","pt":"msg","to":"*[type = 'tab' and label ='Business Logic'].id","tot":"jsonata"}],"action":"","property":"","from":"","to":"","reg":false,"x":2130,"y":2980,"wires":[["73f8b740.51b0e8"]]},{"id":"73f8b740.51b0e8","type":"change","z":"a82c65ac.c0b378","name":"bearer","rules":[{"t":"set","p":"headers","pt":"msg","to":"{}","tot":"json"},{"t":"set","p":"headers.authorization","pt":"msg","to":"\"Bearer \" & msg.accessToken","tot":"jsonata"}],"action":"","property":"","from":"","to":"","reg":false,"x":2310,"y":2980,"wires":[["87b79808.d9e288"]]},{"id":"83e39937.e97bf8","type":"switch","z":"a82c65ac.c0b378","name":"","property":"statusCode","propertyType":"msg","rules":[{"t":"eq","v":"200","vt":"num"},{"t":"else"}],"checkall":"true","repair":false,"outputs":2,"x":2650,"y":2980,"wires":[["6343fd0a.f57954"],["c5b8bcb.e79544"]]},{"id":"41a9d764.2358a8","type":"http response","z":"a82c65ac.c0b378","name":"","statusCode":"","headers":{},"x":2090,"y":3020,"wires":[]},{"id":"6dce635f.9aca0c","type":"http response","z":"a82c65ac.c0b378","name":"","statusCode":"","headers":{},"x":4370,"y":2980,"wires":[]},{"id":"36602634.d8a81a","type":"change","z":"a82c65ac.c0b378","name":"","rules":[{"t":"set","p":"headers","pt":"msg","to":"{\"Content-Type\":\"text/plain\"}","tot":"json"}],"action":"","property":"","from":"","to":"","reg":false,"x":4200,"y":2980,"wires":[["6dce635f.9aca0c"]]},{"id":"5a1dc804.0d2398","type":"change","z":"a82c65ac.c0b378","name":"","rules":[{"t":"set","p":"payload","pt":"msg","to":"to","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":4000,"y":2980,"wires":[["36602634.d8a81a"]]},{"id":"4aaac24e.6389dc","type":"http request","z":"a82c65ac.c0b378","name":"update flow","method":"PUT","ret":"obj","paytoqs":"ignore","url":"https://localhost:1880/flow/{{payload.id}}","tls":"b1a419c1.609c28","persist":false,"proxy":"","authType":"","x":3670,"y":2980,"wires":[["f38c1005.b08b2"]]},{"id":"bbf4a156.cb52","type":"change","z":"a82c65ac.c0b378","name":"bearer","rules":[{"t":"set","p":"headers","pt":"msg","to":"{}","tot":"json"},{"t":"set","p":"headers.authorization","pt":"msg","to":"\"Bearer \" & msg.accessToken","tot":"jsonata"}],"action":"","property":"","from":"","to":"","reg":false,"x":3510,"y":2980,"wires":[["4aaac24e.6389dc"]]},{"id":"f38c1005.b08b2","type":"switch","z":"a82c65ac.c0b378","name":"","property":"statusCode","propertyType":"msg","rules":[{"t":"eq","v":"200","vt":"num"},{"t":"else"}],"checkall":"true","repair":false,"outputs":2,"x":3830,"y":2980,"wires":[["5a1dc804.0d2398"],["f7b42b7f.a1c828"]]},{"id":"f7b42b7f.a1c828","type":"http response","z":"a82c65ac.c0b378","name":"","statusCode":"","headers":{},"x":3970,"y":3020,"wires":[]},{"id":"9d358b52.2b27f8","type":"change","z":"a82c65ac.c0b378","name":"get inputs","rules":[{"t":"set","p":"nodeName","pt":"msg","to":"req.params.nodeName","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":260,"y":140,"wires":[["32ed2d2d.cb4cb2"]]},{"id":"9a11955b.4b1608","type":"change","z":"a82c65ac.c0b378","name":"get inputs","rules":[{"t":"set","p":"nodeName","pt":"msg","to":"req.params.nodeName","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":240,"y":340,"wires":[["eb371ab5.b615c8"]]},{"id":"9b76f2fd.89e82","type":"change","z":"a82c65ac.c0b378","name":"edit","rules":[{"t":"set","p":"old","pt":"msg","to":"payload.nodes[name=$$.nodeName]","tot":"jsonata"},{"t":"set","p":"new","pt":"msg","to":"old","tot":"msg"},{"t":"set","p":"new.qos","pt":"msg","to":"qos","tot":"msg"},{"t":"set","p":"payload.nodes","pt":"msg","to":"$eval($replace($string(payload.nodes),$string(old),$string(new)))","tot":"jsonata"}],"action":"","property":"","from":"","to":"","reg":false,"x":2890,"y":640,"wires":[["eca6f0b7.67cef"]]},{"id":"276b5da0.267532","type":"change","z":"a82c65ac.c0b378","name":"get inputs","rules":[{"t":"set","p":"nodeName","pt":"msg","to":"req.params.nodeName","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":240,"y":740,"wires":[["3b2353b4.315acc"]]},{"id":"c7678f30.eb322","type":"change","z":"a82c65ac.c0b378","name":"get inputs","rules":[{"t":"set","p":"nodeName","pt":"msg","to":"req.params.nodeName","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":240,"y":940,"wires":[["49df5ab3.ba8cb4"]]},{"id":"478b3ed8.b2e6a","type":"change","z":"a82c65ac.c0b378","name":"get inputs","rules":[{"t":"set","p":"nodeName","pt":"msg","to":"req.params.nodeName","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":240,"y":1140,"wires":[["f7d31ce7.a6108"]]},{"id":"6eab6908.96c7b8","type":"change","z":"a82c65ac.c0b378","name":"get inputs","rules":[{"t":"set","p":"nodeName","pt":"msg","to":"req.params.nodeName","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":240,"y":1340,"wires":[["9851d82e.b7bc98"]]},{"id":"17f8210b.00867f","type":"change","z":"a82c65ac.c0b378","name":"get inputs","rules":[{"t":"set","p":"nodeName","pt":"msg","to":"req.params.nodeName","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":220,"y":1540,"wires":[["ee6b20ef.83cc"]]},{"id":"28bbe97b.c87426","type":"change","z":"a82c65ac.c0b378","name":"","rules":[{"t":"set","p":"nodeName","pt":"msg","to":"req.params.nodeName","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":330,"y":1740,"wires":[["c670e075.52a3"]]},{"id":"cf92bf92.4da51","type":"http response","z":"a82c65ac.c0b378","name":"","statusCode":"400","headers":{},"x":2520,"y":1680,"wires":[]},{"id":"6db88de2.7a2044","type":"change","z":"a82c65ac.c0b378","name":"","rules":[{"t":"set","p":"payload","pt":"msg","to":"verifyservercert","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":2320,"y":1680,"wires":[["cf92bf92.4da51"]]},{"id":"bc793275.7e0be","type":"change","z":"a82c65ac.c0b378","name":"get inputs","rules":[{"t":"set","p":"nodeName","pt":"msg","to":"req.params.nodeName","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":280,"y":1940,"wires":[["a78cb82b.3e1218"]]},{"id":"31d54f44.310e9","type":"change","z":"a82c65ac.c0b378","name":"get inputs","rules":[{"t":"set","p":"nodeName","pt":"msg","to":"req.params.nodeName","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":240,"y":2140,"wires":[["e1970bac.ad5878"]]},{"id":"1bd93703.711859","type":"http in","z":"a82c65ac.c0b378","name":"PUT credentials","url":"/node/:nodeName/credentials","method":"put","upload":false,"swaggerDoc":"","x":100,"y":3080,"wires":[["6eed3671.48a018"]]},{"id":"6eed3671.48a018","type":"change","z":"a82c65ac.c0b378","name":"get inputs","rules":[{"t":"set","p":"user","pt":"msg","to":"payload.user","tot":"msg"},{"t":"set","p":"password","pt":"msg","to":"payload.password","tot":"msg"},{"t":"set","p":"nodeName","pt":"msg","to":"req.params.nodeName","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":280,"y":3080,"wires":[["31f458c4.889008"]]},{"id":"67d78391.157e7c","type":"http request","z":"a82c65ac.c0b378","name":"get flows","method":"GET","ret":"obj","paytoqs":"ignore","url":"https://localhost:1880/flows","tls":"b1a419c1.609c28","persist":false,"proxy":"","authType":"","x":1800,"y":3080,"wires":[["b7fa81cc.d0634"]]},{"id":"daf2f5a7.b59688","type":"function","z":"a82c65ac.c0b378","name":"update flows","func":"const http = global.get('https');\nconst data = JSON.stringify(msg.payload);\nconst options = {\n  hostname: 'localhost',\n  port: 1880,\n  path: '/flows',\n  method: 'POST',\n  headers: {\n    'Content-Type': 'application/json',\n    'Content-Length': data.length,\n    'Authorization': 'Bearer '+msg.accessToken\n  },\n  rejectUnauthorized: false\n};\nconst req = http.request(options);\nreq.write(data);\nreq.end();\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":2250,"y":3080,"wires":[["34f77d14.6fb382"]]},{"id":"34f77d14.6fb382","type":"change","z":"a82c65ac.c0b378","name":"set payload","rules":[{"t":"set","p":"payload","pt":"msg","to":"{}","tot":"json"},{"t":"set","p":"payload.user","pt":"msg","to":"user","tot":"msg"},{"t":"set","p":"payload.password","pt":"msg","to":"password","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":2430,"y":3080,"wires":[["3dcbefa8.5e544"]]},{"id":"3dcbefa8.5e544","type":"change","z":"a82c65ac.c0b378","name":"","rules":[{"t":"set","p":"headers","pt":"msg","to":"{\"Content-Type\":\"application/json\"}","tot":"json"}],"action":"","property":"","from":"","to":"","reg":false,"x":2620,"y":3080,"wires":[["8fec670e.11f5e8"]]},{"id":"8fec670e.11f5e8","type":"http response","z":"a82c65ac.c0b378","name":"","statusCode":"","headers":{},"x":2790,"y":3080,"wires":[]},{"id":"49aacff4.c55e3","type":"http request","z":"a82c65ac.c0b378","name":"auth","method":"POST","ret":"obj","paytoqs":"ignore","url":"https://localhost:1880/auth/token","tls":"b1a419c1.609c28","persist":false,"proxy":"","authType":"","x":1130,"y":3080,"wires":[["6b3d62f5.37c57c"]]},{"id":"94a3bb7e.3dafc8","type":"change","z":"a82c65ac.c0b378","name":"auth payload","rules":[{"t":"set","p":"payload","pt":"msg","to":"{}","tot":"json"},{"t":"set","p":"payload.client_id","pt":"msg","to":"node-red-editor","tot":"str"},{"t":"set","p":"payload.grant_type","pt":"msg","to":"password","tot":"str"},{"t":"set","p":"payload.scope","pt":"msg","to":"","tot":"str"},{"t":"set","p":"payload.username","pt":"msg","to":"NRADM_USER","tot":"env"},{"t":"set","p":"payload.password","pt":"msg","to":"NRADM_PASS","tot":"env"}],"action":"","property":"","from":"","to":"","reg":false,"x":970,"y":3080,"wires":[["49aacff4.c55e3"]]},{"id":"d1c0ca19.c1df98","type":"change","z":"a82c65ac.c0b378","name":"","rules":[{"t":"set","p":"accessToken","pt":"msg","to":"payload.access_token","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":1460,"y":3080,"wires":[["dcfbcb33.5435d8"]]},{"id":"dcfbcb33.5435d8","type":"change","z":"a82c65ac.c0b378","name":"bearer","rules":[{"t":"set","p":"headers","pt":"msg","to":"{}","tot":"json"},{"t":"set","p":"headers.authorization","pt":"msg","to":"\"Bearer \" & msg.accessToken","tot":"jsonata"}],"action":"","property":"","from":"","to":"","reg":false,"x":1650,"y":3080,"wires":[["67d78391.157e7c"]]},{"id":"36d0b5af.87b4ba","type":"http request","z":"a82c65ac.c0b378","name":"","method":"POST","ret":"obj","paytoqs":"ignore","url":"${CFG_ACL_ENDP}","tls":"51b09598.a1114c","persist":false,"proxy":"","authType":"","x":650,"y":3080,"wires":[["66f98756.d7a088"]]},{"id":"66f98756.d7a088","type":"switch","z":"a82c65ac.c0b378","name":"","property":"statusCode","propertyType":"msg","rules":[{"t":"eq","v":"200","vt":"num"},{"t":"else"}],"checkall":"true","repair":false,"outputs":2,"x":810,"y":3080,"wires":[["94a3bb7e.3dafc8"],["ab74b7f9.471308"]]},{"id":"31f458c4.889008","type":"change","z":"a82c65ac.c0b378","name":"acl req payload","rules":[{"t":"set","p":"headers","pt":"msg","to":"{}","tot":"json"},{"t":"set","p":"payload","pt":"msg","to":"{}","tot":"json"},{"t":"set","p":"payload.url","pt":"msg","to":"req.url","tot":"msg"},{"t":"set","p":"payload.method","pt":"msg","to":"req.method","tot":"msg"},{"t":"set","p":"payload.headers","pt":"msg","to":"req.headers","tot":"msg"},{"t":"set","p":"payload.params","pt":"msg","to":"req.params","tot":"msg"},{"t":"set","p":"payload.query","pt":"msg","to":"req.query","tot":"msg"},{"t":"set","p":"payload.body","pt":"msg","to":"req.body","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":460,"y":3080,"wires":[["36d0b5af.87b4ba"]]},{"id":"ab74b7f9.471308","type":"http response","z":"a82c65ac.c0b378","name":"","statusCode":"","headers":{},"x":950,"y":3120,"wires":[]},{"id":"d6b740c3.2fe67","type":"change","z":"a82c65ac.c0b378","name":"edit","rules":[{"t":"set","p":"old","pt":"msg","to":"*[name = $$.nodeName & \" broker\"]","tot":"jsonata"},{"t":"set","p":"new","pt":"msg","to":"old","tot":"msg"},{"t":"set","p":"new.credentials","pt":"msg","to":"{}","tot":"json"},{"t":"set","p":"new.credentials.user","pt":"msg","to":"user","tot":"msg"},{"t":"set","p":"new.credentials.password","pt":"msg","to":"password","tot":"msg"},{"t":"set","p":"payload","pt":"msg","to":"$eval($replace($string(payload),$string(old),$string(new)))","tot":"jsonata"}],"action":"","property":"","from":"","to":"","reg":false,"x":2090,"y":3080,"wires":[["daf2f5a7.b59688"]]},{"id":"6b3d62f5.37c57c","type":"switch","z":"a82c65ac.c0b378","name":"","property":"statusCode","propertyType":"msg","rules":[{"t":"eq","v":"200","vt":"num"},{"t":"else"}],"checkall":"true","repair":false,"outputs":2,"x":1270,"y":3080,"wires":[["d1c0ca19.c1df98"],["3a83e50e.d8afda"]]},{"id":"3a83e50e.d8afda","type":"http response","z":"a82c65ac.c0b378","name":"","statusCode":"","headers":{},"x":1410,"y":3120,"wires":[]},{"id":"b7fa81cc.d0634","type":"switch","z":"a82c65ac.c0b378","name":"","property":"statusCode","propertyType":"msg","rules":[{"t":"eq","v":"200","vt":"num"},{"t":"else"}],"checkall":"true","repair":false,"outputs":2,"x":1950,"y":3080,"wires":[["d6b740c3.2fe67"],["46135197.8ed43"]]},{"id":"46135197.8ed43","type":"http response","z":"a82c65ac.c0b378","name":"","statusCode":"","headers":{},"x":2090,"y":3120,"wires":[]},{"id":"4d6c0abd.6352b4","type":"catch","z":"d4b094b8.7dbbe8","name":"","scope":null,"uncaught":false,"x":100,"y":120,"wires":[["b05cf6b0.488598"]]},{"id":"70ca2228.7454fc","type":"status","z":"d4b094b8.7dbbe8","name":"","scope":null,"x":100,"y":200,"wires":[["b05cf6b0.488598"]]},{"id":"af705ae7.3435b8","type":"mqtt out","z":"d4b094b8.7dbbe8","name":"status","topic":"status","qos":"2","retain":"","respTopic":"","contentType":"","userProps":"","correl":"","expiry":"","broker":"2146b471.31764c","x":550,"y":160,"wires":[]},{"id":"b05cf6b0.488598","type":"switch","z":"d4b094b8.7dbbe8","name":"","property":"error","propertyType":"msg","rules":[{"t":"nnull"},{"t":"else"}],"checkall":"true","repair":false,"outputs":2,"x":250,"y":160,"wires":[["2ce36a6d.e98886"],["56257c7.ed7e684"]]},{"id":"2ce36a6d.e98886","type":"change","z":"d4b094b8.7dbbe8","name":"set error","rules":[{"t":"set","p":"payload","pt":"msg","to":"{}","tot":"json"},{"t":"set","p":"payload.error","pt":"msg","to":"error","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":400,"y":120,"wires":[["af705ae7.3435b8"]]},{"id":"56257c7.ed7e684","type":"change","z":"d4b094b8.7dbbe8","name":"set status","rules":[{"t":"set","p":"payload","pt":"msg","to":"{}","tot":"json"},{"t":"set","p":"payload.status","pt":"msg","to":"status","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":400,"y":200,"wires":[["af705ae7.3435b8"]]},{"id":"cd3879d8.9a86f8","type":"function","z":"a82c65ac.c0b378","name":"linked nodes","func":"for(var s = 0; s < 10; s++ ) {\n    var linked = [];\n    msg.newNodes.forEach(function(newNode,index){\n        for(var newNodeProp in newNode) {\n            linked.push(...msg.payload.filter(x => x.id == newNode[newNodeProp] && x.type != \"subflow\" && linked.filter(l => l.id == x.id).length == 0 && msg.newNodes.filter(y => y.id == x.id).length == 0 ));\n        }\n    });\n    msg.newNodes.push(...linked);\n    if(linked.length == 0) break;\n}\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":2770,"y":2280,"wires":[["eaedd316.e75e5"]]},{"id":"3ee5b1f8.31f2de","type":"change","z":"a82c65ac.c0b378","name":"bearer","rules":[{"t":"set","p":"payload","pt":"msg","to":"{}","tot":"json"},{"t":"set","p":"headers","pt":"msg","to":"{}","tot":"json"},{"t":"set","p":"headers.authorization","pt":"msg","to":"\"Bearer \" & msg.accessToken","tot":"jsonata"}],"action":"","property":"","from":"","to":"","reg":false,"x":4250,"y":2180,"wires":[["93ad00e.3e7b6"]]},{"id":"93ad00e.3e7b6","type":"http request","z":"a82c65ac.c0b378","name":"get nodes","method":"GET","ret":"txt","paytoqs":"ignore","url":"https://localhost:1880/nodes","tls":"b1a419c1.609c28","persist":false,"proxy":"","authType":"","x":4380,"y":2180,"wires":[["6c7e52b7.d5d2ec"]]},{"id":"6c7e52b7.d5d2ec","type":"switch","z":"a82c65ac.c0b378","name":"","property":"statusCode","propertyType":"msg","rules":[{"t":"eq","v":"200","vt":"num"},{"t":"else"}],"checkall":"true","repair":false,"outputs":2,"x":4530,"y":2180,"wires":[["6758fdbe.346bd4"],["fbb6093d.e9bc68"]]},{"id":"fbb6093d.e9bc68","type":"http response","z":"a82c65ac.c0b378","name":"","statusCode":"","headers":{},"x":4710,"y":2240,"wires":[]},{"id":"6758fdbe.346bd4","type":"function","z":"a82c65ac.c0b378","name":"missing modules","func":"msg.missing = [];\nmsg.flowsAtNow.forEach(function(node,index){\n    if( (!msg.payload.includes(\"RED.nodes.registerType('\"+node.type+\"'\")) && (!msg.missing.includes(node.type)) && node.type != \"tab\" && node.type != \"subflow\" && !node.type.startsWith(\"subflow:\")) {\n        msg.missing.push(node.type);   \n    }\n});\nmsg.missing = msg.missing.join(\", \");\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":4710,"y":2180,"wires":[["bdb90e6c.a2c26"]]},{"id":"bdb90e6c.a2c26","type":"switch","z":"a82c65ac.c0b378","name":"","property":"missing","propertyType":"msg","rules":[{"t":"empty"},{"t":"else"}],"checkall":"true","repair":false,"outputs":2,"x":4380,"y":1980,"wires":[["4feefad.2bce404"],["ef44345c.5cceb8"]]},{"id":"d0b644d9.2b73a8","type":"http response","z":"a82c65ac.c0b378","name":"","statusCode":"400","headers":{},"x":4760,"y":2020,"wires":[]},{"id":"ef44345c.5cceb8","type":"change","z":"a82c65ac.c0b378","name":"","rules":[{"t":"set","p":"payload","pt":"msg","to":"\"The following nodes are used in the \" & transformation & \" transformation but they are not currently available in this Service Node: \" & missing & \". Please install their respective modules through POST requests to /module/modulename before calling the PUT transformation API.\"","tot":"jsonata"}],"action":"","property":"","from":"","to":"","reg":false,"x":4580,"y":2000,"wires":[["d0b644d9.2b73a8"]]},{"id":"4feefad.2bce404","type":"function","z":"a82c65ac.c0b378","name":"conflicting ids","func":"msg.conflicting = {};\nmsg.flowsAtNow.forEach(function(node,index){\n    if([...new Set(msg.flowsAtNow.filter(x => x.id == node.id).map(x => JSON.stringify(x)))].length > 1) {\n        msg.conflicting[node.id] = msg.flowsAtNow.filter(x => x.id == node.id);\n    }\n});\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":4200,"y":1880,"wires":[["c3567408.545d28"]]},{"id":"c3567408.545d28","type":"switch","z":"a82c65ac.c0b378","name":"","property":"conflicting","propertyType":"msg","rules":[{"t":"empty"},{"t":"else"}],"checkall":"true","repair":false,"outputs":2,"x":4380,"y":1820,"wires":[["bf629a0.1cecc68"],["ef660111.34f8f"]]},{"id":"ef660111.34f8f","type":"change","z":"a82c65ac.c0b378","name":"","rules":[{"t":"set","p":"payload","pt":"msg","to":"\"One or more nodes in the \" & transformation & \" transformation have the same ID of nodes that already exist in this Service Node, but different content. Please resolve the conflict before invoking the PUT transformation API.\\n\\n\" & $string(conflicting)","tot":"jsonata"}],"action":"","property":"","from":"","to":"","reg":false,"x":4560,"y":1840,"wires":[["756f19.b65dd0e8"]]},{"id":"756f19.b65dd0e8","type":"http response","z":"a82c65ac.c0b378","name":"","statusCode":"400","headers":{},"x":4740,"y":1860,"wires":[]},{"id":"bf629a0.1cecc68","type":"change","z":"a82c65ac.c0b378","name":"","rules":[{"t":"set","p":"payload","pt":"msg","to":"flowsAtNow","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":4120,"y":1660,"wires":[["7316c554.72c1fc"]]},{"id":"619cdb7c.286354","type":"http in","z":"a82c65ac.c0b378","name":"GET module","url":"/node/module/:module","method":"get","upload":false,"swaggerDoc":"","x":90,"y":3180,"wires":[["f02d5f15.f2ae7"]]},{"id":"f02d5f15.f2ae7","type":"change","z":"a82c65ac.c0b378","name":"get input params","rules":[{"t":"set","p":"module","pt":"msg","to":"req.params.module","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":290,"y":3180,"wires":[["ce322046.129cd"]]},{"id":"8795807d.48b28","type":"http request","z":"a82c65ac.c0b378","name":"auth","method":"POST","ret":"obj","paytoqs":"ignore","url":"https://localhost:1880/auth/token","tls":"b1a419c1.609c28","persist":false,"proxy":"","authType":"","x":1170,"y":3180,"wires":[["78f51b7.cc008e4"]]},{"id":"5b73785a.3bc618","type":"change","z":"a82c65ac.c0b378","name":"auth payload","rules":[{"t":"set","p":"payload.client_id","pt":"msg","to":"node-red-editor","tot":"str"},{"t":"set","p":"payload.grant_type","pt":"msg","to":"password","tot":"str"},{"t":"set","p":"payload.scope","pt":"msg","to":"","tot":"str"},{"t":"set","p":"payload.username","pt":"msg","to":"NRADM_USER","tot":"env"},{"t":"set","p":"payload.password","pt":"msg","to":"NRADM_PASS","tot":"env"}],"action":"","property":"","from":"","to":"","reg":false,"x":1010,"y":3180,"wires":[["8795807d.48b28"]]},{"id":"78f51b7.cc008e4","type":"switch","z":"a82c65ac.c0b378","name":"","property":"statusCode","propertyType":"msg","rules":[{"t":"eq","v":"200","vt":"num"},{"t":"else"}],"checkall":"true","repair":false,"outputs":2,"x":1310,"y":3180,"wires":[["d92b693f.418338"],["ab1257b6.458ce8"]]},{"id":"6ced2b5.5edb6d4","type":"http request","z":"a82c65ac.c0b378","name":"","method":"POST","ret":"obj","paytoqs":"ignore","url":"${CFG_ACL_ENDP}","tls":"51b09598.a1114c","persist":false,"proxy":"","authType":"","x":690,"y":3180,"wires":[["ea0ce3d6.b0b4"]]},{"id":"ea0ce3d6.b0b4","type":"switch","z":"a82c65ac.c0b378","name":"","property":"statusCode","propertyType":"msg","rules":[{"t":"eq","v":"200","vt":"num"},{"t":"else"}],"checkall":"true","repair":false,"outputs":2,"x":850,"y":3180,"wires":[["5b73785a.3bc618"],["88943d59.cd458"]]},{"id":"ce322046.129cd","type":"change","z":"a82c65ac.c0b378","name":"acl req payload","rules":[{"t":"set","p":"headers","pt":"msg","to":"{}","tot":"json"},{"t":"set","p":"payload","pt":"msg","to":"{}","tot":"json"},{"t":"set","p":"payload.url","pt":"msg","to":"req.url","tot":"msg"},{"t":"set","p":"payload.method","pt":"msg","to":"req.method","tot":"msg"},{"t":"set","p":"payload.headers","pt":"msg","to":"req.headers","tot":"msg"},{"t":"set","p":"payload.params","pt":"msg","to":"req.params","tot":"msg"},{"t":"set","p":"payload.query","pt":"msg","to":"req.query","tot":"msg"},{"t":"set","p":"payload.body","pt":"msg","to":"req.body","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":500,"y":3180,"wires":[["6ced2b5.5edb6d4"]]},{"id":"88943d59.cd458","type":"http response","z":"a82c65ac.c0b378","name":"","statusCode":"","headers":{},"x":990,"y":3220,"wires":[]},{"id":"d92b693f.418338","type":"change","z":"a82c65ac.c0b378","name":"","rules":[{"t":"set","p":"accessToken","pt":"msg","to":"payload.access_token","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":1500,"y":3180,"wires":[["a8c149f3.53a9a8"]]},{"id":"a8c149f3.53a9a8","type":"change","z":"a82c65ac.c0b378","name":"bearer","rules":[{"t":"set","p":"headers","pt":"msg","to":"{}","tot":"json"},{"t":"set","p":"headers.authorization","pt":"msg","to":"\"Bearer \" & msg.accessToken","tot":"jsonata"},{"t":"set","p":"url","pt":"msg","to":"\"https://localhost:1880/nodes/\" & module","tot":"jsonata"}],"action":"","property":"","from":"","to":"","reg":false,"x":1690,"y":3180,"wires":[["ccf919f.b6431e8"]]},{"id":"ab1257b6.458ce8","type":"http response","z":"a82c65ac.c0b378","name":"","statusCode":"","headers":{},"x":1450,"y":3220,"wires":[]},{"id":"ccf919f.b6431e8","type":"http request","z":"a82c65ac.c0b378","name":"get module","method":"GET","ret":"obj","paytoqs":"ignore","url":"","tls":"b1a419c1.609c28","persist":false,"proxy":"","authType":"","x":1850,"y":3180,"wires":[["f4929bbe.482568"]]},{"id":"f4929bbe.482568","type":"http response","z":"a82c65ac.c0b378","name":"","statusCode":"","headers":{},"x":2010,"y":3180,"wires":[]},{"id":"f9be5e8f.d2372","type":"http in","z":"a82c65ac.c0b378","name":"POST module","url":"/node/module/:module","method":"post","upload":false,"swaggerDoc":"","x":90,"y":3280,"wires":[["7d75e004.f505a"]]},{"id":"7d75e004.f505a","type":"change","z":"a82c65ac.c0b378","name":"get input params","rules":[{"t":"set","p":"module","pt":"msg","to":"req.params.module","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":290,"y":3280,"wires":[["2840248e.09331c"]]},{"id":"5dcffbb2.aa3e84","type":"http request","z":"a82c65ac.c0b378","name":"auth","method":"POST","ret":"obj","paytoqs":"ignore","url":"https://localhost:1880/auth/token","tls":"b1a419c1.609c28","persist":false,"proxy":"","authType":"","x":1170,"y":3280,"wires":[["90a09e4.93f416"]]},{"id":"a50bf10b.bee9f","type":"change","z":"a82c65ac.c0b378","name":"auth payload","rules":[{"t":"set","p":"payload.client_id","pt":"msg","to":"node-red-editor","tot":"str"},{"t":"set","p":"payload.grant_type","pt":"msg","to":"password","tot":"str"},{"t":"set","p":"payload.scope","pt":"msg","to":"","tot":"str"},{"t":"set","p":"payload.username","pt":"msg","to":"NRADM_USER","tot":"env"},{"t":"set","p":"payload.password","pt":"msg","to":"NRADM_PASS","tot":"env"}],"action":"","property":"","from":"","to":"","reg":false,"x":1010,"y":3280,"wires":[["5dcffbb2.aa3e84"]]},{"id":"90a09e4.93f416","type":"switch","z":"a82c65ac.c0b378","name":"","property":"statusCode","propertyType":"msg","rules":[{"t":"eq","v":"200","vt":"num"},{"t":"else"}],"checkall":"true","repair":false,"outputs":2,"x":1310,"y":3280,"wires":[["3a1bf92c.aa7406"],["735c2dbb.d60704"]]},{"id":"f92210aa.4e5a7","type":"http request","z":"a82c65ac.c0b378","name":"","method":"POST","ret":"obj","paytoqs":"ignore","url":"${CFG_ACL_ENDP}","tls":"51b09598.a1114c","persist":false,"proxy":"","authType":"","x":690,"y":3280,"wires":[["97fabad0.0dbc98"]]},{"id":"97fabad0.0dbc98","type":"switch","z":"a82c65ac.c0b378","name":"","property":"statusCode","propertyType":"msg","rules":[{"t":"eq","v":"200","vt":"num"},{"t":"else"}],"checkall":"true","repair":false,"outputs":2,"x":850,"y":3280,"wires":[["a50bf10b.bee9f"],["87a9c270.9e5e"]]},{"id":"2840248e.09331c","type":"change","z":"a82c65ac.c0b378","name":"acl req payload","rules":[{"t":"set","p":"headers","pt":"msg","to":"{}","tot":"json"},{"t":"set","p":"payload","pt":"msg","to":"{}","tot":"json"},{"t":"set","p":"payload.url","pt":"msg","to":"req.url","tot":"msg"},{"t":"set","p":"payload.method","pt":"msg","to":"req.method","tot":"msg"},{"t":"set","p":"payload.headers","pt":"msg","to":"req.headers","tot":"msg"},{"t":"set","p":"payload.params","pt":"msg","to":"req.params","tot":"msg"},{"t":"set","p":"payload.query","pt":"msg","to":"req.query","tot":"msg"},{"t":"set","p":"payload.body","pt":"msg","to":"req.body","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":500,"y":3280,"wires":[["f92210aa.4e5a7"]]},{"id":"87a9c270.9e5e","type":"http response","z":"a82c65ac.c0b378","name":"","statusCode":"","headers":{},"x":990,"y":3320,"wires":[]},{"id":"3a1bf92c.aa7406","type":"change","z":"a82c65ac.c0b378","name":"","rules":[{"t":"set","p":"accessToken","pt":"msg","to":"payload.access_token","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":1500,"y":3280,"wires":[["94e33253.0dcc8"]]},{"id":"94e33253.0dcc8","type":"change","z":"a82c65ac.c0b378","name":"bearer","rules":[{"t":"set","p":"headers","pt":"msg","to":"{}","tot":"json"},{"t":"set","p":"headers.authorization","pt":"msg","to":"\"Bearer \" & msg.accessToken","tot":"jsonata"},{"t":"set","p":"url","pt":"msg","to":"https://localhost:1880/nodes","tot":"str"},{"t":"set","p":"payload","pt":"msg","to":"{ \"module\": module }","tot":"jsonata"}],"action":"","property":"","from":"","to":"","reg":false,"x":1690,"y":3280,"wires":[["5ac2057b.a0109c"]]},{"id":"735c2dbb.d60704","type":"http response","z":"a82c65ac.c0b378","name":"","statusCode":"","headers":{},"x":1450,"y":3320,"wires":[]},{"id":"5ac2057b.a0109c","type":"http request","z":"a82c65ac.c0b378","name":"POST module","method":"POST","ret":"obj","paytoqs":"ignore","url":"","tls":"b1a419c1.609c28","persist":false,"proxy":"","authType":"","x":1860,"y":3280,"wires":[["141c627b.f0a05e"]]},{"id":"141c627b.f0a05e","type":"http response","z":"a82c65ac.c0b378","name":"","statusCode":"","headers":{},"x":2030,"y":3280,"wires":[]},{"id":"53565908.3696e8","type":"http in","z":"a82c65ac.c0b378","name":"DELETE module","url":"/node/module/:module","method":"delete","upload":false,"swaggerDoc":"","x":100,"y":3380,"wires":[["7bb47a0c.7f2b84"]]},{"id":"7bb47a0c.7f2b84","type":"change","z":"a82c65ac.c0b378","name":"get input params","rules":[{"t":"set","p":"module","pt":"msg","to":"req.params.module","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":290,"y":3380,"wires":[["b4610b0f.050678"]]},{"id":"1b69e667.fc381a","type":"http request","z":"a82c65ac.c0b378","name":"auth","method":"POST","ret":"obj","paytoqs":"ignore","url":"https://localhost:1880/auth/token","tls":"b1a419c1.609c28","persist":false,"proxy":"","authType":"","x":1170,"y":3380,"wires":[["684b8ed8.8c67a"]]},{"id":"18d830f0.f261af","type":"change","z":"a82c65ac.c0b378","name":"auth payload","rules":[{"t":"set","p":"payload.client_id","pt":"msg","to":"node-red-editor","tot":"str"},{"t":"set","p":"payload.grant_type","pt":"msg","to":"password","tot":"str"},{"t":"set","p":"payload.scope","pt":"msg","to":"","tot":"str"},{"t":"set","p":"payload.username","pt":"msg","to":"NRADM_USER","tot":"env"},{"t":"set","p":"payload.password","pt":"msg","to":"NRADM_PASS","tot":"env"}],"action":"","property":"","from":"","to":"","reg":false,"x":1010,"y":3380,"wires":[["1b69e667.fc381a"]]},{"id":"684b8ed8.8c67a","type":"switch","z":"a82c65ac.c0b378","name":"","property":"statusCode","propertyType":"msg","rules":[{"t":"eq","v":"200","vt":"num"},{"t":"else"}],"checkall":"true","repair":false,"outputs":2,"x":1310,"y":3380,"wires":[["ca9f3ee3.7c655"],["e371a46f.259cd8"]]},{"id":"975e6fd0.0475","type":"http request","z":"a82c65ac.c0b378","name":"","method":"POST","ret":"obj","paytoqs":"ignore","url":"${CFG_ACL_ENDP}","tls":"51b09598.a1114c","persist":false,"proxy":"","authType":"","x":690,"y":3380,"wires":[["a463ceb7.483c3"]]},{"id":"a463ceb7.483c3","type":"switch","z":"a82c65ac.c0b378","name":"","property":"statusCode","propertyType":"msg","rules":[{"t":"eq","v":"200","vt":"num"},{"t":"else"}],"checkall":"true","repair":false,"outputs":2,"x":850,"y":3380,"wires":[["18d830f0.f261af"],["f5dea3f.aef166"]]},{"id":"b4610b0f.050678","type":"change","z":"a82c65ac.c0b378","name":"acl req payload","rules":[{"t":"set","p":"headers","pt":"msg","to":"{}","tot":"json"},{"t":"set","p":"payload","pt":"msg","to":"{}","tot":"json"},{"t":"set","p":"payload.url","pt":"msg","to":"req.url","tot":"msg"},{"t":"set","p":"payload.method","pt":"msg","to":"req.method","tot":"msg"},{"t":"set","p":"payload.headers","pt":"msg","to":"req.headers","tot":"msg"},{"t":"set","p":"payload.params","pt":"msg","to":"req.params","tot":"msg"},{"t":"set","p":"payload.query","pt":"msg","to":"req.query","tot":"msg"},{"t":"set","p":"payload.body","pt":"msg","to":"req.body","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":500,"y":3380,"wires":[["975e6fd0.0475"]]},{"id":"f5dea3f.aef166","type":"http response","z":"a82c65ac.c0b378","name":"","statusCode":"","headers":{},"x":990,"y":3420,"wires":[]},{"id":"ca9f3ee3.7c655","type":"change","z":"a82c65ac.c0b378","name":"","rules":[{"t":"set","p":"accessToken","pt":"msg","to":"payload.access_token","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":1500,"y":3380,"wires":[["1e6a77b8.3318f8"]]},{"id":"1e6a77b8.3318f8","type":"change","z":"a82c65ac.c0b378","name":"bearer","rules":[{"t":"set","p":"headers","pt":"msg","to":"{}","tot":"json"},{"t":"set","p":"headers.authorization","pt":"msg","to":"\"Bearer \" & msg.accessToken","tot":"jsonata"},{"t":"set","p":"url","pt":"msg","to":"\"https://localhost:1880/nodes/\" & module","tot":"jsonata"},{"t":"delete","p":"payload","pt":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":1690,"y":3380,"wires":[["d8a8044b.8eaa38"]]},{"id":"e371a46f.259cd8","type":"http response","z":"a82c65ac.c0b378","name":"","statusCode":"","headers":{},"x":1450,"y":3420,"wires":[]},{"id":"d8a8044b.8eaa38","type":"http request","z":"a82c65ac.c0b378","name":"DELETE module","method":"DELETE","ret":"obj","paytoqs":"ignore","url":"","tls":"b1a419c1.609c28","persist":false,"proxy":"","authType":"","x":1870,"y":3380,"wires":[["63662cb2.1bbc64"]]},{"id":"63662cb2.1bbc64","type":"http response","z":"a82c65ac.c0b378","name":"","statusCode":"","headers":{},"x":2050,"y":3380,"wires":[]},{"id":"5c714449.31c8bc","type":"http in","z":"a82c65ac.c0b378","name":"PUT x","url":"/node/:nodeName/x","method":"put","upload":false,"swaggerDoc":"","x":70,"y":3480,"wires":[["964f6eaf.0e3c3"]]},{"id":"1de2f2c.37bc80d","type":"http in","z":"a82c65ac.c0b378","name":"GET x","url":"/node/:nodeName/x","method":"get","upload":false,"swaggerDoc":"","x":70,"y":3580,"wires":[["53a0505a.bc9c8"]]},{"id":"d4cefd12.eea24","type":"http response","z":"a82c65ac.c0b378","name":"","statusCode":"","headers":{},"x":2450,"y":3580,"wires":[]},{"id":"2a8dfa08.210976","type":"change","z":"a82c65ac.c0b378","name":"","rules":[{"t":"set","p":"headers","pt":"msg","to":"{\"Content-Type\":\"text/plain\"}","tot":"json"}],"action":"","property":"","from":"","to":"","reg":false,"x":2280,"y":3580,"wires":[["d4cefd12.eea24"]]},{"id":"964f6eaf.0e3c3","type":"change","z":"a82c65ac.c0b378","name":"get inputs","rules":[{"t":"set","p":"x","pt":"msg","to":"payload","tot":"msg"},{"t":"set","p":"nodeName","pt":"msg","to":"req.params.nodeName","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":240,"y":3480,"wires":[["923b227c.4cec6"]]},{"id":"b6509215.6e616","type":"http request","z":"a82c65ac.c0b378","name":"get flows","method":"GET","ret":"obj","paytoqs":"ignore","url":"https://localhost:1880/flows","tls":"b1a419c1.609c28","persist":false,"proxy":"","authType":"","x":1760,"y":3480,"wires":[["9aee97d4.49c738"]]},{"id":"e539858a.679898","type":"function","z":"a82c65ac.c0b378","name":"update flows","func":"const http = global.get('https');\nconst data = JSON.stringify(msg.payload);\nconst options = {\n  hostname: 'localhost',\n  port: 1880,\n  path: '/flows',\n  method: 'POST',\n  headers: {\n    'Content-Type': 'application/json',\n    'Content-Length': data.length,\n    'Authorization': 'Bearer '+msg.accessToken\n  },\n  rejectUnauthorized: false\n};\nconst req = http.request(options);\nreq.write(data);\nreq.end();\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":2210,"y":3480,"wires":[["a079fbe6.8111e8"]]},{"id":"a079fbe6.8111e8","type":"change","z":"a82c65ac.c0b378","name":"","rules":[{"t":"set","p":"payload","pt":"msg","to":"x","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":2400,"y":3480,"wires":[["713d7669.891798"]]},{"id":"713d7669.891798","type":"change","z":"a82c65ac.c0b378","name":"","rules":[{"t":"set","p":"headers","pt":"msg","to":"{\"Content-Type\":\"text/plain\"}","tot":"json"}],"action":"","property":"","from":"","to":"","reg":false,"x":2600,"y":3480,"wires":[["8f64e8bc.b0b628"]]},{"id":"8f64e8bc.b0b628","type":"http response","z":"a82c65ac.c0b378","name":"","statusCode":"","headers":{},"x":2770,"y":3480,"wires":[]},{"id":"6a27ad29.927234","type":"http request","z":"a82c65ac.c0b378","name":"get flows","method":"GET","ret":"obj","paytoqs":"ignore","url":"https://localhost:1880/flows","tls":"b1a419c1.609c28","persist":false,"proxy":"","authType":"","x":1760,"y":3580,"wires":[["c6e95a25.c06fe8"]]},{"id":"ea20c81e.dddd98","type":"change","z":"a82c65ac.c0b378","name":"","rules":[{"t":"set","p":"payload","pt":"msg","to":"*[name = $$.nodeName].x","tot":"jsonata"}],"action":"","property":"","from":"","to":"","reg":false,"x":2080,"y":3580,"wires":[["2a8dfa08.210976"]]},{"id":"8342cc07.088f4","type":"http request","z":"a82c65ac.c0b378","name":"auth","method":"POST","ret":"obj","paytoqs":"ignore","url":"https://localhost:1880/auth/token","tls":"b1a419c1.609c28","persist":false,"proxy":"","authType":"","x":1090,"y":3480,"wires":[["529c4fa3.2bacc"]]},{"id":"c1321d50.df299","type":"change","z":"a82c65ac.c0b378","name":"auth payload","rules":[{"t":"set","p":"payload","pt":"msg","to":"{}","tot":"json"},{"t":"set","p":"payload.client_id","pt":"msg","to":"node-red-editor","tot":"str"},{"t":"set","p":"payload.grant_type","pt":"msg","to":"password","tot":"str"},{"t":"set","p":"payload.scope","pt":"msg","to":"","tot":"str"},{"t":"set","p":"payload.username","pt":"msg","to":"NRADM_USER","tot":"env"},{"t":"set","p":"payload.password","pt":"msg","to":"NRADM_PASS","tot":"env"}],"action":"","property":"","from":"","to":"","reg":false,"x":930,"y":3480,"wires":[["8342cc07.088f4"]]},{"id":"13d620a4.39cbcf","type":"change","z":"a82c65ac.c0b378","name":"","rules":[{"t":"set","p":"accessToken","pt":"msg","to":"payload.access_token","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":1420,"y":3480,"wires":[["ae348cf9.f37c6"]]},{"id":"ae348cf9.f37c6","type":"change","z":"a82c65ac.c0b378","name":"bearer","rules":[{"t":"set","p":"headers","pt":"msg","to":"{}","tot":"json"},{"t":"set","p":"headers.authorization","pt":"msg","to":"\"Bearer \" & msg.accessToken","tot":"jsonata"}],"action":"","property":"","from":"","to":"","reg":false,"x":1610,"y":3480,"wires":[["b6509215.6e616"]]},{"id":"719a0b99.805824","type":"http request","z":"a82c65ac.c0b378","name":"auth","method":"POST","ret":"obj","paytoqs":"ignore","url":"https://localhost:1880/auth/token","tls":"b1a419c1.609c28","persist":false,"proxy":"","authType":"","x":1090,"y":3580,"wires":[["1d8731b3.3e949e"]]},{"id":"c96f222d.ba25e","type":"change","z":"a82c65ac.c0b378","name":"auth payload","rules":[{"t":"set","p":"payload.client_id","pt":"msg","to":"node-red-editor","tot":"str"},{"t":"set","p":"payload.grant_type","pt":"msg","to":"password","tot":"str"},{"t":"set","p":"payload.scope","pt":"msg","to":"","tot":"str"},{"t":"set","p":"payload.username","pt":"msg","to":"NRADM_USER","tot":"env"},{"t":"set","p":"payload.password","pt":"msg","to":"NRADM_PASS","tot":"env"}],"action":"","property":"","from":"","to":"","reg":false,"x":930,"y":3580,"wires":[["719a0b99.805824"]]},{"id":"191a9d44.c6b6d3","type":"change","z":"a82c65ac.c0b378","name":"","rules":[{"t":"set","p":"accessToken","pt":"msg","to":"payload.access_token","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":1420,"y":3580,"wires":[["efdf327f.65eb2"]]},{"id":"efdf327f.65eb2","type":"change","z":"a82c65ac.c0b378","name":"bearer","rules":[{"t":"set","p":"headers","pt":"msg","to":"{}","tot":"json"},{"t":"set","p":"headers.authorization","pt":"msg","to":"\"Bearer \" & msg.accessToken","tot":"jsonata"}],"action":"","property":"","from":"","to":"","reg":false,"x":1610,"y":3580,"wires":[["6a27ad29.927234"]]},{"id":"98f3e6dc.d37188","type":"http request","z":"a82c65ac.c0b378","name":"","method":"POST","ret":"obj","paytoqs":"ignore","url":"${CFG_ACL_ENDP}","tls":"51b09598.a1114c","persist":false,"proxy":"","authType":"","x":610,"y":3480,"wires":[["37270080.e0b82"]]},{"id":"37270080.e0b82","type":"switch","z":"a82c65ac.c0b378","name":"","property":"statusCode","propertyType":"msg","rules":[{"t":"eq","v":"200","vt":"num"},{"t":"else"}],"checkall":"true","repair":false,"outputs":2,"x":770,"y":3480,"wires":[["c1321d50.df299"],["ac75fc13.26a28"]]},{"id":"923b227c.4cec6","type":"change","z":"a82c65ac.c0b378","name":"acl req payload","rules":[{"t":"set","p":"headers","pt":"msg","to":"{}","tot":"json"},{"t":"set","p":"payload","pt":"msg","to":"{}","tot":"json"},{"t":"set","p":"payload.url","pt":"msg","to":"req.url","tot":"msg"},{"t":"set","p":"payload.method","pt":"msg","to":"req.method","tot":"msg"},{"t":"set","p":"payload.headers","pt":"msg","to":"req.headers","tot":"msg"},{"t":"set","p":"payload.params","pt":"msg","to":"req.params","tot":"msg"},{"t":"set","p":"payload.query","pt":"msg","to":"req.query","tot":"msg"},{"t":"set","p":"payload.body","pt":"msg","to":"req.body","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":420,"y":3480,"wires":[["98f3e6dc.d37188"]]},{"id":"ac75fc13.26a28","type":"http response","z":"a82c65ac.c0b378","name":"","statusCode":"","headers":{},"x":910,"y":3520,"wires":[]},{"id":"22293839.adc978","type":"http request","z":"a82c65ac.c0b378","name":"","method":"POST","ret":"obj","paytoqs":"ignore","url":"${CFG_ACL_ENDP}","tls":"51b09598.a1114c","persist":false,"proxy":"","authType":"","x":610,"y":3580,"wires":[["9e561220.76cc4"]]},{"id":"9e561220.76cc4","type":"switch","z":"a82c65ac.c0b378","name":"","property":"statusCode","propertyType":"msg","rules":[{"t":"eq","v":"200","vt":"num"},{"t":"else"}],"checkall":"true","repair":false,"outputs":2,"x":770,"y":3580,"wires":[["c96f222d.ba25e"],["7e536eb0.ac8fb"]]},{"id":"b8101e09.26c3f","type":"change","z":"a82c65ac.c0b378","name":"acl req payload","rules":[{"t":"set","p":"headers","pt":"msg","to":"{}","tot":"json"},{"t":"set","p":"payload","pt":"msg","to":"{}","tot":"json"},{"t":"set","p":"payload.url","pt":"msg","to":"req.url","tot":"msg"},{"t":"set","p":"payload.method","pt":"msg","to":"req.method","tot":"msg"},{"t":"set","p":"payload.headers","pt":"msg","to":"req.headers","tot":"msg"},{"t":"set","p":"payload.params","pt":"msg","to":"req.params","tot":"msg"},{"t":"set","p":"payload.query","pt":"msg","to":"req.query","tot":"msg"},{"t":"set","p":"payload.body","pt":"msg","to":"req.body","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":420,"y":3580,"wires":[["22293839.adc978"]]},{"id":"7e536eb0.ac8fb","type":"http response","z":"a82c65ac.c0b378","name":"","statusCode":"","headers":{},"x":910,"y":3620,"wires":[]},{"id":"fdf04477.68bf98","type":"change","z":"a82c65ac.c0b378","name":"edit","rules":[{"t":"set","p":"old","pt":"msg","to":"*[name = $$.nodeName ]","tot":"jsonata"},{"t":"set","p":"new","pt":"msg","to":"old","tot":"msg"},{"t":"set","p":"new.x","pt":"msg","to":"x","tot":"msg"},{"t":"set","p":"payload","pt":"msg","to":"$eval($replace($string(payload),$string(old),$string(new)))","tot":"jsonata"}],"action":"","property":"","from":"","to":"","reg":false,"x":2050,"y":3480,"wires":[["e539858a.679898"]]},{"id":"529c4fa3.2bacc","type":"switch","z":"a82c65ac.c0b378","name":"","property":"statusCode","propertyType":"msg","rules":[{"t":"eq","v":"200","vt":"num"},{"t":"else"}],"checkall":"true","repair":false,"outputs":2,"x":1230,"y":3480,"wires":[["13d620a4.39cbcf"],["2180bb1e.b84e14"]]},{"id":"2180bb1e.b84e14","type":"http response","z":"a82c65ac.c0b378","name":"","statusCode":"","headers":{},"x":1370,"y":3520,"wires":[]},{"id":"9aee97d4.49c738","type":"switch","z":"a82c65ac.c0b378","name":"","property":"statusCode","propertyType":"msg","rules":[{"t":"eq","v":"200","vt":"num"},{"t":"else"}],"checkall":"true","repair":false,"outputs":2,"x":1910,"y":3480,"wires":[["fdf04477.68bf98"],["5e47c9ca.f52958"]]},{"id":"5e47c9ca.f52958","type":"http response","z":"a82c65ac.c0b378","name":"","statusCode":"","headers":{},"x":2050,"y":3520,"wires":[]},{"id":"1d8731b3.3e949e","type":"switch","z":"a82c65ac.c0b378","name":"","property":"statusCode","propertyType":"msg","rules":[{"t":"eq","v":"200","vt":"num"},{"t":"else"}],"checkall":"true","repair":false,"outputs":2,"x":1230,"y":3580,"wires":[["191a9d44.c6b6d3"],["c9adad15.113b6"]]},{"id":"c9adad15.113b6","type":"http response","z":"a82c65ac.c0b378","name":"","statusCode":"","headers":{},"x":1370,"y":3620,"wires":[]},{"id":"c6e95a25.c06fe8","type":"switch","z":"a82c65ac.c0b378","name":"","property":"statusCode","propertyType":"msg","rules":[{"t":"eq","v":"200","vt":"num"},{"t":"else"}],"checkall":"true","repair":false,"outputs":2,"x":1910,"y":3580,"wires":[["ea20c81e.dddd98"],["b8412b6e.537668"]]},{"id":"b8412b6e.537668","type":"http response","z":"a82c65ac.c0b378","name":"","statusCode":"","headers":{},"x":2050,"y":3620,"wires":[]},{"id":"53a0505a.bc9c8","type":"change","z":"a82c65ac.c0b378","name":"get inputs","rules":[{"t":"set","p":"nodeName","pt":"msg","to":"req.params.nodeName","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":240,"y":3580,"wires":[["b8101e09.26c3f"]]},{"id":"4b661a8f.e85ed4","type":"http in","z":"a82c65ac.c0b378","name":"PUT y","url":"/node/:nodeName/y","method":"put","upload":false,"swaggerDoc":"","x":70,"y":3680,"wires":[["2b0f434c.f8e05c"]]},{"id":"9e2cbbd3.94d1c8","type":"http in","z":"a82c65ac.c0b378","name":"GET y","url":"/node/:nodeName/y","method":"get","upload":false,"swaggerDoc":"","x":70,"y":3780,"wires":[["f1f19b93.70cfd8"]]},{"id":"c628b626.fed338","type":"http response","z":"a82c65ac.c0b378","name":"","statusCode":"","headers":{},"x":2450,"y":3780,"wires":[]},{"id":"4b364427.19957c","type":"change","z":"a82c65ac.c0b378","name":"","rules":[{"t":"set","p":"headers","pt":"msg","to":"{\"Content-Type\":\"text/plain\"}","tot":"json"}],"action":"","property":"","from":"","to":"","reg":false,"x":2280,"y":3780,"wires":[["c628b626.fed338"]]},{"id":"2b0f434c.f8e05c","type":"change","z":"a82c65ac.c0b378","name":"get inputs","rules":[{"t":"set","p":"y","pt":"msg","to":"payload","tot":"msg"},{"t":"set","p":"nodeName","pt":"msg","to":"req.params.nodeName","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":240,"y":3680,"wires":[["d26b5a4f.b97c68"]]},{"id":"7193d223.e436dc","type":"http request","z":"a82c65ac.c0b378","name":"get flows","method":"GET","ret":"obj","paytoqs":"ignore","url":"https://localhost:1880/flows","tls":"b1a419c1.609c28","persist":false,"proxy":"","authType":"","x":1760,"y":3680,"wires":[["888d4dcb.1529d"]]},{"id":"88b91ba4.c29618","type":"function","z":"a82c65ac.c0b378","name":"update flows","func":"const http = global.get('https');\nconst data = JSON.stringify(msg.payload);\nconst options = {\n  hostname: 'localhost',\n  port: 1880,\n  path: '/flows',\n  method: 'POST',\n  headers: {\n    'Content-Type': 'application/json',\n    'Content-Length': data.length,\n    'Authorization': 'Bearer '+msg.accessToken\n  },\n  rejectUnauthorized: false\n};\nconst req = http.request(options);\nreq.write(data);\nreq.end();\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":2210,"y":3680,"wires":[["b536d898.83a478"]]},{"id":"b536d898.83a478","type":"change","z":"a82c65ac.c0b378","name":"","rules":[{"t":"set","p":"payload","pt":"msg","to":"y","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":2400,"y":3680,"wires":[["9dd7b941.12f168"]]},{"id":"9dd7b941.12f168","type":"change","z":"a82c65ac.c0b378","name":"","rules":[{"t":"set","p":"headers","pt":"msg","to":"{\"Content-Type\":\"text/plain\"}","tot":"json"}],"action":"","property":"","from":"","to":"","reg":false,"x":2600,"y":3680,"wires":[["418fe4d2.54d41c"]]},{"id":"418fe4d2.54d41c","type":"http response","z":"a82c65ac.c0b378","name":"","statusCode":"","headers":{},"x":2770,"y":3680,"wires":[]},{"id":"72cbb9f2.5b31b8","type":"http request","z":"a82c65ac.c0b378","name":"get flows","method":"GET","ret":"obj","paytoqs":"ignore","url":"https://localhost:1880/flows","tls":"b1a419c1.609c28","persist":false,"proxy":"","authType":"","x":1760,"y":3780,"wires":[["d8ffaee1.c2e14"]]},{"id":"67ae58aa.6c8a08","type":"change","z":"a82c65ac.c0b378","name":"","rules":[{"t":"set","p":"payload","pt":"msg","to":"*[name = $$.nodeName].y","tot":"jsonata"}],"action":"","property":"","from":"","to":"","reg":false,"x":2080,"y":3780,"wires":[["4b364427.19957c"]]},{"id":"42afbeb0.51faf","type":"http request","z":"a82c65ac.c0b378","name":"auth","method":"POST","ret":"obj","paytoqs":"ignore","url":"https://localhost:1880/auth/token","tls":"b1a419c1.609c28","persist":false,"proxy":"","authType":"","x":1090,"y":3680,"wires":[["e10d00c9.e9957"]]},{"id":"f310efac.2f258","type":"change","z":"a82c65ac.c0b378","name":"auth payload","rules":[{"t":"set","p":"payload","pt":"msg","to":"{}","tot":"json"},{"t":"set","p":"payload.client_id","pt":"msg","to":"node-red-editor","tot":"str"},{"t":"set","p":"payload.grant_type","pt":"msg","to":"password","tot":"str"},{"t":"set","p":"payload.scope","pt":"msg","to":"","tot":"str"},{"t":"set","p":"payload.username","pt":"msg","to":"NRADM_USER","tot":"env"},{"t":"set","p":"payload.password","pt":"msg","to":"NRADM_PASS","tot":"env"}],"action":"","property":"","from":"","to":"","reg":false,"x":930,"y":3680,"wires":[["42afbeb0.51faf"]]},{"id":"969ce24e.b13a7","type":"change","z":"a82c65ac.c0b378","name":"","rules":[{"t":"set","p":"accessToken","pt":"msg","to":"payload.access_token","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":1420,"y":3680,"wires":[["b06c93ac.10ecc"]]},{"id":"b06c93ac.10ecc","type":"change","z":"a82c65ac.c0b378","name":"bearer","rules":[{"t":"set","p":"headers","pt":"msg","to":"{}","tot":"json"},{"t":"set","p":"headers.authorization","pt":"msg","to":"\"Bearer \" & msg.accessToken","tot":"jsonata"}],"action":"","property":"","from":"","to":"","reg":false,"x":1610,"y":3680,"wires":[["7193d223.e436dc"]]},{"id":"f3529bab.529f98","type":"http request","z":"a82c65ac.c0b378","name":"auth","method":"POST","ret":"obj","paytoqs":"ignore","url":"https://localhost:1880/auth/token","tls":"b1a419c1.609c28","persist":false,"proxy":"","authType":"","x":1090,"y":3780,"wires":[["785b9a66.ee27a4"]]},{"id":"98c907b8.559318","type":"change","z":"a82c65ac.c0b378","name":"auth payload","rules":[{"t":"set","p":"payload.client_id","pt":"msg","to":"node-red-editor","tot":"str"},{"t":"set","p":"payload.grant_type","pt":"msg","to":"password","tot":"str"},{"t":"set","p":"payload.scope","pt":"msg","to":"","tot":"str"},{"t":"set","p":"payload.username","pt":"msg","to":"NRADM_USER","tot":"env"},{"t":"set","p":"payload.password","pt":"msg","to":"NRADM_PASS","tot":"env"}],"action":"","property":"","from":"","to":"","reg":false,"x":930,"y":3780,"wires":[["f3529bab.529f98"]]},{"id":"85c0a3dd.3053b","type":"change","z":"a82c65ac.c0b378","name":"","rules":[{"t":"set","p":"accessToken","pt":"msg","to":"payload.access_token","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":1420,"y":3780,"wires":[["87b46935.f3d388"]]},{"id":"87b46935.f3d388","type":"change","z":"a82c65ac.c0b378","name":"bearer","rules":[{"t":"set","p":"headers","pt":"msg","to":"{}","tot":"json"},{"t":"set","p":"headers.authorization","pt":"msg","to":"\"Bearer \" & msg.accessToken","tot":"jsonata"}],"action":"","property":"","from":"","to":"","reg":false,"x":1610,"y":3780,"wires":[["72cbb9f2.5b31b8"]]},{"id":"c8913396.035f9","type":"http request","z":"a82c65ac.c0b378","name":"","method":"POST","ret":"obj","paytoqs":"ignore","url":"${CFG_ACL_ENDP}","tls":"51b09598.a1114c","persist":false,"proxy":"","authType":"","x":610,"y":3680,"wires":[["3d3fe0e4.f7fbe"]]},{"id":"3d3fe0e4.f7fbe","type":"switch","z":"a82c65ac.c0b378","name":"","property":"statusCode","propertyType":"msg","rules":[{"t":"eq","v":"200","vt":"num"},{"t":"else"}],"checkall":"true","repair":false,"outputs":2,"x":770,"y":3680,"wires":[["f310efac.2f258"],["7867c52e.eda86c"]]},{"id":"d26b5a4f.b97c68","type":"change","z":"a82c65ac.c0b378","name":"acl req payload","rules":[{"t":"set","p":"headers","pt":"msg","to":"{}","tot":"json"},{"t":"set","p":"payload","pt":"msg","to":"{}","tot":"json"},{"t":"set","p":"payload.url","pt":"msg","to":"req.url","tot":"msg"},{"t":"set","p":"payload.method","pt":"msg","to":"req.method","tot":"msg"},{"t":"set","p":"payload.headers","pt":"msg","to":"req.headers","tot":"msg"},{"t":"set","p":"payload.params","pt":"msg","to":"req.params","tot":"msg"},{"t":"set","p":"payload.query","pt":"msg","to":"req.query","tot":"msg"},{"t":"set","p":"payload.body","pt":"msg","to":"req.body","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":420,"y":3680,"wires":[["c8913396.035f9"]]},{"id":"7867c52e.eda86c","type":"http response","z":"a82c65ac.c0b378","name":"","statusCode":"","headers":{},"x":910,"y":3720,"wires":[]},{"id":"8a01746.511a588","type":"http request","z":"a82c65ac.c0b378","name":"","method":"POST","ret":"obj","paytoqs":"ignore","url":"${CFG_ACL_ENDP}","tls":"51b09598.a1114c","persist":false,"proxy":"","authType":"","x":610,"y":3780,"wires":[["ce407f7d.40ea6"]]},{"id":"ce407f7d.40ea6","type":"switch","z":"a82c65ac.c0b378","name":"","property":"statusCode","propertyType":"msg","rules":[{"t":"eq","v":"200","vt":"num"},{"t":"else"}],"checkall":"true","repair":false,"outputs":2,"x":770,"y":3780,"wires":[["98c907b8.559318"],["c1d369bd.ab4368"]]},{"id":"d125922f.ba0d1","type":"change","z":"a82c65ac.c0b378","name":"acl req payload","rules":[{"t":"set","p":"headers","pt":"msg","to":"{}","tot":"json"},{"t":"set","p":"payload","pt":"msg","to":"{}","tot":"json"},{"t":"set","p":"payload.url","pt":"msg","to":"req.url","tot":"msg"},{"t":"set","p":"payload.method","pt":"msg","to":"req.method","tot":"msg"},{"t":"set","p":"payload.headers","pt":"msg","to":"req.headers","tot":"msg"},{"t":"set","p":"payload.params","pt":"msg","to":"req.params","tot":"msg"},{"t":"set","p":"payload.query","pt":"msg","to":"req.query","tot":"msg"},{"t":"set","p":"payload.body","pt":"msg","to":"req.body","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":420,"y":3780,"wires":[["8a01746.511a588"]]},{"id":"c1d369bd.ab4368","type":"http response","z":"a82c65ac.c0b378","name":"","statusCode":"","headers":{},"x":910,"y":3820,"wires":[]},{"id":"443b7aaa.56d764","type":"change","z":"a82c65ac.c0b378","name":"edit","rules":[{"t":"set","p":"old","pt":"msg","to":"*[name = $$.nodeName ]","tot":"jsonata"},{"t":"set","p":"new","pt":"msg","to":"old","tot":"msg"},{"t":"set","p":"new.y","pt":"msg","to":"y","tot":"msg"},{"t":"set","p":"payload","pt":"msg","to":"$eval($replace($string(payload),$string(old),$string(new)))","tot":"jsonata"}],"action":"","property":"","from":"","to":"","reg":false,"x":2050,"y":3680,"wires":[["88b91ba4.c29618"]]},{"id":"e10d00c9.e9957","type":"switch","z":"a82c65ac.c0b378","name":"","property":"statusCode","propertyType":"msg","rules":[{"t":"eq","v":"200","vt":"num"},{"t":"else"}],"checkall":"true","repair":false,"outputs":2,"x":1230,"y":3680,"wires":[["969ce24e.b13a7"],["8ccea054.64428"]]},{"id":"8ccea054.64428","type":"http response","z":"a82c65ac.c0b378","name":"","statusCode":"","headers":{},"x":1370,"y":3720,"wires":[]},{"id":"888d4dcb.1529d","type":"switch","z":"a82c65ac.c0b378","name":"","property":"statusCode","propertyType":"msg","rules":[{"t":"eq","v":"200","vt":"num"},{"t":"else"}],"checkall":"true","repair":false,"outputs":2,"x":1910,"y":3680,"wires":[["443b7aaa.56d764"],["c3e5b38f.88d27"]]},{"id":"c3e5b38f.88d27","type":"http response","z":"a82c65ac.c0b378","name":"","statusCode":"","headers":{},"x":2050,"y":3720,"wires":[]},{"id":"785b9a66.ee27a4","type":"switch","z":"a82c65ac.c0b378","name":"","property":"statusCode","propertyType":"msg","rules":[{"t":"eq","v":"200","vt":"num"},{"t":"else"}],"checkall":"true","repair":false,"outputs":2,"x":1230,"y":3780,"wires":[["85c0a3dd.3053b"],["d06990d7.df606"]]},{"id":"d06990d7.df606","type":"http response","z":"a82c65ac.c0b378","name":"","statusCode":"","headers":{},"x":1370,"y":3820,"wires":[]},{"id":"d8ffaee1.c2e14","type":"switch","z":"a82c65ac.c0b378","name":"","property":"statusCode","propertyType":"msg","rules":[{"t":"eq","v":"200","vt":"num"},{"t":"else"}],"checkall":"true","repair":false,"outputs":2,"x":1910,"y":3780,"wires":[["67ae58aa.6c8a08"],["e0bf49d0.7227e8"]]},{"id":"e0bf49d0.7227e8","type":"http response","z":"a82c65ac.c0b378","name":"","statusCode":"","headers":{},"x":2050,"y":3820,"wires":[]},{"id":"f1f19b93.70cfd8","type":"change","z":"a82c65ac.c0b378","name":"get inputs","rules":[{"t":"set","p":"nodeName","pt":"msg","to":"req.params.nodeName","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":240,"y":3780,"wires":[["d125922f.ba0d1"]]},{"id":"852f38aa.d018c8","type":"change","z":"a82c65ac.c0b378","name":"","rules":[{"t":"set","p":"payload","pt":"msg","to":"\"node\" is a reserved name, it cannot be used for a transformation subflow","tot":"str"}],"action":"","property":"","from":"","to":"","reg":false,"x":360,"y":2240,"wires":[["1e648fdc.433df"]]},{"id":"1e648fdc.433df","type":"http response","z":"a82c65ac.c0b378","name":"","statusCode":"400","headers":{},"x":540,"y":2240,"wires":[]}]