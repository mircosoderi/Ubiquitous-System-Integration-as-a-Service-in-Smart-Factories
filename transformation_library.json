[{"id":"f6f2187d.f17ca8","type":"tab","label":"Flow 1","disabled":false,"info":""},{"id":"15706c00.b04294","type":"subflow","name":"greaterthan","info":"","category":"","in":[{"x":40,"y":240,"wires":[{"id":"8cb9a655.de6ea8"},{"id":"abef1b61.f3f5b8"}]}],"out":[{"x":860,"y":240,"wires":[{"id":"9799bb84.343af8","port":0}]}],"env":[],"meta":{},"color":"#DDAA99","status":{"x":2900,"y":360,"wires":[{"id":"c1009857.9bf878","port":0},{"id":"fd5f1bb8.5e2448","port":0}]}},{"id":"5ad932d2.c06e2c","type":"subflow","name":"between","info":"","category":"","in":[{"x":40,"y":440,"wires":[{"id":"84c2a949.9c8188"},{"id":"4e9ea80a.f97d28"}]}],"out":[{"x":1140,"y":440,"wires":[{"id":"d37bd4c1.a30a18","port":0}]}],"env":[],"meta":{},"color":"#DDAA99","status":{"x":2900,"y":540,"wires":[{"id":"8af8771a.af8598","port":0},{"id":"10f4bce8.b266c3","port":0},{"id":"99f26c7f.580dc","port":0}]}},{"id":"2599ad7e.d33f62","type":"subflow","name":"enum","info":"","category":"","in":[{"x":40,"y":240,"wires":[{"id":"614867dc.d79a18"},{"id":"7c8fcbf7.8f30c4"}]}],"out":[{"x":720,"y":240,"wires":[{"id":"195d581e.379868","port":0}]}],"env":[],"meta":{},"color":"#DDAA99","status":{"x":2900,"y":360,"wires":[{"id":"3d1d160c.3d868a","port":0},{"id":"dfa08839.8d5d78","port":0}]}},{"id":"3723610.753c9a","type":"subflow","name":"template","info":"","category":"","in":[{"x":40,"y":440,"wires":[{"id":"944c37ef.a2ce08"},{"id":"32875c1b.1a36c4"}]}],"out":[{"x":640,"y":440,"wires":[{"id":"9140a633.d4adf8","port":0}]}],"env":[],"meta":{},"color":"#DDAA99","status":{"x":3340,"y":560,"wires":[{"id":"5c687187.30cb6","port":0},{"id":"702f29e1.1b64f8","port":0},{"id":"b9bf0729.8b8378","port":0}]}},{"id":"55a62a.5aaf59d8","type":"subflow","name":"scale","info":"","category":"","in":[{"x":40,"y":1040,"wires":[{"id":"2b0ce6e6.75e9ea"},{"id":"84ecf99a.7f9c28"}]}],"out":[{"x":700,"y":1040,"wires":[{"id":"2b0ce6e6.75e9ea","port":0}]}],"env":[],"meta":{},"color":"#DDAA99","status":{"x":3080,"y":1120,"wires":[{"id":"88375d74.dc0bc","port":0},{"id":"e5ea631a.a3fcd","port":0},{"id":"48778410.e0076c","port":0},{"id":"8d9e3491.43c168","port":0},{"id":"3717de2b.f4d672","port":0},{"id":"39b5556d.2dd64a","port":0}]}},{"id":"503a42b5.f37bac","type":"subflow","name":"expr","info":"","category":"","in":[{"x":40,"y":240,"wires":[{"id":"2fe0475d.fb9168"},{"id":"2d1475e8.061eea"}]}],"out":[{"x":700,"y":240,"wires":[{"id":"2fe0475d.fb9168","port":0}]}],"env":[],"meta":{},"color":"#DDAA99","status":{"x":2940,"y":320,"wires":[{"id":"a58e7bbe.b39a98","port":0},{"id":"c038222b.3170a","port":0}]}},{"id":"2b718b38.a1a7b4","type":"subflow","name":"lowerthan","info":"","category":"","in":[{"x":40,"y":240,"wires":[{"id":"de2444c3.8394c8"},{"id":"3ce3153a.e5e27a"}]}],"out":[{"x":860,"y":240,"wires":[{"id":"94e54c90.a871e","port":0}]}],"env":[],"meta":{},"color":"#DDAA99","status":{"x":2900,"y":340,"wires":[{"id":"b7c7052f.193038","port":0},{"id":"66ede242.221f5c","port":0}]}},{"id":"189ac7e1.52f288","type":"subflow","name":"outside","info":"","category":"","in":[{"x":60,"y":560,"wires":[{"id":"9b96030c.d311"},{"id":"36847680.a50b7a"}]}],"out":[{"x":1060,"y":560,"wires":[{"id":"6f2be22f.2a5c5c","port":1}]}],"env":[],"meta":{},"color":"#DDAA99","status":{"x":2920,"y":460,"wires":[{"id":"c59e6fac.52e94","port":0},{"id":"ed9180c7.e5ac7","port":0},{"id":"f5e3320e.206b4","port":0}]}},{"id":"4fb04efc.9af29","type":"subflow","name":"quarantine","info":"","category":"","in":[{"x":900,"y":320,"wires":[{"id":"9dfea884.d15448"},{"id":"625e3810.215ae8"}]}],"out":[{"x":1940,"y":240,"wires":[{"id":"cdadb616.477e38","port":0}]}],"env":[],"meta":{},"color":"#DDAA99","status":{"x":2900,"y":400,"wires":[{"id":"9dfea884.d15448","port":0},{"id":"ff1ed7e1.ad5968","port":0},{"id":"eed74d78.35d85","port":0},{"id":"2150186d.67db48","port":0},{"id":"38b965f.6814b9a","port":0}]}},{"id":"938f4ad2.352088","type":"subflow","name":"switch","info":"","category":"","in":[{"x":60,"y":240,"wires":[{"id":"497bf4c2.4715bc"},{"id":"c47e2ab0.f85f08"}]}],"out":[{"x":660,"y":240,"wires":[{"id":"89420d5d.3c3b","port":0}]}],"env":[],"meta":{},"color":"#DDAA99","status":{"x":2960,"y":400,"wires":[{"id":"c47e2ab0.f85f08","port":0},{"id":"a3500328.d308","port":0},{"id":"41c56ccd.724bb4","port":0},{"id":"2ca550d7.a72d4","port":0},{"id":"9a581880.4353a8","port":0}]}},{"id":"add93fe3.4654f","type":"subflow","name":"sampler","info":"","category":"","in":[{"x":40,"y":320,"wires":[{"id":"f939326e.2a0d8"},{"id":"aea18ba4.93ebe8"}]}],"out":[{"x":420,"y":240,"wires":[{"id":"f939326e.2a0d8","port":0}]}],"env":[],"meta":{},"color":"#DDAA99","status":{"x":2940,"y":400,"wires":[{"id":"262567db.bff158","port":0},{"id":"aea18ba4.93ebe8","port":0},{"id":"6926a3d8.d83e1c","port":0}]}},{"id":"50618dc7.9fe494","type":"subflow","name":"watchdog","info":"","category":"","in":[{"x":40,"y":240,"wires":[{"id":"54633570.84c13c"},{"id":"d3e4dfd5.176f3"}]}],"out":[{"x":280,"y":240,"wires":[{"id":"54633570.84c13c","port":0}]}],"env":[],"meta":{},"color":"#DDAA99","status":{"x":2940,"y":340,"wires":[{"id":"d3e4dfd5.176f3","port":0},{"id":"21146aa0.b89206","port":0},{"id":"3b5cde00.c79a82","port":0}]}},{"id":"440d357f.2f371c","type":"subflow","name":"dbtail","info":"","category":"","in":[],"out":[{"x":700,"y":1660,"wires":[{"id":"c88f7618.1d6408","port":0}]}],"env":[],"meta":{},"color":"#DDAA99","status":{"x":3280,"y":1720,"wires":[{"id":"bcae30a8.c249f","port":0},{"id":"7a3a7a93.ea7844","port":0},{"id":"488f1813.50f308","port":0},{"id":"15b2d699.0a0369","port":0},{"id":"9626873d.857678","port":0},{"id":"f8c213c5.c7599","port":0},{"id":"be14788e.3506c8","port":0},{"id":"81229b66.07d2d8","port":0},{"id":"3c5252bb.77294e","port":0},{"id":"59ef9561.2ad03c","port":0}]}},{"id":"5bbedfa3.e6454","type":"subflow","name":"dbread","info":"","category":"","in":[{"x":40,"y":1420,"wires":[{"id":"5574250e.49e45c"}]}],"out":[{"x":640,"y":1360,"wires":[{"id":"695b34fd.215afc","port":0}]}],"env":[],"meta":{},"color":"#DDAA99","status":{"x":3260,"y":1480,"wires":[{"id":"ad73d791.2041c8","port":0},{"id":"7e3bca58.242d64","port":0},{"id":"f8990386.db346","port":0},{"id":"d35ba105.d14ae","port":0},{"id":"b2418d00.738b9","port":0},{"id":"c9d4768f.cddc18","port":0},{"id":"219133b8.980e3c","port":0},{"id":"e87fa74f.0f97c8","port":0},{"id":"9d8c3c75.5e0f2","port":0}]}},{"id":"a6602ce1.5b9f9","type":"subflow","name":"dbwrite","info":"","category":"","in":[{"x":40,"y":1260,"wires":[{"id":"9cd370.1a5acc9"}]}],"out":[{"x":500,"y":1220,"wires":[{"id":"4bdd2950.7deec8","port":0}]}],"env":[],"meta":{},"color":"#DDAA99","status":{"x":3260,"y":1260,"wires":[{"id":"4bdd2950.7deec8","port":0},{"id":"bd380b00.e45568","port":0},{"id":"70dce66c.574e28","port":0},{"id":"8bb3fb63.d13c38","port":0},{"id":"81e2c93f.295d88","port":0},{"id":"d9660ad.84876f8","port":0},{"id":"162a04c5.861afb","port":0}]}},{"id":"b2d45fd.e73bca","type":"subflow","name":"clock","info":"","category":"","in":[],"out":[{"x":250,"y":40,"wires":[{"id":"c8cc962d.c9f418","port":0}]}],"env":[],"meta":{},"color":"#DDAA99","status":{"x":380,"y":100,"wires":[{"id":"e1da28a2.81d398","port":0}]}},{"id":"dcf52b9f.7e2b28","type":"subflow","name":"fork","info":"","category":"","in":[{"x":60,"y":340,"wires":[{"id":"898c8758.921b88"}]}],"out":[{"x":300,"y":240,"wires":[{"id":"898c8758.921b88","port":0}]},{"x":300,"y":440,"wires":[{"id":"898c8758.921b88","port":1}]}],"env":[],"meta":{},"color":"#DDAA99","status":{"x":2900,"y":340,"wires":[{"id":"a2716cb5.12f77","port":0},{"id":"2a168b2a.272314","port":0},{"id":"8a0b8d5d.d4ff","port":0}]}},{"id":"a479104f.4f835","type":"subflow","name":"filetail","info":"","category":"","in":[],"out":[{"x":320,"y":440,"wires":[{"id":"2b120e60.ec81c2","port":0}]}],"env":[],"meta":{},"color":"#DDAA99","status":{"x":3200,"y":500,"wires":[{"id":"cf6917fd.dd12a8","port":0},{"id":"88ebe607.4ca4b8","port":0},{"id":"3027acc4.9322a4","port":0}]}},{"id":"e6b796c2.8cc528","type":"subflow","name":"filewrite","info":"","category":"","in":[{"x":40,"y":240,"wires":[{"id":"4b154e0e.f2967"}]}],"out":[{"x":280,"y":240,"wires":[{"id":"4b154e0e.f2967","port":0}]}],"env":[],"meta":{},"color":"#DDAA99","status":{"x":3140,"y":300,"wires":[{"id":"575450d6.af156","port":0},{"id":"c6370c35.f3ea","port":0}]}},{"id":"b93102f9.c90a7","type":"subflow","name":"opcuai","info":"","category":"","in":[{"x":40,"y":260,"wires":[{"id":"fe160907.8a27a8"},{"id":"4888a117.1d26d"}]}],"out":[{"x":400,"y":260,"wires":[{"id":"1383139f.dc87ec","port":0}]}],"env":[],"meta":{},"color":"#DDAA99","status":{"x":3240,"y":380,"wires":[{"id":"d4b81ab7.dcf228","port":0},{"id":"c06036f1.e22af8","port":0},{"id":"4888a117.1d26d","port":0}]}},{"id":"19c7ab5e.875675","type":"subflow","name":"opcuac","info":"","category":"","in":[{"x":40,"y":460,"wires":[{"id":"2532828.a19017e"},{"id":"1d7d3b2a.ac79c5"}]}],"out":[{"x":420,"y":460,"wires":[{"id":"88e21160.eb7b7","port":0}]}],"env":[],"meta":{},"color":"#DDAA99","status":{"x":3440,"y":520,"wires":[{"id":"35032696.c032ca","port":0},{"id":"2532828.a19017e","port":0},{"id":"f08062ac.21387","port":0},{"id":"d2e5300c.e6bf6","port":0}]}},{"id":"e2448208.9f92f","type":"subflow","name":"opcuab","info":"","category":"","in":[{"x":40,"y":460,"wires":[{"id":"fc441026.5b48c"},{"id":"27e9743c.75e9bc"}]}],"out":[{"x":480,"y":460,"wires":[{"id":"13e50a7.f22caf6","port":0}]}],"env":[],"meta":{},"color":"#DDAA99","status":{"x":3440,"y":540,"wires":[{"id":"27c75b44.fbcaa4","port":0},{"id":"27e9743c.75e9bc","port":0},{"id":"fa7afba1.4d5c38","port":0},{"id":"f936895e.e29a88","port":0}]}},{"id":"90c296a3.7369d8","type":"subflow","name":"opcuas","info":"","category":"","in":[{"x":40,"y":260,"wires":[{"id":"4274e420.44827c"},{"id":"6b5c5d4e.756204"}]}],"out":[{"x":420,"y":260,"wires":[{"id":"65966ad0.c0f5d4","port":0}]}],"env":[],"meta":{},"color":"#DDAA99","status":{"x":3220,"y":320,"wires":[{"id":"84d829f7.3ad998","port":0},{"id":"6b5c5d4e.756204","port":0},{"id":"428b2ce9.86ce44","port":0}]}},{"id":"8c872134.80e4c","type":"subflow","name":"opcuae","info":"","category":"","in":[{"x":40,"y":260,"wires":[{"id":"dd39e82a.706a38"},{"id":"d088016f.5a10b"}]}],"out":[{"x":460,"y":260,"wires":[{"id":"199aa9c6.ba6356","port":0}]}],"env":[],"meta":{},"color":"#DDAA99","status":{"x":3240,"y":300,"wires":[{"id":"51aa5362.23078c","port":0},{"id":"eaf9446d.ed0a08","port":0},{"id":"d088016f.5a10b","port":0}]}},{"id":"c654cb89.a3c268","type":"subflow","name":"opcuam","info":"","category":"","in":[{"x":40,"y":460,"wires":[{"id":"f1e2f5b3.a0bef8"},{"id":"10805cd4.920823"}]}],"out":[{"x":420,"y":460,"wires":[{"id":"38d1a72f.428328","port":0}]}],"env":[],"meta":{},"color":"#DDAA99","status":{"x":3420,"y":520,"wires":[{"id":"9ad2d9ac.ac4758","port":0},{"id":"10805cd4.920823","port":0},{"id":"a2085333.658ab","port":0},{"id":"48665cc4.463ff4","port":0}]}},{"id":"7b111c25.9e2314","type":"Stackhero-MySQL-Server","name":"dbtail mysql server config","host":"localhost","port":"3306","tls":false,"database":"sys"},{"id":"84be6cee.0293c","type":"Stackhero-MySQL-Server","z":"5bbedfa3.e6454","name":"dbread mysql server config","host":"localhost","port":"3306","tls":false,"database":"sys"},{"id":"b1a419c1.609c29","type":"tls-config","name":"tlscfg nr adm in lib","cert":"","key":"","ca":"","certname":"","keyname":"","caname":"","servername":"","verifyservercert":false},{"id":"51b09598.a1114d","type":"tls-config","name":"tlscfg cfg acl in lib","cert":"","key":"","ca":"${CFG_ACL_CACE}","certname":"","keyname":"","caname":"","servername":"","verifyservercert":true},{"id":"fa4af4d5.61c8e8","type":"Stackhero-MySQL-Server","z":"a6602ce1.5b9f9","name":"dbwrite mysql server config","host":"localhost","port":"3306","tls":false,"database":"sys"},{"id":"b7aa8d43.59b97","type":"OpcUa-Endpoint","z":"19c7ab5e.875675","endpoint":"opcuac","secpol":"None","secmode":"None","login":false},{"id":"f8430adc.f6c448","type":"OpcUa-Endpoint","z":"e2448208.9f92f","endpoint":"opcuab","secpol":"None","secmode":"None","login":false},{"id":"1b177826.9fa7b8","type":"OpcUa-Endpoint","z":"c654cb89.a3c268","endpoint":"opcuam","secpol":"None","secmode":"None","login":false},{"id":"3cc11d24.ff01a2","type":"comment","z":"f6f2187d.f17ca8","name":"WARNING: please check you have started this container with a volume that is mounted to /data\\n otherwise any flow changes are lost when you redeploy or upgrade the container\\n (e.g. upgrade to a more recent node-red docker image).\\n  If you are using named volumes you can ignore this warning.\\n Double click or see info side panel to learn how to start Node-RED in Docker to save your work","info":"\nTo start docker with a bind mount volume (-v option), for example:\n\n```\ndocker run -it -p 1880:1880 -v /home/user/node_red_data:/data --name mynodered nodered/node-red\n```\n\nwhere `/home/user/node_red_data` is a directory on your host machine where you want to store your flows.\n\nIf you do not do this then you can experiment and redploy flows, but if you restart or upgrade the container the flows will be disconnected and lost. \n\nThey will still exist in a hidden data volume, which can be recovered using standard docker techniques, but that is much more complex than just starting with a named volume as described above.","x":350,"y":80,"wires":[]},{"id":"9799bb84.343af8","type":"switch","z":"15706c00.b04294","name":"","property":"payload","propertyType":"msg","rules":[{"t":"gt","v":"threshold","vt":"msg"},{"t":"else"}],"checkall":"true","repair":false,"outputs":2,"x":710,"y":240,"wires":[["94bec704.2f0148"],["41418afc.df50a4"]]},{"id":"8cb9a655.de6ea8","type":"change","z":"15706c00.b04294","name":"get greaterthan threshold","rules":[{"t":"set","p":"threshold","pt":"msg","to":"","tot":"str"}],"action":"","property":"","from":"","to":"","reg":false,"x":210,"y":240,"wires":[["f012115f.ec058"]]},{"id":"c504c3bc.84a2f","type":"change","z":"15706c00.b04294","name":"to number","rules":[{"t":"set","p":"payload","pt":"msg","to":"$number(payload)","tot":"jsonata"},{"t":"set","p":"threshold","pt":"msg","to":"$number(threshold)","tot":"jsonata"},{"t":"set","p":"status","pt":"msg","to":"{ \"out\": null }","tot":"json"}],"action":"","property":"","from":"","to":"","reg":false,"x":560,"y":240,"wires":[["9799bb84.343af8"]]},{"id":"d37bd4c1.a30a18","type":"switch","z":"5ad932d2.c06e2c","name":"","property":"payload","propertyType":"msg","rules":[{"t":"btwn","v":"from","vt":"msg","v2":"to","v2t":"msg"},{"t":"else"}],"checkall":"true","repair":false,"outputs":2,"x":990,"y":440,"wires":[["faba1b6a.9dda48"],["497be3fb.74994c"]]},{"id":"84c2a949.9c8188","type":"change","z":"5ad932d2.c06e2c","name":"get between settings","rules":[{"t":"set","p":"from","pt":"msg","to":"","tot":"str"},{"t":"set","p":"to","pt":"msg","to":"","tot":"str"}],"action":"","property":"","from":"","to":"","reg":false,"x":200,"y":440,"wires":[["f7534d0b.4cc29"]]},{"id":"3251fecc.9eff72","type":"change","z":"5ad932d2.c06e2c","name":"to number","rules":[{"t":"set","p":"payload","pt":"msg","to":"$number(payload)","tot":"jsonata"},{"t":"set","p":"from","pt":"msg","to":"$number(from)","tot":"jsonata"},{"t":"set","p":"to","pt":"msg","to":"$number(to)","tot":"jsonata"},{"t":"set","p":"status","pt":"msg","to":"{ \"out\": null }","tot":"json"}],"action":"","property":"","from":"","to":"","reg":false,"x":840,"y":440,"wires":[["d37bd4c1.a30a18"]]},{"id":"195d581e.379868","type":"switch","z":"2599ad7e.d33f62","name":"","property":"enum","propertyType":"msg","rules":[{"t":"cont","v":"payload","vt":"msg"},{"t":"else"}],"checkall":"true","repair":false,"outputs":2,"x":530,"y":240,"wires":[["c051d03f.8c36c"],["ff581746.f0e498"]]},{"id":"9140a633.d4adf8","type":"template","z":"3723610.753c9a","name":"template","field":"payload","fieldType":"msg","format":"handlebars","syntax":"mustache","template":"","output":"str","x":480,"y":440,"wires":[["6668692f.ecceb8"]]},{"id":"2fe0475d.fb9168","type":"change","z":"503a42b5.f37bac","name":"set","rules":[{"t":"set","p":"payload","pt":"msg","to":"payload","tot":"jsonata"}],"action":"","property":"","from":"","to":"","reg":false,"x":150,"y":240,"wires":[["65a0eecf.44191"]]},{"id":"2d1475e8.061eea","type":"change","z":"503a42b5.f37bac","name":"status in","rules":[{"t":"set","p":"status","pt":"msg","to":"{}","tot":"msg"},{"t":"set","p":"status.in","pt":"msg","to":"payload","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":160,"y":320,"wires":[["1f023cb0.4e0543"]]},{"id":"65a0eecf.44191","type":"change","z":"503a42b5.f37bac","name":"status out","rules":[{"t":"set","p":"status","pt":"msg","to":"{}","tot":"json"},{"t":"set","p":"status.out","pt":"msg","to":"payload","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":300,"y":280,"wires":[["1f023cb0.4e0543"]]},{"id":"1f023cb0.4e0543","type":"join","z":"503a42b5.f37bac","name":"","mode":"custom","build":"merged","property":"status","propertyType":"msg","key":"topic","joiner":"\\n","joinerType":"str","accumulate":false,"timeout":"","count":"2","reduceRight":false,"reduceExp":"","reduceInit":"","reduceInitType":"","reduceFixup":"","x":450,"y":320,"wires":[["a58e7bbe.b39a98"]]},{"id":"a58e7bbe.b39a98","type":"change","z":"503a42b5.f37bac","name":"status","rules":[{"t":"set","p":"payload","pt":"msg","to":"{}","tot":"json"},{"t":"set","p":"payload.text","pt":"msg","to":"status.in & \" => \" & status.out","tot":"jsonata"},{"t":"set","p":"payload.shape","pt":"msg","to":"dot","tot":"str"},{"t":"set","p":"payload.fill","pt":"msg","to":"green","tot":"str"}],"action":"","property":"","from":"","to":"","reg":false,"x":590,"y":320,"wires":[[]]},{"id":"15158cee.ee8ac3","type":"http in","z":"503a42b5.f37bac","name":"PUT expr","url":"/expr","method":"put","upload":false,"swaggerDoc":"","x":80,"y":40,"wires":[["e19fe8b0.7f5918"]]},{"id":"a40eecc9.1106f","type":"change","z":"503a42b5.f37bac","name":"","rules":[{"t":"set","p":"payload","pt":"msg","to":"config","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":2420,"y":40,"wires":[["6e179684.9cc078"]]},{"id":"c4b28a8c.da37d8","type":"http in","z":"503a42b5.f37bac","name":"GET expr","url":"/expr","method":"get","upload":false,"swaggerDoc":"","x":80,"y":140,"wires":[["32ed2d2d.cb4cb2"]]},{"id":"98bc7ddc.42f2a","type":"http response","z":"503a42b5.f37bac","name":"","statusCode":"","headers":{},"x":2290,"y":140,"wires":[]},{"id":"b10f52ff.348f7","type":"change","z":"503a42b5.f37bac","name":"","rules":[{"t":"set","p":"headers","pt":"msg","to":"{\"Content-Type\":\"text/plain\"}","tot":"json"}],"action":"","property":"","from":"","to":"","reg":false,"x":2120,"y":140,"wires":[["98bc7ddc.42f2a"]]},{"id":"e19fe8b0.7f5918","type":"change","z":"503a42b5.f37bac","name":"get inputs","rules":[{"t":"set","p":"config","pt":"msg","to":"payload","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":260,"y":40,"wires":[["6afd1467.972c6c"]]},{"id":"1308c910.736217","type":"http request","z":"503a42b5.f37bac","name":"get flows","method":"GET","ret":"obj","paytoqs":"ignore","url":"https://localhost:1880/flows","tls":"b1a419c1.609c29","persist":false,"proxy":"","authType":"","x":1780,"y":40,"wires":[["9c3dc051.ac56e"]]},{"id":"f062181a.249358","type":"http response","z":"503a42b5.f37bac","name":"","statusCode":"","headers":{},"x":2790,"y":40,"wires":[]},{"id":"6e179684.9cc078","type":"change","z":"503a42b5.f37bac","name":"","rules":[{"t":"set","p":"headers","pt":"msg","to":"{\"Content-Type\":\"text/plain\"}","tot":"json"}],"action":"","property":"","from":"","to":"","reg":false,"x":2620,"y":40,"wires":[["f062181a.249358","c038222b.3170a"]]},{"id":"125c7b33.697695","type":"http request","z":"503a42b5.f37bac","name":"get flows","method":"GET","ret":"obj","paytoqs":"ignore","url":"https://localhost:1880/flows","tls":"b1a419c1.609c29","persist":false,"proxy":"","authType":"","x":1600,"y":140,"wires":[["7779a238.df428c"]]},{"id":"e19f3dd8.756e6","type":"http request","z":"503a42b5.f37bac","name":"auth","method":"POST","ret":"obj","paytoqs":"ignore","url":"https://localhost:1880/auth/token","tls":"b1a419c1.609c29","persist":false,"proxy":"","authType":"","x":1110,"y":40,"wires":[["f65d1ce4.84539"]]},{"id":"8804bdcd.5d43a","type":"change","z":"503a42b5.f37bac","name":"auth payload","rules":[{"t":"set","p":"payload","pt":"msg","to":"{}","tot":"json"},{"t":"set","p":"payload.client_id","pt":"msg","to":"node-red-editor","tot":"str"},{"t":"set","p":"payload.grant_type","pt":"msg","to":"password","tot":"str"},{"t":"set","p":"payload.scope","pt":"msg","to":"","tot":"str"},{"t":"set","p":"payload.username","pt":"msg","to":"NRADM_USER","tot":"env"},{"t":"set","p":"payload.password","pt":"msg","to":"NRADM_PASS","tot":"env"}],"action":"","property":"","from":"","to":"","reg":false,"x":950,"y":40,"wires":[["e19f3dd8.756e6"]]},{"id":"2a43ee3.8976412","type":"change","z":"503a42b5.f37bac","name":"","rules":[{"t":"set","p":"accessToken","pt":"msg","to":"payload.access_token","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":1440,"y":40,"wires":[["5a5293d5.98809c"]]},{"id":"5a5293d5.98809c","type":"change","z":"503a42b5.f37bac","name":"bearer","rules":[{"t":"set","p":"headers","pt":"msg","to":"{}","tot":"json"},{"t":"set","p":"headers.authorization","pt":"msg","to":"\"Bearer \" & msg.accessToken","tot":"jsonata"}],"action":"","property":"","from":"","to":"","reg":false,"x":1630,"y":40,"wires":[["1308c910.736217"]]},{"id":"5046fe1.31881","type":"http request","z":"503a42b5.f37bac","name":"auth","method":"POST","ret":"obj","paytoqs":"ignore","url":"https://localhost:1880/auth/token","tls":"b1a419c1.609c29","persist":false,"proxy":"","authType":"","x":930,"y":140,"wires":[["71f7a3fe.8bdf4c"]]},{"id":"eb1f03da.b1eb6","type":"change","z":"503a42b5.f37bac","name":"auth payload","rules":[{"t":"set","p":"payload.client_id","pt":"msg","to":"node-red-editor","tot":"str"},{"t":"set","p":"payload.grant_type","pt":"msg","to":"password","tot":"str"},{"t":"set","p":"payload.scope","pt":"msg","to":"","tot":"str"},{"t":"set","p":"payload.username","pt":"msg","to":"NRADM_USER","tot":"env"},{"t":"set","p":"payload.password","pt":"msg","to":"NRADM_PASS","tot":"env"}],"action":"","property":"","from":"","to":"","reg":false,"x":770,"y":140,"wires":[["5046fe1.31881"]]},{"id":"514afb7f.5275e4","type":"change","z":"503a42b5.f37bac","name":"","rules":[{"t":"set","p":"accessToken","pt":"msg","to":"payload.access_token","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":1260,"y":140,"wires":[["37df391b.dd59c6"]]},{"id":"37df391b.dd59c6","type":"change","z":"503a42b5.f37bac","name":"bearer","rules":[{"t":"set","p":"headers","pt":"msg","to":"{}","tot":"json"},{"t":"set","p":"headers.authorization","pt":"msg","to":"\"Bearer \" & msg.accessToken","tot":"jsonata"}],"action":"","property":"","from":"","to":"","reg":false,"x":1450,"y":140,"wires":[["125c7b33.697695"]]},{"id":"8f9c8b92.0ca268","type":"http request","z":"503a42b5.f37bac","name":"","method":"POST","ret":"obj","paytoqs":"ignore","url":"${CFG_ACL_ENDP}","tls":"51b09598.a1114d","persist":false,"proxy":"","authType":"basic","x":630,"y":40,"wires":[["c2d902a0.0b26f"]]},{"id":"c2d902a0.0b26f","type":"switch","z":"503a42b5.f37bac","name":"","property":"statusCode","propertyType":"msg","rules":[{"t":"eq","v":"200","vt":"num"},{"t":"else"}],"checkall":"true","repair":false,"outputs":2,"x":790,"y":40,"wires":[["8804bdcd.5d43a"],["80346ac.0e4fd98"]]},{"id":"f7c1603c.c76a3","type":"http request","z":"503a42b5.f37bac","name":"","method":"POST","ret":"obj","paytoqs":"ignore","url":"${CFG_ACL_ENDP}","tls":"51b09598.a1114d","persist":false,"proxy":"","authType":"basic","x":450,"y":140,"wires":[["e3dec45b.eb5618"]]},{"id":"e3dec45b.eb5618","type":"switch","z":"503a42b5.f37bac","name":"","property":"statusCode","propertyType":"msg","rules":[{"t":"eq","v":"200","vt":"num"},{"t":"else"}],"checkall":"true","repair":false,"outputs":2,"x":610,"y":140,"wires":[["eb1f03da.b1eb6"],["a07c7a4e.83d448"]]},{"id":"32ed2d2d.cb4cb2","type":"change","z":"503a42b5.f37bac","name":"acl req payload","rules":[{"t":"set","p":"headers","pt":"msg","to":"{}","tot":"json"},{"t":"set","p":"payload","pt":"msg","to":"{}","tot":"json"},{"t":"set","p":"payload.url","pt":"msg","to":"req.url","tot":"msg"},{"t":"set","p":"payload.method","pt":"msg","to":"req.method","tot":"msg"},{"t":"set","p":"payload.headers","pt":"msg","to":"req.headers","tot":"msg"},{"t":"set","p":"payload.params","pt":"msg","to":"req.params","tot":"msg"},{"t":"set","p":"payload.query","pt":"msg","to":"req.query","tot":"msg"},{"t":"set","p":"payload.body","pt":"msg","to":"req.body","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":260,"y":140,"wires":[["f7c1603c.c76a3"]]},{"id":"6afd1467.972c6c","type":"change","z":"503a42b5.f37bac","name":"acl req payload","rules":[{"t":"set","p":"headers","pt":"msg","to":"{}","tot":"json"},{"t":"set","p":"payload","pt":"msg","to":"{}","tot":"json"},{"t":"set","p":"payload.url","pt":"msg","to":"req.url","tot":"msg"},{"t":"set","p":"payload.method","pt":"msg","to":"req.method","tot":"msg"},{"t":"set","p":"payload.headers","pt":"msg","to":"req.headers","tot":"msg"},{"t":"set","p":"payload.params","pt":"msg","to":"req.params","tot":"msg"},{"t":"set","p":"payload.query","pt":"msg","to":"req.query","tot":"msg"},{"t":"set","p":"payload.body","pt":"msg","to":"req.body","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":440,"y":40,"wires":[["8f9c8b92.0ca268"]]},{"id":"a07c7a4e.83d448","type":"http response","z":"503a42b5.f37bac","name":"","statusCode":"","headers":{},"x":750,"y":180,"wires":[]},{"id":"d01b59a8.5566f8","type":"change","z":"503a42b5.f37bac","name":"","rules":[{"t":"set","p":"payload","pt":"msg","to":"*[name = \"set\" and type=\"change\"].rules[0].to","tot":"jsonata"}],"action":"","property":"","from":"","to":"","reg":false,"x":1920,"y":140,"wires":[["b10f52ff.348f7"]]},{"id":"9d61b11e.90a83","type":"change","z":"503a42b5.f37bac","name":"edit","rules":[{"t":"set","p":"old","pt":"msg","to":"*[name = \"set\" and type=\"change\"]","tot":"jsonata"},{"t":"set","p":"new","pt":"msg","to":"old","tot":"msg"},{"t":"set","p":"new.rules[0].to","pt":"msg","to":"config","tot":"msg"},{"t":"set","p":"payload","pt":"msg","to":"$eval($replace($string(payload),$string(old),$string(new)))","tot":"jsonata"}],"action":"","property":"","from":"","to":"","reg":false,"x":2070,"y":40,"wires":[["1de2fa49.48ae06"]]},{"id":"80346ac.0e4fd98","type":"http response","z":"503a42b5.f37bac","name":"","statusCode":"","headers":{},"x":930,"y":80,"wires":[]},{"id":"f65d1ce4.84539","type":"switch","z":"503a42b5.f37bac","name":"","property":"statusCode","propertyType":"msg","rules":[{"t":"eq","v":"200","vt":"num"},{"t":"else"}],"checkall":"true","repair":false,"outputs":2,"x":1250,"y":40,"wires":[["2a43ee3.8976412"],["ad4fcb0a.ad0798"]]},{"id":"ad4fcb0a.ad0798","type":"http response","z":"503a42b5.f37bac","name":"","statusCode":"","headers":{},"x":1390,"y":80,"wires":[]},{"id":"9c3dc051.ac56e","type":"switch","z":"503a42b5.f37bac","name":"","property":"statusCode","propertyType":"msg","rules":[{"t":"eq","v":"200","vt":"num"},{"t":"else"}],"checkall":"true","repair":false,"outputs":2,"x":1930,"y":40,"wires":[["9d61b11e.90a83"],["6f8d4ddf.b1bc04"]]},{"id":"6f8d4ddf.b1bc04","type":"http response","z":"503a42b5.f37bac","name":"","statusCode":"","headers":{},"x":2070,"y":80,"wires":[]},{"id":"1de2fa49.48ae06","type":"function","z":"503a42b5.f37bac","name":"update flows","func":"const http = global.get('https');\nconst data = JSON.stringify(msg.payload);\nconst options = {\n  hostname: 'localhost',\n  port: 1880,\n  path: '/flows',\n  method: 'POST',\n  headers: {\n    'Content-Type': 'application/json',\n    'Content-Length': data.length,\n    'Authorization': 'Bearer '+msg.accessToken\n  },\n  rejectUnauthorized: false\n};\nconst req = http.request(options);\nreq.write(data);\nreq.end();\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":2230,"y":40,"wires":[["a40eecc9.1106f"]]},{"id":"71f7a3fe.8bdf4c","type":"switch","z":"503a42b5.f37bac","name":"","property":"statusCode","propertyType":"msg","rules":[{"t":"eq","v":"200","vt":"num"},{"t":"else"}],"checkall":"true","repair":false,"outputs":2,"x":1070,"y":140,"wires":[["514afb7f.5275e4"],["55f0d95b.24a528"]]},{"id":"55f0d95b.24a528","type":"http response","z":"503a42b5.f37bac","name":"","statusCode":"","headers":{},"x":1210,"y":180,"wires":[]},{"id":"7779a238.df428c","type":"switch","z":"503a42b5.f37bac","name":"","property":"statusCode","propertyType":"msg","rules":[{"t":"eq","v":"200","vt":"num"},{"t":"else"}],"checkall":"true","repair":false,"outputs":2,"x":1750,"y":140,"wires":[["d01b59a8.5566f8"],["9198269.c4df8d8"]]},{"id":"9198269.c4df8d8","type":"http response","z":"503a42b5.f37bac","name":"","statusCode":"","headers":{},"x":1890,"y":180,"wires":[]},{"id":"2b0ce6e6.75e9ea","type":"range","z":"55a62a.5aaf59d8","minin":"0","maxin":"0","minout":"0","maxout":"0","action":"scale","round":false,"property":"payload","name":"scale","x":150,"y":1040,"wires":[["1ba38552.452c0b"]]},{"id":"4b085646.29a718","type":"http in","z":"55a62a.5aaf59d8","name":"PUT minin","url":"/scale/minin","method":"put","upload":false,"swaggerDoc":"","x":80,"y":40,"wires":[["1be27c6a.4816f4"]]},{"id":"596ee6a8.9f9588","type":"change","z":"55a62a.5aaf59d8","name":"","rules":[{"t":"set","p":"payload","pt":"msg","to":"minin","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":2420,"y":40,"wires":[["93c3d501.0c98a8"]]},{"id":"a811c175.46dfa","type":"http in","z":"55a62a.5aaf59d8","name":"GET minin","url":"/scale/minin","method":"get","upload":false,"swaggerDoc":"","x":80,"y":140,"wires":[["911c356b.563428"]]},{"id":"d4160c4a.fe9","type":"http response","z":"55a62a.5aaf59d8","name":"","statusCode":"","headers":{},"x":2290,"y":140,"wires":[]},{"id":"fb459b0e.898a68","type":"change","z":"55a62a.5aaf59d8","name":"","rules":[{"t":"set","p":"headers","pt":"msg","to":"{\"Content-Type\":\"text/plain\"}","tot":"json"}],"action":"","property":"","from":"","to":"","reg":false,"x":2120,"y":140,"wires":[["d4160c4a.fe9"]]},{"id":"1be27c6a.4816f4","type":"change","z":"55a62a.5aaf59d8","name":"get inputs","rules":[{"t":"set","p":"minin","pt":"msg","to":"payload","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":260,"y":40,"wires":[["84b7dd07.1abe2"]]},{"id":"bbee40b6.d7c0c","type":"http request","z":"55a62a.5aaf59d8","name":"get flows","method":"GET","ret":"obj","paytoqs":"ignore","url":"https://localhost:1880/flows","tls":"b1a419c1.609c29","persist":false,"proxy":"","authType":"","x":1780,"y":40,"wires":[["620445d1.15045c"]]},{"id":"a87db211.3b401","type":"http response","z":"55a62a.5aaf59d8","name":"","statusCode":"","headers":{},"x":2790,"y":40,"wires":[]},{"id":"93c3d501.0c98a8","type":"change","z":"55a62a.5aaf59d8","name":"","rules":[{"t":"set","p":"headers","pt":"msg","to":"{\"Content-Type\":\"text/plain\"}","tot":"json"}],"action":"","property":"","from":"","to":"","reg":false,"x":2620,"y":40,"wires":[["a87db211.3b401","39b5556d.2dd64a"]]},{"id":"3ec90a0b.b018b6","type":"http request","z":"55a62a.5aaf59d8","name":"get flows","method":"GET","ret":"obj","paytoqs":"ignore","url":"https://localhost:1880/flows","tls":"b1a419c1.609c29","persist":false,"proxy":"","authType":"","x":1600,"y":140,"wires":[["505dda6b.01e814"]]},{"id":"88d6964c.2f68f8","type":"http request","z":"55a62a.5aaf59d8","name":"auth","method":"POST","ret":"obj","paytoqs":"ignore","url":"https://localhost:1880/auth/token","tls":"b1a419c1.609c29","persist":false,"proxy":"","authType":"","x":1110,"y":40,"wires":[["7a8d70d4.90586"]]},{"id":"61cde1b0.427fa","type":"change","z":"55a62a.5aaf59d8","name":"auth payload","rules":[{"t":"set","p":"payload","pt":"msg","to":"{}","tot":"json"},{"t":"set","p":"payload.client_id","pt":"msg","to":"node-red-editor","tot":"str"},{"t":"set","p":"payload.grant_type","pt":"msg","to":"password","tot":"str"},{"t":"set","p":"payload.scope","pt":"msg","to":"","tot":"str"},{"t":"set","p":"payload.username","pt":"msg","to":"NRADM_USER","tot":"env"},{"t":"set","p":"payload.password","pt":"msg","to":"NRADM_PASS","tot":"env"}],"action":"","property":"","from":"","to":"","reg":false,"x":950,"y":40,"wires":[["88d6964c.2f68f8"]]},{"id":"f2d21a37.9f6068","type":"change","z":"55a62a.5aaf59d8","name":"","rules":[{"t":"set","p":"accessToken","pt":"msg","to":"payload.access_token","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":1440,"y":40,"wires":[["8c1ac43e.7ed158"]]},{"id":"8c1ac43e.7ed158","type":"change","z":"55a62a.5aaf59d8","name":"bearer","rules":[{"t":"set","p":"headers","pt":"msg","to":"{}","tot":"json"},{"t":"set","p":"headers.authorization","pt":"msg","to":"\"Bearer \" & msg.accessToken","tot":"jsonata"}],"action":"","property":"","from":"","to":"","reg":false,"x":1630,"y":40,"wires":[["bbee40b6.d7c0c"]]},{"id":"ee10c521.c23808","type":"http request","z":"55a62a.5aaf59d8","name":"auth","method":"POST","ret":"obj","paytoqs":"ignore","url":"https://localhost:1880/auth/token","tls":"b1a419c1.609c29","persist":false,"proxy":"","authType":"","x":930,"y":140,"wires":[["75dddd68.e9ab84"]]},{"id":"395532b7.84afee","type":"change","z":"55a62a.5aaf59d8","name":"auth payload","rules":[{"t":"set","p":"payload.client_id","pt":"msg","to":"node-red-editor","tot":"str"},{"t":"set","p":"payload.grant_type","pt":"msg","to":"password","tot":"str"},{"t":"set","p":"payload.scope","pt":"msg","to":"","tot":"str"},{"t":"set","p":"payload.username","pt":"msg","to":"NRADM_USER","tot":"env"},{"t":"set","p":"payload.password","pt":"msg","to":"NRADM_PASS","tot":"env"}],"action":"","property":"","from":"","to":"","reg":false,"x":770,"y":140,"wires":[["ee10c521.c23808"]]},{"id":"ef245270.d4784","type":"change","z":"55a62a.5aaf59d8","name":"","rules":[{"t":"set","p":"accessToken","pt":"msg","to":"payload.access_token","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":1260,"y":140,"wires":[["dbaf7c1b.e1403"]]},{"id":"dbaf7c1b.e1403","type":"change","z":"55a62a.5aaf59d8","name":"bearer","rules":[{"t":"set","p":"headers","pt":"msg","to":"{}","tot":"json"},{"t":"set","p":"headers.authorization","pt":"msg","to":"\"Bearer \" & msg.accessToken","tot":"jsonata"}],"action":"","property":"","from":"","to":"","reg":false,"x":1450,"y":140,"wires":[["3ec90a0b.b018b6"]]},{"id":"320e240d.d811fc","type":"http request","z":"55a62a.5aaf59d8","name":"","method":"POST","ret":"obj","paytoqs":"ignore","url":"${CFG_ACL_ENDP}","tls":"51b09598.a1114d","persist":false,"proxy":"","authType":"","x":630,"y":40,"wires":[["7d80fd28.c622c4"]]},{"id":"7d80fd28.c622c4","type":"switch","z":"55a62a.5aaf59d8","name":"","property":"statusCode","propertyType":"msg","rules":[{"t":"eq","v":"200","vt":"num"},{"t":"else"}],"checkall":"true","repair":false,"outputs":2,"x":790,"y":40,"wires":[["61cde1b0.427fa"],["3d6c9693.d182da"]]},{"id":"b28bdffa.57b62","type":"http request","z":"55a62a.5aaf59d8","name":"","method":"POST","ret":"obj","paytoqs":"ignore","url":"${CFG_ACL_ENDP}","tls":"51b09598.a1114d","persist":false,"proxy":"","authType":"","x":450,"y":140,"wires":[["96e450b4.47474"]]},{"id":"96e450b4.47474","type":"switch","z":"55a62a.5aaf59d8","name":"","property":"statusCode","propertyType":"msg","rules":[{"t":"eq","v":"200","vt":"num"},{"t":"else"}],"checkall":"true","repair":false,"outputs":2,"x":610,"y":140,"wires":[["395532b7.84afee"],["648ac28.c054c3c"]]},{"id":"911c356b.563428","type":"change","z":"55a62a.5aaf59d8","name":"acl req payload","rules":[{"t":"set","p":"headers","pt":"msg","to":"{}","tot":"json"},{"t":"set","p":"payload","pt":"msg","to":"{}","tot":"json"},{"t":"set","p":"payload.url","pt":"msg","to":"req.url","tot":"msg"},{"t":"set","p":"payload.method","pt":"msg","to":"req.method","tot":"msg"},{"t":"set","p":"payload.headers","pt":"msg","to":"req.headers","tot":"msg"},{"t":"set","p":"payload.params","pt":"msg","to":"req.params","tot":"msg"},{"t":"set","p":"payload.query","pt":"msg","to":"req.query","tot":"msg"},{"t":"set","p":"payload.body","pt":"msg","to":"req.body","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":260,"y":140,"wires":[["b28bdffa.57b62"]]},{"id":"84b7dd07.1abe2","type":"change","z":"55a62a.5aaf59d8","name":"acl req payload","rules":[{"t":"set","p":"headers","pt":"msg","to":"{}","tot":"json"},{"t":"set","p":"payload","pt":"msg","to":"{}","tot":"json"},{"t":"set","p":"payload.url","pt":"msg","to":"req.url","tot":"msg"},{"t":"set","p":"payload.method","pt":"msg","to":"req.method","tot":"msg"},{"t":"set","p":"payload.headers","pt":"msg","to":"req.headers","tot":"msg"},{"t":"set","p":"payload.params","pt":"msg","to":"req.params","tot":"msg"},{"t":"set","p":"payload.query","pt":"msg","to":"req.query","tot":"msg"},{"t":"set","p":"payload.body","pt":"msg","to":"req.body","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":440,"y":40,"wires":[["320e240d.d811fc"]]},{"id":"648ac28.c054c3c","type":"http response","z":"55a62a.5aaf59d8","name":"","statusCode":"","headers":{},"x":750,"y":180,"wires":[]},{"id":"590f47b8.87e088","type":"change","z":"55a62a.5aaf59d8","name":"","rules":[{"t":"set","p":"payload","pt":"msg","to":"*[name = \"scale\" and type=\"range\"].minin","tot":"jsonata"}],"action":"","property":"","from":"","to":"","reg":false,"x":1920,"y":140,"wires":[["fb459b0e.898a68"]]},{"id":"2de49ce6.18cce4","type":"change","z":"55a62a.5aaf59d8","name":"edit","rules":[{"t":"set","p":"old","pt":"msg","to":"*[name = \"scale\" and type=\"range\"]","tot":"jsonata"},{"t":"set","p":"new","pt":"msg","to":"old","tot":"msg"},{"t":"set","p":"new.minin","pt":"msg","to":"minin","tot":"msg"},{"t":"set","p":"payload","pt":"msg","to":"$eval($replace($string(payload),$string(old),$string(new)))","tot":"jsonata"}],"action":"","property":"","from":"","to":"","reg":false,"x":2070,"y":40,"wires":[["c735f348.24e75"]]},{"id":"3d6c9693.d182da","type":"http response","z":"55a62a.5aaf59d8","name":"","statusCode":"","headers":{},"x":930,"y":80,"wires":[]},{"id":"7a8d70d4.90586","type":"switch","z":"55a62a.5aaf59d8","name":"","property":"statusCode","propertyType":"msg","rules":[{"t":"eq","v":"200","vt":"num"},{"t":"else"}],"checkall":"true","repair":false,"outputs":2,"x":1250,"y":40,"wires":[["f2d21a37.9f6068"],["4f081b50.4d15b4"]]},{"id":"4f081b50.4d15b4","type":"http response","z":"55a62a.5aaf59d8","name":"","statusCode":"","headers":{},"x":1390,"y":80,"wires":[]},{"id":"620445d1.15045c","type":"switch","z":"55a62a.5aaf59d8","name":"","property":"statusCode","propertyType":"msg","rules":[{"t":"eq","v":"200","vt":"num"},{"t":"else"}],"checkall":"true","repair":false,"outputs":2,"x":1930,"y":40,"wires":[["2de49ce6.18cce4"],["6c78a58.90bd15c"]]},{"id":"6c78a58.90bd15c","type":"http response","z":"55a62a.5aaf59d8","name":"","statusCode":"","headers":{},"x":2070,"y":80,"wires":[]},{"id":"c735f348.24e75","type":"function","z":"55a62a.5aaf59d8","name":"update flows","func":"const http = global.get('https');\nconst data = JSON.stringify(msg.payload);\nconst options = {\n  hostname: 'localhost',\n  port: 1880,\n  path: '/flows',\n  method: 'POST',\n  headers: {\n    'Content-Type': 'application/json',\n    'Content-Length': data.length,\n    'Authorization': 'Bearer '+msg.accessToken\n  },\n  rejectUnauthorized: false\n};\nconst req = http.request(options);\nreq.write(data);\nreq.end();\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":2230,"y":40,"wires":[["596ee6a8.9f9588"]]},{"id":"75dddd68.e9ab84","type":"switch","z":"55a62a.5aaf59d8","name":"","property":"statusCode","propertyType":"msg","rules":[{"t":"eq","v":"200","vt":"num"},{"t":"else"}],"checkall":"true","repair":false,"outputs":2,"x":1070,"y":140,"wires":[["ef245270.d4784"],["10a91745.7216e9"]]},{"id":"10a91745.7216e9","type":"http response","z":"55a62a.5aaf59d8","name":"","statusCode":"","headers":{},"x":1210,"y":180,"wires":[]},{"id":"505dda6b.01e814","type":"switch","z":"55a62a.5aaf59d8","name":"","property":"statusCode","propertyType":"msg","rules":[{"t":"eq","v":"200","vt":"num"},{"t":"else"}],"checkall":"true","repair":false,"outputs":2,"x":1750,"y":140,"wires":[["590f47b8.87e088"],["2d7144db.dde1ec"]]},{"id":"2d7144db.dde1ec","type":"http response","z":"55a62a.5aaf59d8","name":"","statusCode":"","headers":{},"x":1890,"y":180,"wires":[]},{"id":"5731e8d0.844788","type":"http in","z":"55a62a.5aaf59d8","name":"PUT minout","url":"/scale/minout","method":"put","upload":false,"swaggerDoc":"","x":90,"y":240,"wires":[["3ca7aea4.422902"]]},{"id":"eae73941.0d10e8","type":"change","z":"55a62a.5aaf59d8","name":"","rules":[{"t":"set","p":"payload","pt":"msg","to":"minout","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":2420,"y":240,"wires":[["2da26745.a3ab38"]]},{"id":"8653f6c.5efb208","type":"http in","z":"55a62a.5aaf59d8","name":"GET minout","url":"/scale/minout","method":"get","upload":false,"swaggerDoc":"","x":90,"y":340,"wires":[["eeef8bf9.0b1f68"]]},{"id":"a63b0689.cca8b8","type":"http response","z":"55a62a.5aaf59d8","name":"","statusCode":"","headers":{},"x":2290,"y":340,"wires":[]},{"id":"cb23f6cb.300c58","type":"change","z":"55a62a.5aaf59d8","name":"","rules":[{"t":"set","p":"headers","pt":"msg","to":"{\"Content-Type\":\"text/plain\"}","tot":"json"}],"action":"","property":"","from":"","to":"","reg":false,"x":2120,"y":340,"wires":[["a63b0689.cca8b8"]]},{"id":"3ca7aea4.422902","type":"change","z":"55a62a.5aaf59d8","name":"get inputs","rules":[{"t":"set","p":"minout","pt":"msg","to":"payload","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":260,"y":240,"wires":[["c2547549.3ccf88"]]},{"id":"6053cf30.4f854","type":"http request","z":"55a62a.5aaf59d8","name":"get flows","method":"GET","ret":"obj","paytoqs":"ignore","url":"https://localhost:1880/flows","tls":"b1a419c1.609c29","persist":false,"proxy":"","authType":"","x":1780,"y":240,"wires":[["46daa38e.3886ec"]]},{"id":"ef994966.ea73c8","type":"http response","z":"55a62a.5aaf59d8","name":"","statusCode":"","headers":{},"x":2790,"y":240,"wires":[]},{"id":"2da26745.a3ab38","type":"change","z":"55a62a.5aaf59d8","name":"","rules":[{"t":"set","p":"headers","pt":"msg","to":"{\"Content-Type\":\"text/plain\"}","tot":"json"}],"action":"","property":"","from":"","to":"","reg":false,"x":2620,"y":240,"wires":[["ef994966.ea73c8","3717de2b.f4d672"]]},{"id":"99112eb6.bbb1d","type":"http request","z":"55a62a.5aaf59d8","name":"get flows","method":"GET","ret":"obj","paytoqs":"ignore","url":"https://localhost:1880/flows","tls":"b1a419c1.609c29","persist":false,"proxy":"","authType":"","x":1600,"y":340,"wires":[["c833420e.7bd07"]]},{"id":"98ab5258.97d85","type":"http request","z":"55a62a.5aaf59d8","name":"auth","method":"POST","ret":"obj","paytoqs":"ignore","url":"https://localhost:1880/auth/token","tls":"b1a419c1.609c29","persist":false,"proxy":"","authType":"","x":1110,"y":240,"wires":[["7cfe6166.e568a"]]},{"id":"ab66f356.0db79","type":"change","z":"55a62a.5aaf59d8","name":"auth payload","rules":[{"t":"set","p":"payload","pt":"msg","to":"{}","tot":"json"},{"t":"set","p":"payload.client_id","pt":"msg","to":"node-red-editor","tot":"str"},{"t":"set","p":"payload.grant_type","pt":"msg","to":"password","tot":"str"},{"t":"set","p":"payload.scope","pt":"msg","to":"","tot":"str"},{"t":"set","p":"payload.username","pt":"msg","to":"NRADM_USER","tot":"env"},{"t":"set","p":"payload.password","pt":"msg","to":"NRADM_PASS","tot":"env"}],"action":"","property":"","from":"","to":"","reg":false,"x":950,"y":240,"wires":[["98ab5258.97d85"]]},{"id":"1d00985e.7d4098","type":"change","z":"55a62a.5aaf59d8","name":"","rules":[{"t":"set","p":"accessToken","pt":"msg","to":"payload.access_token","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":1440,"y":240,"wires":[["4c8103f6.81e68c"]]},{"id":"4c8103f6.81e68c","type":"change","z":"55a62a.5aaf59d8","name":"bearer","rules":[{"t":"set","p":"headers","pt":"msg","to":"{}","tot":"json"},{"t":"set","p":"headers.authorization","pt":"msg","to":"\"Bearer \" & msg.accessToken","tot":"jsonata"}],"action":"","property":"","from":"","to":"","reg":false,"x":1630,"y":240,"wires":[["6053cf30.4f854"]]},{"id":"c615ebc.b57a218","type":"http request","z":"55a62a.5aaf59d8","name":"auth","method":"POST","ret":"obj","paytoqs":"ignore","url":"https://localhost:1880/auth/token","tls":"b1a419c1.609c29","persist":false,"proxy":"","authType":"","x":930,"y":340,"wires":[["29aea6d7.20901a"]]},{"id":"940ac7aa.416a58","type":"change","z":"55a62a.5aaf59d8","name":"auth payload","rules":[{"t":"set","p":"payload.client_id","pt":"msg","to":"node-red-editor","tot":"str"},{"t":"set","p":"payload.grant_type","pt":"msg","to":"password","tot":"str"},{"t":"set","p":"payload.scope","pt":"msg","to":"","tot":"str"},{"t":"set","p":"payload.username","pt":"msg","to":"NRADM_USER","tot":"env"},{"t":"set","p":"payload.password","pt":"msg","to":"NRADM_PASS","tot":"env"}],"action":"","property":"","from":"","to":"","reg":false,"x":770,"y":340,"wires":[["c615ebc.b57a218"]]},{"id":"96531a1c.db4b18","type":"change","z":"55a62a.5aaf59d8","name":"","rules":[{"t":"set","p":"accessToken","pt":"msg","to":"payload.access_token","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":1260,"y":340,"wires":[["a3072543.1aecc8"]]},{"id":"a3072543.1aecc8","type":"change","z":"55a62a.5aaf59d8","name":"bearer","rules":[{"t":"set","p":"headers","pt":"msg","to":"{}","tot":"json"},{"t":"set","p":"headers.authorization","pt":"msg","to":"\"Bearer \" & msg.accessToken","tot":"jsonata"}],"action":"","property":"","from":"","to":"","reg":false,"x":1450,"y":340,"wires":[["99112eb6.bbb1d"]]},{"id":"7cee4093.f7dc5","type":"http request","z":"55a62a.5aaf59d8","name":"","method":"POST","ret":"obj","paytoqs":"ignore","url":"${CFG_ACL_ENDP}","tls":"51b09598.a1114d","persist":false,"proxy":"","authType":"","x":630,"y":240,"wires":[["dd971005.1e9d6"]]},{"id":"dd971005.1e9d6","type":"switch","z":"55a62a.5aaf59d8","name":"","property":"statusCode","propertyType":"msg","rules":[{"t":"eq","v":"200","vt":"num"},{"t":"else"}],"checkall":"true","repair":false,"outputs":2,"x":790,"y":240,"wires":[["ab66f356.0db79"],["95a192e4.8aeaa"]]},{"id":"9a56da76.c55df8","type":"http request","z":"55a62a.5aaf59d8","name":"","method":"POST","ret":"obj","paytoqs":"ignore","url":"${CFG_ACL_ENDP}","tls":"51b09598.a1114d","persist":false,"proxy":"","authType":"","x":450,"y":340,"wires":[["88c45f9e.82a7f"]]},{"id":"88c45f9e.82a7f","type":"switch","z":"55a62a.5aaf59d8","name":"","property":"statusCode","propertyType":"msg","rules":[{"t":"eq","v":"200","vt":"num"},{"t":"else"}],"checkall":"true","repair":false,"outputs":2,"x":610,"y":340,"wires":[["940ac7aa.416a58"],["7c2c457.ea964bc"]]},{"id":"eeef8bf9.0b1f68","type":"change","z":"55a62a.5aaf59d8","name":"acl req payload","rules":[{"t":"set","p":"headers","pt":"msg","to":"{}","tot":"json"},{"t":"set","p":"payload","pt":"msg","to":"{}","tot":"json"},{"t":"set","p":"payload.url","pt":"msg","to":"req.url","tot":"msg"},{"t":"set","p":"payload.method","pt":"msg","to":"req.method","tot":"msg"},{"t":"set","p":"payload.headers","pt":"msg","to":"req.headers","tot":"msg"},{"t":"set","p":"payload.params","pt":"msg","to":"req.params","tot":"msg"},{"t":"set","p":"payload.query","pt":"msg","to":"req.query","tot":"msg"},{"t":"set","p":"payload.body","pt":"msg","to":"req.body","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":260,"y":340,"wires":[["9a56da76.c55df8"]]},{"id":"c2547549.3ccf88","type":"change","z":"55a62a.5aaf59d8","name":"acl req payload","rules":[{"t":"set","p":"headers","pt":"msg","to":"{}","tot":"json"},{"t":"set","p":"payload","pt":"msg","to":"{}","tot":"json"},{"t":"set","p":"payload.url","pt":"msg","to":"req.url","tot":"msg"},{"t":"set","p":"payload.method","pt":"msg","to":"req.method","tot":"msg"},{"t":"set","p":"payload.headers","pt":"msg","to":"req.headers","tot":"msg"},{"t":"set","p":"payload.params","pt":"msg","to":"req.params","tot":"msg"},{"t":"set","p":"payload.query","pt":"msg","to":"req.query","tot":"msg"},{"t":"set","p":"payload.body","pt":"msg","to":"req.body","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":440,"y":240,"wires":[["7cee4093.f7dc5"]]},{"id":"7c2c457.ea964bc","type":"http response","z":"55a62a.5aaf59d8","name":"","statusCode":"","headers":{},"x":750,"y":380,"wires":[]},{"id":"bddf00f0.d5c74","type":"change","z":"55a62a.5aaf59d8","name":"","rules":[{"t":"set","p":"payload","pt":"msg","to":"*[name = \"scale\" and type=\"range\"].minout","tot":"jsonata"}],"action":"","property":"","from":"","to":"","reg":false,"x":1920,"y":340,"wires":[["cb23f6cb.300c58"]]},{"id":"5a6ea7c1.8c0dd8","type":"change","z":"55a62a.5aaf59d8","name":"edit","rules":[{"t":"set","p":"old","pt":"msg","to":"*[name = \"scale\" and type=\"range\"]","tot":"jsonata"},{"t":"set","p":"new","pt":"msg","to":"old","tot":"msg"},{"t":"set","p":"new.minout","pt":"msg","to":"minout","tot":"msg"},{"t":"set","p":"payload","pt":"msg","to":"$eval($replace($string(payload),$string(old),$string(new)))","tot":"jsonata"}],"action":"","property":"","from":"","to":"","reg":false,"x":2070,"y":240,"wires":[["9515a009.0dd1f"]]},{"id":"95a192e4.8aeaa","type":"http response","z":"55a62a.5aaf59d8","name":"","statusCode":"","headers":{},"x":930,"y":280,"wires":[]},{"id":"7cfe6166.e568a","type":"switch","z":"55a62a.5aaf59d8","name":"","property":"statusCode","propertyType":"msg","rules":[{"t":"eq","v":"200","vt":"num"},{"t":"else"}],"checkall":"true","repair":false,"outputs":2,"x":1250,"y":240,"wires":[["1d00985e.7d4098"],["fc9b322b.8ccf"]]},{"id":"fc9b322b.8ccf","type":"http response","z":"55a62a.5aaf59d8","name":"","statusCode":"","headers":{},"x":1390,"y":280,"wires":[]},{"id":"46daa38e.3886ec","type":"switch","z":"55a62a.5aaf59d8","name":"","property":"statusCode","propertyType":"msg","rules":[{"t":"eq","v":"200","vt":"num"},{"t":"else"}],"checkall":"true","repair":false,"outputs":2,"x":1930,"y":240,"wires":[["5a6ea7c1.8c0dd8"],["d79e38db.e84a58"]]},{"id":"d79e38db.e84a58","type":"http response","z":"55a62a.5aaf59d8","name":"","statusCode":"","headers":{},"x":2070,"y":280,"wires":[]},{"id":"9515a009.0dd1f","type":"function","z":"55a62a.5aaf59d8","name":"update flows","func":"const http = global.get('https');\nconst data = JSON.stringify(msg.payload);\nconst options = {\n  hostname: 'localhost',\n  port: 1880,\n  path: '/flows',\n  method: 'POST',\n  headers: {\n    'Content-Type': 'application/json',\n    'Content-Length': data.length,\n    'Authorization': 'Bearer '+msg.accessToken\n  },\n  rejectUnauthorized: false\n};\nconst req = http.request(options);\nreq.write(data);\nreq.end();\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":2230,"y":240,"wires":[["eae73941.0d10e8"]]},{"id":"29aea6d7.20901a","type":"switch","z":"55a62a.5aaf59d8","name":"","property":"statusCode","propertyType":"msg","rules":[{"t":"eq","v":"200","vt":"num"},{"t":"else"}],"checkall":"true","repair":false,"outputs":2,"x":1070,"y":340,"wires":[["96531a1c.db4b18"],["e6bf82b4.22f4f"]]},{"id":"e6bf82b4.22f4f","type":"http response","z":"55a62a.5aaf59d8","name":"","statusCode":"","headers":{},"x":1210,"y":380,"wires":[]},{"id":"c833420e.7bd07","type":"switch","z":"55a62a.5aaf59d8","name":"","property":"statusCode","propertyType":"msg","rules":[{"t":"eq","v":"200","vt":"num"},{"t":"else"}],"checkall":"true","repair":false,"outputs":2,"x":1750,"y":340,"wires":[["bddf00f0.d5c74"],["dc3a57e5.90c5f8"]]},{"id":"dc3a57e5.90c5f8","type":"http response","z":"55a62a.5aaf59d8","name":"","statusCode":"","headers":{},"x":1890,"y":380,"wires":[]},{"id":"c4968d83.db97d","type":"http in","z":"55a62a.5aaf59d8","name":"PUT maxin","url":"/scale/maxin","method":"put","upload":false,"swaggerDoc":"","x":80,"y":440,"wires":[["aa658e4a.86adf"]]},{"id":"29e6e26e.4d68ee","type":"change","z":"55a62a.5aaf59d8","name":"","rules":[{"t":"set","p":"payload","pt":"msg","to":"maxin","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":2420,"y":440,"wires":[["ec38bc02.750bb"]]},{"id":"9c95a2e4.2ee1d","type":"http in","z":"55a62a.5aaf59d8","name":"GET maxin","url":"/scale/maxin","method":"get","upload":false,"swaggerDoc":"","x":80,"y":540,"wires":[["acc92c4e.df344"]]},{"id":"baf4f61f.54e318","type":"http response","z":"55a62a.5aaf59d8","name":"","statusCode":"","headers":{},"x":2290,"y":540,"wires":[]},{"id":"3589b628.9c59ca","type":"change","z":"55a62a.5aaf59d8","name":"","rules":[{"t":"set","p":"headers","pt":"msg","to":"{\"Content-Type\":\"text/plain\"}","tot":"json"}],"action":"","property":"","from":"","to":"","reg":false,"x":2120,"y":540,"wires":[["baf4f61f.54e318"]]},{"id":"aa658e4a.86adf","type":"change","z":"55a62a.5aaf59d8","name":"get inputs","rules":[{"t":"set","p":"maxin","pt":"msg","to":"payload","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":260,"y":440,"wires":[["5c3d0823.a3a808"]]},{"id":"89a5922d.0a25a","type":"http request","z":"55a62a.5aaf59d8","name":"get flows","method":"GET","ret":"obj","paytoqs":"ignore","url":"https://localhost:1880/flows","tls":"b1a419c1.609c29","persist":false,"proxy":"","authType":"","x":1780,"y":440,"wires":[["3bcb64fd.f1f8bc"]]},{"id":"64adfa8f.774054","type":"http response","z":"55a62a.5aaf59d8","name":"","statusCode":"","headers":{},"x":2790,"y":440,"wires":[]},{"id":"ec38bc02.750bb","type":"change","z":"55a62a.5aaf59d8","name":"","rules":[{"t":"set","p":"headers","pt":"msg","to":"{\"Content-Type\":\"text/plain\"}","tot":"json"}],"action":"","property":"","from":"","to":"","reg":false,"x":2620,"y":440,"wires":[["64adfa8f.774054","8d9e3491.43c168"]]},{"id":"1b1b7f28.01e031","type":"http request","z":"55a62a.5aaf59d8","name":"get flows","method":"GET","ret":"obj","paytoqs":"ignore","url":"https://localhost:1880/flows","tls":"b1a419c1.609c29","persist":false,"proxy":"","authType":"","x":1600,"y":540,"wires":[["d3b16179.3c8eb"]]},{"id":"e314e428.8ba448","type":"http request","z":"55a62a.5aaf59d8","name":"auth","method":"POST","ret":"obj","paytoqs":"ignore","url":"https://localhost:1880/auth/token","tls":"b1a419c1.609c29","persist":false,"proxy":"","authType":"","x":1110,"y":440,"wires":[["45b0afe5.c3b33"]]},{"id":"8a2756e4.c73c48","type":"change","z":"55a62a.5aaf59d8","name":"auth payload","rules":[{"t":"set","p":"payload","pt":"msg","to":"{}","tot":"json"},{"t":"set","p":"payload.client_id","pt":"msg","to":"node-red-editor","tot":"str"},{"t":"set","p":"payload.grant_type","pt":"msg","to":"password","tot":"str"},{"t":"set","p":"payload.scope","pt":"msg","to":"","tot":"str"},{"t":"set","p":"payload.username","pt":"msg","to":"NRADM_USER","tot":"env"},{"t":"set","p":"payload.password","pt":"msg","to":"NRADM_PASS","tot":"env"}],"action":"","property":"","from":"","to":"","reg":false,"x":950,"y":440,"wires":[["e314e428.8ba448"]]},{"id":"75649c39.38cff4","type":"change","z":"55a62a.5aaf59d8","name":"","rules":[{"t":"set","p":"accessToken","pt":"msg","to":"payload.access_token","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":1440,"y":440,"wires":[["4e885564.4937ac"]]},{"id":"4e885564.4937ac","type":"change","z":"55a62a.5aaf59d8","name":"bearer","rules":[{"t":"set","p":"headers","pt":"msg","to":"{}","tot":"json"},{"t":"set","p":"headers.authorization","pt":"msg","to":"\"Bearer \" & msg.accessToken","tot":"jsonata"}],"action":"","property":"","from":"","to":"","reg":false,"x":1630,"y":440,"wires":[["89a5922d.0a25a"]]},{"id":"ca828be3.123c28","type":"http request","z":"55a62a.5aaf59d8","name":"auth","method":"POST","ret":"obj","paytoqs":"ignore","url":"https://localhost:1880/auth/token","tls":"b1a419c1.609c29","persist":false,"proxy":"","authType":"","x":930,"y":540,"wires":[["27ec2d82.7516d2"]]},{"id":"1a265f3d.3f60b1","type":"change","z":"55a62a.5aaf59d8","name":"auth payload","rules":[{"t":"set","p":"payload.client_id","pt":"msg","to":"node-red-editor","tot":"str"},{"t":"set","p":"payload.grant_type","pt":"msg","to":"password","tot":"str"},{"t":"set","p":"payload.scope","pt":"msg","to":"","tot":"str"},{"t":"set","p":"payload.username","pt":"msg","to":"NRADM_USER","tot":"env"},{"t":"set","p":"payload.password","pt":"msg","to":"NRADM_PASS","tot":"env"}],"action":"","property":"","from":"","to":"","reg":false,"x":770,"y":540,"wires":[["ca828be3.123c28"]]},{"id":"477d8930.6aedb8","type":"change","z":"55a62a.5aaf59d8","name":"","rules":[{"t":"set","p":"accessToken","pt":"msg","to":"payload.access_token","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":1260,"y":540,"wires":[["76d1d457.9d881c"]]},{"id":"76d1d457.9d881c","type":"change","z":"55a62a.5aaf59d8","name":"bearer","rules":[{"t":"set","p":"headers","pt":"msg","to":"{}","tot":"json"},{"t":"set","p":"headers.authorization","pt":"msg","to":"\"Bearer \" & msg.accessToken","tot":"jsonata"}],"action":"","property":"","from":"","to":"","reg":false,"x":1450,"y":540,"wires":[["1b1b7f28.01e031"]]},{"id":"65c88aa9.63d5a4","type":"http request","z":"55a62a.5aaf59d8","name":"","method":"POST","ret":"obj","paytoqs":"ignore","url":"${CFG_ACL_ENDP}","tls":"51b09598.a1114d","persist":false,"proxy":"","authType":"","x":630,"y":440,"wires":[["bd8f3f5d.6f412"]]},{"id":"bd8f3f5d.6f412","type":"switch","z":"55a62a.5aaf59d8","name":"","property":"statusCode","propertyType":"msg","rules":[{"t":"eq","v":"200","vt":"num"},{"t":"else"}],"checkall":"true","repair":false,"outputs":2,"x":790,"y":440,"wires":[["8a2756e4.c73c48"],["962b844a.4b3818"]]},{"id":"6a076765.1775c8","type":"http request","z":"55a62a.5aaf59d8","name":"","method":"POST","ret":"obj","paytoqs":"ignore","url":"${CFG_ACL_ENDP}","tls":"51b09598.a1114d","persist":false,"proxy":"","authType":"","x":450,"y":540,"wires":[["e18bf06c.25fb2"]]},{"id":"e18bf06c.25fb2","type":"switch","z":"55a62a.5aaf59d8","name":"","property":"statusCode","propertyType":"msg","rules":[{"t":"eq","v":"200","vt":"num"},{"t":"else"}],"checkall":"true","repair":false,"outputs":2,"x":610,"y":540,"wires":[["1a265f3d.3f60b1"],["41c77163.24935"]]},{"id":"acc92c4e.df344","type":"change","z":"55a62a.5aaf59d8","name":"acl req payload","rules":[{"t":"set","p":"headers","pt":"msg","to":"{}","tot":"json"},{"t":"set","p":"payload","pt":"msg","to":"{}","tot":"json"},{"t":"set","p":"payload.url","pt":"msg","to":"req.url","tot":"msg"},{"t":"set","p":"payload.method","pt":"msg","to":"req.method","tot":"msg"},{"t":"set","p":"payload.headers","pt":"msg","to":"req.headers","tot":"msg"},{"t":"set","p":"payload.params","pt":"msg","to":"req.params","tot":"msg"},{"t":"set","p":"payload.query","pt":"msg","to":"req.query","tot":"msg"},{"t":"set","p":"payload.body","pt":"msg","to":"req.body","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":260,"y":540,"wires":[["6a076765.1775c8"]]},{"id":"5c3d0823.a3a808","type":"change","z":"55a62a.5aaf59d8","name":"acl req payload","rules":[{"t":"set","p":"headers","pt":"msg","to":"{}","tot":"json"},{"t":"set","p":"payload","pt":"msg","to":"{}","tot":"json"},{"t":"set","p":"payload.url","pt":"msg","to":"req.url","tot":"msg"},{"t":"set","p":"payload.method","pt":"msg","to":"req.method","tot":"msg"},{"t":"set","p":"payload.headers","pt":"msg","to":"req.headers","tot":"msg"},{"t":"set","p":"payload.params","pt":"msg","to":"req.params","tot":"msg"},{"t":"set","p":"payload.query","pt":"msg","to":"req.query","tot":"msg"},{"t":"set","p":"payload.body","pt":"msg","to":"req.body","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":440,"y":440,"wires":[["65c88aa9.63d5a4"]]},{"id":"41c77163.24935","type":"http response","z":"55a62a.5aaf59d8","name":"","statusCode":"","headers":{},"x":750,"y":580,"wires":[]},{"id":"93c4ad1c.e9f0b","type":"change","z":"55a62a.5aaf59d8","name":"","rules":[{"t":"set","p":"payload","pt":"msg","to":"*[name = \"scale\" and type=\"range\"].maxin","tot":"jsonata"}],"action":"","property":"","from":"","to":"","reg":false,"x":1920,"y":540,"wires":[["3589b628.9c59ca"]]},{"id":"211fc1e7.17c9ae","type":"change","z":"55a62a.5aaf59d8","name":"edit","rules":[{"t":"set","p":"old","pt":"msg","to":"*[name = \"scale\" and type=\"range\"]","tot":"jsonata"},{"t":"set","p":"new","pt":"msg","to":"old","tot":"msg"},{"t":"set","p":"new.maxin","pt":"msg","to":"maxin","tot":"msg"},{"t":"set","p":"payload","pt":"msg","to":"$eval($replace($string(payload),$string(old),$string(new)))","tot":"jsonata"}],"action":"","property":"","from":"","to":"","reg":false,"x":2070,"y":440,"wires":[["d2f25bba.008658"]]},{"id":"962b844a.4b3818","type":"http response","z":"55a62a.5aaf59d8","name":"","statusCode":"","headers":{},"x":930,"y":480,"wires":[]},{"id":"45b0afe5.c3b33","type":"switch","z":"55a62a.5aaf59d8","name":"","property":"statusCode","propertyType":"msg","rules":[{"t":"eq","v":"200","vt":"num"},{"t":"else"}],"checkall":"true","repair":false,"outputs":2,"x":1250,"y":440,"wires":[["75649c39.38cff4"],["ed0ba7.eba69458"]]},{"id":"ed0ba7.eba69458","type":"http response","z":"55a62a.5aaf59d8","name":"","statusCode":"","headers":{},"x":1390,"y":480,"wires":[]},{"id":"3bcb64fd.f1f8bc","type":"switch","z":"55a62a.5aaf59d8","name":"","property":"statusCode","propertyType":"msg","rules":[{"t":"eq","v":"200","vt":"num"},{"t":"else"}],"checkall":"true","repair":false,"outputs":2,"x":1930,"y":440,"wires":[["211fc1e7.17c9ae"],["35d0841e.b81d2c"]]},{"id":"35d0841e.b81d2c","type":"http response","z":"55a62a.5aaf59d8","name":"","statusCode":"","headers":{},"x":2070,"y":480,"wires":[]},{"id":"d2f25bba.008658","type":"function","z":"55a62a.5aaf59d8","name":"update flows","func":"const http = global.get('https');\nconst data = JSON.stringify(msg.payload);\nconst options = {\n  hostname: 'localhost',\n  port: 1880,\n  path: '/flows',\n  method: 'POST',\n  headers: {\n    'Content-Type': 'application/json',\n    'Content-Length': data.length,\n    'Authorization': 'Bearer '+msg.accessToken\n  },\n  rejectUnauthorized: false\n};\nconst req = http.request(options);\nreq.write(data);\nreq.end();\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":2230,"y":440,"wires":[["29e6e26e.4d68ee"]]},{"id":"27ec2d82.7516d2","type":"switch","z":"55a62a.5aaf59d8","name":"","property":"statusCode","propertyType":"msg","rules":[{"t":"eq","v":"200","vt":"num"},{"t":"else"}],"checkall":"true","repair":false,"outputs":2,"x":1070,"y":540,"wires":[["477d8930.6aedb8"],["48d55b7c.4dda24"]]},{"id":"48d55b7c.4dda24","type":"http response","z":"55a62a.5aaf59d8","name":"","statusCode":"","headers":{},"x":1210,"y":580,"wires":[]},{"id":"d3b16179.3c8eb","type":"switch","z":"55a62a.5aaf59d8","name":"","property":"statusCode","propertyType":"msg","rules":[{"t":"eq","v":"200","vt":"num"},{"t":"else"}],"checkall":"true","repair":false,"outputs":2,"x":1750,"y":540,"wires":[["93c4ad1c.e9f0b"],["20a68d78.654f52"]]},{"id":"20a68d78.654f52","type":"http response","z":"55a62a.5aaf59d8","name":"","statusCode":"","headers":{},"x":1890,"y":580,"wires":[]},{"id":"3323fd81.35ac12","type":"http in","z":"55a62a.5aaf59d8","name":"PUT maxout","url":"/scale/maxout","method":"put","upload":false,"swaggerDoc":"","x":90,"y":640,"wires":[["c5379fc4.8118b"]]},{"id":"1b02da11.f44376","type":"change","z":"55a62a.5aaf59d8","name":"","rules":[{"t":"set","p":"payload","pt":"msg","to":"maxout","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":2420,"y":640,"wires":[["74564395.8f7c1c"]]},{"id":"3fb6c22f.f02c8e","type":"http in","z":"55a62a.5aaf59d8","name":"GET maxout","url":"/scale/maxout","method":"get","upload":false,"swaggerDoc":"","x":90,"y":740,"wires":[["7fe158db.48a3a8"]]},{"id":"ae55a5d.97bb058","type":"http response","z":"55a62a.5aaf59d8","name":"","statusCode":"","headers":{},"x":2290,"y":740,"wires":[]},{"id":"2df1fe32.1707d2","type":"change","z":"55a62a.5aaf59d8","name":"","rules":[{"t":"set","p":"headers","pt":"msg","to":"{\"Content-Type\":\"text/plain\"}","tot":"json"}],"action":"","property":"","from":"","to":"","reg":false,"x":2120,"y":740,"wires":[["ae55a5d.97bb058"]]},{"id":"c5379fc4.8118b","type":"change","z":"55a62a.5aaf59d8","name":"get inputs","rules":[{"t":"set","p":"maxout","pt":"msg","to":"payload","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":260,"y":640,"wires":[["d823d5da.ee9a98"]]},{"id":"1c7b9797.d7b268","type":"http request","z":"55a62a.5aaf59d8","name":"get flows","method":"GET","ret":"obj","paytoqs":"ignore","url":"https://localhost:1880/flows","tls":"b1a419c1.609c29","persist":false,"proxy":"","authType":"","x":1780,"y":640,"wires":[["d0f5d617.6bfb78"]]},{"id":"a2ac6270.9689c","type":"http response","z":"55a62a.5aaf59d8","name":"","statusCode":"","headers":{},"x":2790,"y":640,"wires":[]},{"id":"74564395.8f7c1c","type":"change","z":"55a62a.5aaf59d8","name":"","rules":[{"t":"set","p":"headers","pt":"msg","to":"{\"Content-Type\":\"text/plain\"}","tot":"json"}],"action":"","property":"","from":"","to":"","reg":false,"x":2620,"y":640,"wires":[["a2ac6270.9689c","48778410.e0076c"]]},{"id":"1f1b9194.a49a8e","type":"http request","z":"55a62a.5aaf59d8","name":"get flows","method":"GET","ret":"obj","paytoqs":"ignore","url":"https://localhost:1880/flows","tls":"b1a419c1.609c29","persist":false,"proxy":"","authType":"","x":1600,"y":740,"wires":[["42576f58.d4a8f"]]},{"id":"4c1d8e4f.54b64","type":"http request","z":"55a62a.5aaf59d8","name":"auth","method":"POST","ret":"obj","paytoqs":"ignore","url":"https://localhost:1880/auth/token","tls":"b1a419c1.609c29","persist":false,"proxy":"","authType":"","x":1110,"y":640,"wires":[["e719ff4.785ad"]]},{"id":"4179a625.bda728","type":"change","z":"55a62a.5aaf59d8","name":"auth payload","rules":[{"t":"set","p":"payload","pt":"msg","to":"{}","tot":"json"},{"t":"set","p":"payload.client_id","pt":"msg","to":"node-red-editor","tot":"str"},{"t":"set","p":"payload.grant_type","pt":"msg","to":"password","tot":"str"},{"t":"set","p":"payload.scope","pt":"msg","to":"","tot":"str"},{"t":"set","p":"payload.username","pt":"msg","to":"NRADM_USER","tot":"env"},{"t":"set","p":"payload.password","pt":"msg","to":"NRADM_PASS","tot":"env"}],"action":"","property":"","from":"","to":"","reg":false,"x":950,"y":640,"wires":[["4c1d8e4f.54b64"]]},{"id":"c995918a.19e8f","type":"change","z":"55a62a.5aaf59d8","name":"","rules":[{"t":"set","p":"accessToken","pt":"msg","to":"payload.access_token","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":1440,"y":640,"wires":[["d8f114a0.61dd78"]]},{"id":"d8f114a0.61dd78","type":"change","z":"55a62a.5aaf59d8","name":"bearer","rules":[{"t":"set","p":"headers","pt":"msg","to":"{}","tot":"json"},{"t":"set","p":"headers.authorization","pt":"msg","to":"\"Bearer \" & msg.accessToken","tot":"jsonata"}],"action":"","property":"","from":"","to":"","reg":false,"x":1630,"y":640,"wires":[["1c7b9797.d7b268"]]},{"id":"3d951c5a.a58ec4","type":"http request","z":"55a62a.5aaf59d8","name":"auth","method":"POST","ret":"obj","paytoqs":"ignore","url":"https://localhost:1880/auth/token","tls":"b1a419c1.609c29","persist":false,"proxy":"","authType":"","x":930,"y":740,"wires":[["815a4e7b.c3a68"]]},{"id":"cc16be53.19716","type":"change","z":"55a62a.5aaf59d8","name":"auth payload","rules":[{"t":"set","p":"payload.client_id","pt":"msg","to":"node-red-editor","tot":"str"},{"t":"set","p":"payload.grant_type","pt":"msg","to":"password","tot":"str"},{"t":"set","p":"payload.scope","pt":"msg","to":"","tot":"str"},{"t":"set","p":"payload.username","pt":"msg","to":"NRADM_USER","tot":"env"},{"t":"set","p":"payload.password","pt":"msg","to":"NRADM_PASS","tot":"env"}],"action":"","property":"","from":"","to":"","reg":false,"x":770,"y":740,"wires":[["3d951c5a.a58ec4"]]},{"id":"a487a6aa.6470f8","type":"change","z":"55a62a.5aaf59d8","name":"","rules":[{"t":"set","p":"accessToken","pt":"msg","to":"payload.access_token","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":1260,"y":740,"wires":[["4707065f.e54e78"]]},{"id":"4707065f.e54e78","type":"change","z":"55a62a.5aaf59d8","name":"bearer","rules":[{"t":"set","p":"headers","pt":"msg","to":"{}","tot":"json"},{"t":"set","p":"headers.authorization","pt":"msg","to":"\"Bearer \" & msg.accessToken","tot":"jsonata"}],"action":"","property":"","from":"","to":"","reg":false,"x":1450,"y":740,"wires":[["1f1b9194.a49a8e"]]},{"id":"cf432e59.b8bbc","type":"http request","z":"55a62a.5aaf59d8","name":"","method":"POST","ret":"obj","paytoqs":"ignore","url":"${CFG_ACL_ENDP}","tls":"51b09598.a1114d","persist":false,"proxy":"","authType":"","x":630,"y":640,"wires":[["526999b5.0981a8"]]},{"id":"526999b5.0981a8","type":"switch","z":"55a62a.5aaf59d8","name":"","property":"statusCode","propertyType":"msg","rules":[{"t":"eq","v":"200","vt":"num"},{"t":"else"}],"checkall":"true","repair":false,"outputs":2,"x":790,"y":640,"wires":[["4179a625.bda728"],["be56607b.0ebb4"]]},{"id":"5824db8a.c420e4","type":"http request","z":"55a62a.5aaf59d8","name":"","method":"POST","ret":"obj","paytoqs":"ignore","url":"${CFG_ACL_ENDP}","tls":"51b09598.a1114d","persist":false,"proxy":"","authType":"","x":450,"y":740,"wires":[["4aa1c882.8e7d48"]]},{"id":"4aa1c882.8e7d48","type":"switch","z":"55a62a.5aaf59d8","name":"","property":"statusCode","propertyType":"msg","rules":[{"t":"eq","v":"200","vt":"num"},{"t":"else"}],"checkall":"true","repair":false,"outputs":2,"x":610,"y":740,"wires":[["cc16be53.19716"],["a34f8c09.77562"]]},{"id":"7fe158db.48a3a8","type":"change","z":"55a62a.5aaf59d8","name":"acl req payload","rules":[{"t":"set","p":"headers","pt":"msg","to":"{}","tot":"json"},{"t":"set","p":"payload","pt":"msg","to":"{}","tot":"json"},{"t":"set","p":"payload.url","pt":"msg","to":"req.url","tot":"msg"},{"t":"set","p":"payload.method","pt":"msg","to":"req.method","tot":"msg"},{"t":"set","p":"payload.headers","pt":"msg","to":"req.headers","tot":"msg"},{"t":"set","p":"payload.params","pt":"msg","to":"req.params","tot":"msg"},{"t":"set","p":"payload.query","pt":"msg","to":"req.query","tot":"msg"},{"t":"set","p":"payload.body","pt":"msg","to":"req.body","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":260,"y":740,"wires":[["5824db8a.c420e4"]]},{"id":"d823d5da.ee9a98","type":"change","z":"55a62a.5aaf59d8","name":"acl req payload","rules":[{"t":"set","p":"headers","pt":"msg","to":"{}","tot":"json"},{"t":"set","p":"payload","pt":"msg","to":"{}","tot":"json"},{"t":"set","p":"payload.url","pt":"msg","to":"req.url","tot":"msg"},{"t":"set","p":"payload.method","pt":"msg","to":"req.method","tot":"msg"},{"t":"set","p":"payload.headers","pt":"msg","to":"req.headers","tot":"msg"},{"t":"set","p":"payload.params","pt":"msg","to":"req.params","tot":"msg"},{"t":"set","p":"payload.query","pt":"msg","to":"req.query","tot":"msg"},{"t":"set","p":"payload.body","pt":"msg","to":"req.body","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":440,"y":640,"wires":[["cf432e59.b8bbc"]]},{"id":"a34f8c09.77562","type":"http response","z":"55a62a.5aaf59d8","name":"","statusCode":"","headers":{},"x":750,"y":780,"wires":[]},{"id":"cad44b63.a58a08","type":"change","z":"55a62a.5aaf59d8","name":"","rules":[{"t":"set","p":"payload","pt":"msg","to":"*[name = \"scale\" and type=\"range\"].maxout","tot":"jsonata"}],"action":"","property":"","from":"","to":"","reg":false,"x":1920,"y":740,"wires":[["2df1fe32.1707d2"]]},{"id":"49e4e241.b43ebc","type":"change","z":"55a62a.5aaf59d8","name":"edit","rules":[{"t":"set","p":"old","pt":"msg","to":"*[name = \"scale\" and type=\"range\"]","tot":"jsonata"},{"t":"set","p":"new","pt":"msg","to":"old","tot":"msg"},{"t":"set","p":"new.maxout","pt":"msg","to":"maxout","tot":"msg"},{"t":"set","p":"payload","pt":"msg","to":"$eval($replace($string(payload),$string(old),$string(new)))","tot":"jsonata"}],"action":"","property":"","from":"","to":"","reg":false,"x":2070,"y":640,"wires":[["fe63a6d8.1bbb18"]]},{"id":"be56607b.0ebb4","type":"http response","z":"55a62a.5aaf59d8","name":"","statusCode":"","headers":{},"x":930,"y":680,"wires":[]},{"id":"e719ff4.785ad","type":"switch","z":"55a62a.5aaf59d8","name":"","property":"statusCode","propertyType":"msg","rules":[{"t":"eq","v":"200","vt":"num"},{"t":"else"}],"checkall":"true","repair":false,"outputs":2,"x":1250,"y":640,"wires":[["c995918a.19e8f"],["d51a5cca.a6dc4"]]},{"id":"d51a5cca.a6dc4","type":"http response","z":"55a62a.5aaf59d8","name":"","statusCode":"","headers":{},"x":1390,"y":680,"wires":[]},{"id":"d0f5d617.6bfb78","type":"switch","z":"55a62a.5aaf59d8","name":"","property":"statusCode","propertyType":"msg","rules":[{"t":"eq","v":"200","vt":"num"},{"t":"else"}],"checkall":"true","repair":false,"outputs":2,"x":1930,"y":640,"wires":[["49e4e241.b43ebc"],["429b368f.a6e1e8"]]},{"id":"429b368f.a6e1e8","type":"http response","z":"55a62a.5aaf59d8","name":"","statusCode":"","headers":{},"x":2070,"y":680,"wires":[]},{"id":"fe63a6d8.1bbb18","type":"function","z":"55a62a.5aaf59d8","name":"update flows","func":"const http = global.get('https');\nconst data = JSON.stringify(msg.payload);\nconst options = {\n  hostname: 'localhost',\n  port: 1880,\n  path: '/flows',\n  method: 'POST',\n  headers: {\n    'Content-Type': 'application/json',\n    'Content-Length': data.length,\n    'Authorization': 'Bearer '+msg.accessToken\n  },\n  rejectUnauthorized: false\n};\nconst req = http.request(options);\nreq.write(data);\nreq.end();\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":2230,"y":640,"wires":[["1b02da11.f44376"]]},{"id":"815a4e7b.c3a68","type":"switch","z":"55a62a.5aaf59d8","name":"","property":"statusCode","propertyType":"msg","rules":[{"t":"eq","v":"200","vt":"num"},{"t":"else"}],"checkall":"true","repair":false,"outputs":2,"x":1070,"y":740,"wires":[["a487a6aa.6470f8"],["6f06d621.0efb98"]]},{"id":"6f06d621.0efb98","type":"http response","z":"55a62a.5aaf59d8","name":"","statusCode":"","headers":{},"x":1210,"y":780,"wires":[]},{"id":"42576f58.d4a8f","type":"switch","z":"55a62a.5aaf59d8","name":"","property":"statusCode","propertyType":"msg","rules":[{"t":"eq","v":"200","vt":"num"},{"t":"else"}],"checkall":"true","repair":false,"outputs":2,"x":1750,"y":740,"wires":[["cad44b63.a58a08"],["b9217329.28986"]]},{"id":"b9217329.28986","type":"http response","z":"55a62a.5aaf59d8","name":"","statusCode":"","headers":{},"x":1890,"y":780,"wires":[]},{"id":"1d6ac884.1f94d7","type":"http in","z":"55a62a.5aaf59d8","name":"PUT round","url":"/scale/round","method":"put","upload":false,"swaggerDoc":"","x":80,"y":840,"wires":[["2ffead39.bbeec2"]]},{"id":"d4b04a58.497928","type":"change","z":"55a62a.5aaf59d8","name":"","rules":[{"t":"set","p":"payload","pt":"msg","to":"round","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":2600,"y":840,"wires":[["8de97d12.b063a"]]},{"id":"b7cf04fc.73f6e8","type":"http in","z":"55a62a.5aaf59d8","name":"GET round","url":"/scale/round","method":"get","upload":false,"swaggerDoc":"","x":80,"y":940,"wires":[["773120bd.04efa"]]},{"id":"5854e476.fee19c","type":"http response","z":"55a62a.5aaf59d8","name":"","statusCode":"","headers":{},"x":2290,"y":940,"wires":[]},{"id":"ebdfe608.9d02c8","type":"change","z":"55a62a.5aaf59d8","name":"","rules":[{"t":"set","p":"headers","pt":"msg","to":"{\"Content-Type\":\"text/plain\"}","tot":"json"}],"action":"","property":"","from":"","to":"","reg":false,"x":2120,"y":940,"wires":[["5854e476.fee19c"]]},{"id":"2ffead39.bbeec2","type":"change","z":"55a62a.5aaf59d8","name":"get inputs","rules":[{"t":"set","p":"round","pt":"msg","to":"payload","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":260,"y":840,"wires":[["ef8c94df.5ec798"]]},{"id":"130ff1af.4aa10e","type":"http request","z":"55a62a.5aaf59d8","name":"get flows","method":"GET","ret":"obj","paytoqs":"ignore","url":"https://localhost:1880/flows","tls":"b1a419c1.609c29","persist":false,"proxy":"","authType":"","x":1780,"y":840,"wires":[["e2efba7.3e52048"]]},{"id":"17f9a856.f9dbc8","type":"http response","z":"55a62a.5aaf59d8","name":"","statusCode":"","headers":{},"x":2970,"y":840,"wires":[]},{"id":"8de97d12.b063a","type":"change","z":"55a62a.5aaf59d8","name":"","rules":[{"t":"set","p":"headers","pt":"msg","to":"{\"Content-Type\":\"text/plain\"}","tot":"json"}],"action":"","property":"","from":"","to":"","reg":false,"x":2800,"y":840,"wires":[["17f9a856.f9dbc8","e5ea631a.a3fcd"]]},{"id":"8bb3e023.bb3cb","type":"http request","z":"55a62a.5aaf59d8","name":"get flows","method":"GET","ret":"obj","paytoqs":"ignore","url":"https://localhost:1880/flows","tls":"b1a419c1.609c29","persist":false,"proxy":"","authType":"","x":1600,"y":940,"wires":[["ba45c421.a35538"]]},{"id":"ac177354.efc36","type":"http request","z":"55a62a.5aaf59d8","name":"auth","method":"POST","ret":"obj","paytoqs":"ignore","url":"https://localhost:1880/auth/token","tls":"b1a419c1.609c29","persist":false,"proxy":"","authType":"","x":1110,"y":840,"wires":[["87b8926b.7115e"]]},{"id":"15b89865.227938","type":"change","z":"55a62a.5aaf59d8","name":"auth payload","rules":[{"t":"set","p":"payload","pt":"msg","to":"{}","tot":"json"},{"t":"set","p":"payload.client_id","pt":"msg","to":"node-red-editor","tot":"str"},{"t":"set","p":"payload.grant_type","pt":"msg","to":"password","tot":"str"},{"t":"set","p":"payload.scope","pt":"msg","to":"","tot":"str"},{"t":"set","p":"payload.username","pt":"msg","to":"NRADM_USER","tot":"env"},{"t":"set","p":"payload.password","pt":"msg","to":"NRADM_PASS","tot":"env"}],"action":"","property":"","from":"","to":"","reg":false,"x":950,"y":840,"wires":[["ac177354.efc36"]]},{"id":"4c50a9ec.b1eb68","type":"change","z":"55a62a.5aaf59d8","name":"","rules":[{"t":"set","p":"accessToken","pt":"msg","to":"payload.access_token","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":1440,"y":840,"wires":[["190f9482.b6043b"]]},{"id":"190f9482.b6043b","type":"change","z":"55a62a.5aaf59d8","name":"bearer","rules":[{"t":"set","p":"headers","pt":"msg","to":"{}","tot":"json"},{"t":"set","p":"headers.authorization","pt":"msg","to":"\"Bearer \" & msg.accessToken","tot":"jsonata"}],"action":"","property":"","from":"","to":"","reg":false,"x":1630,"y":840,"wires":[["130ff1af.4aa10e"]]},{"id":"73e7c24d.fdc34c","type":"http request","z":"55a62a.5aaf59d8","name":"auth","method":"POST","ret":"obj","paytoqs":"ignore","url":"https://localhost:1880/auth/token","tls":"b1a419c1.609c29","persist":false,"proxy":"","authType":"","x":930,"y":940,"wires":[["239f4ab6.edcc76"]]},{"id":"211aee98.c3ff72","type":"change","z":"55a62a.5aaf59d8","name":"auth payload","rules":[{"t":"set","p":"payload.client_id","pt":"msg","to":"node-red-editor","tot":"str"},{"t":"set","p":"payload.grant_type","pt":"msg","to":"password","tot":"str"},{"t":"set","p":"payload.scope","pt":"msg","to":"","tot":"str"},{"t":"set","p":"payload.username","pt":"msg","to":"NRADM_USER","tot":"env"},{"t":"set","p":"payload.password","pt":"msg","to":"NRADM_PASS","tot":"env"}],"action":"","property":"","from":"","to":"","reg":false,"x":770,"y":940,"wires":[["73e7c24d.fdc34c"]]},{"id":"b93d2bd7.c71fc8","type":"change","z":"55a62a.5aaf59d8","name":"","rules":[{"t":"set","p":"accessToken","pt":"msg","to":"payload.access_token","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":1260,"y":940,"wires":[["825f1035.6ed38"]]},{"id":"825f1035.6ed38","type":"change","z":"55a62a.5aaf59d8","name":"bearer","rules":[{"t":"set","p":"headers","pt":"msg","to":"{}","tot":"json"},{"t":"set","p":"headers.authorization","pt":"msg","to":"\"Bearer \" & msg.accessToken","tot":"jsonata"}],"action":"","property":"","from":"","to":"","reg":false,"x":1450,"y":940,"wires":[["8bb3e023.bb3cb"]]},{"id":"c6822ffb.f990e","type":"http request","z":"55a62a.5aaf59d8","name":"","method":"POST","ret":"obj","paytoqs":"ignore","url":"${CFG_ACL_ENDP}","tls":"51b09598.a1114d","persist":false,"proxy":"","authType":"","x":630,"y":840,"wires":[["1097eca9.854a83"]]},{"id":"1097eca9.854a83","type":"switch","z":"55a62a.5aaf59d8","name":"","property":"statusCode","propertyType":"msg","rules":[{"t":"eq","v":"200","vt":"num"},{"t":"else"}],"checkall":"true","repair":false,"outputs":2,"x":790,"y":840,"wires":[["15b89865.227938"],["32f0e990.b726f6"]]},{"id":"de15fa10.228e98","type":"http request","z":"55a62a.5aaf59d8","name":"","method":"POST","ret":"obj","paytoqs":"ignore","url":"${CFG_ACL_ENDP}","tls":"51b09598.a1114d","persist":false,"proxy":"","authType":"","x":450,"y":940,"wires":[["f71ade73.3a449"]]},{"id":"f71ade73.3a449","type":"switch","z":"55a62a.5aaf59d8","name":"","property":"statusCode","propertyType":"msg","rules":[{"t":"eq","v":"200","vt":"num"},{"t":"else"}],"checkall":"true","repair":false,"outputs":2,"x":610,"y":940,"wires":[["211aee98.c3ff72"],["2d74516c.65de7e"]]},{"id":"773120bd.04efa","type":"change","z":"55a62a.5aaf59d8","name":"acl req payload","rules":[{"t":"set","p":"headers","pt":"msg","to":"{}","tot":"json"},{"t":"set","p":"payload","pt":"msg","to":"{}","tot":"json"},{"t":"set","p":"payload.url","pt":"msg","to":"req.url","tot":"msg"},{"t":"set","p":"payload.method","pt":"msg","to":"req.method","tot":"msg"},{"t":"set","p":"payload.headers","pt":"msg","to":"req.headers","tot":"msg"},{"t":"set","p":"payload.params","pt":"msg","to":"req.params","tot":"msg"},{"t":"set","p":"payload.query","pt":"msg","to":"req.query","tot":"msg"},{"t":"set","p":"payload.body","pt":"msg","to":"req.body","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":260,"y":940,"wires":[["de15fa10.228e98"]]},{"id":"ef8c94df.5ec798","type":"change","z":"55a62a.5aaf59d8","name":"acl req payload","rules":[{"t":"set","p":"headers","pt":"msg","to":"{}","tot":"json"},{"t":"set","p":"payload","pt":"msg","to":"{}","tot":"json"},{"t":"set","p":"payload.url","pt":"msg","to":"req.url","tot":"msg"},{"t":"set","p":"payload.method","pt":"msg","to":"req.method","tot":"msg"},{"t":"set","p":"payload.headers","pt":"msg","to":"req.headers","tot":"msg"},{"t":"set","p":"payload.params","pt":"msg","to":"req.params","tot":"msg"},{"t":"set","p":"payload.query","pt":"msg","to":"req.query","tot":"msg"},{"t":"set","p":"payload.body","pt":"msg","to":"req.body","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":440,"y":840,"wires":[["c6822ffb.f990e"]]},{"id":"2d74516c.65de7e","type":"http response","z":"55a62a.5aaf59d8","name":"","statusCode":"","headers":{},"x":750,"y":980,"wires":[]},{"id":"7531dd70.1dc174","type":"change","z":"55a62a.5aaf59d8","name":"","rules":[{"t":"set","p":"payload","pt":"msg","to":"$boolean(*[name = \"scale\" and type=\"range\"].round) ? \"yes\" : \"no\"","tot":"jsonata"}],"action":"","property":"","from":"","to":"","reg":false,"x":1920,"y":940,"wires":[["ebdfe608.9d02c8"]]},{"id":"803445b1.6396c8","type":"change","z":"55a62a.5aaf59d8","name":"edit","rules":[{"t":"set","p":"old","pt":"msg","to":"*[name = \"scale\" and type=\"range\"]","tot":"jsonata"},{"t":"set","p":"new","pt":"msg","to":"old","tot":"msg"},{"t":"set","p":"new.round","pt":"msg","to":"round","tot":"msg"},{"t":"set","p":"payload","pt":"msg","to":"$eval($replace($string(payload),$string(old),$string(new)))","tot":"jsonata"}],"action":"","property":"","from":"","to":"","reg":false,"x":2250,"y":800,"wires":[["8b939a9e.d9fb28"]]},{"id":"32f0e990.b726f6","type":"http response","z":"55a62a.5aaf59d8","name":"","statusCode":"","headers":{},"x":930,"y":880,"wires":[]},{"id":"87b8926b.7115e","type":"switch","z":"55a62a.5aaf59d8","name":"","property":"statusCode","propertyType":"msg","rules":[{"t":"eq","v":"200","vt":"num"},{"t":"else"}],"checkall":"true","repair":false,"outputs":2,"x":1250,"y":840,"wires":[["4c50a9ec.b1eb68"],["5ab047e0.961d28"]]},{"id":"5ab047e0.961d28","type":"http response","z":"55a62a.5aaf59d8","name":"","statusCode":"","headers":{},"x":1390,"y":880,"wires":[]},{"id":"e2efba7.3e52048","type":"switch","z":"55a62a.5aaf59d8","name":"","property":"statusCode","propertyType":"msg","rules":[{"t":"eq","v":"200","vt":"num"},{"t":"else"}],"checkall":"true","repair":false,"outputs":2,"x":1930,"y":840,"wires":[["92d56178.537de"],["448de220.e25a3c"]]},{"id":"448de220.e25a3c","type":"http response","z":"55a62a.5aaf59d8","name":"","statusCode":"","headers":{},"x":2070,"y":880,"wires":[]},{"id":"8b939a9e.d9fb28","type":"function","z":"55a62a.5aaf59d8","name":"update flows","func":"const http = global.get('https');\nconst data = JSON.stringify(msg.payload);\nconst options = {\n  hostname: 'localhost',\n  port: 1880,\n  path: '/flows',\n  method: 'POST',\n  headers: {\n    'Content-Type': 'application/json',\n    'Content-Length': data.length,\n    'Authorization': 'Bearer '+msg.accessToken\n  },\n  rejectUnauthorized: false\n};\nconst req = http.request(options);\nreq.write(data);\nreq.end();\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":2410,"y":840,"wires":[["d4b04a58.497928"]]},{"id":"239f4ab6.edcc76","type":"switch","z":"55a62a.5aaf59d8","name":"","property":"statusCode","propertyType":"msg","rules":[{"t":"eq","v":"200","vt":"num"},{"t":"else"}],"checkall":"true","repair":false,"outputs":2,"x":1070,"y":940,"wires":[["b93d2bd7.c71fc8"],["89741643.67b0a8"]]},{"id":"89741643.67b0a8","type":"http response","z":"55a62a.5aaf59d8","name":"","statusCode":"","headers":{},"x":1210,"y":980,"wires":[]},{"id":"ba45c421.a35538","type":"switch","z":"55a62a.5aaf59d8","name":"","property":"statusCode","propertyType":"msg","rules":[{"t":"eq","v":"200","vt":"num"},{"t":"else"}],"checkall":"true","repair":false,"outputs":2,"x":1750,"y":940,"wires":[["7531dd70.1dc174"],["d3ee99c1.eab588"]]},{"id":"d3ee99c1.eab588","type":"http response","z":"55a62a.5aaf59d8","name":"","statusCode":"","headers":{},"x":1890,"y":980,"wires":[]},{"id":"87af176e.cd46b8","type":"http in","z":"3723610.753c9a","name":"PUT string","url":"/template/string","method":"put","upload":false,"swaggerDoc":"","x":80,"y":40,"wires":[["c86ff1f7.a27e7"]]},{"id":"9756577b.676bf8","type":"change","z":"3723610.753c9a","name":"","rules":[{"t":"set","p":"payload","pt":"msg","to":"template","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":2420,"y":40,"wires":[["21db5af6.8e1746"]]},{"id":"19908a13.b9f426","type":"http in","z":"3723610.753c9a","name":"GET string","url":"/template/string","method":"get","upload":false,"swaggerDoc":"","x":80,"y":140,"wires":[["a7204ef2.0df5"]]},{"id":"31eb2b7f.2977b4","type":"http response","z":"3723610.753c9a","name":"","statusCode":"","headers":{},"x":2290,"y":140,"wires":[]},{"id":"231b455.91d05ba","type":"change","z":"3723610.753c9a","name":"","rules":[{"t":"set","p":"headers","pt":"msg","to":"{\"Content-Type\":\"text/plain\"}","tot":"json"}],"action":"","property":"","from":"","to":"","reg":false,"x":2120,"y":140,"wires":[["31eb2b7f.2977b4"]]},{"id":"c86ff1f7.a27e7","type":"change","z":"3723610.753c9a","name":"get inputs","rules":[{"t":"set","p":"template","pt":"msg","to":"payload","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":260,"y":40,"wires":[["f6a2d6af.ba3168"]]},{"id":"4810c705.55bea8","type":"http request","z":"3723610.753c9a","name":"get flows","method":"GET","ret":"obj","paytoqs":"ignore","url":"https://localhost:1880/flows","tls":"b1a419c1.609c29","persist":false,"proxy":"","authType":"","x":1780,"y":40,"wires":[["1661932f.b7746d"]]},{"id":"131c4927.b363a7","type":"http response","z":"3723610.753c9a","name":"","statusCode":"","headers":{},"x":3170,"y":40,"wires":[]},{"id":"21db5af6.8e1746","type":"change","z":"3723610.753c9a","name":"","rules":[{"t":"set","p":"headers","pt":"msg","to":"{\"Content-Type\":\"text/plain\"}","tot":"json"}],"action":"","property":"","from":"","to":"","reg":false,"x":2620,"y":40,"wires":[["131c4927.b363a7","b9bf0729.8b8378"]]},{"id":"8466496d.be2158","type":"http request","z":"3723610.753c9a","name":"get flows","method":"GET","ret":"obj","paytoqs":"ignore","url":"https://localhost:1880/flows","tls":"b1a419c1.609c29","persist":false,"proxy":"","authType":"","x":1600,"y":140,"wires":[["f09fe768.515948"]]},{"id":"471de34a.741bec","type":"http request","z":"3723610.753c9a","name":"auth","method":"POST","ret":"obj","paytoqs":"ignore","url":"https://localhost:1880/auth/token","tls":"b1a419c1.609c29","persist":false,"proxy":"","authType":"","x":1110,"y":40,"wires":[["acc8e012.08021"]]},{"id":"754d90a8.74719","type":"change","z":"3723610.753c9a","name":"auth payload","rules":[{"t":"set","p":"payload","pt":"msg","to":"{}","tot":"json"},{"t":"set","p":"payload.client_id","pt":"msg","to":"node-red-editor","tot":"str"},{"t":"set","p":"payload.grant_type","pt":"msg","to":"password","tot":"str"},{"t":"set","p":"payload.scope","pt":"msg","to":"","tot":"str"},{"t":"set","p":"payload.username","pt":"msg","to":"NRADM_USER","tot":"env"},{"t":"set","p":"payload.password","pt":"msg","to":"NRADM_PASS","tot":"env"}],"action":"","property":"","from":"","to":"","reg":false,"x":950,"y":40,"wires":[["471de34a.741bec"]]},{"id":"8f9e2d7c.0cf11","type":"change","z":"3723610.753c9a","name":"","rules":[{"t":"set","p":"accessToken","pt":"msg","to":"payload.access_token","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":1440,"y":40,"wires":[["b142b897.71ad48"]]},{"id":"b142b897.71ad48","type":"change","z":"3723610.753c9a","name":"bearer","rules":[{"t":"set","p":"headers","pt":"msg","to":"{}","tot":"json"},{"t":"set","p":"headers.authorization","pt":"msg","to":"\"Bearer \" & msg.accessToken","tot":"jsonata"}],"action":"","property":"","from":"","to":"","reg":false,"x":1630,"y":40,"wires":[["4810c705.55bea8"]]},{"id":"e57789b7.708ea8","type":"http request","z":"3723610.753c9a","name":"auth","method":"POST","ret":"obj","paytoqs":"ignore","url":"https://localhost:1880/auth/token","tls":"b1a419c1.609c29","persist":false,"proxy":"","authType":"","x":930,"y":140,"wires":[["25083415.03cd5c"]]},{"id":"b65651c5.103f3","type":"change","z":"3723610.753c9a","name":"auth payload","rules":[{"t":"set","p":"payload.client_id","pt":"msg","to":"node-red-editor","tot":"str"},{"t":"set","p":"payload.grant_type","pt":"msg","to":"password","tot":"str"},{"t":"set","p":"payload.scope","pt":"msg","to":"","tot":"str"},{"t":"set","p":"payload.username","pt":"msg","to":"NRADM_USER","tot":"env"},{"t":"set","p":"payload.password","pt":"msg","to":"NRADM_PASS","tot":"env"}],"action":"","property":"","from":"","to":"","reg":false,"x":770,"y":140,"wires":[["e57789b7.708ea8"]]},{"id":"98e08197.ea003","type":"change","z":"3723610.753c9a","name":"","rules":[{"t":"set","p":"accessToken","pt":"msg","to":"payload.access_token","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":1260,"y":140,"wires":[["2c37e605.d60a6a"]]},{"id":"2c37e605.d60a6a","type":"change","z":"3723610.753c9a","name":"bearer","rules":[{"t":"set","p":"headers","pt":"msg","to":"{}","tot":"json"},{"t":"set","p":"headers.authorization","pt":"msg","to":"\"Bearer \" & msg.accessToken","tot":"jsonata"}],"action":"","property":"","from":"","to":"","reg":false,"x":1450,"y":140,"wires":[["8466496d.be2158"]]},{"id":"d6cbecc4.62d67","type":"http request","z":"3723610.753c9a","name":"","method":"POST","ret":"obj","paytoqs":"ignore","url":"${CFG_ACL_ENDP}","tls":"51b09598.a1114d","persist":false,"proxy":"","authType":"","x":630,"y":40,"wires":[["ab2698a4.0ab7b8"]]},{"id":"ab2698a4.0ab7b8","type":"switch","z":"3723610.753c9a","name":"","property":"statusCode","propertyType":"msg","rules":[{"t":"eq","v":"200","vt":"num"},{"t":"else"}],"checkall":"true","repair":false,"outputs":2,"x":790,"y":40,"wires":[["754d90a8.74719"],["d8893d5b.dba4b"]]},{"id":"d9a00948.c0e7d8","type":"http request","z":"3723610.753c9a","name":"","method":"POST","ret":"obj","paytoqs":"ignore","url":"${CFG_ACL_ENDP}","tls":"51b09598.a1114d","persist":false,"proxy":"","authType":"","x":450,"y":140,"wires":[["65aa2ea.b1ba3d"]]},{"id":"65aa2ea.b1ba3d","type":"switch","z":"3723610.753c9a","name":"","property":"statusCode","propertyType":"msg","rules":[{"t":"eq","v":"200","vt":"num"},{"t":"else"}],"checkall":"true","repair":false,"outputs":2,"x":610,"y":140,"wires":[["b65651c5.103f3"],["7303e245.8fa1dc"]]},{"id":"a7204ef2.0df5","type":"change","z":"3723610.753c9a","name":"acl req payload","rules":[{"t":"set","p":"headers","pt":"msg","to":"{}","tot":"json"},{"t":"set","p":"payload","pt":"msg","to":"{}","tot":"json"},{"t":"set","p":"payload.url","pt":"msg","to":"req.url","tot":"msg"},{"t":"set","p":"payload.method","pt":"msg","to":"req.method","tot":"msg"},{"t":"set","p":"payload.headers","pt":"msg","to":"req.headers","tot":"msg"},{"t":"set","p":"payload.params","pt":"msg","to":"req.params","tot":"msg"},{"t":"set","p":"payload.query","pt":"msg","to":"req.query","tot":"msg"},{"t":"set","p":"payload.body","pt":"msg","to":"req.body","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":260,"y":140,"wires":[["d9a00948.c0e7d8"]]},{"id":"f6a2d6af.ba3168","type":"change","z":"3723610.753c9a","name":"acl req payload","rules":[{"t":"set","p":"headers","pt":"msg","to":"{}","tot":"json"},{"t":"set","p":"payload","pt":"msg","to":"{}","tot":"json"},{"t":"set","p":"payload.url","pt":"msg","to":"req.url","tot":"msg"},{"t":"set","p":"payload.method","pt":"msg","to":"req.method","tot":"msg"},{"t":"set","p":"payload.headers","pt":"msg","to":"req.headers","tot":"msg"},{"t":"set","p":"payload.params","pt":"msg","to":"req.params","tot":"msg"},{"t":"set","p":"payload.query","pt":"msg","to":"req.query","tot":"msg"},{"t":"set","p":"payload.body","pt":"msg","to":"req.body","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":440,"y":40,"wires":[["d6cbecc4.62d67"]]},{"id":"7303e245.8fa1dc","type":"http response","z":"3723610.753c9a","name":"","statusCode":"","headers":{},"x":750,"y":180,"wires":[]},{"id":"9c8fb19.c95175","type":"change","z":"3723610.753c9a","name":"","rules":[{"t":"set","p":"payload","pt":"msg","to":"*[name = \"template\" and type=\"template\"].template","tot":"jsonata"}],"action":"","property":"","from":"","to":"","reg":false,"x":1920,"y":140,"wires":[["231b455.91d05ba"]]},{"id":"7c9bea0d.250074","type":"change","z":"3723610.753c9a","name":"edit","rules":[{"t":"set","p":"old","pt":"msg","to":"*[name = \"get tpl config\" and type=\"change\"]","tot":"jsonata"},{"t":"set","p":"new","pt":"msg","to":"old","tot":"msg"},{"t":"set","p":"new.rules[0].to","pt":"msg","to":"template","tot":"msg"},{"t":"set","p":"payload","pt":"msg","to":"$eval($replace($string(payload),$string(old),$string(new)))","tot":"jsonata"}],"action":"","property":"","from":"","to":"","reg":false,"x":2070,"y":40,"wires":[["96892a73.6491e8"]]},{"id":"d8893d5b.dba4b","type":"http response","z":"3723610.753c9a","name":"","statusCode":"","headers":{},"x":930,"y":80,"wires":[]},{"id":"acc8e012.08021","type":"switch","z":"3723610.753c9a","name":"","property":"statusCode","propertyType":"msg","rules":[{"t":"eq","v":"200","vt":"num"},{"t":"else"}],"checkall":"true","repair":false,"outputs":2,"x":1250,"y":40,"wires":[["8f9e2d7c.0cf11"],["2dcfd8b3.eeb008"]]},{"id":"2dcfd8b3.eeb008","type":"http response","z":"3723610.753c9a","name":"","statusCode":"","headers":{},"x":1390,"y":80,"wires":[]},{"id":"1661932f.b7746d","type":"switch","z":"3723610.753c9a","name":"","property":"statusCode","propertyType":"msg","rules":[{"t":"eq","v":"200","vt":"num"},{"t":"else"}],"checkall":"true","repair":false,"outputs":2,"x":1930,"y":40,"wires":[["7c9bea0d.250074"],["b9956304.bcd53"]]},{"id":"b9956304.bcd53","type":"http response","z":"3723610.753c9a","name":"","statusCode":"","headers":{},"x":2070,"y":80,"wires":[]},{"id":"96892a73.6491e8","type":"function","z":"3723610.753c9a","name":"update flows","func":"const http = global.get('https');\nconst data = JSON.stringify(msg.payload);\nconst options = {\n  hostname: 'localhost',\n  port: 1880,\n  path: '/flows',\n  method: 'POST',\n  headers: {\n    'Content-Type': 'application/json',\n    'Content-Length': data.length,\n    'Authorization': 'Bearer '+msg.accessToken\n  },\n  rejectUnauthorized: false\n};\nconst req = http.request(options);\nreq.write(data);\nreq.end();\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":2230,"y":40,"wires":[["9756577b.676bf8"]]},{"id":"25083415.03cd5c","type":"switch","z":"3723610.753c9a","name":"","property":"statusCode","propertyType":"msg","rules":[{"t":"eq","v":"200","vt":"num"},{"t":"else"}],"checkall":"true","repair":false,"outputs":2,"x":1070,"y":140,"wires":[["98e08197.ea003"],["61b70da5.0add04"]]},{"id":"61b70da5.0add04","type":"http response","z":"3723610.753c9a","name":"","statusCode":"","headers":{},"x":1210,"y":180,"wires":[]},{"id":"f09fe768.515948","type":"switch","z":"3723610.753c9a","name":"","property":"statusCode","propertyType":"msg","rules":[{"t":"eq","v":"200","vt":"num"},{"t":"else"}],"checkall":"true","repair":false,"outputs":2,"x":1750,"y":140,"wires":[["9c8fb19.c95175"],["14a8310b.ec7e9f"]]},{"id":"14a8310b.ec7e9f","type":"http response","z":"3723610.753c9a","name":"","statusCode":"","headers":{},"x":1890,"y":180,"wires":[]},{"id":"ca84f41b.910dc8","type":"http in","z":"3723610.753c9a","name":"PUT output","url":"/template/output","method":"put","upload":false,"swaggerDoc":"","x":80,"y":240,"wires":[["cafad9e1.9bc8a8"]]},{"id":"a4e85995.acfdd8","type":"change","z":"3723610.753c9a","name":"","rules":[{"t":"set","p":"payload","pt":"msg","to":"output","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":2800,"y":240,"wires":[["e067aa71.c7af98"]]},{"id":"af004f83.2aa9d","type":"http in","z":"3723610.753c9a","name":"GET output","url":"/template/output","method":"get","upload":false,"swaggerDoc":"","x":90,"y":340,"wires":[["e138591e.44cd48"]]},{"id":"18078e28.c73442","type":"http response","z":"3723610.753c9a","name":"","statusCode":"","headers":{},"x":2290,"y":340,"wires":[]},{"id":"224e2b2b.7113e4","type":"change","z":"3723610.753c9a","name":"","rules":[{"t":"set","p":"headers","pt":"msg","to":"{\"Content-Type\":\"text/plain\"}","tot":"json"}],"action":"","property":"","from":"","to":"","reg":false,"x":2120,"y":340,"wires":[["18078e28.c73442"]]},{"id":"cafad9e1.9bc8a8","type":"change","z":"3723610.753c9a","name":"get inputs","rules":[{"t":"set","p":"output","pt":"msg","to":"payload","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":260,"y":240,"wires":[["1738ae54.887582"]]},{"id":"23302597.e6163a","type":"http request","z":"3723610.753c9a","name":"get flows","method":"GET","ret":"obj","paytoqs":"ignore","url":"https://localhost:1880/flows","tls":"b1a419c1.609c29","persist":false,"proxy":"","authType":"","x":1780,"y":240,"wires":[["df347616.7ed478"]]},{"id":"fb83e824.973d88","type":"http response","z":"3723610.753c9a","name":"","statusCode":"","headers":{},"x":3170,"y":240,"wires":[]},{"id":"e067aa71.c7af98","type":"change","z":"3723610.753c9a","name":"","rules":[{"t":"set","p":"headers","pt":"msg","to":"{\"Content-Type\":\"text/plain\"}","tot":"json"}],"action":"","property":"","from":"","to":"","reg":false,"x":3000,"y":240,"wires":[["fb83e824.973d88","702f29e1.1b64f8"]]},{"id":"1ed9b60b.5d196a","type":"http request","z":"3723610.753c9a","name":"get flows","method":"GET","ret":"obj","paytoqs":"ignore","url":"https://localhost:1880/flows","tls":"b1a419c1.609c29","persist":false,"proxy":"","authType":"","x":1600,"y":340,"wires":[["e809ca7b.967e28"]]},{"id":"7d0eaf07.e4899","type":"http request","z":"3723610.753c9a","name":"auth","method":"POST","ret":"obj","paytoqs":"ignore","url":"https://localhost:1880/auth/token","tls":"b1a419c1.609c29","persist":false,"proxy":"","authType":"","x":1110,"y":240,"wires":[["79751a34.4d9764"]]},{"id":"e5536db.f5e709","type":"change","z":"3723610.753c9a","name":"auth payload","rules":[{"t":"set","p":"payload","pt":"msg","to":"{}","tot":"json"},{"t":"set","p":"payload.client_id","pt":"msg","to":"node-red-editor","tot":"str"},{"t":"set","p":"payload.grant_type","pt":"msg","to":"password","tot":"str"},{"t":"set","p":"payload.scope","pt":"msg","to":"","tot":"str"},{"t":"set","p":"payload.username","pt":"msg","to":"NRADM_USER","tot":"env"},{"t":"set","p":"payload.password","pt":"msg","to":"NRADM_PASS","tot":"env"}],"action":"","property":"","from":"","to":"","reg":false,"x":950,"y":240,"wires":[["7d0eaf07.e4899"]]},{"id":"609f8828.27b118","type":"change","z":"3723610.753c9a","name":"","rules":[{"t":"set","p":"accessToken","pt":"msg","to":"payload.access_token","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":1440,"y":240,"wires":[["2a1cee8a.82b122"]]},{"id":"2a1cee8a.82b122","type":"change","z":"3723610.753c9a","name":"bearer","rules":[{"t":"set","p":"headers","pt":"msg","to":"{}","tot":"json"},{"t":"set","p":"headers.authorization","pt":"msg","to":"\"Bearer \" & msg.accessToken","tot":"jsonata"}],"action":"","property":"","from":"","to":"","reg":false,"x":1630,"y":240,"wires":[["23302597.e6163a"]]},{"id":"5e27e829.eb2fa8","type":"http request","z":"3723610.753c9a","name":"auth","method":"POST","ret":"obj","paytoqs":"ignore","url":"https://localhost:1880/auth/token","tls":"b1a419c1.609c29","persist":false,"proxy":"","authType":"","x":930,"y":340,"wires":[["e118ffba.221e"]]},{"id":"9f9427d7.bea2c8","type":"change","z":"3723610.753c9a","name":"auth payload","rules":[{"t":"set","p":"payload.client_id","pt":"msg","to":"node-red-editor","tot":"str"},{"t":"set","p":"payload.grant_type","pt":"msg","to":"password","tot":"str"},{"t":"set","p":"payload.scope","pt":"msg","to":"","tot":"str"},{"t":"set","p":"payload.username","pt":"msg","to":"NRADM_USER","tot":"env"},{"t":"set","p":"payload.password","pt":"msg","to":"NRADM_PASS","tot":"env"}],"action":"","property":"","from":"","to":"","reg":false,"x":770,"y":340,"wires":[["5e27e829.eb2fa8"]]},{"id":"609a1b42.f2ce64","type":"change","z":"3723610.753c9a","name":"","rules":[{"t":"set","p":"accessToken","pt":"msg","to":"payload.access_token","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":1260,"y":340,"wires":[["1088addf.fd54f2"]]},{"id":"1088addf.fd54f2","type":"change","z":"3723610.753c9a","name":"bearer","rules":[{"t":"set","p":"headers","pt":"msg","to":"{}","tot":"json"},{"t":"set","p":"headers.authorization","pt":"msg","to":"\"Bearer \" & msg.accessToken","tot":"jsonata"}],"action":"","property":"","from":"","to":"","reg":false,"x":1450,"y":340,"wires":[["1ed9b60b.5d196a"]]},{"id":"a93de5b2.b59858","type":"http request","z":"3723610.753c9a","name":"","method":"POST","ret":"obj","paytoqs":"ignore","url":"${CFG_ACL_ENDP}","tls":"51b09598.a1114d","persist":false,"proxy":"","authType":"","x":630,"y":240,"wires":[["e52d0ab9.4b0f38"]]},{"id":"e52d0ab9.4b0f38","type":"switch","z":"3723610.753c9a","name":"","property":"statusCode","propertyType":"msg","rules":[{"t":"eq","v":"200","vt":"num"},{"t":"else"}],"checkall":"true","repair":false,"outputs":2,"x":790,"y":240,"wires":[["e5536db.f5e709"],["ea6f89dc.9ad4a8"]]},{"id":"b1e453fc.37513","type":"http request","z":"3723610.753c9a","name":"","method":"POST","ret":"obj","paytoqs":"ignore","url":"${CFG_ACL_ENDP}","tls":"51b09598.a1114d","persist":false,"proxy":"","authType":"","x":450,"y":340,"wires":[["dfcf3f16.2cc8f"]]},{"id":"dfcf3f16.2cc8f","type":"switch","z":"3723610.753c9a","name":"","property":"statusCode","propertyType":"msg","rules":[{"t":"eq","v":"200","vt":"num"},{"t":"else"}],"checkall":"true","repair":false,"outputs":2,"x":610,"y":340,"wires":[["9f9427d7.bea2c8"],["d5f81e48.1b2bf"]]},{"id":"e138591e.44cd48","type":"change","z":"3723610.753c9a","name":"acl req payload","rules":[{"t":"set","p":"headers","pt":"msg","to":"{}","tot":"json"},{"t":"set","p":"payload","pt":"msg","to":"{}","tot":"json"},{"t":"set","p":"payload.url","pt":"msg","to":"req.url","tot":"msg"},{"t":"set","p":"payload.method","pt":"msg","to":"req.method","tot":"msg"},{"t":"set","p":"payload.headers","pt":"msg","to":"req.headers","tot":"msg"},{"t":"set","p":"payload.params","pt":"msg","to":"req.params","tot":"msg"},{"t":"set","p":"payload.query","pt":"msg","to":"req.query","tot":"msg"},{"t":"set","p":"payload.body","pt":"msg","to":"req.body","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":260,"y":340,"wires":[["b1e453fc.37513"]]},{"id":"1738ae54.887582","type":"change","z":"3723610.753c9a","name":"acl req payload","rules":[{"t":"set","p":"headers","pt":"msg","to":"{}","tot":"json"},{"t":"set","p":"payload","pt":"msg","to":"{}","tot":"json"},{"t":"set","p":"payload.url","pt":"msg","to":"req.url","tot":"msg"},{"t":"set","p":"payload.method","pt":"msg","to":"req.method","tot":"msg"},{"t":"set","p":"payload.headers","pt":"msg","to":"req.headers","tot":"msg"},{"t":"set","p":"payload.params","pt":"msg","to":"req.params","tot":"msg"},{"t":"set","p":"payload.query","pt":"msg","to":"req.query","tot":"msg"},{"t":"set","p":"payload.body","pt":"msg","to":"req.body","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":440,"y":240,"wires":[["a93de5b2.b59858"]]},{"id":"d5f81e48.1b2bf","type":"http response","z":"3723610.753c9a","name":"","statusCode":"","headers":{},"x":750,"y":380,"wires":[]},{"id":"22c5c7c0.e76738","type":"change","z":"3723610.753c9a","name":"","rules":[{"t":"set","p":"payload","pt":"msg","to":"*[name = \"template\" and type=\"template\"].output = \"str\" ? \"string\" : \"object\"","tot":"jsonata"}],"action":"","property":"","from":"","to":"","reg":false,"x":1920,"y":340,"wires":[["224e2b2b.7113e4"]]},{"id":"8af925dd.7619b8","type":"change","z":"3723610.753c9a","name":"edit","rules":[{"t":"set","p":"old","pt":"msg","to":"*[name = \"template\" and type=\"template\"]","tot":"jsonata"},{"t":"set","p":"new","pt":"msg","to":"old","tot":"msg"},{"t":"set","p":"new.output","pt":"msg","to":"nroutput","tot":"msg"},{"t":"set","p":"payload","pt":"msg","to":"$eval($replace($string(payload),$string(old),$string(new)))","tot":"jsonata"}],"action":"","property":"","from":"","to":"","reg":false,"x":2450,"y":240,"wires":[["a30fb9c6.b748b8"]]},{"id":"ea6f89dc.9ad4a8","type":"http response","z":"3723610.753c9a","name":"","statusCode":"","headers":{},"x":930,"y":280,"wires":[]},{"id":"79751a34.4d9764","type":"switch","z":"3723610.753c9a","name":"","property":"statusCode","propertyType":"msg","rules":[{"t":"eq","v":"200","vt":"num"},{"t":"else"}],"checkall":"true","repair":false,"outputs":2,"x":1250,"y":240,"wires":[["609f8828.27b118"],["ad6e027d.3c42"]]},{"id":"ad6e027d.3c42","type":"http response","z":"3723610.753c9a","name":"","statusCode":"","headers":{},"x":1390,"y":280,"wires":[]},{"id":"df347616.7ed478","type":"switch","z":"3723610.753c9a","name":"","property":"statusCode","propertyType":"msg","rules":[{"t":"eq","v":"200","vt":"num"},{"t":"else"}],"checkall":"true","repair":false,"outputs":2,"x":1930,"y":240,"wires":[["b1a4ab0f.daa108"],["9f16c3da.fa069"]]},{"id":"9f16c3da.fa069","type":"http response","z":"3723610.753c9a","name":"","statusCode":"","headers":{},"x":2070,"y":280,"wires":[]},{"id":"a30fb9c6.b748b8","type":"function","z":"3723610.753c9a","name":"update flows","func":"const http = global.get('https');\nconst data = JSON.stringify(msg.payload);\nconst options = {\n  hostname: 'localhost',\n  port: 1880,\n  path: '/flows',\n  method: 'POST',\n  headers: {\n    'Content-Type': 'application/json',\n    'Content-Length': data.length,\n    'Authorization': 'Bearer '+msg.accessToken\n  },\n  rejectUnauthorized: false\n};\nconst req = http.request(options);\nreq.write(data);\nreq.end();\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":2610,"y":240,"wires":[["a4e85995.acfdd8"]]},{"id":"e118ffba.221e","type":"switch","z":"3723610.753c9a","name":"","property":"statusCode","propertyType":"msg","rules":[{"t":"eq","v":"200","vt":"num"},{"t":"else"}],"checkall":"true","repair":false,"outputs":2,"x":1070,"y":340,"wires":[["609a1b42.f2ce64"],["34ae1cee.3e4924"]]},{"id":"34ae1cee.3e4924","type":"http response","z":"3723610.753c9a","name":"","statusCode":"","headers":{},"x":1210,"y":380,"wires":[]},{"id":"e809ca7b.967e28","type":"switch","z":"3723610.753c9a","name":"","property":"statusCode","propertyType":"msg","rules":[{"t":"eq","v":"200","vt":"num"},{"t":"else"}],"checkall":"true","repair":false,"outputs":2,"x":1750,"y":340,"wires":[["22c5c7c0.e76738"],["d2e9c61c.ca13f8"]]},{"id":"d2e9c61c.ca13f8","type":"http response","z":"3723610.753c9a","name":"","statusCode":"","headers":{},"x":1890,"y":380,"wires":[]},{"id":"b1a4ab0f.daa108","type":"switch","z":"3723610.753c9a","name":"","property":"output","propertyType":"msg","rules":[{"t":"eq","v":"string","vt":"str"},{"t":"eq","v":"object","vt":"str"},{"t":"else"}],"checkall":"true","repair":false,"outputs":3,"x":2070,"y":240,"wires":[["28a724b2.2f5ebc"],["36e37c4e.0fe8b4"],["5722e55d.b7748c"]]},{"id":"28a724b2.2f5ebc","type":"change","z":"3723610.753c9a","name":"","rules":[{"t":"set","p":"nroutput","pt":"msg","to":"str","tot":"str"}],"action":"","property":"","from":"","to":"","reg":false,"x":2280,"y":220,"wires":[["8af925dd.7619b8"]]},{"id":"36e37c4e.0fe8b4","type":"change","z":"3723610.753c9a","name":"","rules":[{"t":"set","p":"nroutput","pt":"msg","to":"json","tot":"str"}],"action":"","property":"","from":"","to":"","reg":false,"x":2280,"y":260,"wires":[["8af925dd.7619b8"]]},{"id":"5722e55d.b7748c","type":"change","z":"3723610.753c9a","name":"","rules":[{"t":"set","p":"payload","pt":"msg","to":"Allowed values: string, object.","tot":"str"}],"action":"","property":"","from":"","to":"","reg":false,"x":2270,"y":300,"wires":[["82d34284.f6989"]]},{"id":"82d34284.f6989","type":"http response","z":"3723610.753c9a","name":"","statusCode":"400","headers":{},"x":2460,"y":300,"wires":[]},{"id":"faba1b6a.9dda48","type":"change","z":"5ad932d2.c06e2c","name":"status out","rules":[{"t":"set","p":"status","pt":"msg","to":"{ \"out\": payload }","tot":"jsonata"}],"action":"","property":"","from":"","to":"","reg":false,"x":1180,"y":480,"wires":[["497be3fb.74994c"]]},{"id":"4e9ea80a.f97d28","type":"change","z":"5ad932d2.c06e2c","name":"status in","rules":[{"t":"set","p":"status","pt":"msg","to":"{}","tot":"msg"},{"t":"set","p":"status.in","pt":"msg","to":"payload","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":160,"y":540,"wires":[["497be3fb.74994c"]]},{"id":"497be3fb.74994c","type":"join","z":"5ad932d2.c06e2c","name":"","mode":"custom","build":"merged","property":"status","propertyType":"msg","key":"topic","joiner":"\\n","joinerType":"str","accumulate":false,"timeout":"","count":"2","reduceRight":false,"reduceExp":"","reduceInit":"","reduceInitType":"","reduceFixup":"","x":1170,"y":540,"wires":[["8af8771a.af8598"]]},{"id":"8af8771a.af8598","type":"change","z":"5ad932d2.c06e2c","name":"status","rules":[{"t":"set","p":"payload","pt":"msg","to":"{}","tot":"json"},{"t":"set","p":"payload.text","pt":"msg","to":"$boolean(status.error) ? \"error: \" & status.error : $boolean(status.out) ? \"forwarded: \" & status.out : \"discarded: \" & status.in","tot":"jsonata"},{"t":"set","p":"payload.shape","pt":"msg","to":"dot","tot":"str"},{"t":"set","p":"payload.fill","pt":"msg","to":"$boolean(status.out) ? \"green\" : $boolean(status.error) ? \"red\" : \"yellow\"","tot":"jsonata"}],"action":"","property":"","from":"","to":"","reg":false,"x":1310,"y":540,"wires":[[]]},{"id":"df6bcb58.3edb48","type":"http in","z":"5ad932d2.c06e2c","name":"PUT from","url":"/between/from","method":"put","upload":false,"swaggerDoc":"","x":80,"y":40,"wires":[["608b06dc.be7e68"]]},{"id":"b26c0c04.66d05","type":"change","z":"5ad932d2.c06e2c","name":"","rules":[{"t":"set","p":"payload","pt":"msg","to":"from","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":2400,"y":40,"wires":[["b749f11f.271cc"]]},{"id":"e452b112.c62f1","type":"http in","z":"5ad932d2.c06e2c","name":"GET from","url":"/between/from","method":"get","upload":false,"swaggerDoc":"","x":80,"y":140,"wires":[["b78ef4cd.9a9258"]]},{"id":"29f8d300.6290be","type":"http response","z":"5ad932d2.c06e2c","name":"","statusCode":"","headers":{},"x":2290,"y":140,"wires":[]},{"id":"277c57d6.852968","type":"change","z":"5ad932d2.c06e2c","name":"","rules":[{"t":"set","p":"headers","pt":"msg","to":"{\"Content-Type\":\"text/plain\"}","tot":"json"}],"action":"","property":"","from":"","to":"","reg":false,"x":2120,"y":140,"wires":[["29f8d300.6290be"]]},{"id":"608b06dc.be7e68","type":"change","z":"5ad932d2.c06e2c","name":"get inputs","rules":[{"t":"set","p":"from","pt":"msg","to":"payload","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":240,"y":40,"wires":[["ee10dd35.35a74"]]},{"id":"370a3ee2.c38dd2","type":"http request","z":"5ad932d2.c06e2c","name":"get flows","method":"GET","ret":"obj","paytoqs":"ignore","url":"https://localhost:1880/flows","tls":"b1a419c1.609c29","persist":false,"proxy":"","authType":"","x":1760,"y":40,"wires":[["83faa5c1.999278"]]},{"id":"f2ce0b2.4cb99f8","type":"http response","z":"5ad932d2.c06e2c","name":"","statusCode":"","headers":{},"x":2770,"y":40,"wires":[]},{"id":"b749f11f.271cc","type":"change","z":"5ad932d2.c06e2c","name":"","rules":[{"t":"set","p":"headers","pt":"msg","to":"{\"Content-Type\":\"text/plain\"}","tot":"json"}],"action":"","property":"","from":"","to":"","reg":false,"x":2600,"y":40,"wires":[["f2ce0b2.4cb99f8","99f26c7f.580dc"]]},{"id":"60449fb0.e35f6","type":"http request","z":"5ad932d2.c06e2c","name":"get flows","method":"GET","ret":"obj","paytoqs":"ignore","url":"https://localhost:1880/flows","tls":"b1a419c1.609c29","persist":false,"proxy":"","authType":"","x":1600,"y":140,"wires":[["ef73571b.b05508"]]},{"id":"1af27b9c.e40ad4","type":"http request","z":"5ad932d2.c06e2c","name":"auth","method":"POST","ret":"obj","paytoqs":"ignore","url":"https://localhost:1880/auth/token","tls":"b1a419c1.609c29","persist":false,"proxy":"","authType":"","x":1090,"y":40,"wires":[["53290d65.008514"]]},{"id":"e0312735.2fcb58","type":"change","z":"5ad932d2.c06e2c","name":"auth payload","rules":[{"t":"set","p":"payload","pt":"msg","to":"{}","tot":"json"},{"t":"set","p":"payload.client_id","pt":"msg","to":"node-red-editor","tot":"str"},{"t":"set","p":"payload.grant_type","pt":"msg","to":"password","tot":"str"},{"t":"set","p":"payload.scope","pt":"msg","to":"","tot":"str"},{"t":"set","p":"payload.username","pt":"msg","to":"NRADM_USER","tot":"env"},{"t":"set","p":"payload.password","pt":"msg","to":"NRADM_PASS","tot":"env"}],"action":"","property":"","from":"","to":"","reg":false,"x":930,"y":40,"wires":[["1af27b9c.e40ad4"]]},{"id":"ebda7822.46d928","type":"change","z":"5ad932d2.c06e2c","name":"","rules":[{"t":"set","p":"accessToken","pt":"msg","to":"payload.access_token","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":1420,"y":40,"wires":[["22324454.900acc"]]},{"id":"22324454.900acc","type":"change","z":"5ad932d2.c06e2c","name":"bearer","rules":[{"t":"set","p":"headers","pt":"msg","to":"{}","tot":"json"},{"t":"set","p":"headers.authorization","pt":"msg","to":"\"Bearer \" & msg.accessToken","tot":"jsonata"}],"action":"","property":"","from":"","to":"","reg":false,"x":1610,"y":40,"wires":[["370a3ee2.c38dd2"]]},{"id":"c10db412.0acb78","type":"http request","z":"5ad932d2.c06e2c","name":"auth","method":"POST","ret":"obj","paytoqs":"ignore","url":"https://localhost:1880/auth/token","tls":"b1a419c1.609c29","persist":false,"proxy":"","authType":"","x":930,"y":140,"wires":[["19f99644.64304a"]]},{"id":"e00e7e06.83f15","type":"change","z":"5ad932d2.c06e2c","name":"auth payload","rules":[{"t":"set","p":"payload.client_id","pt":"msg","to":"node-red-editor","tot":"str"},{"t":"set","p":"payload.grant_type","pt":"msg","to":"password","tot":"str"},{"t":"set","p":"payload.scope","pt":"msg","to":"","tot":"str"},{"t":"set","p":"payload.username","pt":"msg","to":"NRADM_USER","tot":"env"},{"t":"set","p":"payload.password","pt":"msg","to":"NRADM_PASS","tot":"env"}],"action":"","property":"","from":"","to":"","reg":false,"x":770,"y":140,"wires":[["c10db412.0acb78"]]},{"id":"e5226d88.5e4bd","type":"change","z":"5ad932d2.c06e2c","name":"","rules":[{"t":"set","p":"accessToken","pt":"msg","to":"payload.access_token","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":1260,"y":140,"wires":[["7c51c06.ca5524"]]},{"id":"7c51c06.ca5524","type":"change","z":"5ad932d2.c06e2c","name":"bearer","rules":[{"t":"set","p":"headers","pt":"msg","to":"{}","tot":"json"},{"t":"set","p":"headers.authorization","pt":"msg","to":"\"Bearer \" & msg.accessToken","tot":"jsonata"}],"action":"","property":"","from":"","to":"","reg":false,"x":1450,"y":140,"wires":[["60449fb0.e35f6"]]},{"id":"a0182686.5e34c8","type":"http request","z":"5ad932d2.c06e2c","name":"","method":"POST","ret":"obj","paytoqs":"ignore","url":"${CFG_ACL_ENDP}","tls":"51b09598.a1114d","persist":false,"proxy":"","authType":"","x":610,"y":40,"wires":[["10441770.22b839"]]},{"id":"10441770.22b839","type":"switch","z":"5ad932d2.c06e2c","name":"","property":"statusCode","propertyType":"msg","rules":[{"t":"eq","v":"200","vt":"num"},{"t":"else"}],"checkall":"true","repair":false,"outputs":2,"x":770,"y":40,"wires":[["e0312735.2fcb58"],["a3bcc431.087848"]]},{"id":"12284345.d62cbd","type":"http request","z":"5ad932d2.c06e2c","name":"","method":"POST","ret":"obj","paytoqs":"ignore","url":"${CFG_ACL_ENDP}","tls":"51b09598.a1114d","persist":false,"proxy":"","authType":"","x":450,"y":140,"wires":[["c30fcf83.04256"]]},{"id":"c30fcf83.04256","type":"switch","z":"5ad932d2.c06e2c","name":"","property":"statusCode","propertyType":"msg","rules":[{"t":"eq","v":"200","vt":"num"},{"t":"else"}],"checkall":"true","repair":false,"outputs":2,"x":610,"y":140,"wires":[["e00e7e06.83f15"],["cd9e1128.328a3"]]},{"id":"b78ef4cd.9a9258","type":"change","z":"5ad932d2.c06e2c","name":"acl req payload","rules":[{"t":"set","p":"headers","pt":"msg","to":"{}","tot":"json"},{"t":"set","p":"payload","pt":"msg","to":"{}","tot":"json"},{"t":"set","p":"payload.url","pt":"msg","to":"req.url","tot":"msg"},{"t":"set","p":"payload.method","pt":"msg","to":"req.method","tot":"msg"},{"t":"set","p":"payload.headers","pt":"msg","to":"req.headers","tot":"msg"},{"t":"set","p":"payload.params","pt":"msg","to":"req.params","tot":"msg"},{"t":"set","p":"payload.query","pt":"msg","to":"req.query","tot":"msg"},{"t":"set","p":"payload.body","pt":"msg","to":"req.body","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":260,"y":140,"wires":[["12284345.d62cbd"]]},{"id":"ee10dd35.35a74","type":"change","z":"5ad932d2.c06e2c","name":"acl req payload","rules":[{"t":"set","p":"headers","pt":"msg","to":"{}","tot":"json"},{"t":"set","p":"payload","pt":"msg","to":"{}","tot":"json"},{"t":"set","p":"payload.url","pt":"msg","to":"req.url","tot":"msg"},{"t":"set","p":"payload.method","pt":"msg","to":"req.method","tot":"msg"},{"t":"set","p":"payload.headers","pt":"msg","to":"req.headers","tot":"msg"},{"t":"set","p":"payload.params","pt":"msg","to":"req.params","tot":"msg"},{"t":"set","p":"payload.query","pt":"msg","to":"req.query","tot":"msg"},{"t":"set","p":"payload.body","pt":"msg","to":"req.body","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":420,"y":40,"wires":[["a0182686.5e34c8"]]},{"id":"cd9e1128.328a3","type":"http response","z":"5ad932d2.c06e2c","name":"","statusCode":"","headers":{},"x":750,"y":180,"wires":[]},{"id":"f956edb5.b709c","type":"change","z":"5ad932d2.c06e2c","name":"","rules":[{"t":"set","p":"payload","pt":"msg","to":"*[name = \"get between settings\" and type=\"change\"].rules[0].to","tot":"jsonata"}],"action":"","property":"","from":"","to":"","reg":false,"x":1920,"y":140,"wires":[["277c57d6.852968"]]},{"id":"42bc6eed.a653e","type":"change","z":"5ad932d2.c06e2c","name":"edit","rules":[{"t":"set","p":"old","pt":"msg","to":"*[name = \"get between settings\" and type=\"change\"]","tot":"jsonata"},{"t":"set","p":"new","pt":"msg","to":"old","tot":"msg"},{"t":"set","p":"new.rules[0].to","pt":"msg","to":"from","tot":"msg"},{"t":"set","p":"payload","pt":"msg","to":"$eval($replace($string(payload),$string(old),$string(new)))","tot":"jsonata"}],"action":"","property":"","from":"","to":"","reg":false,"x":2050,"y":40,"wires":[["7687ad78.0233d4"]]},{"id":"a3bcc431.087848","type":"http response","z":"5ad932d2.c06e2c","name":"","statusCode":"","headers":{},"x":910,"y":80,"wires":[]},{"id":"53290d65.008514","type":"switch","z":"5ad932d2.c06e2c","name":"","property":"statusCode","propertyType":"msg","rules":[{"t":"eq","v":"200","vt":"num"},{"t":"else"}],"checkall":"true","repair":false,"outputs":2,"x":1230,"y":40,"wires":[["ebda7822.46d928"],["305d5f82.617fb"]]},{"id":"305d5f82.617fb","type":"http response","z":"5ad932d2.c06e2c","name":"","statusCode":"","headers":{},"x":1370,"y":80,"wires":[]},{"id":"83faa5c1.999278","type":"switch","z":"5ad932d2.c06e2c","name":"","property":"statusCode","propertyType":"msg","rules":[{"t":"eq","v":"200","vt":"num"},{"t":"else"}],"checkall":"true","repair":false,"outputs":2,"x":1910,"y":40,"wires":[["42bc6eed.a653e"],["4ec133fb.7e5f5c"]]},{"id":"4ec133fb.7e5f5c","type":"http response","z":"5ad932d2.c06e2c","name":"","statusCode":"","headers":{},"x":2050,"y":80,"wires":[]},{"id":"7687ad78.0233d4","type":"function","z":"5ad932d2.c06e2c","name":"update flows","func":"const http = global.get('https');\nconst data = JSON.stringify(msg.payload);\nconst options = {\n  hostname: 'localhost',\n  port: 1880,\n  path: '/flows',\n  method: 'POST',\n  headers: {\n    'Content-Type': 'application/json',\n    'Content-Length': data.length,\n    'Authorization': 'Bearer '+msg.accessToken\n  },\n  rejectUnauthorized: false\n};\nconst req = http.request(options);\nreq.write(data);\nreq.end();\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":2210,"y":40,"wires":[["b26c0c04.66d05"]]},{"id":"19f99644.64304a","type":"switch","z":"5ad932d2.c06e2c","name":"","property":"statusCode","propertyType":"msg","rules":[{"t":"eq","v":"200","vt":"num"},{"t":"else"}],"checkall":"true","repair":false,"outputs":2,"x":1070,"y":140,"wires":[["e5226d88.5e4bd"],["7b451428.faec2c"]]},{"id":"7b451428.faec2c","type":"http response","z":"5ad932d2.c06e2c","name":"","statusCode":"","headers":{},"x":1210,"y":180,"wires":[]},{"id":"ef73571b.b05508","type":"switch","z":"5ad932d2.c06e2c","name":"","property":"statusCode","propertyType":"msg","rules":[{"t":"eq","v":"200","vt":"num"},{"t":"else"}],"checkall":"true","repair":false,"outputs":2,"x":1750,"y":140,"wires":[["f956edb5.b709c"],["13f8103f.460ef"]]},{"id":"13f8103f.460ef","type":"http response","z":"5ad932d2.c06e2c","name":"","statusCode":"","headers":{},"x":1890,"y":180,"wires":[]},{"id":"f6a32164.08aca","type":"http in","z":"5ad932d2.c06e2c","name":"PUT to","url":"/between/to","method":"put","upload":false,"swaggerDoc":"","x":70,"y":240,"wires":[["9a21675.4403d98"]]},{"id":"7c201fb5.901de","type":"change","z":"5ad932d2.c06e2c","name":"","rules":[{"t":"set","p":"payload","pt":"msg","to":"to","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":2380,"y":240,"wires":[["26849865.1926a8"]]},{"id":"cfd9e28a.e5582","type":"http in","z":"5ad932d2.c06e2c","name":"GET to","url":"/between/to","method":"get","upload":false,"swaggerDoc":"","x":70,"y":340,"wires":[["cdb8dc8a.aadf5"]]},{"id":"f2226283.c56a8","type":"http response","z":"5ad932d2.c06e2c","name":"","statusCode":"","headers":{},"x":2270,"y":340,"wires":[]},{"id":"c1a6bff8.f89ba","type":"change","z":"5ad932d2.c06e2c","name":"","rules":[{"t":"set","p":"headers","pt":"msg","to":"{\"Content-Type\":\"text/plain\"}","tot":"json"}],"action":"","property":"","from":"","to":"","reg":false,"x":2100,"y":340,"wires":[["f2226283.c56a8"]]},{"id":"9a21675.4403d98","type":"change","z":"5ad932d2.c06e2c","name":"get inputs","rules":[{"t":"set","p":"to","pt":"msg","to":"payload","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":220,"y":240,"wires":[["88225c0b.735cc"]]},{"id":"10d21fb2.9cd25","type":"http request","z":"5ad932d2.c06e2c","name":"get flows","method":"GET","ret":"obj","paytoqs":"ignore","url":"https://localhost:1880/flows","tls":"b1a419c1.609c29","persist":false,"proxy":"","authType":"","x":1740,"y":240,"wires":[["be0620be.053a"]]},{"id":"449583b.6e7127c","type":"http response","z":"5ad932d2.c06e2c","name":"","statusCode":"","headers":{},"x":2750,"y":240,"wires":[]},{"id":"26849865.1926a8","type":"change","z":"5ad932d2.c06e2c","name":"","rules":[{"t":"set","p":"headers","pt":"msg","to":"{\"Content-Type\":\"text/plain\"}","tot":"json"}],"action":"","property":"","from":"","to":"","reg":false,"x":2580,"y":240,"wires":[["449583b.6e7127c","10f4bce8.b266c3"]]},{"id":"6ce1c69c.eb4d88","type":"http request","z":"5ad932d2.c06e2c","name":"get flows","method":"GET","ret":"obj","paytoqs":"ignore","url":"https://localhost:1880/flows","tls":"b1a419c1.609c29","persist":false,"proxy":"","authType":"","x":1580,"y":340,"wires":[["84d61d5a.de0e4"]]},{"id":"f0163574.f68708","type":"http request","z":"5ad932d2.c06e2c","name":"auth","method":"POST","ret":"obj","paytoqs":"ignore","url":"https://localhost:1880/auth/token","tls":"b1a419c1.609c29","persist":false,"proxy":"","authType":"","x":1070,"y":240,"wires":[["5bdcb861.0dff28"]]},{"id":"749a09d1.66cee8","type":"change","z":"5ad932d2.c06e2c","name":"auth payload","rules":[{"t":"set","p":"payload","pt":"msg","to":"{}","tot":"json"},{"t":"set","p":"payload.client_id","pt":"msg","to":"node-red-editor","tot":"str"},{"t":"set","p":"payload.grant_type","pt":"msg","to":"password","tot":"str"},{"t":"set","p":"payload.scope","pt":"msg","to":"","tot":"str"},{"t":"set","p":"payload.username","pt":"msg","to":"NRADM_USER","tot":"env"},{"t":"set","p":"payload.password","pt":"msg","to":"NRADM_PASS","tot":"env"}],"action":"","property":"","from":"","to":"","reg":false,"x":910,"y":240,"wires":[["f0163574.f68708"]]},{"id":"efcffad6.973858","type":"change","z":"5ad932d2.c06e2c","name":"","rules":[{"t":"set","p":"accessToken","pt":"msg","to":"payload.access_token","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":1400,"y":240,"wires":[["b891d447.d043c8"]]},{"id":"b891d447.d043c8","type":"change","z":"5ad932d2.c06e2c","name":"bearer","rules":[{"t":"set","p":"headers","pt":"msg","to":"{}","tot":"json"},{"t":"set","p":"headers.authorization","pt":"msg","to":"\"Bearer \" & msg.accessToken","tot":"jsonata"}],"action":"","property":"","from":"","to":"","reg":false,"x":1590,"y":240,"wires":[["10d21fb2.9cd25"]]},{"id":"e2bb956b.e86558","type":"http request","z":"5ad932d2.c06e2c","name":"auth","method":"POST","ret":"obj","paytoqs":"ignore","url":"https://localhost:1880/auth/token","tls":"b1a419c1.609c29","persist":false,"proxy":"","authType":"","x":910,"y":340,"wires":[["fdb94c3f.db9de"]]},{"id":"62946472.197c7c","type":"change","z":"5ad932d2.c06e2c","name":"auth payload","rules":[{"t":"set","p":"payload.client_id","pt":"msg","to":"node-red-editor","tot":"str"},{"t":"set","p":"payload.grant_type","pt":"msg","to":"password","tot":"str"},{"t":"set","p":"payload.scope","pt":"msg","to":"","tot":"str"},{"t":"set","p":"payload.username","pt":"msg","to":"NRADM_USER","tot":"env"},{"t":"set","p":"payload.password","pt":"msg","to":"NRADM_PASS","tot":"env"}],"action":"","property":"","from":"","to":"","reg":false,"x":750,"y":340,"wires":[["e2bb956b.e86558"]]},{"id":"f12be0e2.1778","type":"change","z":"5ad932d2.c06e2c","name":"","rules":[{"t":"set","p":"accessToken","pt":"msg","to":"payload.access_token","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":1240,"y":340,"wires":[["fd5ff4dd.c31358"]]},{"id":"fd5ff4dd.c31358","type":"change","z":"5ad932d2.c06e2c","name":"bearer","rules":[{"t":"set","p":"headers","pt":"msg","to":"{}","tot":"json"},{"t":"set","p":"headers.authorization","pt":"msg","to":"\"Bearer \" & msg.accessToken","tot":"jsonata"}],"action":"","property":"","from":"","to":"","reg":false,"x":1430,"y":340,"wires":[["6ce1c69c.eb4d88"]]},{"id":"23484a5f.556876","type":"http request","z":"5ad932d2.c06e2c","name":"","method":"POST","ret":"obj","paytoqs":"ignore","url":"${CFG_ACL_ENDP}","tls":"51b09598.a1114d","persist":false,"proxy":"","authType":"","x":590,"y":240,"wires":[["4f085922.f008e8"]]},{"id":"4f085922.f008e8","type":"switch","z":"5ad932d2.c06e2c","name":"","property":"statusCode","propertyType":"msg","rules":[{"t":"eq","v":"200","vt":"num"},{"t":"else"}],"checkall":"true","repair":false,"outputs":2,"x":750,"y":240,"wires":[["749a09d1.66cee8"],["aa0b46d5.ac40f8"]]},{"id":"c863ad48.7eac5","type":"http request","z":"5ad932d2.c06e2c","name":"","method":"POST","ret":"obj","paytoqs":"ignore","url":"${CFG_ACL_ENDP}","tls":"51b09598.a1114d","persist":false,"proxy":"","authType":"","x":430,"y":340,"wires":[["40e7798f.d8b548"]]},{"id":"40e7798f.d8b548","type":"switch","z":"5ad932d2.c06e2c","name":"","property":"statusCode","propertyType":"msg","rules":[{"t":"eq","v":"200","vt":"num"},{"t":"else"}],"checkall":"true","repair":false,"outputs":2,"x":590,"y":340,"wires":[["62946472.197c7c"],["8fb9c194.b70e3"]]},{"id":"cdb8dc8a.aadf5","type":"change","z":"5ad932d2.c06e2c","name":"acl req payload","rules":[{"t":"set","p":"headers","pt":"msg","to":"{}","tot":"json"},{"t":"set","p":"payload","pt":"msg","to":"{}","tot":"json"},{"t":"set","p":"payload.url","pt":"msg","to":"req.url","tot":"msg"},{"t":"set","p":"payload.method","pt":"msg","to":"req.method","tot":"msg"},{"t":"set","p":"payload.headers","pt":"msg","to":"req.headers","tot":"msg"},{"t":"set","p":"payload.params","pt":"msg","to":"req.params","tot":"msg"},{"t":"set","p":"payload.query","pt":"msg","to":"req.query","tot":"msg"},{"t":"set","p":"payload.body","pt":"msg","to":"req.body","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":240,"y":340,"wires":[["c863ad48.7eac5"]]},{"id":"88225c0b.735cc","type":"change","z":"5ad932d2.c06e2c","name":"acl req payload","rules":[{"t":"set","p":"headers","pt":"msg","to":"{}","tot":"json"},{"t":"set","p":"payload","pt":"msg","to":"{}","tot":"json"},{"t":"set","p":"payload.url","pt":"msg","to":"req.url","tot":"msg"},{"t":"set","p":"payload.method","pt":"msg","to":"req.method","tot":"msg"},{"t":"set","p":"payload.headers","pt":"msg","to":"req.headers","tot":"msg"},{"t":"set","p":"payload.params","pt":"msg","to":"req.params","tot":"msg"},{"t":"set","p":"payload.query","pt":"msg","to":"req.query","tot":"msg"},{"t":"set","p":"payload.body","pt":"msg","to":"req.body","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":400,"y":240,"wires":[["23484a5f.556876"]]},{"id":"8fb9c194.b70e3","type":"http response","z":"5ad932d2.c06e2c","name":"","statusCode":"","headers":{},"x":730,"y":380,"wires":[]},{"id":"143260e.b02dc9f","type":"change","z":"5ad932d2.c06e2c","name":"","rules":[{"t":"set","p":"payload","pt":"msg","to":"*[name = \"get between settings\" and type=\"change\"].rules[1].to","tot":"jsonata"}],"action":"","property":"","from":"","to":"","reg":false,"x":1900,"y":340,"wires":[["c1a6bff8.f89ba"]]},{"id":"c1e3269e.7129c8","type":"change","z":"5ad932d2.c06e2c","name":"edit","rules":[{"t":"set","p":"old","pt":"msg","to":"*[name = \"get between settings\" and type=\"change\"]","tot":"jsonata"},{"t":"set","p":"new","pt":"msg","to":"old","tot":"msg"},{"t":"set","p":"new.rules[1].to","pt":"msg","to":"to","tot":"msg"},{"t":"set","p":"payload","pt":"msg","to":"$eval($replace($string(payload),$string(old),$string(new)))","tot":"jsonata"}],"action":"","property":"","from":"","to":"","reg":false,"x":2030,"y":240,"wires":[["e1b730b8.c61ac"]]},{"id":"aa0b46d5.ac40f8","type":"http response","z":"5ad932d2.c06e2c","name":"","statusCode":"","headers":{},"x":890,"y":280,"wires":[]},{"id":"5bdcb861.0dff28","type":"switch","z":"5ad932d2.c06e2c","name":"","property":"statusCode","propertyType":"msg","rules":[{"t":"eq","v":"200","vt":"num"},{"t":"else"}],"checkall":"true","repair":false,"outputs":2,"x":1210,"y":240,"wires":[["efcffad6.973858"],["bb3b4896.1e6268"]]},{"id":"bb3b4896.1e6268","type":"http response","z":"5ad932d2.c06e2c","name":"","statusCode":"","headers":{},"x":1350,"y":280,"wires":[]},{"id":"be0620be.053a","type":"switch","z":"5ad932d2.c06e2c","name":"","property":"statusCode","propertyType":"msg","rules":[{"t":"eq","v":"200","vt":"num"},{"t":"else"}],"checkall":"true","repair":false,"outputs":2,"x":1890,"y":240,"wires":[["c1e3269e.7129c8"],["3e2a60e.bbb67a"]]},{"id":"3e2a60e.bbb67a","type":"http response","z":"5ad932d2.c06e2c","name":"","statusCode":"","headers":{},"x":2030,"y":280,"wires":[]},{"id":"e1b730b8.c61ac","type":"function","z":"5ad932d2.c06e2c","name":"update flows","func":"const http = global.get('https');\nconst data = JSON.stringify(msg.payload);\nconst options = {\n  hostname: 'localhost',\n  port: 1880,\n  path: '/flows',\n  method: 'POST',\n  headers: {\n    'Content-Type': 'application/json',\n    'Content-Length': data.length,\n    'Authorization': 'Bearer '+msg.accessToken\n  },\n  rejectUnauthorized: false\n};\nconst req = http.request(options);\nreq.write(data);\nreq.end();\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":2190,"y":240,"wires":[["7c201fb5.901de"]]},{"id":"fdb94c3f.db9de","type":"switch","z":"5ad932d2.c06e2c","name":"","property":"statusCode","propertyType":"msg","rules":[{"t":"eq","v":"200","vt":"num"},{"t":"else"}],"checkall":"true","repair":false,"outputs":2,"x":1050,"y":340,"wires":[["f12be0e2.1778"],["d45e3790.cc2c18"]]},{"id":"d45e3790.cc2c18","type":"http response","z":"5ad932d2.c06e2c","name":"","statusCode":"","headers":{},"x":1190,"y":380,"wires":[]},{"id":"84d61d5a.de0e4","type":"switch","z":"5ad932d2.c06e2c","name":"","property":"statusCode","propertyType":"msg","rules":[{"t":"eq","v":"200","vt":"num"},{"t":"else"}],"checkall":"true","repair":false,"outputs":2,"x":1730,"y":340,"wires":[["143260e.b02dc9f"],["335678e.e6a5b88"]]},{"id":"335678e.e6a5b88","type":"http response","z":"5ad932d2.c06e2c","name":"","statusCode":"","headers":{},"x":1870,"y":380,"wires":[]},{"id":"4f9f4ee.a8338b","type":"http in","z":"15706c00.b04294","name":"PUT threshold","url":"/greaterthan/threshold","method":"put","upload":false,"swaggerDoc":"","x":90,"y":40,"wires":[["24421cbe.3e3d54"]]},{"id":"c1a45052.f88ae","type":"change","z":"15706c00.b04294","name":"","rules":[{"t":"set","p":"payload","pt":"msg","to":"threshold","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":2400,"y":40,"wires":[["520593c4.bcd44c"]]},{"id":"4e6e0517.19185c","type":"http in","z":"15706c00.b04294","name":"GET threshold","url":"/greaterthan/threshold","method":"get","upload":false,"swaggerDoc":"","x":90,"y":140,"wires":[["50035113.c6893"]]},{"id":"98a4aa2f.44cc88","type":"http response","z":"15706c00.b04294","name":"","statusCode":"","headers":{},"x":2290,"y":140,"wires":[]},{"id":"e257b469.588868","type":"change","z":"15706c00.b04294","name":"","rules":[{"t":"set","p":"headers","pt":"msg","to":"{\"Content-Type\":\"text/plain\"}","tot":"json"}],"action":"","property":"","from":"","to":"","reg":false,"x":2120,"y":140,"wires":[["98a4aa2f.44cc88"]]},{"id":"24421cbe.3e3d54","type":"change","z":"15706c00.b04294","name":"get inputs","rules":[{"t":"set","p":"threshold","pt":"msg","to":"payload","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":240,"y":40,"wires":[["41e9c707.0c3a88"]]},{"id":"c70e3202.70e57","type":"http request","z":"15706c00.b04294","name":"get flows","method":"GET","ret":"obj","paytoqs":"ignore","url":"https://localhost:1880/flows","tls":"b1a419c1.609c29","persist":false,"proxy":"","authType":"","x":1760,"y":40,"wires":[["b8fb213c.1400e"]]},{"id":"770c9529.0a876c","type":"http response","z":"15706c00.b04294","name":"","statusCode":"","headers":{},"x":2770,"y":40,"wires":[]},{"id":"520593c4.bcd44c","type":"change","z":"15706c00.b04294","name":"","rules":[{"t":"set","p":"headers","pt":"msg","to":"{\"Content-Type\":\"text/plain\"}","tot":"json"}],"action":"","property":"","from":"","to":"","reg":false,"x":2600,"y":40,"wires":[["770c9529.0a876c","fd5f1bb8.5e2448"]]},{"id":"ce971fd7.6d803","type":"http request","z":"15706c00.b04294","name":"get flows","method":"GET","ret":"obj","paytoqs":"ignore","url":"https://localhost:1880/flows","tls":"b1a419c1.609c29","persist":false,"proxy":"","authType":"","x":1600,"y":140,"wires":[["4037427a.3c806c"]]},{"id":"c7039cb7.5bba1","type":"http request","z":"15706c00.b04294","name":"auth","method":"POST","ret":"obj","paytoqs":"ignore","url":"https://localhost:1880/auth/token","tls":"b1a419c1.609c29","persist":false,"proxy":"","authType":"","x":1090,"y":40,"wires":[["d464fa1d.061c78"]]},{"id":"c62e079f.aed1f8","type":"change","z":"15706c00.b04294","name":"auth payload","rules":[{"t":"set","p":"payload","pt":"msg","to":"{}","tot":"json"},{"t":"set","p":"payload.client_id","pt":"msg","to":"node-red-editor","tot":"str"},{"t":"set","p":"payload.grant_type","pt":"msg","to":"password","tot":"str"},{"t":"set","p":"payload.scope","pt":"msg","to":"","tot":"str"},{"t":"set","p":"payload.username","pt":"msg","to":"NRADM_USER","tot":"env"},{"t":"set","p":"payload.password","pt":"msg","to":"NRADM_PASS","tot":"env"}],"action":"","property":"","from":"","to":"","reg":false,"x":930,"y":40,"wires":[["c7039cb7.5bba1"]]},{"id":"30736663.8d886a","type":"change","z":"15706c00.b04294","name":"","rules":[{"t":"set","p":"accessToken","pt":"msg","to":"payload.access_token","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":1420,"y":40,"wires":[["e051bc2c.38fc2"]]},{"id":"e051bc2c.38fc2","type":"change","z":"15706c00.b04294","name":"bearer","rules":[{"t":"set","p":"headers","pt":"msg","to":"{}","tot":"json"},{"t":"set","p":"headers.authorization","pt":"msg","to":"\"Bearer \" & msg.accessToken","tot":"jsonata"}],"action":"","property":"","from":"","to":"","reg":false,"x":1610,"y":40,"wires":[["c70e3202.70e57"]]},{"id":"535c8707.a90e38","type":"http request","z":"15706c00.b04294","name":"auth","method":"POST","ret":"obj","paytoqs":"ignore","url":"https://localhost:1880/auth/token","tls":"b1a419c1.609c29","persist":false,"proxy":"","authType":"","x":930,"y":140,"wires":[["9cef2354.19098"]]},{"id":"46628feb.99781","type":"change","z":"15706c00.b04294","name":"auth payload","rules":[{"t":"set","p":"payload.client_id","pt":"msg","to":"node-red-editor","tot":"str"},{"t":"set","p":"payload.grant_type","pt":"msg","to":"password","tot":"str"},{"t":"set","p":"payload.scope","pt":"msg","to":"","tot":"str"},{"t":"set","p":"payload.username","pt":"msg","to":"NRADM_USER","tot":"env"},{"t":"set","p":"payload.password","pt":"msg","to":"NRADM_PASS","tot":"env"}],"action":"","property":"","from":"","to":"","reg":false,"x":770,"y":140,"wires":[["535c8707.a90e38"]]},{"id":"942e1302.8bf4b","type":"change","z":"15706c00.b04294","name":"","rules":[{"t":"set","p":"accessToken","pt":"msg","to":"payload.access_token","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":1260,"y":140,"wires":[["7f1bf15b.2eed7"]]},{"id":"7f1bf15b.2eed7","type":"change","z":"15706c00.b04294","name":"bearer","rules":[{"t":"set","p":"headers","pt":"msg","to":"{}","tot":"json"},{"t":"set","p":"headers.authorization","pt":"msg","to":"\"Bearer \" & msg.accessToken","tot":"jsonata"}],"action":"","property":"","from":"","to":"","reg":false,"x":1450,"y":140,"wires":[["ce971fd7.6d803"]]},{"id":"48e48b48.5954a4","type":"http request","z":"15706c00.b04294","name":"","method":"POST","ret":"obj","paytoqs":"ignore","url":"${CFG_ACL_ENDP}","tls":"51b09598.a1114d","persist":false,"proxy":"","authType":"","x":610,"y":40,"wires":[["7efa1492.8bf0ac"]]},{"id":"7efa1492.8bf0ac","type":"switch","z":"15706c00.b04294","name":"","property":"statusCode","propertyType":"msg","rules":[{"t":"eq","v":"200","vt":"num"},{"t":"else"}],"checkall":"true","repair":false,"outputs":2,"x":770,"y":40,"wires":[["c62e079f.aed1f8"],["ed43d6c6.ea4a88"]]},{"id":"4b459efb.6aeed","type":"http request","z":"15706c00.b04294","name":"","method":"POST","ret":"obj","paytoqs":"ignore","url":"${CFG_ACL_ENDP}","tls":"51b09598.a1114d","persist":false,"proxy":"","authType":"","x":450,"y":140,"wires":[["92cde54f.521de8"]]},{"id":"92cde54f.521de8","type":"switch","z":"15706c00.b04294","name":"","property":"statusCode","propertyType":"msg","rules":[{"t":"eq","v":"200","vt":"num"},{"t":"else"}],"checkall":"true","repair":false,"outputs":2,"x":610,"y":140,"wires":[["46628feb.99781"],["2399ce65.c30752"]]},{"id":"50035113.c6893","type":"change","z":"15706c00.b04294","name":"acl req payload","rules":[{"t":"set","p":"headers","pt":"msg","to":"{}","tot":"json"},{"t":"set","p":"payload","pt":"msg","to":"{}","tot":"json"},{"t":"set","p":"payload.url","pt":"msg","to":"req.url","tot":"msg"},{"t":"set","p":"payload.method","pt":"msg","to":"req.method","tot":"msg"},{"t":"set","p":"payload.headers","pt":"msg","to":"req.headers","tot":"msg"},{"t":"set","p":"payload.params","pt":"msg","to":"req.params","tot":"msg"},{"t":"set","p":"payload.query","pt":"msg","to":"req.query","tot":"msg"},{"t":"set","p":"payload.body","pt":"msg","to":"req.body","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":260,"y":140,"wires":[["4b459efb.6aeed"]]},{"id":"41e9c707.0c3a88","type":"change","z":"15706c00.b04294","name":"acl req payload","rules":[{"t":"set","p":"headers","pt":"msg","to":"{}","tot":"json"},{"t":"set","p":"payload","pt":"msg","to":"{}","tot":"json"},{"t":"set","p":"payload.url","pt":"msg","to":"req.url","tot":"msg"},{"t":"set","p":"payload.method","pt":"msg","to":"req.method","tot":"msg"},{"t":"set","p":"payload.headers","pt":"msg","to":"req.headers","tot":"msg"},{"t":"set","p":"payload.params","pt":"msg","to":"req.params","tot":"msg"},{"t":"set","p":"payload.query","pt":"msg","to":"req.query","tot":"msg"},{"t":"set","p":"payload.body","pt":"msg","to":"req.body","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":420,"y":40,"wires":[["48e48b48.5954a4"]]},{"id":"2399ce65.c30752","type":"http response","z":"15706c00.b04294","name":"","statusCode":"","headers":{},"x":750,"y":180,"wires":[]},{"id":"b96257b6.6b7d68","type":"change","z":"15706c00.b04294","name":"","rules":[{"t":"set","p":"payload","pt":"msg","to":"*[name = \"get greaterthan threshold\" and type=\"change\"].rules[0].to","tot":"jsonata"}],"action":"","property":"","from":"","to":"","reg":false,"x":1920,"y":140,"wires":[["e257b469.588868"]]},{"id":"374a015c.2c61ae","type":"change","z":"15706c00.b04294","name":"edit","rules":[{"t":"set","p":"old","pt":"msg","to":"*[name = \"get greaterthan threshold\" and type=\"change\"]","tot":"jsonata"},{"t":"set","p":"new","pt":"msg","to":"old","tot":"msg"},{"t":"set","p":"new.rules[0].to","pt":"msg","to":"threshold","tot":"msg"},{"t":"set","p":"payload","pt":"msg","to":"$eval($replace($string(payload),$string(old),$string(new)))","tot":"jsonata"}],"action":"","property":"","from":"","to":"","reg":false,"x":2050,"y":40,"wires":[["3b767b1c.620964"]]},{"id":"ed43d6c6.ea4a88","type":"http response","z":"15706c00.b04294","name":"","statusCode":"","headers":{},"x":910,"y":80,"wires":[]},{"id":"d464fa1d.061c78","type":"switch","z":"15706c00.b04294","name":"","property":"statusCode","propertyType":"msg","rules":[{"t":"eq","v":"200","vt":"num"},{"t":"else"}],"checkall":"true","repair":false,"outputs":2,"x":1230,"y":40,"wires":[["30736663.8d886a"],["f179b790.cb9618"]]},{"id":"f179b790.cb9618","type":"http response","z":"15706c00.b04294","name":"","statusCode":"","headers":{},"x":1370,"y":80,"wires":[]},{"id":"b8fb213c.1400e","type":"switch","z":"15706c00.b04294","name":"","property":"statusCode","propertyType":"msg","rules":[{"t":"eq","v":"200","vt":"num"},{"t":"else"}],"checkall":"true","repair":false,"outputs":2,"x":1910,"y":40,"wires":[["374a015c.2c61ae"],["e43be90.73d5d18"]]},{"id":"e43be90.73d5d18","type":"http response","z":"15706c00.b04294","name":"","statusCode":"","headers":{},"x":2050,"y":80,"wires":[]},{"id":"3b767b1c.620964","type":"function","z":"15706c00.b04294","name":"update flows","func":"const http = global.get('https');\nconst data = JSON.stringify(msg.payload);\nconst options = {\n  hostname: 'localhost',\n  port: 1880,\n  path: '/flows',\n  method: 'POST',\n  headers: {\n    'Content-Type': 'application/json',\n    'Content-Length': data.length,\n    'Authorization': 'Bearer '+msg.accessToken\n  },\n  rejectUnauthorized: false\n};\nconst req = http.request(options);\nreq.write(data);\nreq.end();\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":2210,"y":40,"wires":[["c1a45052.f88ae"]]},{"id":"9cef2354.19098","type":"switch","z":"15706c00.b04294","name":"","property":"statusCode","propertyType":"msg","rules":[{"t":"eq","v":"200","vt":"num"},{"t":"else"}],"checkall":"true","repair":false,"outputs":2,"x":1070,"y":140,"wires":[["942e1302.8bf4b"],["e0660490.1db848"]]},{"id":"e0660490.1db848","type":"http response","z":"15706c00.b04294","name":"","statusCode":"","headers":{},"x":1210,"y":180,"wires":[]},{"id":"4037427a.3c806c","type":"switch","z":"15706c00.b04294","name":"","property":"statusCode","propertyType":"msg","rules":[{"t":"eq","v":"200","vt":"num"},{"t":"else"}],"checkall":"true","repair":false,"outputs":2,"x":1750,"y":140,"wires":[["b96257b6.6b7d68"],["5aa259f6.8bfc18"]]},{"id":"5aa259f6.8bfc18","type":"http response","z":"15706c00.b04294","name":"","statusCode":"","headers":{},"x":1890,"y":180,"wires":[]},{"id":"94bec704.2f0148","type":"change","z":"15706c00.b04294","name":"status out","rules":[{"t":"set","p":"status","pt":"msg","to":"{ \"out\": payload }","tot":"jsonata"}],"action":"","property":"","from":"","to":"","reg":false,"x":900,"y":300,"wires":[["41418afc.df50a4"]]},{"id":"abef1b61.f3f5b8","type":"change","z":"15706c00.b04294","name":"status in","rules":[{"t":"set","p":"status","pt":"msg","to":"{}","tot":"json"},{"t":"set","p":"status.in","pt":"msg","to":"payload","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":160,"y":360,"wires":[["41418afc.df50a4"]]},{"id":"41418afc.df50a4","type":"join","z":"15706c00.b04294","name":"","mode":"custom","build":"merged","property":"status","propertyType":"msg","key":"topic","joiner":"\\n","joinerType":"str","accumulate":false,"timeout":"","count":"2","reduceRight":false,"reduceExp":"","reduceInit":"","reduceInitType":"","reduceFixup":"","x":870,"y":360,"wires":[["c1009857.9bf878"]]},{"id":"c1009857.9bf878","type":"change","z":"15706c00.b04294","name":"status","rules":[{"t":"set","p":"payload","pt":"msg","to":"{}","tot":"json"},{"t":"set","p":"payload.text","pt":"msg","to":"$boolean(status.error) ? \"error: \" & status.error : $boolean(status.out) ? \"forwarded: \" & status.out : \"discarded: \" & status.in","tot":"jsonata"},{"t":"set","p":"payload.shape","pt":"msg","to":"dot","tot":"str"},{"t":"set","p":"payload.fill","pt":"msg","to":"$boolean(status.out) ? \"green\" : $boolean(status.error) ? \"red\" : \"yellow\"","tot":"jsonata"}],"action":"","property":"","from":"","to":"","reg":false,"x":1010,"y":360,"wires":[[]]},{"id":"94e54c90.a871e","type":"switch","z":"2b718b38.a1a7b4","name":"","property":"payload","propertyType":"msg","rules":[{"t":"lt","v":"threshold","vt":"msg"},{"t":"else"}],"checkall":"true","repair":false,"outputs":2,"x":710,"y":240,"wires":[["d6b0e9a3.023578"],["58901566.2ea99c"]]},{"id":"de2444c3.8394c8","type":"change","z":"2b718b38.a1a7b4","name":"get lowerthan threshold","rules":[{"t":"set","p":"threshold","pt":"msg","to":"","tot":"str"}],"action":"","property":"","from":"","to":"","reg":false,"x":210,"y":240,"wires":[["d5ee2a5c.222428"]]},{"id":"8724d39c.44d86","type":"change","z":"2b718b38.a1a7b4","name":"to number","rules":[{"t":"set","p":"payload","pt":"msg","to":"$number(payload)","tot":"jsonata"},{"t":"set","p":"threshold","pt":"msg","to":"$number(threshold)","tot":"jsonata"},{"t":"set","p":"status","pt":"msg","to":"{ \"out\": null }","tot":"json"}],"action":"","property":"","from":"","to":"","reg":false,"x":560,"y":240,"wires":[["94e54c90.a871e"]]},{"id":"b1c4fdd1.d6c75","type":"http in","z":"2b718b38.a1a7b4","name":"PUT threshold","url":"/lowerthan/threshold","method":"put","upload":false,"swaggerDoc":"","x":90,"y":40,"wires":[["1148906f.f2832"]]},{"id":"fe6b1791.17d9e8","type":"change","z":"2b718b38.a1a7b4","name":"","rules":[{"t":"set","p":"payload","pt":"msg","to":"threshold","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":2400,"y":40,"wires":[["3cd8e5d6.a0a72a"]]},{"id":"a950a1ce.55882","type":"http in","z":"2b718b38.a1a7b4","name":"GET threshold","url":"/lowerthan/threshold","method":"get","upload":false,"swaggerDoc":"","x":90,"y":140,"wires":[["656264b7.17f85c"]]},{"id":"a1043dec.de3bc","type":"http response","z":"2b718b38.a1a7b4","name":"","statusCode":"","headers":{},"x":2290,"y":140,"wires":[]},{"id":"87cd5b1f.abb918","type":"change","z":"2b718b38.a1a7b4","name":"","rules":[{"t":"set","p":"headers","pt":"msg","to":"{\"Content-Type\":\"text/plain\"}","tot":"json"}],"action":"","property":"","from":"","to":"","reg":false,"x":2120,"y":140,"wires":[["a1043dec.de3bc"]]},{"id":"1148906f.f2832","type":"change","z":"2b718b38.a1a7b4","name":"get inputs","rules":[{"t":"set","p":"threshold","pt":"msg","to":"payload","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":240,"y":40,"wires":[["218e307c.16d82"]]},{"id":"2db63977.39bc46","type":"http request","z":"2b718b38.a1a7b4","name":"get flows","method":"GET","ret":"obj","paytoqs":"ignore","url":"https://localhost:1880/flows","tls":"b1a419c1.609c29","persist":false,"proxy":"","authType":"","x":1760,"y":40,"wires":[["814f357b.f7a498"]]},{"id":"fb80778f.020148","type":"http response","z":"2b718b38.a1a7b4","name":"","statusCode":"","headers":{},"x":2770,"y":40,"wires":[]},{"id":"3cd8e5d6.a0a72a","type":"change","z":"2b718b38.a1a7b4","name":"","rules":[{"t":"set","p":"headers","pt":"msg","to":"{\"Content-Type\":\"text/plain\"}","tot":"json"}],"action":"","property":"","from":"","to":"","reg":false,"x":2600,"y":40,"wires":[["fb80778f.020148","66ede242.221f5c"]]},{"id":"1e6793b3.605cfc","type":"http request","z":"2b718b38.a1a7b4","name":"get flows","method":"GET","ret":"obj","paytoqs":"ignore","url":"https://localhost:1880/flows","tls":"b1a419c1.609c29","persist":false,"proxy":"","authType":"","x":1600,"y":140,"wires":[["709e57f8.f36028"]]},{"id":"562938e9.d69668","type":"http request","z":"2b718b38.a1a7b4","name":"auth","method":"POST","ret":"obj","paytoqs":"ignore","url":"https://localhost:1880/auth/token","tls":"b1a419c1.609c29","persist":false,"proxy":"","authType":"","x":1090,"y":40,"wires":[["2c8daa3e.0dd0b6"]]},{"id":"8fb94f90.5fc87","type":"change","z":"2b718b38.a1a7b4","name":"auth payload","rules":[{"t":"set","p":"payload","pt":"msg","to":"{}","tot":"json"},{"t":"set","p":"payload.client_id","pt":"msg","to":"node-red-editor","tot":"str"},{"t":"set","p":"payload.grant_type","pt":"msg","to":"password","tot":"str"},{"t":"set","p":"payload.scope","pt":"msg","to":"","tot":"str"},{"t":"set","p":"payload.username","pt":"msg","to":"NRADM_USER","tot":"env"},{"t":"set","p":"payload.password","pt":"msg","to":"NRADM_PASS","tot":"env"}],"action":"","property":"","from":"","to":"","reg":false,"x":930,"y":40,"wires":[["562938e9.d69668"]]},{"id":"db810e04.46aa","type":"change","z":"2b718b38.a1a7b4","name":"","rules":[{"t":"set","p":"accessToken","pt":"msg","to":"payload.access_token","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":1420,"y":40,"wires":[["f0483748.f07198"]]},{"id":"f0483748.f07198","type":"change","z":"2b718b38.a1a7b4","name":"bearer","rules":[{"t":"set","p":"headers","pt":"msg","to":"{}","tot":"json"},{"t":"set","p":"headers.authorization","pt":"msg","to":"\"Bearer \" & msg.accessToken","tot":"jsonata"}],"action":"","property":"","from":"","to":"","reg":false,"x":1610,"y":40,"wires":[["2db63977.39bc46"]]},{"id":"2dc3c60c.e8116a","type":"http request","z":"2b718b38.a1a7b4","name":"auth","method":"POST","ret":"obj","paytoqs":"ignore","url":"https://localhost:1880/auth/token","tls":"b1a419c1.609c29","persist":false,"proxy":"","authType":"","x":930,"y":140,"wires":[["c7589b7d.fcc578"]]},{"id":"74dc7620.9e8678","type":"change","z":"2b718b38.a1a7b4","name":"auth payload","rules":[{"t":"set","p":"payload.client_id","pt":"msg","to":"node-red-editor","tot":"str"},{"t":"set","p":"payload.grant_type","pt":"msg","to":"password","tot":"str"},{"t":"set","p":"payload.scope","pt":"msg","to":"","tot":"str"},{"t":"set","p":"payload.username","pt":"msg","to":"NRADM_USER","tot":"env"},{"t":"set","p":"payload.password","pt":"msg","to":"NRADM_PASS","tot":"env"}],"action":"","property":"","from":"","to":"","reg":false,"x":770,"y":140,"wires":[["2dc3c60c.e8116a"]]},{"id":"1d216223.8b852e","type":"change","z":"2b718b38.a1a7b4","name":"","rules":[{"t":"set","p":"accessToken","pt":"msg","to":"payload.access_token","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":1260,"y":140,"wires":[["40de1053.05834"]]},{"id":"40de1053.05834","type":"change","z":"2b718b38.a1a7b4","name":"bearer","rules":[{"t":"set","p":"headers","pt":"msg","to":"{}","tot":"json"},{"t":"set","p":"headers.authorization","pt":"msg","to":"\"Bearer \" & msg.accessToken","tot":"jsonata"}],"action":"","property":"","from":"","to":"","reg":false,"x":1450,"y":140,"wires":[["1e6793b3.605cfc"]]},{"id":"83b5aac.7fd1058","type":"http request","z":"2b718b38.a1a7b4","name":"","method":"POST","ret":"obj","paytoqs":"ignore","url":"${CFG_ACL_ENDP}","tls":"51b09598.a1114d","persist":false,"proxy":"","authType":"basic","x":610,"y":40,"wires":[["c6f4911c.5d0a9"]]},{"id":"c6f4911c.5d0a9","type":"switch","z":"2b718b38.a1a7b4","name":"","property":"statusCode","propertyType":"msg","rules":[{"t":"eq","v":"200","vt":"num"},{"t":"else"}],"checkall":"true","repair":false,"outputs":2,"x":770,"y":40,"wires":[["8fb94f90.5fc87"],["5763833d.58aedc"]]},{"id":"472cbf14.7efb2","type":"http request","z":"2b718b38.a1a7b4","name":"","method":"POST","ret":"obj","paytoqs":"ignore","url":"${CFG_ACL_ENDP}","tls":"51b09598.a1114d","persist":false,"proxy":"","authType":"basic","x":450,"y":140,"wires":[["797069f1.d69d98"]]},{"id":"797069f1.d69d98","type":"switch","z":"2b718b38.a1a7b4","name":"","property":"statusCode","propertyType":"msg","rules":[{"t":"eq","v":"200","vt":"num"},{"t":"else"}],"checkall":"true","repair":false,"outputs":2,"x":610,"y":140,"wires":[["74dc7620.9e8678"],["5d23c234.42453c"]]},{"id":"656264b7.17f85c","type":"change","z":"2b718b38.a1a7b4","name":"acl req payload","rules":[{"t":"set","p":"headers","pt":"msg","to":"{}","tot":"json"},{"t":"set","p":"payload","pt":"msg","to":"{}","tot":"json"},{"t":"set","p":"payload.url","pt":"msg","to":"req.url","tot":"msg"},{"t":"set","p":"payload.method","pt":"msg","to":"req.method","tot":"msg"},{"t":"set","p":"payload.headers","pt":"msg","to":"req.headers","tot":"msg"},{"t":"set","p":"payload.params","pt":"msg","to":"req.params","tot":"msg"},{"t":"set","p":"payload.query","pt":"msg","to":"req.query","tot":"msg"},{"t":"set","p":"payload.body","pt":"msg","to":"req.body","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":260,"y":140,"wires":[["472cbf14.7efb2"]]},{"id":"218e307c.16d82","type":"change","z":"2b718b38.a1a7b4","name":"acl req payload","rules":[{"t":"set","p":"headers","pt":"msg","to":"{}","tot":"json"},{"t":"set","p":"payload","pt":"msg","to":"{}","tot":"json"},{"t":"set","p":"payload.url","pt":"msg","to":"req.url","tot":"msg"},{"t":"set","p":"payload.method","pt":"msg","to":"req.method","tot":"msg"},{"t":"set","p":"payload.headers","pt":"msg","to":"req.headers","tot":"msg"},{"t":"set","p":"payload.params","pt":"msg","to":"req.params","tot":"msg"},{"t":"set","p":"payload.query","pt":"msg","to":"req.query","tot":"msg"},{"t":"set","p":"payload.body","pt":"msg","to":"req.body","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":420,"y":40,"wires":[["83b5aac.7fd1058"]]},{"id":"5d23c234.42453c","type":"http response","z":"2b718b38.a1a7b4","name":"","statusCode":"","headers":{},"x":750,"y":180,"wires":[]},{"id":"ac48f1a2.1e326","type":"change","z":"2b718b38.a1a7b4","name":"","rules":[{"t":"set","p":"payload","pt":"msg","to":"*[name = \"get lowerthan threshold\" and type=\"change\"].rules[0].to","tot":"jsonata"}],"action":"","property":"","from":"","to":"","reg":false,"x":1920,"y":140,"wires":[["87cd5b1f.abb918"]]},{"id":"65731f28.cb352","type":"change","z":"2b718b38.a1a7b4","name":"edit","rules":[{"t":"set","p":"old","pt":"msg","to":"*[name = \"get lowerthan threshold\" and type=\"change\"]","tot":"jsonata"},{"t":"set","p":"new","pt":"msg","to":"old","tot":"msg"},{"t":"set","p":"new.rules[0].to","pt":"msg","to":"threshold","tot":"msg"},{"t":"set","p":"payload","pt":"msg","to":"$eval($replace($string(payload),$string(old),$string(new)))","tot":"jsonata"}],"action":"","property":"","from":"","to":"","reg":false,"x":2050,"y":40,"wires":[["4f791bf2.9c12f4"]]},{"id":"5763833d.58aedc","type":"http response","z":"2b718b38.a1a7b4","name":"","statusCode":"","headers":{},"x":910,"y":80,"wires":[]},{"id":"2c8daa3e.0dd0b6","type":"switch","z":"2b718b38.a1a7b4","name":"","property":"statusCode","propertyType":"msg","rules":[{"t":"eq","v":"200","vt":"num"},{"t":"else"}],"checkall":"true","repair":false,"outputs":2,"x":1230,"y":40,"wires":[["db810e04.46aa"],["107ef8d8.115957"]]},{"id":"107ef8d8.115957","type":"http response","z":"2b718b38.a1a7b4","name":"","statusCode":"","headers":{},"x":1370,"y":80,"wires":[]},{"id":"814f357b.f7a498","type":"switch","z":"2b718b38.a1a7b4","name":"","property":"statusCode","propertyType":"msg","rules":[{"t":"eq","v":"200","vt":"num"},{"t":"else"}],"checkall":"true","repair":false,"outputs":2,"x":1910,"y":40,"wires":[["65731f28.cb352"],["36c3b350.ada8fc"]]},{"id":"36c3b350.ada8fc","type":"http response","z":"2b718b38.a1a7b4","name":"","statusCode":"","headers":{},"x":2050,"y":80,"wires":[]},{"id":"4f791bf2.9c12f4","type":"function","z":"2b718b38.a1a7b4","name":"update flows","func":"const http = global.get('https');\nconst data = JSON.stringify(msg.payload);\nconst options = {\n  hostname: 'localhost',\n  port: 1880,\n  path: '/flows',\n  method: 'POST',\n  headers: {\n    'Content-Type': 'application/json',\n    'Content-Length': data.length,\n    'Authorization': 'Bearer '+msg.accessToken\n  },\n  rejectUnauthorized: false\n};\nconst req = http.request(options);\nreq.write(data);\nreq.end();\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":2210,"y":40,"wires":[["fe6b1791.17d9e8"]]},{"id":"c7589b7d.fcc578","type":"switch","z":"2b718b38.a1a7b4","name":"","property":"statusCode","propertyType":"msg","rules":[{"t":"eq","v":"200","vt":"num"},{"t":"else"}],"checkall":"true","repair":false,"outputs":2,"x":1070,"y":140,"wires":[["1d216223.8b852e"],["4bf77588.616adc"]]},{"id":"4bf77588.616adc","type":"http response","z":"2b718b38.a1a7b4","name":"","statusCode":"","headers":{},"x":1210,"y":180,"wires":[]},{"id":"709e57f8.f36028","type":"switch","z":"2b718b38.a1a7b4","name":"","property":"statusCode","propertyType":"msg","rules":[{"t":"eq","v":"200","vt":"num"},{"t":"else"}],"checkall":"true","repair":false,"outputs":2,"x":1750,"y":140,"wires":[["ac48f1a2.1e326"],["7742ce98.e09fc"]]},{"id":"7742ce98.e09fc","type":"http response","z":"2b718b38.a1a7b4","name":"","statusCode":"","headers":{},"x":1890,"y":180,"wires":[]},{"id":"d6b0e9a3.023578","type":"change","z":"2b718b38.a1a7b4","name":"status out","rules":[{"t":"set","p":"status","pt":"msg","to":"{ \"out\": payload }","tot":"jsonata"}],"action":"","property":"","from":"","to":"","reg":false,"x":900,"y":280,"wires":[["58901566.2ea99c"]]},{"id":"3ce3153a.e5e27a","type":"change","z":"2b718b38.a1a7b4","name":"status in","rules":[{"t":"set","p":"status","pt":"msg","to":"{}","tot":"msg"},{"t":"set","p":"status.in","pt":"msg","to":"payload","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":160,"y":340,"wires":[["58901566.2ea99c"]]},{"id":"58901566.2ea99c","type":"join","z":"2b718b38.a1a7b4","name":"","mode":"custom","build":"merged","property":"status","propertyType":"msg","key":"topic","joiner":"\\n","joinerType":"str","accumulate":false,"timeout":"","count":"2","reduceRight":false,"reduceExp":"","reduceInit":"","reduceInitType":"","reduceFixup":"","x":890,"y":340,"wires":[["b7c7052f.193038"]]},{"id":"6f2be22f.2a5c5c","type":"switch","z":"189ac7e1.52f288","name":"","property":"payload","propertyType":"msg","rules":[{"t":"btwn","v":"from","vt":"msg","v2":"to","v2t":"msg"},{"t":"else"}],"checkall":"true","repair":false,"outputs":2,"x":690,"y":560,"wires":[["29c42bf0.04f6f4"],["e8d76f26.163ee"]]},{"id":"9b96030c.d311","type":"change","z":"189ac7e1.52f288","name":"get outside settings","rules":[{"t":"set","p":"from","pt":"msg","to":"","tot":"str"},{"t":"set","p":"to","pt":"msg","to":"","tot":"str"}],"action":"","property":"","from":"","to":"","reg":false,"x":210,"y":560,"wires":[["19f0b1a9.9f791e"]]},{"id":"e1beda2a.24c408","type":"change","z":"189ac7e1.52f288","name":"to number","rules":[{"t":"set","p":"payload","pt":"msg","to":"$number(payload)","tot":"jsonata"},{"t":"set","p":"from","pt":"msg","to":"$number(from)","tot":"jsonata"},{"t":"set","p":"to","pt":"msg","to":"$number(to)","tot":"jsonata"},{"t":"set","p":"status","pt":"msg","to":"{ \"out\": null }","tot":"json"}],"action":"","property":"","from":"","to":"","reg":false,"x":540,"y":560,"wires":[["6f2be22f.2a5c5c"]]},{"id":"e8d76f26.163ee","type":"change","z":"189ac7e1.52f288","name":"status out","rules":[{"t":"set","p":"status.out","pt":"msg","to":"payload","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":900,"y":540,"wires":[["29c42bf0.04f6f4"]]},{"id":"36847680.a50b7a","type":"change","z":"189ac7e1.52f288","name":"status in","rules":[{"t":"set","p":"status","pt":"msg","to":"{}","tot":"msg"},{"t":"set","p":"status.in","pt":"msg","to":"payload","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":180,"y":460,"wires":[["29c42bf0.04f6f4"]]},{"id":"29c42bf0.04f6f4","type":"join","z":"189ac7e1.52f288","name":"","mode":"custom","build":"merged","property":"status","propertyType":"msg","key":"topic","joiner":"\\n","joinerType":"str","accumulate":false,"timeout":"","count":"2","reduceRight":false,"reduceExp":"","reduceInit":"","reduceInitType":"","reduceFixup":"","x":890,"y":460,"wires":[["f5e3320e.206b4"]]},{"id":"fe5d5c12.6f429","type":"http in","z":"189ac7e1.52f288","name":"PUT from","url":"/outside/from","method":"put","upload":false,"swaggerDoc":"","x":100,"y":40,"wires":[["4477a7a0.234278"]]},{"id":"c4e34fc8.5e9ce","type":"change","z":"189ac7e1.52f288","name":"","rules":[{"t":"set","p":"payload","pt":"msg","to":"from","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":2420,"y":40,"wires":[["ace4f102.8b7ca"]]},{"id":"e3e9c5b2.cbac38","type":"http in","z":"189ac7e1.52f288","name":"GET from","url":"/outside/from","method":"get","upload":false,"swaggerDoc":"","x":100,"y":140,"wires":[["442afc77.fd8334"]]},{"id":"f4225ba6.5d6268","type":"http response","z":"189ac7e1.52f288","name":"","statusCode":"","headers":{},"x":2310,"y":140,"wires":[]},{"id":"7fe664d0.dbfbcc","type":"change","z":"189ac7e1.52f288","name":"","rules":[{"t":"set","p":"headers","pt":"msg","to":"{\"Content-Type\":\"text/plain\"}","tot":"json"}],"action":"","property":"","from":"","to":"","reg":false,"x":2140,"y":140,"wires":[["f4225ba6.5d6268"]]},{"id":"4477a7a0.234278","type":"change","z":"189ac7e1.52f288","name":"get inputs","rules":[{"t":"set","p":"from","pt":"msg","to":"payload","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":260,"y":40,"wires":[["c7617896.ce40d8"]]},{"id":"d4b8e3de.7dc1b","type":"http request","z":"189ac7e1.52f288","name":"get flows","method":"GET","ret":"obj","paytoqs":"ignore","url":"https://localhost:1880/flows","tls":"b1a419c1.609c29","persist":false,"proxy":"","authType":"","x":1780,"y":40,"wires":[["5d832936.8cc378"]]},{"id":"f94034d3.253148","type":"http response","z":"189ac7e1.52f288","name":"","statusCode":"","headers":{},"x":2790,"y":40,"wires":[]},{"id":"ace4f102.8b7ca","type":"change","z":"189ac7e1.52f288","name":"","rules":[{"t":"set","p":"headers","pt":"msg","to":"{\"Content-Type\":\"text/plain\"}","tot":"json"}],"action":"","property":"","from":"","to":"","reg":false,"x":2620,"y":40,"wires":[["f94034d3.253148","ed9180c7.e5ac7"]]},{"id":"da47b31f.ec70b","type":"http request","z":"189ac7e1.52f288","name":"get flows","method":"GET","ret":"obj","paytoqs":"ignore","url":"https://localhost:1880/flows","tls":"b1a419c1.609c29","persist":false,"proxy":"","authType":"","x":1620,"y":140,"wires":[["164e2196.a9d08e"]]},{"id":"dd32bd57.46559","type":"http request","z":"189ac7e1.52f288","name":"auth","method":"POST","ret":"obj","paytoqs":"ignore","url":"https://localhost:1880/auth/token","tls":"b1a419c1.609c29","persist":false,"proxy":"","authType":"","x":1110,"y":40,"wires":[["93bef053.c6ffd"]]},{"id":"9850333e.b22dc","type":"change","z":"189ac7e1.52f288","name":"auth payload","rules":[{"t":"set","p":"payload","pt":"msg","to":"{}","tot":"json"},{"t":"set","p":"payload.client_id","pt":"msg","to":"node-red-editor","tot":"str"},{"t":"set","p":"payload.grant_type","pt":"msg","to":"password","tot":"str"},{"t":"set","p":"payload.scope","pt":"msg","to":"","tot":"str"},{"t":"set","p":"payload.username","pt":"msg","to":"NRADM_USER","tot":"env"},{"t":"set","p":"payload.password","pt":"msg","to":"NRADM_PASS","tot":"env"}],"action":"","property":"","from":"","to":"","reg":false,"x":950,"y":40,"wires":[["dd32bd57.46559"]]},{"id":"a7a9afc5.ee5cc","type":"change","z":"189ac7e1.52f288","name":"","rules":[{"t":"set","p":"accessToken","pt":"msg","to":"payload.access_token","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":1440,"y":40,"wires":[["6a4780ac.11bf8"]]},{"id":"6a4780ac.11bf8","type":"change","z":"189ac7e1.52f288","name":"bearer","rules":[{"t":"set","p":"headers","pt":"msg","to":"{}","tot":"json"},{"t":"set","p":"headers.authorization","pt":"msg","to":"\"Bearer \" & msg.accessToken","tot":"jsonata"}],"action":"","property":"","from":"","to":"","reg":false,"x":1630,"y":40,"wires":[["d4b8e3de.7dc1b"]]},{"id":"32091a00.9c97d6","type":"http request","z":"189ac7e1.52f288","name":"auth","method":"POST","ret":"obj","paytoqs":"ignore","url":"https://localhost:1880/auth/token","tls":"b1a419c1.609c29","persist":false,"proxy":"","authType":"","x":950,"y":140,"wires":[["7cc91774.537958"]]},{"id":"69c19a63.b49c94","type":"change","z":"189ac7e1.52f288","name":"auth payload","rules":[{"t":"set","p":"payload.client_id","pt":"msg","to":"node-red-editor","tot":"str"},{"t":"set","p":"payload.grant_type","pt":"msg","to":"password","tot":"str"},{"t":"set","p":"payload.scope","pt":"msg","to":"","tot":"str"},{"t":"set","p":"payload.username","pt":"msg","to":"NRADM_USER","tot":"env"},{"t":"set","p":"payload.password","pt":"msg","to":"NRADM_PASS","tot":"env"}],"action":"","property":"","from":"","to":"","reg":false,"x":790,"y":140,"wires":[["32091a00.9c97d6"]]},{"id":"22057af4.79a3a6","type":"change","z":"189ac7e1.52f288","name":"","rules":[{"t":"set","p":"accessToken","pt":"msg","to":"payload.access_token","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":1280,"y":140,"wires":[["d380cf30.b493c"]]},{"id":"d380cf30.b493c","type":"change","z":"189ac7e1.52f288","name":"bearer","rules":[{"t":"set","p":"headers","pt":"msg","to":"{}","tot":"json"},{"t":"set","p":"headers.authorization","pt":"msg","to":"\"Bearer \" & msg.accessToken","tot":"jsonata"}],"action":"","property":"","from":"","to":"","reg":false,"x":1470,"y":140,"wires":[["da47b31f.ec70b"]]},{"id":"856ae4a4.788c58","type":"http request","z":"189ac7e1.52f288","name":"","method":"POST","ret":"obj","paytoqs":"ignore","url":"${CFG_ACL_ENDP}","tls":"51b09598.a1114d","persist":false,"proxy":"","authType":"","x":630,"y":40,"wires":[["9a0e75ea.8ca928"]]},{"id":"9a0e75ea.8ca928","type":"switch","z":"189ac7e1.52f288","name":"","property":"statusCode","propertyType":"msg","rules":[{"t":"eq","v":"200","vt":"num"},{"t":"else"}],"checkall":"true","repair":false,"outputs":2,"x":790,"y":40,"wires":[["9850333e.b22dc"],["a5d13d2.63e7ac"]]},{"id":"b78b0752.27a808","type":"http request","z":"189ac7e1.52f288","name":"","method":"POST","ret":"obj","paytoqs":"ignore","url":"${CFG_ACL_ENDP}","tls":"51b09598.a1114d","persist":false,"proxy":"","authType":"","x":470,"y":140,"wires":[["c80113cb.40ee2"]]},{"id":"c80113cb.40ee2","type":"switch","z":"189ac7e1.52f288","name":"","property":"statusCode","propertyType":"msg","rules":[{"t":"eq","v":"200","vt":"num"},{"t":"else"}],"checkall":"true","repair":false,"outputs":2,"x":630,"y":140,"wires":[["69c19a63.b49c94"],["17487128.f0203f"]]},{"id":"442afc77.fd8334","type":"change","z":"189ac7e1.52f288","name":"acl req payload","rules":[{"t":"set","p":"headers","pt":"msg","to":"{}","tot":"json"},{"t":"set","p":"payload","pt":"msg","to":"{}","tot":"json"},{"t":"set","p":"payload.url","pt":"msg","to":"req.url","tot":"msg"},{"t":"set","p":"payload.method","pt":"msg","to":"req.method","tot":"msg"},{"t":"set","p":"payload.headers","pt":"msg","to":"req.headers","tot":"msg"},{"t":"set","p":"payload.params","pt":"msg","to":"req.params","tot":"msg"},{"t":"set","p":"payload.query","pt":"msg","to":"req.query","tot":"msg"},{"t":"set","p":"payload.body","pt":"msg","to":"req.body","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":280,"y":140,"wires":[["b78b0752.27a808"]]},{"id":"c7617896.ce40d8","type":"change","z":"189ac7e1.52f288","name":"acl req payload","rules":[{"t":"set","p":"headers","pt":"msg","to":"{}","tot":"json"},{"t":"set","p":"payload","pt":"msg","to":"{}","tot":"json"},{"t":"set","p":"payload.url","pt":"msg","to":"req.url","tot":"msg"},{"t":"set","p":"payload.method","pt":"msg","to":"req.method","tot":"msg"},{"t":"set","p":"payload.headers","pt":"msg","to":"req.headers","tot":"msg"},{"t":"set","p":"payload.params","pt":"msg","to":"req.params","tot":"msg"},{"t":"set","p":"payload.query","pt":"msg","to":"req.query","tot":"msg"},{"t":"set","p":"payload.body","pt":"msg","to":"req.body","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":440,"y":40,"wires":[["856ae4a4.788c58"]]},{"id":"17487128.f0203f","type":"http response","z":"189ac7e1.52f288","name":"","statusCode":"","headers":{},"x":770,"y":180,"wires":[]},{"id":"52a4a105.c8dcb","type":"change","z":"189ac7e1.52f288","name":"","rules":[{"t":"set","p":"payload","pt":"msg","to":"*[name = \"get outside settings\" and type=\"change\"].rules[0].to","tot":"jsonata"}],"action":"","property":"","from":"","to":"","reg":false,"x":1940,"y":140,"wires":[["7fe664d0.dbfbcc"]]},{"id":"b04ee1eb.93d76","type":"change","z":"189ac7e1.52f288","name":"edit","rules":[{"t":"set","p":"old","pt":"msg","to":"*[name = \"get outside settings\" and type=\"change\"]","tot":"jsonata"},{"t":"set","p":"new","pt":"msg","to":"old","tot":"msg"},{"t":"set","p":"new.rules[0].to","pt":"msg","to":"from","tot":"msg"},{"t":"set","p":"payload","pt":"msg","to":"$eval($replace($string(payload),$string(old),$string(new)))","tot":"jsonata"}],"action":"","property":"","from":"","to":"","reg":false,"x":2070,"y":40,"wires":[["3eaf5732.05ae58"]]},{"id":"a5d13d2.63e7ac","type":"http response","z":"189ac7e1.52f288","name":"","statusCode":"","headers":{},"x":930,"y":80,"wires":[]},{"id":"93bef053.c6ffd","type":"switch","z":"189ac7e1.52f288","name":"","property":"statusCode","propertyType":"msg","rules":[{"t":"eq","v":"200","vt":"num"},{"t":"else"}],"checkall":"true","repair":false,"outputs":2,"x":1250,"y":40,"wires":[["a7a9afc5.ee5cc"],["54c8999b.01a4f8"]]},{"id":"54c8999b.01a4f8","type":"http response","z":"189ac7e1.52f288","name":"","statusCode":"","headers":{},"x":1390,"y":80,"wires":[]},{"id":"5d832936.8cc378","type":"switch","z":"189ac7e1.52f288","name":"","property":"statusCode","propertyType":"msg","rules":[{"t":"eq","v":"200","vt":"num"},{"t":"else"}],"checkall":"true","repair":false,"outputs":2,"x":1930,"y":40,"wires":[["b04ee1eb.93d76"],["fb8e03e5.8fe1f"]]},{"id":"fb8e03e5.8fe1f","type":"http response","z":"189ac7e1.52f288","name":"","statusCode":"","headers":{},"x":2070,"y":80,"wires":[]},{"id":"3eaf5732.05ae58","type":"function","z":"189ac7e1.52f288","name":"update flows","func":"const http = global.get('https');\nconst data = JSON.stringify(msg.payload);\nconst options = {\n  hostname: 'localhost',\n  port: 1880,\n  path: '/flows',\n  method: 'POST',\n  headers: {\n    'Content-Type': 'application/json',\n    'Content-Length': data.length,\n    'Authorization': 'Bearer '+msg.accessToken\n  },\n  rejectUnauthorized: false\n};\nconst req = http.request(options);\nreq.write(data);\nreq.end();\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":2230,"y":40,"wires":[["c4e34fc8.5e9ce"]]},{"id":"7cc91774.537958","type":"switch","z":"189ac7e1.52f288","name":"","property":"statusCode","propertyType":"msg","rules":[{"t":"eq","v":"200","vt":"num"},{"t":"else"}],"checkall":"true","repair":false,"outputs":2,"x":1090,"y":140,"wires":[["22057af4.79a3a6"],["a06757c4.6205f8"]]},{"id":"a06757c4.6205f8","type":"http response","z":"189ac7e1.52f288","name":"","statusCode":"","headers":{},"x":1230,"y":180,"wires":[]},{"id":"164e2196.a9d08e","type":"switch","z":"189ac7e1.52f288","name":"","property":"statusCode","propertyType":"msg","rules":[{"t":"eq","v":"200","vt":"num"},{"t":"else"}],"checkall":"true","repair":false,"outputs":2,"x":1770,"y":140,"wires":[["52a4a105.c8dcb"],["ec39c0b4.35a22"]]},{"id":"ec39c0b4.35a22","type":"http response","z":"189ac7e1.52f288","name":"","statusCode":"","headers":{},"x":1910,"y":180,"wires":[]},{"id":"916cced6.a5391","type":"http in","z":"189ac7e1.52f288","name":"PUT to","url":"/outside/to","method":"put","upload":false,"swaggerDoc":"","x":90,"y":240,"wires":[["69c17338.6977ac"]]},{"id":"fd23ed00.f097e","type":"change","z":"189ac7e1.52f288","name":"","rules":[{"t":"set","p":"payload","pt":"msg","to":"to","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":2400,"y":240,"wires":[["5b312e3.a1e78d"]]},{"id":"15fa54f4.54881b","type":"http in","z":"189ac7e1.52f288","name":"GET to","url":"/outside/to","method":"get","upload":false,"swaggerDoc":"","x":90,"y":340,"wires":[["d42a3502.219318"]]},{"id":"41a9fd53.9eb794","type":"http response","z":"189ac7e1.52f288","name":"","statusCode":"","headers":{},"x":2290,"y":340,"wires":[]},{"id":"b3816bcf.f24f38","type":"change","z":"189ac7e1.52f288","name":"","rules":[{"t":"set","p":"headers","pt":"msg","to":"{\"Content-Type\":\"text/plain\"}","tot":"json"}],"action":"","property":"","from":"","to":"","reg":false,"x":2120,"y":340,"wires":[["41a9fd53.9eb794"]]},{"id":"69c17338.6977ac","type":"change","z":"189ac7e1.52f288","name":"get inputs","rules":[{"t":"set","p":"to","pt":"msg","to":"payload","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":240,"y":240,"wires":[["2c514a97.cd6996"]]},{"id":"2d6b1fef.29693","type":"http request","z":"189ac7e1.52f288","name":"get flows","method":"GET","ret":"obj","paytoqs":"ignore","url":"https://localhost:1880/flows","tls":"b1a419c1.609c29","persist":false,"proxy":"","authType":"","x":1760,"y":240,"wires":[["10fafa96.d373f5"]]},{"id":"598bfa3a.e9dd74","type":"http response","z":"189ac7e1.52f288","name":"","statusCode":"","headers":{},"x":2770,"y":240,"wires":[]},{"id":"5b312e3.a1e78d","type":"change","z":"189ac7e1.52f288","name":"","rules":[{"t":"set","p":"headers","pt":"msg","to":"{\"Content-Type\":\"text/plain\"}","tot":"json"}],"action":"","property":"","from":"","to":"","reg":false,"x":2600,"y":240,"wires":[["598bfa3a.e9dd74","c59e6fac.52e94"]]},{"id":"5b0fac0f.13c5e4","type":"http request","z":"189ac7e1.52f288","name":"get flows","method":"GET","ret":"obj","paytoqs":"ignore","url":"https://localhost:1880/flows","tls":"b1a419c1.609c29","persist":false,"proxy":"","authType":"","x":1600,"y":340,"wires":[["30f42813.b4ac88"]]},{"id":"9a8eaaf.1f4d258","type":"http request","z":"189ac7e1.52f288","name":"auth","method":"POST","ret":"obj","paytoqs":"ignore","url":"https://localhost:1880/auth/token","tls":"b1a419c1.609c29","persist":false,"proxy":"","authType":"","x":1090,"y":240,"wires":[["bb8ab3eb.05c08"]]},{"id":"d3039f03.76de4","type":"change","z":"189ac7e1.52f288","name":"auth payload","rules":[{"t":"set","p":"payload","pt":"msg","to":"{}","tot":"json"},{"t":"set","p":"payload.client_id","pt":"msg","to":"node-red-editor","tot":"str"},{"t":"set","p":"payload.grant_type","pt":"msg","to":"password","tot":"str"},{"t":"set","p":"payload.scope","pt":"msg","to":"","tot":"str"},{"t":"set","p":"payload.username","pt":"msg","to":"NRADM_USER","tot":"env"},{"t":"set","p":"payload.password","pt":"msg","to":"NRADM_PASS","tot":"env"}],"action":"","property":"","from":"","to":"","reg":false,"x":930,"y":240,"wires":[["9a8eaaf.1f4d258"]]},{"id":"3567d3e0.642e4c","type":"change","z":"189ac7e1.52f288","name":"","rules":[{"t":"set","p":"accessToken","pt":"msg","to":"payload.access_token","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":1420,"y":240,"wires":[["a82bc69c.f7c728"]]},{"id":"a82bc69c.f7c728","type":"change","z":"189ac7e1.52f288","name":"bearer","rules":[{"t":"set","p":"headers","pt":"msg","to":"{}","tot":"json"},{"t":"set","p":"headers.authorization","pt":"msg","to":"\"Bearer \" & msg.accessToken","tot":"jsonata"}],"action":"","property":"","from":"","to":"","reg":false,"x":1610,"y":240,"wires":[["2d6b1fef.29693"]]},{"id":"c165a2b8.928d4","type":"http request","z":"189ac7e1.52f288","name":"auth","method":"POST","ret":"obj","paytoqs":"ignore","url":"https://localhost:1880/auth/token","tls":"b1a419c1.609c29","persist":false,"proxy":"","authType":"","x":930,"y":340,"wires":[["3c345176.37dc3e"]]},{"id":"688e4804.17a318","type":"change","z":"189ac7e1.52f288","name":"auth payload","rules":[{"t":"set","p":"payload.client_id","pt":"msg","to":"node-red-editor","tot":"str"},{"t":"set","p":"payload.grant_type","pt":"msg","to":"password","tot":"str"},{"t":"set","p":"payload.scope","pt":"msg","to":"","tot":"str"},{"t":"set","p":"payload.username","pt":"msg","to":"NRADM_USER","tot":"env"},{"t":"set","p":"payload.password","pt":"msg","to":"NRADM_PASS","tot":"env"}],"action":"","property":"","from":"","to":"","reg":false,"x":770,"y":340,"wires":[["c165a2b8.928d4"]]},{"id":"658c8399.68ef0c","type":"change","z":"189ac7e1.52f288","name":"","rules":[{"t":"set","p":"accessToken","pt":"msg","to":"payload.access_token","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":1260,"y":340,"wires":[["6238b8df.12b2f8"]]},{"id":"6238b8df.12b2f8","type":"change","z":"189ac7e1.52f288","name":"bearer","rules":[{"t":"set","p":"headers","pt":"msg","to":"{}","tot":"json"},{"t":"set","p":"headers.authorization","pt":"msg","to":"\"Bearer \" & msg.accessToken","tot":"jsonata"}],"action":"","property":"","from":"","to":"","reg":false,"x":1450,"y":340,"wires":[["5b0fac0f.13c5e4"]]},{"id":"45b78684.c1c478","type":"http request","z":"189ac7e1.52f288","name":"","method":"POST","ret":"obj","paytoqs":"ignore","url":"${CFG_ACL_ENDP}","tls":"51b09598.a1114d","persist":false,"proxy":"","authType":"","x":610,"y":240,"wires":[["f61575a3.3e9ad8"]]},{"id":"f61575a3.3e9ad8","type":"switch","z":"189ac7e1.52f288","name":"","property":"statusCode","propertyType":"msg","rules":[{"t":"eq","v":"200","vt":"num"},{"t":"else"}],"checkall":"true","repair":false,"outputs":2,"x":770,"y":240,"wires":[["d3039f03.76de4"],["c5af7d09.7d9e4"]]},{"id":"e7d750a9.041d7","type":"http request","z":"189ac7e1.52f288","name":"","method":"POST","ret":"obj","paytoqs":"ignore","url":"${CFG_ACL_ENDP}","tls":"51b09598.a1114d","persist":false,"proxy":"","authType":"","x":450,"y":340,"wires":[["b3079145.d8719"]]},{"id":"b3079145.d8719","type":"switch","z":"189ac7e1.52f288","name":"","property":"statusCode","propertyType":"msg","rules":[{"t":"eq","v":"200","vt":"num"},{"t":"else"}],"checkall":"true","repair":false,"outputs":2,"x":610,"y":340,"wires":[["688e4804.17a318"],["5e5b414c.e22a9"]]},{"id":"d42a3502.219318","type":"change","z":"189ac7e1.52f288","name":"acl req payload","rules":[{"t":"set","p":"headers","pt":"msg","to":"{}","tot":"json"},{"t":"set","p":"payload","pt":"msg","to":"{}","tot":"json"},{"t":"set","p":"payload.url","pt":"msg","to":"req.url","tot":"msg"},{"t":"set","p":"payload.method","pt":"msg","to":"req.method","tot":"msg"},{"t":"set","p":"payload.headers","pt":"msg","to":"req.headers","tot":"msg"},{"t":"set","p":"payload.params","pt":"msg","to":"req.params","tot":"msg"},{"t":"set","p":"payload.query","pt":"msg","to":"req.query","tot":"msg"},{"t":"set","p":"payload.body","pt":"msg","to":"req.body","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":260,"y":340,"wires":[["e7d750a9.041d7"]]},{"id":"2c514a97.cd6996","type":"change","z":"189ac7e1.52f288","name":"acl req payload","rules":[{"t":"set","p":"headers","pt":"msg","to":"{}","tot":"json"},{"t":"set","p":"payload","pt":"msg","to":"{}","tot":"json"},{"t":"set","p":"payload.url","pt":"msg","to":"req.url","tot":"msg"},{"t":"set","p":"payload.method","pt":"msg","to":"req.method","tot":"msg"},{"t":"set","p":"payload.headers","pt":"msg","to":"req.headers","tot":"msg"},{"t":"set","p":"payload.params","pt":"msg","to":"req.params","tot":"msg"},{"t":"set","p":"payload.query","pt":"msg","to":"req.query","tot":"msg"},{"t":"set","p":"payload.body","pt":"msg","to":"req.body","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":420,"y":240,"wires":[["45b78684.c1c478"]]},{"id":"5e5b414c.e22a9","type":"http response","z":"189ac7e1.52f288","name":"","statusCode":"","headers":{},"x":750,"y":380,"wires":[]},{"id":"ca4bb770.b8bfb8","type":"change","z":"189ac7e1.52f288","name":"","rules":[{"t":"set","p":"payload","pt":"msg","to":"*[name = \"get outside settings\" and type=\"change\"].rules[1].to","tot":"jsonata"}],"action":"","property":"","from":"","to":"","reg":false,"x":1920,"y":340,"wires":[["b3816bcf.f24f38"]]},{"id":"8b454c3f.209b2","type":"change","z":"189ac7e1.52f288","name":"edit","rules":[{"t":"set","p":"old","pt":"msg","to":"*[name = \"get outside settings\" and type=\"change\"]","tot":"jsonata"},{"t":"set","p":"new","pt":"msg","to":"old","tot":"msg"},{"t":"set","p":"new.rules[1].to","pt":"msg","to":"to","tot":"msg"},{"t":"set","p":"payload","pt":"msg","to":"$eval($replace($string(payload),$string(old),$string(new)))","tot":"jsonata"}],"action":"","property":"","from":"","to":"","reg":false,"x":2050,"y":240,"wires":[["c628052d.2369b8"]]},{"id":"c5af7d09.7d9e4","type":"http response","z":"189ac7e1.52f288","name":"","statusCode":"","headers":{},"x":910,"y":280,"wires":[]},{"id":"bb8ab3eb.05c08","type":"switch","z":"189ac7e1.52f288","name":"","property":"statusCode","propertyType":"msg","rules":[{"t":"eq","v":"200","vt":"num"},{"t":"else"}],"checkall":"true","repair":false,"outputs":2,"x":1230,"y":240,"wires":[["3567d3e0.642e4c"],["e182533f.6dc37"]]},{"id":"e182533f.6dc37","type":"http response","z":"189ac7e1.52f288","name":"","statusCode":"","headers":{},"x":1370,"y":280,"wires":[]},{"id":"10fafa96.d373f5","type":"switch","z":"189ac7e1.52f288","name":"","property":"statusCode","propertyType":"msg","rules":[{"t":"eq","v":"200","vt":"num"},{"t":"else"}],"checkall":"true","repair":false,"outputs":2,"x":1910,"y":240,"wires":[["8b454c3f.209b2"],["40a61f64.7cf6c"]]},{"id":"40a61f64.7cf6c","type":"http response","z":"189ac7e1.52f288","name":"","statusCode":"","headers":{},"x":2050,"y":280,"wires":[]},{"id":"c628052d.2369b8","type":"function","z":"189ac7e1.52f288","name":"update flows","func":"const http = global.get('https');\nconst data = JSON.stringify(msg.payload);\nconst options = {\n  hostname: 'localhost',\n  port: 1880,\n  path: '/flows',\n  method: 'POST',\n  headers: {\n    'Content-Type': 'application/json',\n    'Content-Length': data.length,\n    'Authorization': 'Bearer '+msg.accessToken\n  },\n  rejectUnauthorized: false\n};\nconst req = http.request(options);\nreq.write(data);\nreq.end();\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":2210,"y":240,"wires":[["fd23ed00.f097e"]]},{"id":"3c345176.37dc3e","type":"switch","z":"189ac7e1.52f288","name":"","property":"statusCode","propertyType":"msg","rules":[{"t":"eq","v":"200","vt":"num"},{"t":"else"}],"checkall":"true","repair":false,"outputs":2,"x":1070,"y":340,"wires":[["658c8399.68ef0c"],["5b2b600.57868a"]]},{"id":"5b2b600.57868a","type":"http response","z":"189ac7e1.52f288","name":"","statusCode":"","headers":{},"x":1210,"y":380,"wires":[]},{"id":"30f42813.b4ac88","type":"switch","z":"189ac7e1.52f288","name":"","property":"statusCode","propertyType":"msg","rules":[{"t":"eq","v":"200","vt":"num"},{"t":"else"}],"checkall":"true","repair":false,"outputs":2,"x":1750,"y":340,"wires":[["ca4bb770.b8bfb8"],["334f1e0c.dfe372"]]},{"id":"334f1e0c.dfe372","type":"http response","z":"189ac7e1.52f288","name":"","statusCode":"","headers":{},"x":1890,"y":380,"wires":[]},{"id":"2e5ae3f5.1fb5bc","type":"delay","z":"4fb04efc.9af29","name":"delay","pauseType":"delayv","timeout":"1","timeoutUnits":"seconds","rate":"1","nbRateUnits":"1","rateUnits":"second","randomFirst":"1","randomLast":"5","randomUnits":"seconds","drop":true,"x":1670,"y":240,"wires":[["38b965f.6814b9a","cdadb616.477e38"]]},{"id":"89420d5d.3c3b","type":"trigger","z":"938f4ad2.352088","name":"switchon","op1":"1","op2":"0","op1type":"str","op2type":"str","duration":"1000","extend":false,"overrideDelay":true,"units":"ms","reset":"","bytopic":"all","topic":"topic","outputs":1,"x":540,"y":240,"wires":[["c76b73d.02e479"]]},{"id":"9dfea884.d15448","type":"change","z":"4fb04efc.9af29","name":"ring","rules":[{"t":"set","p":"v","pt":"msg","to":"payload","tot":"msg"},{"t":"set","p":"payload","pt":"msg","to":"{}","tot":"json"},{"t":"set","p":"payload.text","pt":"msg","to":"\"quarantined: \" & v","tot":"jsonata"},{"t":"set","p":"payload.shape","pt":"msg","to":"ring","tot":"str"},{"t":"set","p":"payload.fill","pt":"msg","to":"green","tot":"str"}],"action":"","property":"","from":"","to":"","reg":false,"x":990,"y":400,"wires":[[]]},{"id":"38b965f.6814b9a","type":"change","z":"4fb04efc.9af29","name":"dot","rules":[{"t":"set","p":"v","pt":"msg","to":"payload","tot":"msg"},{"t":"set","p":"payload","pt":"msg","to":"{}","tot":"json"},{"t":"set","p":"payload.text","pt":"msg","to":"$boolean(reset) ? \"all killed\" : $boolean(flush) ? \"quarantine ended\" : \"forwarded: \" & v","tot":"jsonata"},{"t":"set","p":"payload.shape","pt":"msg","to":"dot","tot":"str"},{"t":"set","p":"payload.fill","pt":"msg","to":"$boolean(reset) or $boolean(flush) ? \"grey\" : \"green\"","tot":"jsonata"}],"action":"","property":"","from":"","to":"","reg":false,"x":1830,"y":300,"wires":[[]]},{"id":"826fa5f7.20f338","type":"http in","z":"4fb04efc.9af29","name":"PUT duration","url":"/quarantine/duration","method":"put","upload":false,"swaggerDoc":"","x":90,"y":40,"wires":[["2bf48c47.df2514"]]},{"id":"9635f7a0.f8f108","type":"change","z":"4fb04efc.9af29","name":"","rules":[{"t":"set","p":"payload","pt":"msg","to":"duration & \" ms\"","tot":"jsonata"}],"action":"","property":"","from":"","to":"","reg":false,"x":2400,"y":40,"wires":[["a6f859d.a3aa0a8"]]},{"id":"ea9313fd.a8043","type":"http in","z":"4fb04efc.9af29","name":"GET duration","url":"/quarantine/duration","method":"get","upload":false,"swaggerDoc":"","x":90,"y":140,"wires":[["b62543a4.32ee2"]]},{"id":"d1a9ad5a.4d452","type":"http response","z":"4fb04efc.9af29","name":"","statusCode":"","headers":{},"x":2290,"y":140,"wires":[]},{"id":"d9d8a9c5.ea3ce8","type":"change","z":"4fb04efc.9af29","name":"","rules":[{"t":"set","p":"headers","pt":"msg","to":"{\"Content-Type\":\"text/plain\"}","tot":"json"}],"action":"","property":"","from":"","to":"","reg":false,"x":2120,"y":140,"wires":[["d1a9ad5a.4d452"]]},{"id":"2bf48c47.df2514","type":"change","z":"4fb04efc.9af29","name":"get inputs","rules":[{"t":"set","p":"duration","pt":"msg","to":"payload","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":240,"y":40,"wires":[["d28e46d3.2c0218"]]},{"id":"b474ec8c.fceb3","type":"http request","z":"4fb04efc.9af29","name":"get flows","method":"GET","ret":"obj","paytoqs":"ignore","url":"https://localhost:1880/flows","tls":"b1a419c1.609c29","persist":false,"proxy":"","authType":"","x":1760,"y":40,"wires":[["4b6ee48b.d1b86c"]]},{"id":"704c07e0.2805e8","type":"http response","z":"4fb04efc.9af29","name":"","statusCode":"","headers":{},"x":2770,"y":40,"wires":[]},{"id":"a6f859d.a3aa0a8","type":"change","z":"4fb04efc.9af29","name":"","rules":[{"t":"set","p":"headers","pt":"msg","to":"{\"Content-Type\":\"text/plain\"}","tot":"json"}],"action":"","property":"","from":"","to":"","reg":false,"x":2600,"y":40,"wires":[["704c07e0.2805e8","eed74d78.35d85"]]},{"id":"9eec7fca.0094b","type":"http request","z":"4fb04efc.9af29","name":"get flows","method":"GET","ret":"obj","paytoqs":"ignore","url":"https://localhost:1880/flows","tls":"b1a419c1.609c29","persist":false,"proxy":"","authType":"","x":1600,"y":140,"wires":[["bf268e13.69241"]]},{"id":"30fe7f49.caa07","type":"http request","z":"4fb04efc.9af29","name":"auth","method":"POST","ret":"obj","paytoqs":"ignore","url":"https://localhost:1880/auth/token","tls":"b1a419c1.609c29","persist":false,"proxy":"","authType":"","x":1090,"y":40,"wires":[["c228ed7a.4a0d9"]]},{"id":"e78ff693.53b228","type":"change","z":"4fb04efc.9af29","name":"auth payload","rules":[{"t":"set","p":"payload","pt":"msg","to":"{}","tot":"json"},{"t":"set","p":"payload.client_id","pt":"msg","to":"node-red-editor","tot":"str"},{"t":"set","p":"payload.grant_type","pt":"msg","to":"password","tot":"str"},{"t":"set","p":"payload.scope","pt":"msg","to":"","tot":"str"},{"t":"set","p":"payload.username","pt":"msg","to":"NRADM_USER","tot":"env"},{"t":"set","p":"payload.password","pt":"msg","to":"NRADM_PASS","tot":"env"}],"action":"","property":"","from":"","to":"","reg":false,"x":930,"y":40,"wires":[["30fe7f49.caa07"]]},{"id":"ff1be450.d4f028","type":"change","z":"4fb04efc.9af29","name":"","rules":[{"t":"set","p":"accessToken","pt":"msg","to":"payload.access_token","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":1420,"y":40,"wires":[["4cf128a9.7d7b08"]]},{"id":"4cf128a9.7d7b08","type":"change","z":"4fb04efc.9af29","name":"bearer","rules":[{"t":"set","p":"headers","pt":"msg","to":"{}","tot":"json"},{"t":"set","p":"headers.authorization","pt":"msg","to":"\"Bearer \" & msg.accessToken","tot":"jsonata"}],"action":"","property":"","from":"","to":"","reg":false,"x":1610,"y":40,"wires":[["b474ec8c.fceb3"]]},{"id":"71338786.40f1a8","type":"http request","z":"4fb04efc.9af29","name":"auth","method":"POST","ret":"obj","paytoqs":"ignore","url":"https://localhost:1880/auth/token","tls":"b1a419c1.609c29","persist":false,"proxy":"","authType":"","x":930,"y":140,"wires":[["d4ae3660.7e2df8"]]},{"id":"e2bc91bf.19844","type":"change","z":"4fb04efc.9af29","name":"auth payload","rules":[{"t":"set","p":"payload.client_id","pt":"msg","to":"node-red-editor","tot":"str"},{"t":"set","p":"payload.grant_type","pt":"msg","to":"password","tot":"str"},{"t":"set","p":"payload.scope","pt":"msg","to":"","tot":"str"},{"t":"set","p":"payload.username","pt":"msg","to":"NRADM_USER","tot":"env"},{"t":"set","p":"payload.password","pt":"msg","to":"NRADM_PASS","tot":"env"}],"action":"","property":"","from":"","to":"","reg":false,"x":770,"y":140,"wires":[["71338786.40f1a8"]]},{"id":"9936ce15.d9ecd","type":"change","z":"4fb04efc.9af29","name":"","rules":[{"t":"set","p":"accessToken","pt":"msg","to":"payload.access_token","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":1260,"y":140,"wires":[["7f0cd809.8e67a8"]]},{"id":"7f0cd809.8e67a8","type":"change","z":"4fb04efc.9af29","name":"bearer","rules":[{"t":"set","p":"headers","pt":"msg","to":"{}","tot":"json"},{"t":"set","p":"headers.authorization","pt":"msg","to":"\"Bearer \" & msg.accessToken","tot":"jsonata"}],"action":"","property":"","from":"","to":"","reg":false,"x":1450,"y":140,"wires":[["9eec7fca.0094b"]]},{"id":"f071122c.a67d5","type":"http request","z":"4fb04efc.9af29","name":"","method":"POST","ret":"obj","paytoqs":"ignore","url":"${CFG_ACL_ENDP}","tls":"51b09598.a1114d","persist":false,"proxy":"","authType":"","x":610,"y":40,"wires":[["2fc60b42.4747b4"]]},{"id":"2fc60b42.4747b4","type":"switch","z":"4fb04efc.9af29","name":"","property":"statusCode","propertyType":"msg","rules":[{"t":"eq","v":"200","vt":"num"},{"t":"else"}],"checkall":"true","repair":false,"outputs":2,"x":770,"y":40,"wires":[["e78ff693.53b228"],["8113833f.1c496"]]},{"id":"6a05e96b.fb39b8","type":"http request","z":"4fb04efc.9af29","name":"","method":"POST","ret":"obj","paytoqs":"ignore","url":"${CFG_ACL_ENDP}","tls":"51b09598.a1114d","persist":false,"proxy":"","authType":"","x":450,"y":140,"wires":[["dd41091.21cc6f8"]]},{"id":"dd41091.21cc6f8","type":"switch","z":"4fb04efc.9af29","name":"","property":"statusCode","propertyType":"msg","rules":[{"t":"eq","v":"200","vt":"num"},{"t":"else"}],"checkall":"true","repair":false,"outputs":2,"x":610,"y":140,"wires":[["e2bc91bf.19844"],["47e2ba47.4b37e4"]]},{"id":"b62543a4.32ee2","type":"change","z":"4fb04efc.9af29","name":"acl req payload","rules":[{"t":"set","p":"headers","pt":"msg","to":"{}","tot":"json"},{"t":"set","p":"payload","pt":"msg","to":"{}","tot":"json"},{"t":"set","p":"payload.url","pt":"msg","to":"req.url","tot":"msg"},{"t":"set","p":"payload.method","pt":"msg","to":"req.method","tot":"msg"},{"t":"set","p":"payload.headers","pt":"msg","to":"req.headers","tot":"msg"},{"t":"set","p":"payload.params","pt":"msg","to":"req.params","tot":"msg"},{"t":"set","p":"payload.query","pt":"msg","to":"req.query","tot":"msg"},{"t":"set","p":"payload.body","pt":"msg","to":"req.body","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":260,"y":140,"wires":[["6a05e96b.fb39b8"]]},{"id":"d28e46d3.2c0218","type":"change","z":"4fb04efc.9af29","name":"acl req payload","rules":[{"t":"set","p":"headers","pt":"msg","to":"{}","tot":"json"},{"t":"set","p":"payload","pt":"msg","to":"{}","tot":"json"},{"t":"set","p":"payload.url","pt":"msg","to":"req.url","tot":"msg"},{"t":"set","p":"payload.method","pt":"msg","to":"req.method","tot":"msg"},{"t":"set","p":"payload.headers","pt":"msg","to":"req.headers","tot":"msg"},{"t":"set","p":"payload.params","pt":"msg","to":"req.params","tot":"msg"},{"t":"set","p":"payload.query","pt":"msg","to":"req.query","tot":"msg"},{"t":"set","p":"payload.body","pt":"msg","to":"req.body","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":420,"y":40,"wires":[["f071122c.a67d5"]]},{"id":"47e2ba47.4b37e4","type":"http response","z":"4fb04efc.9af29","name":"","statusCode":"","headers":{},"x":750,"y":180,"wires":[]},{"id":"e06068ea.395d48","type":"change","z":"4fb04efc.9af29","name":"","rules":[{"t":"set","p":"payload","pt":"msg","to":"$string(*[name = \"quarantine duration\" and type=\"change\"].rules[0].to) & ($string(*[name = \"quarantine duration\" and type=\"change\"].rules[0].to) != \"\" ? \" ms\" : \"\")","tot":"jsonata"}],"action":"","property":"","from":"","to":"","reg":false,"x":1920,"y":140,"wires":[["d9d8a9c5.ea3ce8"]]},{"id":"fe3d4ab3.815a78","type":"change","z":"4fb04efc.9af29","name":"edit","rules":[{"t":"set","p":"old","pt":"msg","to":"*[name = \"quarantine duration\" and type=\"change\"]","tot":"jsonata"},{"t":"set","p":"new","pt":"msg","to":"old","tot":"msg"},{"t":"set","p":"new.rules[0].to","pt":"msg","to":"duration","tot":"msg"},{"t":"set","p":"payload","pt":"msg","to":"$eval($replace($string(payload),$string(old),$string(new)))","tot":"jsonata"}],"action":"","property":"","from":"","to":"","reg":false,"x":2050,"y":40,"wires":[["76a76fa4.a9afc"]]},{"id":"8113833f.1c496","type":"http response","z":"4fb04efc.9af29","name":"","statusCode":"","headers":{},"x":910,"y":80,"wires":[]},{"id":"c228ed7a.4a0d9","type":"switch","z":"4fb04efc.9af29","name":"","property":"statusCode","propertyType":"msg","rules":[{"t":"eq","v":"200","vt":"num"},{"t":"else"}],"checkall":"true","repair":false,"outputs":2,"x":1230,"y":40,"wires":[["ff1be450.d4f028"],["ccc89d20.1add4"]]},{"id":"ccc89d20.1add4","type":"http response","z":"4fb04efc.9af29","name":"","statusCode":"","headers":{},"x":1370,"y":80,"wires":[]},{"id":"4b6ee48b.d1b86c","type":"switch","z":"4fb04efc.9af29","name":"","property":"statusCode","propertyType":"msg","rules":[{"t":"eq","v":"200","vt":"num"},{"t":"else"}],"checkall":"true","repair":false,"outputs":2,"x":1910,"y":40,"wires":[["fe3d4ab3.815a78"],["efd9f2d1.0fb71"]]},{"id":"efd9f2d1.0fb71","type":"http response","z":"4fb04efc.9af29","name":"","statusCode":"","headers":{},"x":2050,"y":80,"wires":[]},{"id":"76a76fa4.a9afc","type":"function","z":"4fb04efc.9af29","name":"update flows","func":"const http = global.get('https');\nconst data = JSON.stringify(msg.payload);\nconst options = {\n  hostname: 'localhost',\n  port: 1880,\n  path: '/flows',\n  method: 'POST',\n  headers: {\n    'Content-Type': 'application/json',\n    'Content-Length': data.length,\n    'Authorization': 'Bearer '+msg.accessToken\n  },\n  rejectUnauthorized: false\n};\nconst req = http.request(options);\nreq.write(data);\nreq.end();\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":2210,"y":40,"wires":[["9635f7a0.f8f108"]]},{"id":"d4ae3660.7e2df8","type":"switch","z":"4fb04efc.9af29","name":"","property":"statusCode","propertyType":"msg","rules":[{"t":"eq","v":"200","vt":"num"},{"t":"else"}],"checkall":"true","repair":false,"outputs":2,"x":1070,"y":140,"wires":[["9936ce15.d9ecd"],["621cc667.e7e798"]]},{"id":"621cc667.e7e798","type":"http response","z":"4fb04efc.9af29","name":"","statusCode":"","headers":{},"x":1210,"y":180,"wires":[]},{"id":"bf268e13.69241","type":"switch","z":"4fb04efc.9af29","name":"","property":"statusCode","propertyType":"msg","rules":[{"t":"eq","v":"200","vt":"num"},{"t":"else"}],"checkall":"true","repair":false,"outputs":2,"x":1750,"y":140,"wires":[["e06068ea.395d48"],["383521ca.e5d8ee"]]},{"id":"383521ca.e5d8ee","type":"http response","z":"4fb04efc.9af29","name":"","statusCode":"","headers":{},"x":1890,"y":180,"wires":[]},{"id":"7cb7a996.4a5288","type":"http in","z":"4fb04efc.9af29","name":"PUT killall","url":"/quarantine/killall","method":"put","upload":false,"swaggerDoc":"","x":80,"y":240,"wires":[["f91241d5.64b5d"]]},{"id":"276b92ea.22a4be","type":"change","z":"4fb04efc.9af29","name":"reset","rules":[{"t":"set","p":"reset","pt":"msg","to":"true","tot":"bool"}],"action":"","property":"","from":"","to":"","reg":false,"x":750,"y":240,"wires":[["625e3810.215ae8"]]},{"id":"3a123c64.c74e24","type":"http request","z":"4fb04efc.9af29","name":"","method":"POST","ret":"obj","paytoqs":"ignore","url":"${CFG_ACL_ENDP}","tls":"51b09598.a1114d","persist":false,"proxy":"","authType":"","x":450,"y":240,"wires":[["29ae906a.84b21"]]},{"id":"29ae906a.84b21","type":"switch","z":"4fb04efc.9af29","name":"","property":"statusCode","propertyType":"msg","rules":[{"t":"eq","v":"200","vt":"num"},{"t":"else"}],"checkall":"true","repair":false,"outputs":2,"x":610,"y":240,"wires":[["276b92ea.22a4be"],["93db5287.3bfb6"]]},{"id":"f91241d5.64b5d","type":"change","z":"4fb04efc.9af29","name":"acl req payload","rules":[{"t":"set","p":"headers","pt":"msg","to":"{}","tot":"json"},{"t":"set","p":"payload","pt":"msg","to":"{}","tot":"json"},{"t":"set","p":"payload.url","pt":"msg","to":"req.url","tot":"msg"},{"t":"set","p":"payload.method","pt":"msg","to":"req.method","tot":"msg"},{"t":"set","p":"payload.headers","pt":"msg","to":"req.headers","tot":"msg"},{"t":"set","p":"payload.params","pt":"msg","to":"req.params","tot":"msg"},{"t":"set","p":"payload.query","pt":"msg","to":"req.query","tot":"msg"},{"t":"set","p":"payload.body","pt":"msg","to":"req.body","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":260,"y":240,"wires":[["3a123c64.c74e24"]]},{"id":"93db5287.3bfb6","type":"http response","z":"4fb04efc.9af29","name":"","statusCode":"","headers":{},"x":750,"y":280,"wires":[]},{"id":"6aeea17d.3b10f","type":"http in","z":"4fb04efc.9af29","name":"PUT end","url":"/quarantine/end","method":"put","upload":false,"swaggerDoc":"","x":80,"y":360,"wires":[["1bc76c75.d9ef54"]]},{"id":"10bac94b.df2ab7","type":"change","z":"4fb04efc.9af29","name":"flush","rules":[{"t":"set","p":"flush","pt":"msg","to":"true","tot":"bool"}],"action":"","property":"","from":"","to":"","reg":false,"x":750,"y":360,"wires":[["625e3810.215ae8"]]},{"id":"1dacbba5.4dfd44","type":"http request","z":"4fb04efc.9af29","name":"","method":"POST","ret":"obj","paytoqs":"ignore","url":"${CFG_ACL_ENDP}","tls":"51b09598.a1114d","persist":false,"proxy":"","authType":"","x":450,"y":360,"wires":[["3c111c62.d2bee4"]]},{"id":"3c111c62.d2bee4","type":"switch","z":"4fb04efc.9af29","name":"","property":"statusCode","propertyType":"msg","rules":[{"t":"eq","v":"200","vt":"num"},{"t":"else"}],"checkall":"true","repair":false,"outputs":2,"x":610,"y":360,"wires":[["10bac94b.df2ab7"],["cba6c3d9.15998"]]},{"id":"1bc76c75.d9ef54","type":"change","z":"4fb04efc.9af29","name":"acl req payload","rules":[{"t":"set","p":"headers","pt":"msg","to":"{}","tot":"json"},{"t":"set","p":"payload","pt":"msg","to":"{}","tot":"json"},{"t":"set","p":"payload.url","pt":"msg","to":"req.url","tot":"msg"},{"t":"set","p":"payload.method","pt":"msg","to":"req.method","tot":"msg"},{"t":"set","p":"payload.headers","pt":"msg","to":"req.headers","tot":"msg"},{"t":"set","p":"payload.params","pt":"msg","to":"req.params","tot":"msg"},{"t":"set","p":"payload.query","pt":"msg","to":"req.query","tot":"msg"},{"t":"set","p":"payload.body","pt":"msg","to":"req.body","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":260,"y":360,"wires":[["1dacbba5.4dfd44"]]},{"id":"cba6c3d9.15998","type":"http response","z":"4fb04efc.9af29","name":"","statusCode":"","headers":{},"x":750,"y":400,"wires":[]},{"id":"f939326e.2a0d8","type":"delay","z":"add93fe3.4654f","name":"sampler","pauseType":"rate","timeout":"2","timeoutUnits":"seconds","rate":"1","nbRateUnits":"1","rateUnits":"second","randomFirst":"1","randomLast":"5","randomUnits":"seconds","drop":true,"x":180,"y":240,"wires":[["262567db.bff158"]]},{"id":"aea18ba4.93ebe8","type":"change","z":"add93fe3.4654f","name":"ring","rules":[{"t":"set","p":"v","pt":"msg","to":"payload","tot":"msg"},{"t":"set","p":"payload","pt":"msg","to":"{}","tot":"json"},{"t":"set","p":"payload.text","pt":"msg","to":"\"received: \" & v","tot":"jsonata"},{"t":"set","p":"payload.shape","pt":"msg","to":"ring","tot":"str"},{"t":"set","p":"payload.fill","pt":"msg","to":"green","tot":"str"}],"action":"","property":"","from":"","to":"","reg":false,"x":170,"y":400,"wires":[[]]},{"id":"262567db.bff158","type":"change","z":"add93fe3.4654f","name":"dot","rules":[{"t":"set","p":"v","pt":"msg","to":"payload","tot":"msg"},{"t":"set","p":"payload","pt":"msg","to":"{}","tot":"json"},{"t":"set","p":"payload.text","pt":"msg","to":"\"forwarded: \" & v","tot":"jsonata"},{"t":"set","p":"payload.shape","pt":"msg","to":"dot","tot":"str"},{"t":"set","p":"payload.fill","pt":"msg","to":"green","tot":"str"}],"action":"","property":"","from":"","to":"","reg":false,"x":310,"y":320,"wires":[[]]},{"id":"af4b444f.f08da8","type":"http in","z":"add93fe3.4654f","name":"PUT interval","url":"/sampler/interval","method":"put","upload":false,"swaggerDoc":"","x":90,"y":40,"wires":[["c014f7d.0e2c508"]]},{"id":"f6196afe.f80278","type":"change","z":"add93fe3.4654f","name":"","rules":[{"t":"set","p":"payload","pt":"msg","to":"interval & \" s\"","tot":"jsonata"}],"action":"","property":"","from":"","to":"","reg":false,"x":2420,"y":40,"wires":[["4fc21d30.760e84"]]},{"id":"9c5e878a.7cacc8","type":"http in","z":"add93fe3.4654f","name":"GET interval","url":"/sampler/interval","method":"get","upload":false,"swaggerDoc":"","x":90,"y":140,"wires":[["8c9b17d.e1624e8"]]},{"id":"73d9cdb.ed4bb34","type":"http response","z":"add93fe3.4654f","name":"","statusCode":"","headers":{},"x":2310,"y":140,"wires":[]},{"id":"b5319c5c.f063d","type":"change","z":"add93fe3.4654f","name":"","rules":[{"t":"set","p":"headers","pt":"msg","to":"{\"Content-Type\":\"text/plain\"}","tot":"json"}],"action":"","property":"","from":"","to":"","reg":false,"x":2140,"y":140,"wires":[["73d9cdb.ed4bb34"]]},{"id":"c014f7d.0e2c508","type":"change","z":"add93fe3.4654f","name":"get inputs","rules":[{"t":"set","p":"interval","pt":"msg","to":"payload","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":260,"y":40,"wires":[["86def7a0.3d3ef8"]]},{"id":"da8814c7.96aed8","type":"http request","z":"add93fe3.4654f","name":"get flows","method":"GET","ret":"obj","paytoqs":"ignore","url":"https://localhost:1880/flows","tls":"b1a419c1.609c29","persist":false,"proxy":"","authType":"","x":1780,"y":40,"wires":[["4fd37afc.ac0204"]]},{"id":"2a88da9.40d2326","type":"http response","z":"add93fe3.4654f","name":"","statusCode":"","headers":{},"x":2790,"y":40,"wires":[]},{"id":"4fc21d30.760e84","type":"change","z":"add93fe3.4654f","name":"","rules":[{"t":"set","p":"headers","pt":"msg","to":"{\"Content-Type\":\"text/plain\"}","tot":"json"}],"action":"","property":"","from":"","to":"","reg":false,"x":2620,"y":40,"wires":[["2a88da9.40d2326","6926a3d8.d83e1c"]]},{"id":"323d68ff.7d8048","type":"http request","z":"add93fe3.4654f","name":"get flows","method":"GET","ret":"obj","paytoqs":"ignore","url":"https://localhost:1880/flows","tls":"b1a419c1.609c29","persist":false,"proxy":"","authType":"","x":1620,"y":140,"wires":[["f4539913.edadb8"]]},{"id":"6cf3d822.ac3228","type":"http request","z":"add93fe3.4654f","name":"auth","method":"POST","ret":"obj","paytoqs":"ignore","url":"https://localhost:1880/auth/token","tls":"b1a419c1.609c29","persist":false,"proxy":"","authType":"","x":1110,"y":40,"wires":[["4609e27e.341d7c"]]},{"id":"fbd7c14a.36e61","type":"change","z":"add93fe3.4654f","name":"auth payload","rules":[{"t":"set","p":"payload","pt":"msg","to":"{}","tot":"json"},{"t":"set","p":"payload.client_id","pt":"msg","to":"node-red-editor","tot":"str"},{"t":"set","p":"payload.grant_type","pt":"msg","to":"password","tot":"str"},{"t":"set","p":"payload.scope","pt":"msg","to":"","tot":"str"},{"t":"set","p":"payload.username","pt":"msg","to":"NRADM_USER","tot":"env"},{"t":"set","p":"payload.password","pt":"msg","to":"NRADM_PASS","tot":"env"}],"action":"","property":"","from":"","to":"","reg":false,"x":950,"y":40,"wires":[["6cf3d822.ac3228"]]},{"id":"8a4a963b.533f58","type":"change","z":"add93fe3.4654f","name":"","rules":[{"t":"set","p":"accessToken","pt":"msg","to":"payload.access_token","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":1440,"y":40,"wires":[["4f70807e.8c6f4"]]},{"id":"4f70807e.8c6f4","type":"change","z":"add93fe3.4654f","name":"bearer","rules":[{"t":"set","p":"headers","pt":"msg","to":"{}","tot":"json"},{"t":"set","p":"headers.authorization","pt":"msg","to":"\"Bearer \" & msg.accessToken","tot":"jsonata"}],"action":"","property":"","from":"","to":"","reg":false,"x":1630,"y":40,"wires":[["da8814c7.96aed8"]]},{"id":"15883da2.4f0a92","type":"http request","z":"add93fe3.4654f","name":"auth","method":"POST","ret":"obj","paytoqs":"ignore","url":"https://localhost:1880/auth/token","tls":"b1a419c1.609c29","persist":false,"proxy":"","authType":"","x":950,"y":140,"wires":[["a0f43603.ff4f98"]]},{"id":"244cd8fe.4443d8","type":"change","z":"add93fe3.4654f","name":"auth payload","rules":[{"t":"set","p":"payload.client_id","pt":"msg","to":"node-red-editor","tot":"str"},{"t":"set","p":"payload.grant_type","pt":"msg","to":"password","tot":"str"},{"t":"set","p":"payload.scope","pt":"msg","to":"","tot":"str"},{"t":"set","p":"payload.username","pt":"msg","to":"NRADM_USER","tot":"env"},{"t":"set","p":"payload.password","pt":"msg","to":"NRADM_PASS","tot":"env"}],"action":"","property":"","from":"","to":"","reg":false,"x":790,"y":140,"wires":[["15883da2.4f0a92"]]},{"id":"11a3ca41.bccc16","type":"change","z":"add93fe3.4654f","name":"","rules":[{"t":"set","p":"accessToken","pt":"msg","to":"payload.access_token","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":1280,"y":140,"wires":[["a82a9d3b.e3004"]]},{"id":"a82a9d3b.e3004","type":"change","z":"add93fe3.4654f","name":"bearer","rules":[{"t":"set","p":"headers","pt":"msg","to":"{}","tot":"json"},{"t":"set","p":"headers.authorization","pt":"msg","to":"\"Bearer \" & msg.accessToken","tot":"jsonata"}],"action":"","property":"","from":"","to":"","reg":false,"x":1470,"y":140,"wires":[["323d68ff.7d8048"]]},{"id":"58a6dfc3.0701c","type":"http request","z":"add93fe3.4654f","name":"","method":"POST","ret":"obj","paytoqs":"ignore","url":"${CFG_ACL_ENDP}","tls":"51b09598.a1114d","persist":false,"proxy":"","authType":"basic","x":630,"y":40,"wires":[["f57f8a0b.f1e1b8"]]},{"id":"f57f8a0b.f1e1b8","type":"switch","z":"add93fe3.4654f","name":"","property":"statusCode","propertyType":"msg","rules":[{"t":"eq","v":"200","vt":"num"},{"t":"else"}],"checkall":"true","repair":false,"outputs":2,"x":790,"y":40,"wires":[["fbd7c14a.36e61"],["9719fae1.48d168"]]},{"id":"f74990b5.29ddc","type":"http request","z":"add93fe3.4654f","name":"","method":"POST","ret":"obj","paytoqs":"ignore","url":"${CFG_ACL_ENDP}","tls":"51b09598.a1114d","persist":false,"proxy":"","authType":"basic","x":470,"y":140,"wires":[["41f56c88.44f8c4"]]},{"id":"41f56c88.44f8c4","type":"switch","z":"add93fe3.4654f","name":"","property":"statusCode","propertyType":"msg","rules":[{"t":"eq","v":"200","vt":"num"},{"t":"else"}],"checkall":"true","repair":false,"outputs":2,"x":630,"y":140,"wires":[["244cd8fe.4443d8"],["4c087584.f2e01c"]]},{"id":"8c9b17d.e1624e8","type":"change","z":"add93fe3.4654f","name":"acl req payload","rules":[{"t":"set","p":"headers","pt":"msg","to":"{}","tot":"json"},{"t":"set","p":"payload","pt":"msg","to":"{}","tot":"json"},{"t":"set","p":"payload.url","pt":"msg","to":"req.url","tot":"msg"},{"t":"set","p":"payload.method","pt":"msg","to":"req.method","tot":"msg"},{"t":"set","p":"payload.headers","pt":"msg","to":"req.headers","tot":"msg"},{"t":"set","p":"payload.params","pt":"msg","to":"req.params","tot":"msg"},{"t":"set","p":"payload.query","pt":"msg","to":"req.query","tot":"msg"},{"t":"set","p":"payload.body","pt":"msg","to":"req.body","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":280,"y":140,"wires":[["f74990b5.29ddc"]]},{"id":"86def7a0.3d3ef8","type":"change","z":"add93fe3.4654f","name":"acl req payload","rules":[{"t":"set","p":"headers","pt":"msg","to":"{}","tot":"json"},{"t":"set","p":"payload","pt":"msg","to":"{}","tot":"json"},{"t":"set","p":"payload.url","pt":"msg","to":"req.url","tot":"msg"},{"t":"set","p":"payload.method","pt":"msg","to":"req.method","tot":"msg"},{"t":"set","p":"payload.headers","pt":"msg","to":"req.headers","tot":"msg"},{"t":"set","p":"payload.params","pt":"msg","to":"req.params","tot":"msg"},{"t":"set","p":"payload.query","pt":"msg","to":"req.query","tot":"msg"},{"t":"set","p":"payload.body","pt":"msg","to":"req.body","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":440,"y":40,"wires":[["58a6dfc3.0701c"]]},{"id":"4c087584.f2e01c","type":"http response","z":"add93fe3.4654f","name":"","statusCode":"","headers":{},"x":770,"y":180,"wires":[]},{"id":"8db4b85.127e748","type":"change","z":"add93fe3.4654f","name":"","rules":[{"t":"set","p":"payload","pt":"msg","to":"*[name = \"sampler\" and type=\"delay\"].nbRateUnits & \" s\"","tot":"jsonata"}],"action":"","property":"","from":"","to":"","reg":false,"x":1940,"y":140,"wires":[["b5319c5c.f063d"]]},{"id":"efad3757.0ca938","type":"change","z":"add93fe3.4654f","name":"edit","rules":[{"t":"set","p":"old","pt":"msg","to":"*[name = \"sampler\" and type=\"delay\"]","tot":"jsonata"},{"t":"set","p":"new","pt":"msg","to":"old","tot":"msg"},{"t":"set","p":"new.nbRateUnits","pt":"msg","to":"interval","tot":"msg"},{"t":"set","p":"payload","pt":"msg","to":"$eval($replace($string(payload),$string(old),$string(new)))","tot":"jsonata"}],"action":"","property":"","from":"","to":"","reg":false,"x":2070,"y":40,"wires":[["d1d183de.1c72f"]]},{"id":"9719fae1.48d168","type":"http response","z":"add93fe3.4654f","name":"","statusCode":"","headers":{},"x":930,"y":80,"wires":[]},{"id":"4609e27e.341d7c","type":"switch","z":"add93fe3.4654f","name":"","property":"statusCode","propertyType":"msg","rules":[{"t":"eq","v":"200","vt":"num"},{"t":"else"}],"checkall":"true","repair":false,"outputs":2,"x":1250,"y":40,"wires":[["8a4a963b.533f58"],["74276b4a.fa0f24"]]},{"id":"74276b4a.fa0f24","type":"http response","z":"add93fe3.4654f","name":"","statusCode":"","headers":{},"x":1390,"y":80,"wires":[]},{"id":"4fd37afc.ac0204","type":"switch","z":"add93fe3.4654f","name":"","property":"statusCode","propertyType":"msg","rules":[{"t":"eq","v":"200","vt":"num"},{"t":"else"}],"checkall":"true","repair":false,"outputs":2,"x":1930,"y":40,"wires":[["efad3757.0ca938"],["70f5c496.929bcc"]]},{"id":"70f5c496.929bcc","type":"http response","z":"add93fe3.4654f","name":"","statusCode":"","headers":{},"x":2070,"y":80,"wires":[]},{"id":"d1d183de.1c72f","type":"function","z":"add93fe3.4654f","name":"update flows","func":"const http = global.get('https');\nconst data = JSON.stringify(msg.payload);\nconst options = {\n  hostname: 'localhost',\n  port: 1880,\n  path: '/flows',\n  method: 'POST',\n  headers: {\n    'Content-Type': 'application/json',\n    'Content-Length': data.length,\n    'Authorization': 'Bearer '+msg.accessToken\n  },\n  rejectUnauthorized: false\n};\nconst req = http.request(options);\nreq.write(data);\nreq.end();\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":2230,"y":40,"wires":[["f6196afe.f80278"]]},{"id":"a0f43603.ff4f98","type":"switch","z":"add93fe3.4654f","name":"","property":"statusCode","propertyType":"msg","rules":[{"t":"eq","v":"200","vt":"num"},{"t":"else"}],"checkall":"true","repair":false,"outputs":2,"x":1090,"y":140,"wires":[["11a3ca41.bccc16"],["dd569159.08e1e"]]},{"id":"dd569159.08e1e","type":"http response","z":"add93fe3.4654f","name":"","statusCode":"","headers":{},"x":1230,"y":180,"wires":[]},{"id":"f4539913.edadb8","type":"switch","z":"add93fe3.4654f","name":"","property":"statusCode","propertyType":"msg","rules":[{"t":"eq","v":"200","vt":"num"},{"t":"else"}],"checkall":"true","repair":false,"outputs":2,"x":1770,"y":140,"wires":[["8db4b85.127e748"],["18d78e64.8c4d92"]]},{"id":"18d78e64.8c4d92","type":"http response","z":"add93fe3.4654f","name":"","statusCode":"","headers":{},"x":1910,"y":180,"wires":[]},{"id":"6cf1c774.330158","type":"http in","z":"938f4ad2.352088","name":"PUT duration","url":"/switch/duration","method":"put","upload":false,"swaggerDoc":"","x":110,"y":40,"wires":[["9fdcfa26.063ce8"]]},{"id":"88aec260.545c6","type":"change","z":"938f4ad2.352088","name":"","rules":[{"t":"set","p":"payload","pt":"msg","to":"duration & \" ms\"","tot":"jsonata"}],"action":"","property":"","from":"","to":"","reg":false,"x":2440,"y":40,"wires":[["5966613b.2b311"]]},{"id":"6bee1b1f.f6ea54","type":"http in","z":"938f4ad2.352088","name":"GET duration","url":"/switch/duration","method":"get","upload":false,"swaggerDoc":"","x":110,"y":140,"wires":[["202cf9c9.810936"]]},{"id":"b9ae7cb6.23fa1","type":"http response","z":"938f4ad2.352088","name":"","statusCode":"","headers":{},"x":2330,"y":140,"wires":[]},{"id":"e9bd5078.11005","type":"change","z":"938f4ad2.352088","name":"","rules":[{"t":"set","p":"headers","pt":"msg","to":"{\"Content-Type\":\"text/plain\"}","tot":"json"}],"action":"","property":"","from":"","to":"","reg":false,"x":2160,"y":140,"wires":[["b9ae7cb6.23fa1"]]},{"id":"9fdcfa26.063ce8","type":"change","z":"938f4ad2.352088","name":"get inputs","rules":[{"t":"set","p":"duration","pt":"msg","to":"payload","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":280,"y":40,"wires":[["29d0f949.9d1156"]]},{"id":"26cce41d.f9538c","type":"http request","z":"938f4ad2.352088","name":"get flows","method":"GET","ret":"obj","paytoqs":"ignore","url":"https://localhost:1880/flows","tls":"b1a419c1.609c29","persist":false,"proxy":"","authType":"","x":1800,"y":40,"wires":[["2f69dc3e.47e2c4"]]},{"id":"e2e8acb8.0ef36","type":"http response","z":"938f4ad2.352088","name":"","statusCode":"","headers":{},"x":2810,"y":40,"wires":[]},{"id":"5966613b.2b311","type":"change","z":"938f4ad2.352088","name":"","rules":[{"t":"set","p":"headers","pt":"msg","to":"{\"Content-Type\":\"text/plain\"}","tot":"json"}],"action":"","property":"","from":"","to":"","reg":false,"x":2640,"y":40,"wires":[["e2e8acb8.0ef36","2ca550d7.a72d4"]]},{"id":"d084eed6.44782","type":"http request","z":"938f4ad2.352088","name":"get flows","method":"GET","ret":"obj","paytoqs":"ignore","url":"https://localhost:1880/flows","tls":"b1a419c1.609c29","persist":false,"proxy":"","authType":"","x":1640,"y":140,"wires":[["e275c734.885038"]]},{"id":"52b469b7.5a90c8","type":"http request","z":"938f4ad2.352088","name":"auth","method":"POST","ret":"obj","paytoqs":"ignore","url":"https://localhost:1880/auth/token","tls":"b1a419c1.609c29","persist":false,"proxy":"","authType":"","x":1130,"y":40,"wires":[["3e5e55a4.adc06a"]]},{"id":"ab178c52.a37ce","type":"change","z":"938f4ad2.352088","name":"auth payload","rules":[{"t":"set","p":"payload","pt":"msg","to":"{}","tot":"json"},{"t":"set","p":"payload.client_id","pt":"msg","to":"node-red-editor","tot":"str"},{"t":"set","p":"payload.grant_type","pt":"msg","to":"password","tot":"str"},{"t":"set","p":"payload.scope","pt":"msg","to":"","tot":"str"},{"t":"set","p":"payload.username","pt":"msg","to":"NRADM_USER","tot":"env"},{"t":"set","p":"payload.password","pt":"msg","to":"NRADM_PASS","tot":"env"}],"action":"","property":"","from":"","to":"","reg":false,"x":970,"y":40,"wires":[["52b469b7.5a90c8"]]},{"id":"1e85c7cf.2e37d8","type":"change","z":"938f4ad2.352088","name":"","rules":[{"t":"set","p":"accessToken","pt":"msg","to":"payload.access_token","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":1460,"y":40,"wires":[["4292a9ee.bedec8"]]},{"id":"4292a9ee.bedec8","type":"change","z":"938f4ad2.352088","name":"bearer","rules":[{"t":"set","p":"headers","pt":"msg","to":"{}","tot":"json"},{"t":"set","p":"headers.authorization","pt":"msg","to":"\"Bearer \" & msg.accessToken","tot":"jsonata"}],"action":"","property":"","from":"","to":"","reg":false,"x":1650,"y":40,"wires":[["26cce41d.f9538c"]]},{"id":"80fafdba.5a8","type":"http request","z":"938f4ad2.352088","name":"auth","method":"POST","ret":"obj","paytoqs":"ignore","url":"https://localhost:1880/auth/token","tls":"b1a419c1.609c29","persist":false,"proxy":"","authType":"","x":970,"y":140,"wires":[["49753350.7205ec"]]},{"id":"58d47f36.1fc06","type":"change","z":"938f4ad2.352088","name":"auth payload","rules":[{"t":"set","p":"payload.client_id","pt":"msg","to":"node-red-editor","tot":"str"},{"t":"set","p":"payload.grant_type","pt":"msg","to":"password","tot":"str"},{"t":"set","p":"payload.scope","pt":"msg","to":"","tot":"str"},{"t":"set","p":"payload.username","pt":"msg","to":"NRADM_USER","tot":"env"},{"t":"set","p":"payload.password","pt":"msg","to":"NRADM_PASS","tot":"env"}],"action":"","property":"","from":"","to":"","reg":false,"x":810,"y":140,"wires":[["80fafdba.5a8"]]},{"id":"2bb535e8.0c019a","type":"change","z":"938f4ad2.352088","name":"","rules":[{"t":"set","p":"accessToken","pt":"msg","to":"payload.access_token","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":1300,"y":140,"wires":[["144cdecf.470e61"]]},{"id":"144cdecf.470e61","type":"change","z":"938f4ad2.352088","name":"bearer","rules":[{"t":"set","p":"headers","pt":"msg","to":"{}","tot":"json"},{"t":"set","p":"headers.authorization","pt":"msg","to":"\"Bearer \" & msg.accessToken","tot":"jsonata"}],"action":"","property":"","from":"","to":"","reg":false,"x":1490,"y":140,"wires":[["d084eed6.44782"]]},{"id":"cda3ade4.e70eb","type":"http request","z":"938f4ad2.352088","name":"","method":"POST","ret":"obj","paytoqs":"ignore","url":"${CFG_ACL_ENDP}","tls":"51b09598.a1114d","persist":false,"proxy":"","authType":"basic","x":650,"y":40,"wires":[["78866543.5a6eec"]]},{"id":"78866543.5a6eec","type":"switch","z":"938f4ad2.352088","name":"","property":"statusCode","propertyType":"msg","rules":[{"t":"eq","v":"200","vt":"num"},{"t":"else"}],"checkall":"true","repair":false,"outputs":2,"x":810,"y":40,"wires":[["ab178c52.a37ce"],["a2d398d4.472b98"]]},{"id":"69e337ba.2367e8","type":"http request","z":"938f4ad2.352088","name":"","method":"POST","ret":"obj","paytoqs":"ignore","url":"${CFG_ACL_ENDP}","tls":"51b09598.a1114d","persist":false,"proxy":"","authType":"basic","x":490,"y":140,"wires":[["ad9f377a.473b18"]]},{"id":"ad9f377a.473b18","type":"switch","z":"938f4ad2.352088","name":"","property":"statusCode","propertyType":"msg","rules":[{"t":"eq","v":"200","vt":"num"},{"t":"else"}],"checkall":"true","repair":false,"outputs":2,"x":650,"y":140,"wires":[["58d47f36.1fc06"],["3fabac6d.6fa484"]]},{"id":"202cf9c9.810936","type":"change","z":"938f4ad2.352088","name":"acl req payload","rules":[{"t":"set","p":"headers","pt":"msg","to":"{}","tot":"json"},{"t":"set","p":"payload","pt":"msg","to":"{}","tot":"json"},{"t":"set","p":"payload.url","pt":"msg","to":"req.url","tot":"msg"},{"t":"set","p":"payload.method","pt":"msg","to":"req.method","tot":"msg"},{"t":"set","p":"payload.headers","pt":"msg","to":"req.headers","tot":"msg"},{"t":"set","p":"payload.params","pt":"msg","to":"req.params","tot":"msg"},{"t":"set","p":"payload.query","pt":"msg","to":"req.query","tot":"msg"},{"t":"set","p":"payload.body","pt":"msg","to":"req.body","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":300,"y":140,"wires":[["69e337ba.2367e8"]]},{"id":"29d0f949.9d1156","type":"change","z":"938f4ad2.352088","name":"acl req payload","rules":[{"t":"set","p":"headers","pt":"msg","to":"{}","tot":"json"},{"t":"set","p":"payload","pt":"msg","to":"{}","tot":"json"},{"t":"set","p":"payload.url","pt":"msg","to":"req.url","tot":"msg"},{"t":"set","p":"payload.method","pt":"msg","to":"req.method","tot":"msg"},{"t":"set","p":"payload.headers","pt":"msg","to":"req.headers","tot":"msg"},{"t":"set","p":"payload.params","pt":"msg","to":"req.params","tot":"msg"},{"t":"set","p":"payload.query","pt":"msg","to":"req.query","tot":"msg"},{"t":"set","p":"payload.body","pt":"msg","to":"req.body","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":460,"y":40,"wires":[["cda3ade4.e70eb"]]},{"id":"3fabac6d.6fa484","type":"http response","z":"938f4ad2.352088","name":"","statusCode":"","headers":{},"x":790,"y":180,"wires":[]},{"id":"865cb720.c975a8","type":"change","z":"938f4ad2.352088","name":"","rules":[{"t":"set","p":"payload","pt":"msg","to":"*[name = \"switch duration\" and type=\"change\"].rules[0].to & ( $string(*[name = \"switch duration\" and type=\"change\"].rules[0].to) != \"\" ? \" ms\" : \"\" )","tot":"jsonata"}],"action":"","property":"","from":"","to":"","reg":false,"x":1960,"y":140,"wires":[["e9bd5078.11005"]]},{"id":"4d7bb5e9.cc693c","type":"change","z":"938f4ad2.352088","name":"edit","rules":[{"t":"set","p":"old","pt":"msg","to":"*[name = \"switch duration\" and type=\"change\"]","tot":"jsonata"},{"t":"set","p":"new","pt":"msg","to":"old","tot":"msg"},{"t":"set","p":"new.rules[0].to","pt":"msg","to":"duration","tot":"msg"},{"t":"set","p":"payload","pt":"msg","to":"$eval($replace($string(payload),$string(old),$string(new)))","tot":"jsonata"}],"action":"","property":"","from":"","to":"","reg":false,"x":2090,"y":40,"wires":[["d044b383.b215e"]]},{"id":"a2d398d4.472b98","type":"http response","z":"938f4ad2.352088","name":"","statusCode":"","headers":{},"x":950,"y":80,"wires":[]},{"id":"3e5e55a4.adc06a","type":"switch","z":"938f4ad2.352088","name":"","property":"statusCode","propertyType":"msg","rules":[{"t":"eq","v":"200","vt":"num"},{"t":"else"}],"checkall":"true","repair":false,"outputs":2,"x":1270,"y":40,"wires":[["1e85c7cf.2e37d8"],["f8c3726.f3dbf9"]]},{"id":"f8c3726.f3dbf9","type":"http response","z":"938f4ad2.352088","name":"","statusCode":"","headers":{},"x":1410,"y":80,"wires":[]},{"id":"2f69dc3e.47e2c4","type":"switch","z":"938f4ad2.352088","name":"","property":"statusCode","propertyType":"msg","rules":[{"t":"eq","v":"200","vt":"num"},{"t":"else"}],"checkall":"true","repair":false,"outputs":2,"x":1950,"y":40,"wires":[["4d7bb5e9.cc693c"],["3eec4a3c.d47666"]]},{"id":"3eec4a3c.d47666","type":"http response","z":"938f4ad2.352088","name":"","statusCode":"","headers":{},"x":2090,"y":80,"wires":[]},{"id":"d044b383.b215e","type":"function","z":"938f4ad2.352088","name":"update flows","func":"const http = global.get('https');\nconst data = JSON.stringify(msg.payload);\nconst options = {\n  hostname: 'localhost',\n  port: 1880,\n  path: '/flows',\n  method: 'POST',\n  headers: {\n    'Content-Type': 'application/json',\n    'Content-Length': data.length,\n    'Authorization': 'Bearer '+msg.accessToken\n  },\n  rejectUnauthorized: false\n};\nconst req = http.request(options);\nreq.write(data);\nreq.end();\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":2250,"y":40,"wires":[["88aec260.545c6"]]},{"id":"49753350.7205ec","type":"switch","z":"938f4ad2.352088","name":"","property":"statusCode","propertyType":"msg","rules":[{"t":"eq","v":"200","vt":"num"},{"t":"else"}],"checkall":"true","repair":false,"outputs":2,"x":1110,"y":140,"wires":[["2bb535e8.0c019a"],["3135ab50.d79874"]]},{"id":"3135ab50.d79874","type":"http response","z":"938f4ad2.352088","name":"","statusCode":"","headers":{},"x":1250,"y":180,"wires":[]},{"id":"e275c734.885038","type":"switch","z":"938f4ad2.352088","name":"","property":"statusCode","propertyType":"msg","rules":[{"t":"eq","v":"200","vt":"num"},{"t":"else"}],"checkall":"true","repair":false,"outputs":2,"x":1790,"y":140,"wires":[["865cb720.c975a8"],["c96ec634.9418c8"]]},{"id":"c96ec634.9418c8","type":"http response","z":"938f4ad2.352088","name":"","statusCode":"","headers":{},"x":1930,"y":180,"wires":[]},{"id":"54633570.84c13c","type":"trigger","z":"50618dc7.9fe494","name":"watchdog","op1":"","op2":"bau","op1type":"nul","op2type":"str","duration":"1000","extend":true,"overrideDelay":false,"units":"ms","reset":"","bytopic":"all","topic":"topic","outputs":1,"x":160,"y":240,"wires":[["21146aa0.b89206"]]},{"id":"a64dd36b.3b72","type":"http in","z":"50618dc7.9fe494","name":"PUT timeout","url":"/watchdog/timeout","method":"put","upload":false,"swaggerDoc":"","x":90,"y":40,"wires":[["c4d5eefd.1139a"]]},{"id":"cc86667d.856c18","type":"change","z":"50618dc7.9fe494","name":"","rules":[{"t":"set","p":"payload","pt":"msg","to":"timeout & \" ms\"","tot":"jsonata"}],"action":"","property":"","from":"","to":"","reg":false,"x":2420,"y":40,"wires":[["f229f652.116978"]]},{"id":"51c07a76.c633e4","type":"http in","z":"50618dc7.9fe494","name":"GET timeout","url":"/watchdog/timeout","method":"get","upload":false,"swaggerDoc":"","x":90,"y":140,"wires":[["ad961ec5.56abc"]]},{"id":"5f39b185.a08cc","type":"http response","z":"50618dc7.9fe494","name":"","statusCode":"","headers":{},"x":2310,"y":140,"wires":[]},{"id":"e58705d7.180b88","type":"change","z":"50618dc7.9fe494","name":"","rules":[{"t":"set","p":"headers","pt":"msg","to":"{\"Content-Type\":\"text/plain\"}","tot":"json"}],"action":"","property":"","from":"","to":"","reg":false,"x":2140,"y":140,"wires":[["5f39b185.a08cc"]]},{"id":"c4d5eefd.1139a","type":"change","z":"50618dc7.9fe494","name":"get inputs","rules":[{"t":"set","p":"timeout","pt":"msg","to":"payload","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":260,"y":40,"wires":[["20204625.fc4bba"]]},{"id":"1837a473.b287dc","type":"http request","z":"50618dc7.9fe494","name":"get flows","method":"GET","ret":"obj","paytoqs":"ignore","url":"https://localhost:1880/flows","tls":"b1a419c1.609c29","persist":false,"proxy":"","authType":"","x":1780,"y":40,"wires":[["32fb72a0.579b6e"]]},{"id":"c31ff640.388588","type":"http response","z":"50618dc7.9fe494","name":"","statusCode":"","headers":{},"x":2790,"y":40,"wires":[]},{"id":"f229f652.116978","type":"change","z":"50618dc7.9fe494","name":"","rules":[{"t":"set","p":"headers","pt":"msg","to":"{\"Content-Type\":\"text/plain\"}","tot":"json"}],"action":"","property":"","from":"","to":"","reg":false,"x":2620,"y":40,"wires":[["c31ff640.388588","3b5cde00.c79a82"]]},{"id":"c065cfe2.e7488","type":"http request","z":"50618dc7.9fe494","name":"get flows","method":"GET","ret":"obj","paytoqs":"ignore","url":"https://localhost:1880/flows","tls":"b1a419c1.609c29","persist":false,"proxy":"","authType":"","x":1620,"y":140,"wires":[["23287752.103c88"]]},{"id":"30aee63.8a9291a","type":"http request","z":"50618dc7.9fe494","name":"auth","method":"POST","ret":"obj","paytoqs":"ignore","url":"https://localhost:1880/auth/token","tls":"b1a419c1.609c29","persist":false,"proxy":"","authType":"","x":1110,"y":40,"wires":[["63269b67.0115e4"]]},{"id":"218d09c6.a306d6","type":"change","z":"50618dc7.9fe494","name":"auth payload","rules":[{"t":"set","p":"payload","pt":"msg","to":"{}","tot":"json"},{"t":"set","p":"payload.client_id","pt":"msg","to":"node-red-editor","tot":"str"},{"t":"set","p":"payload.grant_type","pt":"msg","to":"password","tot":"str"},{"t":"set","p":"payload.scope","pt":"msg","to":"","tot":"str"},{"t":"set","p":"payload.username","pt":"msg","to":"NRADM_USER","tot":"env"},{"t":"set","p":"payload.password","pt":"msg","to":"NRADM_PASS","tot":"env"}],"action":"","property":"","from":"","to":"","reg":false,"x":950,"y":40,"wires":[["30aee63.8a9291a"]]},{"id":"c9c22bd6.c1f848","type":"change","z":"50618dc7.9fe494","name":"","rules":[{"t":"set","p":"accessToken","pt":"msg","to":"payload.access_token","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":1440,"y":40,"wires":[["e092c611.da8d58"]]},{"id":"e092c611.da8d58","type":"change","z":"50618dc7.9fe494","name":"bearer","rules":[{"t":"set","p":"headers","pt":"msg","to":"{}","tot":"json"},{"t":"set","p":"headers.authorization","pt":"msg","to":"\"Bearer \" & msg.accessToken","tot":"jsonata"}],"action":"","property":"","from":"","to":"","reg":false,"x":1630,"y":40,"wires":[["1837a473.b287dc"]]},{"id":"9855b962.722aa8","type":"http request","z":"50618dc7.9fe494","name":"auth","method":"POST","ret":"obj","paytoqs":"ignore","url":"https://localhost:1880/auth/token","tls":"b1a419c1.609c29","persist":false,"proxy":"","authType":"","x":950,"y":140,"wires":[["96a0bb94.a2f218"]]},{"id":"a46929b9.b86be8","type":"change","z":"50618dc7.9fe494","name":"auth payload","rules":[{"t":"set","p":"payload.client_id","pt":"msg","to":"node-red-editor","tot":"str"},{"t":"set","p":"payload.grant_type","pt":"msg","to":"password","tot":"str"},{"t":"set","p":"payload.scope","pt":"msg","to":"","tot":"str"},{"t":"set","p":"payload.username","pt":"msg","to":"NRADM_USER","tot":"env"},{"t":"set","p":"payload.password","pt":"msg","to":"NRADM_PASS","tot":"env"}],"action":"","property":"","from":"","to":"","reg":false,"x":790,"y":140,"wires":[["9855b962.722aa8"]]},{"id":"ddc3a64.b38cd58","type":"change","z":"50618dc7.9fe494","name":"","rules":[{"t":"set","p":"accessToken","pt":"msg","to":"payload.access_token","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":1280,"y":140,"wires":[["e7425e9e.06f0d"]]},{"id":"e7425e9e.06f0d","type":"change","z":"50618dc7.9fe494","name":"bearer","rules":[{"t":"set","p":"headers","pt":"msg","to":"{}","tot":"json"},{"t":"set","p":"headers.authorization","pt":"msg","to":"\"Bearer \" & msg.accessToken","tot":"jsonata"}],"action":"","property":"","from":"","to":"","reg":false,"x":1470,"y":140,"wires":[["c065cfe2.e7488"]]},{"id":"516cd578.941d1c","type":"http request","z":"50618dc7.9fe494","name":"","method":"POST","ret":"obj","paytoqs":"ignore","url":"${CFG_ACL_ENDP}","tls":"51b09598.a1114d","persist":false,"proxy":"","authType":"basic","x":630,"y":40,"wires":[["2096d69.4d7192a"]]},{"id":"2096d69.4d7192a","type":"switch","z":"50618dc7.9fe494","name":"","property":"statusCode","propertyType":"msg","rules":[{"t":"eq","v":"200","vt":"num"},{"t":"else"}],"checkall":"true","repair":false,"outputs":2,"x":790,"y":40,"wires":[["218d09c6.a306d6"],["76bc716b.b0d34"]]},{"id":"502c2e07.43532","type":"http request","z":"50618dc7.9fe494","name":"","method":"POST","ret":"obj","paytoqs":"ignore","url":"${CFG_ACL_ENDP}","tls":"51b09598.a1114d","persist":false,"proxy":"","authType":"basic","x":470,"y":140,"wires":[["9f38779a.9b0368"]]},{"id":"9f38779a.9b0368","type":"switch","z":"50618dc7.9fe494","name":"","property":"statusCode","propertyType":"msg","rules":[{"t":"eq","v":"200","vt":"num"},{"t":"else"}],"checkall":"true","repair":false,"outputs":2,"x":630,"y":140,"wires":[["a46929b9.b86be8"],["ec8d0cc2.8998d"]]},{"id":"ad961ec5.56abc","type":"change","z":"50618dc7.9fe494","name":"acl req payload","rules":[{"t":"set","p":"headers","pt":"msg","to":"{}","tot":"json"},{"t":"set","p":"payload","pt":"msg","to":"{}","tot":"json"},{"t":"set","p":"payload.url","pt":"msg","to":"req.url","tot":"msg"},{"t":"set","p":"payload.method","pt":"msg","to":"req.method","tot":"msg"},{"t":"set","p":"payload.headers","pt":"msg","to":"req.headers","tot":"msg"},{"t":"set","p":"payload.params","pt":"msg","to":"req.params","tot":"msg"},{"t":"set","p":"payload.query","pt":"msg","to":"req.query","tot":"msg"},{"t":"set","p":"payload.body","pt":"msg","to":"req.body","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":280,"y":140,"wires":[["502c2e07.43532"]]},{"id":"20204625.fc4bba","type":"change","z":"50618dc7.9fe494","name":"acl req payload","rules":[{"t":"set","p":"headers","pt":"msg","to":"{}","tot":"json"},{"t":"set","p":"payload","pt":"msg","to":"{}","tot":"json"},{"t":"set","p":"payload.url","pt":"msg","to":"req.url","tot":"msg"},{"t":"set","p":"payload.method","pt":"msg","to":"req.method","tot":"msg"},{"t":"set","p":"payload.headers","pt":"msg","to":"req.headers","tot":"msg"},{"t":"set","p":"payload.params","pt":"msg","to":"req.params","tot":"msg"},{"t":"set","p":"payload.query","pt":"msg","to":"req.query","tot":"msg"},{"t":"set","p":"payload.body","pt":"msg","to":"req.body","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":440,"y":40,"wires":[["516cd578.941d1c"]]},{"id":"ec8d0cc2.8998d","type":"http response","z":"50618dc7.9fe494","name":"","statusCode":"","headers":{},"x":770,"y":180,"wires":[]},{"id":"65874b52.ef4864","type":"change","z":"50618dc7.9fe494","name":"","rules":[{"t":"set","p":"payload","pt":"msg","to":"*[name = \"watchdog\" and type=\"trigger\"].duration & \" ms\"","tot":"jsonata"}],"action":"","property":"","from":"","to":"","reg":false,"x":1940,"y":140,"wires":[["e58705d7.180b88"]]},{"id":"a6a89c5f.9e96","type":"change","z":"50618dc7.9fe494","name":"edit","rules":[{"t":"set","p":"old","pt":"msg","to":"*[name = \"watchdog\" and type=\"trigger\"]","tot":"jsonata"},{"t":"set","p":"new","pt":"msg","to":"old","tot":"msg"},{"t":"set","p":"new.duration","pt":"msg","to":"timeout","tot":"msg"},{"t":"set","p":"payload","pt":"msg","to":"$eval($replace($string(payload),$string(old),$string(new)))","tot":"jsonata"}],"action":"","property":"","from":"","to":"","reg":false,"x":2070,"y":40,"wires":[["461f40dd.4854c"]]},{"id":"76bc716b.b0d34","type":"http response","z":"50618dc7.9fe494","name":"","statusCode":"","headers":{},"x":930,"y":80,"wires":[]},{"id":"63269b67.0115e4","type":"switch","z":"50618dc7.9fe494","name":"","property":"statusCode","propertyType":"msg","rules":[{"t":"eq","v":"200","vt":"num"},{"t":"else"}],"checkall":"true","repair":false,"outputs":2,"x":1250,"y":40,"wires":[["c9c22bd6.c1f848"],["1e189c17.e6e0f4"]]},{"id":"1e189c17.e6e0f4","type":"http response","z":"50618dc7.9fe494","name":"","statusCode":"","headers":{},"x":1390,"y":80,"wires":[]},{"id":"32fb72a0.579b6e","type":"switch","z":"50618dc7.9fe494","name":"","property":"statusCode","propertyType":"msg","rules":[{"t":"eq","v":"200","vt":"num"},{"t":"else"}],"checkall":"true","repair":false,"outputs":2,"x":1930,"y":40,"wires":[["a6a89c5f.9e96"],["1aa31c6d.672614"]]},{"id":"1aa31c6d.672614","type":"http response","z":"50618dc7.9fe494","name":"","statusCode":"","headers":{},"x":2070,"y":80,"wires":[]},{"id":"461f40dd.4854c","type":"function","z":"50618dc7.9fe494","name":"update flows","func":"const http = global.get('https');\nconst data = JSON.stringify(msg.payload);\nconst options = {\n  hostname: 'localhost',\n  port: 1880,\n  path: '/flows',\n  method: 'POST',\n  headers: {\n    'Content-Type': 'application/json',\n    'Content-Length': data.length,\n    'Authorization': 'Bearer '+msg.accessToken\n  },\n  rejectUnauthorized: false\n};\nconst req = http.request(options);\nreq.write(data);\nreq.end();\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":2230,"y":40,"wires":[["cc86667d.856c18"]]},{"id":"96a0bb94.a2f218","type":"switch","z":"50618dc7.9fe494","name":"","property":"statusCode","propertyType":"msg","rules":[{"t":"eq","v":"200","vt":"num"},{"t":"else"}],"checkall":"true","repair":false,"outputs":2,"x":1090,"y":140,"wires":[["ddc3a64.b38cd58"],["1d113b9c.404014"]]},{"id":"1d113b9c.404014","type":"http response","z":"50618dc7.9fe494","name":"","statusCode":"","headers":{},"x":1230,"y":180,"wires":[]},{"id":"23287752.103c88","type":"switch","z":"50618dc7.9fe494","name":"","property":"statusCode","propertyType":"msg","rules":[{"t":"eq","v":"200","vt":"num"},{"t":"else"}],"checkall":"true","repair":false,"outputs":2,"x":1770,"y":140,"wires":[["65874b52.ef4864"],["71a9709f.ae9d1"]]},{"id":"71a9709f.ae9d1","type":"http response","z":"50618dc7.9fe494","name":"","statusCode":"","headers":{},"x":1910,"y":180,"wires":[]},{"id":"f012115f.ec058","type":"switch","z":"15706c00.b04294","name":"","property":"threshold","propertyType":"msg","rules":[{"t":"nempty"},{"t":"else"}],"checkall":"true","repair":false,"outputs":2,"x":410,"y":240,"wires":[["c504c3bc.84a2f"],["7f5b0e17.56459"]]},{"id":"7f5b0e17.56459","type":"change","z":"15706c00.b04294","name":"status error","rules":[{"t":"set","p":"status","pt":"msg","to":"{ \"error\": \"threshold not set\" }","tot":"json"}],"action":"","property":"","from":"","to":"","reg":false,"x":630,"y":300,"wires":[["41418afc.df50a4"]]},{"id":"f7534d0b.4cc29","type":"switch","z":"5ad932d2.c06e2c","name":"","property":"$boolean(from) and $boolean(to)","propertyType":"jsonata","rules":[{"t":"true"},{"t":"else"}],"checkall":"true","repair":false,"outputs":2,"x":390,"y":440,"wires":[["3251fecc.9eff72"],["a610e9df.774d18"]]},{"id":"a610e9df.774d18","type":"change","z":"5ad932d2.c06e2c","name":"status error","rules":[{"t":"set","p":"status","pt":"msg","to":"{ \"error\": \"interval not set\" }","tot":"json"}],"action":"","property":"","from":"","to":"","reg":false,"x":550,"y":480,"wires":[["497be3fb.74994c"]]},{"id":"fd5f1bb8.5e2448","type":"change","z":"15706c00.b04294","name":"status","rules":[{"t":"set","p":"payload","pt":"msg","to":"{}","tot":"json"},{"t":"set","p":"payload.text","pt":"msg","to":"\"threshold: \" & threshold","tot":"jsonata"},{"t":"set","p":"payload.shape","pt":"msg","to":"dot","tot":"str"},{"t":"set","p":"payload.fill","pt":"msg","to":"grey","tot":"str"}],"action":"","property":"","from":"","to":"","reg":false,"x":2770,"y":100,"wires":[[]]},{"id":"10f4bce8.b266c3","type":"change","z":"5ad932d2.c06e2c","name":"status","rules":[{"t":"set","p":"payload","pt":"msg","to":"{}","tot":"json"},{"t":"set","p":"payload.text","pt":"msg","to":"\"to: \" & to","tot":"jsonata"},{"t":"set","p":"payload.shape","pt":"msg","to":"dot","tot":"str"},{"t":"set","p":"payload.fill","pt":"msg","to":"grey","tot":"str"}],"action":"","property":"","from":"","to":"","reg":false,"x":2750,"y":300,"wires":[[]]},{"id":"99f26c7f.580dc","type":"change","z":"5ad932d2.c06e2c","name":"status","rules":[{"t":"set","p":"payload","pt":"msg","to":"{}","tot":"json"},{"t":"set","p":"payload.text","pt":"msg","to":"\"from: \" & from","tot":"jsonata"},{"t":"set","p":"payload.shape","pt":"msg","to":"dot","tot":"str"},{"t":"set","p":"payload.fill","pt":"msg","to":"grey","tot":"str"}],"action":"","property":"","from":"","to":"","reg":false,"x":2770,"y":100,"wires":[[]]},{"id":"d5ee2a5c.222428","type":"switch","z":"2b718b38.a1a7b4","name":"","property":"threshold","propertyType":"msg","rules":[{"t":"nempty"},{"t":"else"}],"checkall":"true","repair":false,"outputs":2,"x":410,"y":240,"wires":[["8724d39c.44d86"],["81a3af15.6eacd"]]},{"id":"81a3af15.6eacd","type":"change","z":"2b718b38.a1a7b4","name":"status error","rules":[{"t":"set","p":"status","pt":"msg","to":"{ \"error\": \"threshold not set\" }","tot":"json"}],"action":"","property":"","from":"","to":"","reg":false,"x":630,"y":300,"wires":[["58901566.2ea99c"]]},{"id":"b7c7052f.193038","type":"change","z":"2b718b38.a1a7b4","name":"status","rules":[{"t":"set","p":"payload","pt":"msg","to":"{}","tot":"json"},{"t":"set","p":"payload.text","pt":"msg","to":"$boolean(status.error) ? \"error: \" & status.error : $boolean(status.out) ? \"forwarded: \" & status.out : \"discarded: \" & status.in","tot":"jsonata"},{"t":"set","p":"payload.shape","pt":"msg","to":"dot","tot":"str"},{"t":"set","p":"payload.fill","pt":"msg","to":"$boolean(status.out) ? \"green\" : $boolean(status.error) ? \"red\" : \"yellow\"","tot":"jsonata"}],"action":"","property":"","from":"","to":"","reg":false,"x":1030,"y":340,"wires":[[]]},{"id":"66ede242.221f5c","type":"change","z":"2b718b38.a1a7b4","name":"status","rules":[{"t":"set","p":"payload","pt":"msg","to":"{}","tot":"json"},{"t":"set","p":"payload.text","pt":"msg","to":"\"threshold: \" & threshold","tot":"jsonata"},{"t":"set","p":"payload.shape","pt":"msg","to":"dot","tot":"str"},{"t":"set","p":"payload.fill","pt":"msg","to":"grey","tot":"str"}],"action":"","property":"","from":"","to":"","reg":false,"x":2770,"y":100,"wires":[[]]},{"id":"19f0b1a9.9f791e","type":"switch","z":"189ac7e1.52f288","name":"","property":"$boolean(from) and $boolean(to)","propertyType":"jsonata","rules":[{"t":"false"},{"t":"else"}],"checkall":"true","repair":false,"outputs":2,"x":390,"y":560,"wires":[["e9f2754.4878a88"],["e1beda2a.24c408"]]},{"id":"e9f2754.4878a88","type":"change","z":"189ac7e1.52f288","name":"status error","rules":[{"t":"set","p":"status","pt":"msg","to":"{ \"error\": \"interval not set\" }","tot":"json"}],"action":"","property":"","from":"","to":"","reg":false,"x":550,"y":500,"wires":[["29c42bf0.04f6f4"]]},{"id":"ed9180c7.e5ac7","type":"change","z":"189ac7e1.52f288","name":"status","rules":[{"t":"set","p":"payload","pt":"msg","to":"{}","tot":"json"},{"t":"set","p":"payload.text","pt":"msg","to":"\"from: \" & from","tot":"jsonata"},{"t":"set","p":"payload.shape","pt":"msg","to":"dot","tot":"str"},{"t":"set","p":"payload.fill","pt":"msg","to":"grey","tot":"str"}],"action":"","property":"","from":"","to":"","reg":false,"x":2790,"y":100,"wires":[[]]},{"id":"c59e6fac.52e94","type":"change","z":"189ac7e1.52f288","name":"status","rules":[{"t":"set","p":"payload","pt":"msg","to":"{}","tot":"json"},{"t":"set","p":"payload.text","pt":"msg","to":"\"to: \" & to","tot":"jsonata"},{"t":"set","p":"payload.shape","pt":"msg","to":"dot","tot":"str"},{"t":"set","p":"payload.fill","pt":"msg","to":"grey","tot":"str"}],"action":"","property":"","from":"","to":"","reg":false,"x":2770,"y":300,"wires":[[]]},{"id":"f5e3320e.206b4","type":"change","z":"189ac7e1.52f288","name":"status","rules":[{"t":"set","p":"payload","pt":"msg","to":"{}","tot":"json"},{"t":"set","p":"payload.text","pt":"msg","to":"$boolean(status.error) ? \"error: \" & status.error : $boolean(status.out) ? \"forwarded: \" & status.out : \"discarded: \" & status.in","tot":"jsonata"},{"t":"set","p":"payload.shape","pt":"msg","to":"dot","tot":"str"},{"t":"set","p":"payload.fill","pt":"msg","to":"$boolean(status.out) ? \"green\" : $boolean(status.error) ? \"red\" : \"yellow\"","tot":"jsonata"}],"action":"","property":"","from":"","to":"","reg":false,"x":1030,"y":460,"wires":[[]]},{"id":"614867dc.d79a18","type":"change","z":"2599ad7e.d33f62","name":"get enum","rules":[{"t":"set","p":"enum","pt":"msg","to":"[]","tot":"json"},{"t":"set","p":"status","pt":"msg","to":"{ \"out\": null }","tot":"json"}],"action":"","property":"","from":"","to":"","reg":false,"x":160,"y":240,"wires":[["f8f18b8f.f7b4f8"]]},{"id":"a28c2e1b.23982","type":"http in","z":"2599ad7e.d33f62","name":"PUT enum","url":"/enum","method":"put","upload":false,"swaggerDoc":"","x":80,"y":40,"wires":[["10ffc3d6.e1379c"]]},{"id":"e28312b2.cc6ba","type":"change","z":"2599ad7e.d33f62","name":"","rules":[{"t":"set","p":"payload","pt":"msg","to":"enum","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":2400,"y":40,"wires":[["cdc4305a.c0362"]]},{"id":"72537e65.46726","type":"http in","z":"2599ad7e.d33f62","name":"GET enum","url":"/enum","method":"get","upload":false,"swaggerDoc":"","x":80,"y":140,"wires":[["99571328.c5273"]]},{"id":"a3afb667.5b75c8","type":"http response","z":"2599ad7e.d33f62","name":"","statusCode":"","headers":{},"x":2290,"y":140,"wires":[]},{"id":"59a91311.51be6c","type":"change","z":"2599ad7e.d33f62","name":"","rules":[{"t":"set","p":"headers","pt":"msg","to":"{\"Content-Type\":\"text/plain\"}","tot":"json"}],"action":"","property":"","from":"","to":"","reg":false,"x":2120,"y":140,"wires":[["a3afb667.5b75c8"]]},{"id":"10ffc3d6.e1379c","type":"change","z":"2599ad7e.d33f62","name":"get inputs","rules":[{"t":"set","p":"enum","pt":"msg","to":"payload","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":240,"y":40,"wires":[["56fdcb8e.b07b54"]]},{"id":"3beebee6.34a652","type":"http request","z":"2599ad7e.d33f62","name":"get flows","method":"GET","ret":"obj","paytoqs":"ignore","url":"https://localhost:1880/flows","tls":"b1a419c1.609c29","persist":false,"proxy":"","authType":"","x":1760,"y":40,"wires":[["93e6af4d.a901c"]]},{"id":"db6c03e1.1f6aa","type":"http response","z":"2599ad7e.d33f62","name":"","statusCode":"","headers":{},"x":2770,"y":40,"wires":[]},{"id":"cdc4305a.c0362","type":"change","z":"2599ad7e.d33f62","name":"","rules":[{"t":"set","p":"headers","pt":"msg","to":"{\"Content-Type\":\"text/plain\"}","tot":"json"}],"action":"","property":"","from":"","to":"","reg":false,"x":2600,"y":40,"wires":[["db6c03e1.1f6aa","dfa08839.8d5d78"]]},{"id":"e182dfee.744b8","type":"http request","z":"2599ad7e.d33f62","name":"get flows","method":"GET","ret":"obj","paytoqs":"ignore","url":"https://localhost:1880/flows","tls":"b1a419c1.609c29","persist":false,"proxy":"","authType":"","x":1600,"y":140,"wires":[["a54cf944.25d4f8"]]},{"id":"f031d3b8.fe225","type":"http request","z":"2599ad7e.d33f62","name":"auth","method":"POST","ret":"obj","paytoqs":"ignore","url":"https://localhost:1880/auth/token","tls":"b1a419c1.609c29","persist":false,"proxy":"","authType":"","x":1090,"y":40,"wires":[["d1ac3930.58f148"]]},{"id":"87231f2d.99141","type":"change","z":"2599ad7e.d33f62","name":"auth payload","rules":[{"t":"set","p":"payload","pt":"msg","to":"{}","tot":"json"},{"t":"set","p":"payload.client_id","pt":"msg","to":"node-red-editor","tot":"str"},{"t":"set","p":"payload.grant_type","pt":"msg","to":"password","tot":"str"},{"t":"set","p":"payload.scope","pt":"msg","to":"","tot":"str"},{"t":"set","p":"payload.username","pt":"msg","to":"NRADM_USER","tot":"env"},{"t":"set","p":"payload.password","pt":"msg","to":"NRADM_PASS","tot":"env"}],"action":"","property":"","from":"","to":"","reg":false,"x":930,"y":40,"wires":[["f031d3b8.fe225"]]},{"id":"7046ea0f.37f374","type":"change","z":"2599ad7e.d33f62","name":"","rules":[{"t":"set","p":"accessToken","pt":"msg","to":"payload.access_token","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":1420,"y":40,"wires":[["ec1e3637.0b5338"]]},{"id":"ec1e3637.0b5338","type":"change","z":"2599ad7e.d33f62","name":"bearer","rules":[{"t":"set","p":"headers","pt":"msg","to":"{}","tot":"json"},{"t":"set","p":"headers.authorization","pt":"msg","to":"\"Bearer \" & msg.accessToken","tot":"jsonata"}],"action":"","property":"","from":"","to":"","reg":false,"x":1610,"y":40,"wires":[["3beebee6.34a652"]]},{"id":"cebb7aa5.f91598","type":"http request","z":"2599ad7e.d33f62","name":"auth","method":"POST","ret":"obj","paytoqs":"ignore","url":"https://localhost:1880/auth/token","tls":"b1a419c1.609c29","persist":false,"proxy":"","authType":"","x":930,"y":140,"wires":[["30651802.a59b98"]]},{"id":"2f4e5e1c.a6b972","type":"change","z":"2599ad7e.d33f62","name":"auth payload","rules":[{"t":"set","p":"payload.client_id","pt":"msg","to":"node-red-editor","tot":"str"},{"t":"set","p":"payload.grant_type","pt":"msg","to":"password","tot":"str"},{"t":"set","p":"payload.scope","pt":"msg","to":"","tot":"str"},{"t":"set","p":"payload.username","pt":"msg","to":"NRADM_USER","tot":"env"},{"t":"set","p":"payload.password","pt":"msg","to":"NRADM_PASS","tot":"env"}],"action":"","property":"","from":"","to":"","reg":false,"x":770,"y":140,"wires":[["cebb7aa5.f91598"]]},{"id":"7b68a735.c07e48","type":"change","z":"2599ad7e.d33f62","name":"","rules":[{"t":"set","p":"accessToken","pt":"msg","to":"payload.access_token","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":1260,"y":140,"wires":[["94cbff82.458d4"]]},{"id":"94cbff82.458d4","type":"change","z":"2599ad7e.d33f62","name":"bearer","rules":[{"t":"set","p":"headers","pt":"msg","to":"{}","tot":"json"},{"t":"set","p":"headers.authorization","pt":"msg","to":"\"Bearer \" & msg.accessToken","tot":"jsonata"}],"action":"","property":"","from":"","to":"","reg":false,"x":1450,"y":140,"wires":[["e182dfee.744b8"]]},{"id":"536b1f7a.3cf55","type":"http request","z":"2599ad7e.d33f62","name":"","method":"POST","ret":"obj","paytoqs":"ignore","url":"${CFG_ACL_ENDP}","tls":"51b09598.a1114d","persist":false,"proxy":"","authType":"","x":610,"y":40,"wires":[["79d5737d.720b0c"]]},{"id":"79d5737d.720b0c","type":"switch","z":"2599ad7e.d33f62","name":"","property":"statusCode","propertyType":"msg","rules":[{"t":"eq","v":"200","vt":"num"},{"t":"else"}],"checkall":"true","repair":false,"outputs":2,"x":770,"y":40,"wires":[["87231f2d.99141"],["57b7fb16.2c3674"]]},{"id":"5d1065f.d92d29c","type":"http request","z":"2599ad7e.d33f62","name":"","method":"POST","ret":"obj","paytoqs":"ignore","url":"${CFG_ACL_ENDP}","tls":"51b09598.a1114d","persist":false,"proxy":"","authType":"","x":450,"y":140,"wires":[["8a92cea.522663"]]},{"id":"8a92cea.522663","type":"switch","z":"2599ad7e.d33f62","name":"","property":"statusCode","propertyType":"msg","rules":[{"t":"eq","v":"200","vt":"num"},{"t":"else"}],"checkall":"true","repair":false,"outputs":2,"x":610,"y":140,"wires":[["2f4e5e1c.a6b972"],["c8eb1c0e.ba5bb"]]},{"id":"99571328.c5273","type":"change","z":"2599ad7e.d33f62","name":"acl req payload","rules":[{"t":"set","p":"headers","pt":"msg","to":"{}","tot":"json"},{"t":"set","p":"payload","pt":"msg","to":"{}","tot":"json"},{"t":"set","p":"payload.url","pt":"msg","to":"req.url","tot":"msg"},{"t":"set","p":"payload.method","pt":"msg","to":"req.method","tot":"msg"},{"t":"set","p":"payload.headers","pt":"msg","to":"req.headers","tot":"msg"},{"t":"set","p":"payload.params","pt":"msg","to":"req.params","tot":"msg"},{"t":"set","p":"payload.query","pt":"msg","to":"req.query","tot":"msg"},{"t":"set","p":"payload.body","pt":"msg","to":"req.body","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":260,"y":140,"wires":[["5d1065f.d92d29c"]]},{"id":"56fdcb8e.b07b54","type":"change","z":"2599ad7e.d33f62","name":"acl req payload","rules":[{"t":"set","p":"headers","pt":"msg","to":"{}","tot":"json"},{"t":"set","p":"payload","pt":"msg","to":"{}","tot":"json"},{"t":"set","p":"payload.url","pt":"msg","to":"req.url","tot":"msg"},{"t":"set","p":"payload.method","pt":"msg","to":"req.method","tot":"msg"},{"t":"set","p":"payload.headers","pt":"msg","to":"req.headers","tot":"msg"},{"t":"set","p":"payload.params","pt":"msg","to":"req.params","tot":"msg"},{"t":"set","p":"payload.query","pt":"msg","to":"req.query","tot":"msg"},{"t":"set","p":"payload.body","pt":"msg","to":"req.body","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":420,"y":40,"wires":[["536b1f7a.3cf55"]]},{"id":"c8eb1c0e.ba5bb","type":"http response","z":"2599ad7e.d33f62","name":"","statusCode":"","headers":{},"x":750,"y":180,"wires":[]},{"id":"c378cabb.192b38","type":"change","z":"2599ad7e.d33f62","name":"","rules":[{"t":"set","p":"payload","pt":"msg","to":"*[name = \"get enum\" and type=\"change\"].rules[0].to","tot":"jsonata"}],"action":"","property":"","from":"","to":"","reg":false,"x":1920,"y":140,"wires":[["59a91311.51be6c"]]},{"id":"1e0ea82c.1ce818","type":"change","z":"2599ad7e.d33f62","name":"edit","rules":[{"t":"set","p":"old","pt":"msg","to":"*[name = \"get enum\" and type=\"change\"]","tot":"jsonata"},{"t":"set","p":"new","pt":"msg","to":"old","tot":"msg"},{"t":"set","p":"new.rules[0].to","pt":"msg","to":"$string(enum)","tot":"jsonata"},{"t":"set","p":"payload","pt":"msg","to":"$eval($replace($string(payload),$string(old),$string(new)))","tot":"jsonata"}],"action":"","property":"","from":"","to":"","reg":false,"x":2050,"y":40,"wires":[["f64a3946.dac158"]]},{"id":"57b7fb16.2c3674","type":"http response","z":"2599ad7e.d33f62","name":"","statusCode":"","headers":{},"x":910,"y":80,"wires":[]},{"id":"d1ac3930.58f148","type":"switch","z":"2599ad7e.d33f62","name":"","property":"statusCode","propertyType":"msg","rules":[{"t":"eq","v":"200","vt":"num"},{"t":"else"}],"checkall":"true","repair":false,"outputs":2,"x":1230,"y":40,"wires":[["7046ea0f.37f374"],["e4d4f8c5.ba1eb8"]]},{"id":"e4d4f8c5.ba1eb8","type":"http response","z":"2599ad7e.d33f62","name":"","statusCode":"","headers":{},"x":1370,"y":80,"wires":[]},{"id":"93e6af4d.a901c","type":"switch","z":"2599ad7e.d33f62","name":"","property":"statusCode","propertyType":"msg","rules":[{"t":"eq","v":"200","vt":"num"},{"t":"else"}],"checkall":"true","repair":false,"outputs":2,"x":1910,"y":40,"wires":[["1e0ea82c.1ce818"],["c6c43964.25e668"]]},{"id":"c6c43964.25e668","type":"http response","z":"2599ad7e.d33f62","name":"","statusCode":"","headers":{},"x":2050,"y":80,"wires":[]},{"id":"f64a3946.dac158","type":"function","z":"2599ad7e.d33f62","name":"update flows","func":"const http = global.get('https');\nconst data = JSON.stringify(msg.payload);\nconst options = {\n  hostname: 'localhost',\n  port: 1880,\n  path: '/flows',\n  method: 'POST',\n  headers: {\n    'Content-Type': 'application/json',\n    'Content-Length': data.length,\n    'Authorization': 'Bearer '+msg.accessToken\n  },\n  rejectUnauthorized: false\n};\nconst req = http.request(options);\nreq.write(data);\nreq.end();\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":2210,"y":40,"wires":[["e28312b2.cc6ba"]]},{"id":"30651802.a59b98","type":"switch","z":"2599ad7e.d33f62","name":"","property":"statusCode","propertyType":"msg","rules":[{"t":"eq","v":"200","vt":"num"},{"t":"else"}],"checkall":"true","repair":false,"outputs":2,"x":1070,"y":140,"wires":[["7b68a735.c07e48"],["34cc73e6.9196fc"]]},{"id":"34cc73e6.9196fc","type":"http response","z":"2599ad7e.d33f62","name":"","statusCode":"","headers":{},"x":1210,"y":180,"wires":[]},{"id":"a54cf944.25d4f8","type":"switch","z":"2599ad7e.d33f62","name":"","property":"statusCode","propertyType":"msg","rules":[{"t":"eq","v":"200","vt":"num"},{"t":"else"}],"checkall":"true","repair":false,"outputs":2,"x":1750,"y":140,"wires":[["c378cabb.192b38"],["665a6ff0.4f00d"]]},{"id":"665a6ff0.4f00d","type":"http response","z":"2599ad7e.d33f62","name":"","statusCode":"","headers":{},"x":1890,"y":180,"wires":[]},{"id":"dfa08839.8d5d78","type":"change","z":"2599ad7e.d33f62","name":"status","rules":[{"t":"set","p":"payload","pt":"msg","to":"{}","tot":"json"},{"t":"set","p":"payload.text","pt":"msg","to":"\"threshold: \" & threshold","tot":"jsonata"},{"t":"set","p":"payload.shape","pt":"msg","to":"dot","tot":"str"},{"t":"set","p":"payload.fill","pt":"msg","to":"grey","tot":"str"}],"action":"","property":"","from":"","to":"","reg":false,"x":2770,"y":100,"wires":[[]]},{"id":"7c8fcbf7.8f30c4","type":"change","z":"2599ad7e.d33f62","name":"status in","rules":[{"t":"set","p":"status","pt":"msg","to":"{}","tot":"json"},{"t":"set","p":"status.in","pt":"msg","to":"payload","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":160,"y":360,"wires":[["ff581746.f0e498"]]},{"id":"20afecf4.ba5974","type":"change","z":"2599ad7e.d33f62","name":"status error","rules":[{"t":"set","p":"status","pt":"msg","to":"{ \"error\": \"valid values?\" }","tot":"json"}],"action":"","property":"","from":"","to":"","reg":false,"x":510,"y":300,"wires":[["ff581746.f0e498"]]},{"id":"ff581746.f0e498","type":"join","z":"2599ad7e.d33f62","name":"","mode":"custom","build":"merged","property":"status","propertyType":"msg","key":"topic","joiner":"\\n","joinerType":"str","accumulate":false,"timeout":"","count":"2","reduceRight":false,"reduceExp":"","reduceInit":"","reduceInitType":"","reduceFixup":"","x":730,"y":360,"wires":[["3d1d160c.3d868a"]]},{"id":"c051d03f.8c36c","type":"change","z":"2599ad7e.d33f62","name":"status out","rules":[{"t":"set","p":"status","pt":"msg","to":"{ \"out\": payload }","tot":"jsonata"}],"action":"","property":"","from":"","to":"","reg":false,"x":760,"y":300,"wires":[["ff581746.f0e498"]]},{"id":"f8f18b8f.f7b4f8","type":"switch","z":"2599ad7e.d33f62","name":"","property":"enum","propertyType":"msg","rules":[{"t":"nempty"},{"t":"else"}],"checkall":"true","repair":false,"outputs":2,"x":350,"y":240,"wires":[["195d581e.379868"],["20afecf4.ba5974"]]},{"id":"3d1d160c.3d868a","type":"change","z":"2599ad7e.d33f62","name":"status","rules":[{"t":"set","p":"payload","pt":"msg","to":"{}","tot":"json"},{"t":"set","p":"payload.text","pt":"msg","to":"$boolean(status.error) ? \"error: \" & status.error : $boolean(status.out) ? \"forwarded: \" & status.out : \"discarded: \" & status.in","tot":"jsonata"},{"t":"set","p":"payload.shape","pt":"msg","to":"dot","tot":"str"},{"t":"set","p":"payload.fill","pt":"msg","to":"$boolean(status.out) ? \"green\" : $boolean(status.error) ? \"red\" : \"yellow\"","tot":"jsonata"}],"action":"","property":"","from":"","to":"","reg":false,"x":870,"y":360,"wires":[[]]},{"id":"944c37ef.a2ce08","type":"change","z":"3723610.753c9a","name":"get tpl config","rules":[{"t":"set","p":"template","pt":"msg","to":"","tot":"str"}],"action":"","property":"","from":"","to":"","reg":false,"x":170,"y":440,"wires":[["199b4f4c.6cff91"]]},{"id":"199b4f4c.6cff91","type":"switch","z":"3723610.753c9a","name":"","property":"template","propertyType":"msg","rules":[{"t":"nempty"},{"t":"else"}],"checkall":"true","repair":false,"outputs":2,"x":330,"y":440,"wires":[["9140a633.d4adf8"],["7b23a120.2a1cf"]]},{"id":"7b23a120.2a1cf","type":"change","z":"3723610.753c9a","name":"status error","rules":[{"t":"set","p":"status","pt":"msg","to":"{ \"error\": \"template not set\" }","tot":"json"}],"action":"","property":"","from":"","to":"","reg":false,"x":490,"y":500,"wires":[["ada9fbc8.6c9a28"]]},{"id":"32875c1b.1a36c4","type":"change","z":"3723610.753c9a","name":"status in","rules":[{"t":"set","p":"status","pt":"msg","to":"{}","tot":"json"},{"t":"set","p":"status.in","pt":"msg","to":"payload","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":160,"y":560,"wires":[["ada9fbc8.6c9a28"]]},{"id":"ada9fbc8.6c9a28","type":"join","z":"3723610.753c9a","name":"","mode":"custom","build":"merged","property":"status","propertyType":"msg","key":"topic","joiner":"\\n","joinerType":"str","accumulate":false,"timeout":"","count":"2","reduceRight":false,"reduceExp":"","reduceInit":"","reduceInitType":"","reduceFixup":"","x":690,"y":560,"wires":[["5c687187.30cb6"]]},{"id":"5c687187.30cb6","type":"change","z":"3723610.753c9a","name":"status","rules":[{"t":"set","p":"payload","pt":"msg","to":"{}","tot":"json"},{"t":"set","p":"payload.text","pt":"msg","to":"$boolean(status.error) ? \"error: \" & status.error : $string(status.out)","tot":"jsonata"},{"t":"set","p":"payload.shape","pt":"msg","to":"dot","tot":"str"},{"t":"set","p":"payload.fill","pt":"msg","to":"$boolean(status.error) ? \"red\" : \"green\"","tot":"jsonata"}],"action":"","property":"","from":"","to":"","reg":false,"x":830,"y":560,"wires":[[]]},{"id":"6668692f.ecceb8","type":"change","z":"3723610.753c9a","name":"status out","rules":[{"t":"set","p":"status","pt":"msg","to":"{ \"out\": payload }","tot":"jsonata"}],"action":"","property":"","from":"","to":"","reg":false,"x":680,"y":500,"wires":[["ada9fbc8.6c9a28"]]},{"id":"702f29e1.1b64f8","type":"change","z":"3723610.753c9a","name":"status","rules":[{"t":"set","p":"payload","pt":"msg","to":"{}","tot":"json"},{"t":"set","p":"payload.text","pt":"msg","to":"\"output: \" & output","tot":"jsonata"},{"t":"set","p":"payload.shape","pt":"msg","to":"dot","tot":"str"},{"t":"set","p":"payload.fill","pt":"msg","to":"grey","tot":"str"}],"action":"","property":"","from":"","to":"","reg":false,"x":3170,"y":300,"wires":[[]]},{"id":"b9bf0729.8b8378","type":"change","z":"3723610.753c9a","name":"status","rules":[{"t":"set","p":"payload","pt":"msg","to":"{}","tot":"json"},{"t":"set","p":"payload.text","pt":"msg","to":"\"template: \" & template","tot":"jsonata"},{"t":"set","p":"payload.shape","pt":"msg","to":"dot","tot":"str"},{"t":"set","p":"payload.fill","pt":"msg","to":"grey","tot":"str"}],"action":"","property":"","from":"","to":"","reg":false,"x":3170,"y":120,"wires":[[]]},{"id":"88375d74.dc0bc","type":"change","z":"55a62a.5aaf59d8","name":"status","rules":[{"t":"set","p":"payload","pt":"msg","to":"{}","tot":"json"},{"t":"set","p":"payload.text","pt":"msg","to":"status.in & \" => \" & status.out","tot":"jsonata"},{"t":"set","p":"payload.shape","pt":"msg","to":"dot","tot":"str"},{"t":"set","p":"payload.fill","pt":"msg","to":"green","tot":"str"}],"action":"","property":"","from":"","to":"","reg":false,"x":590,"y":1120,"wires":[[]]},{"id":"b6e99c53.96749","type":"join","z":"55a62a.5aaf59d8","name":"","mode":"custom","build":"merged","property":"status","propertyType":"msg","key":"topic","joiner":"\\n","joinerType":"str","accumulate":false,"timeout":"","count":"2","reduceRight":false,"reduceExp":"","reduceInit":"","reduceInitType":"","reduceFixup":"","x":450,"y":1120,"wires":[["88375d74.dc0bc"]]},{"id":"84ecf99a.7f9c28","type":"change","z":"55a62a.5aaf59d8","name":"status in","rules":[{"t":"set","p":"status","pt":"msg","to":"{}","tot":"msg"},{"t":"set","p":"status.in","pt":"msg","to":"payload","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":160,"y":1120,"wires":[["b6e99c53.96749"]]},{"id":"1ba38552.452c0b","type":"change","z":"55a62a.5aaf59d8","name":"status out","rules":[{"t":"set","p":"status","pt":"msg","to":"{}","tot":"json"},{"t":"set","p":"status.out","pt":"msg","to":"payload","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":300,"y":1080,"wires":[["b6e99c53.96749"]]},{"id":"39b5556d.2dd64a","type":"change","z":"55a62a.5aaf59d8","name":"status","rules":[{"t":"set","p":"payload","pt":"msg","to":"{}","tot":"json"},{"t":"set","p":"payload.text","pt":"msg","to":"\"minin: \" & minin","tot":"jsonata"},{"t":"set","p":"payload.shape","pt":"msg","to":"dot","tot":"str"},{"t":"set","p":"payload.fill","pt":"msg","to":"grey","tot":"str"}],"action":"","property":"","from":"","to":"","reg":false,"x":2790,"y":100,"wires":[[]]},{"id":"3717de2b.f4d672","type":"change","z":"55a62a.5aaf59d8","name":"status","rules":[{"t":"set","p":"payload","pt":"msg","to":"{}","tot":"json"},{"t":"set","p":"payload.text","pt":"msg","to":"\"minout: \" & minout","tot":"jsonata"},{"t":"set","p":"payload.shape","pt":"msg","to":"dot","tot":"str"},{"t":"set","p":"payload.fill","pt":"msg","to":"grey","tot":"str"}],"action":"","property":"","from":"","to":"","reg":false,"x":2790,"y":300,"wires":[[]]},{"id":"8d9e3491.43c168","type":"change","z":"55a62a.5aaf59d8","name":"status","rules":[{"t":"set","p":"payload","pt":"msg","to":"{}","tot":"json"},{"t":"set","p":"payload.text","pt":"msg","to":"\"maxin: \" & maxin","tot":"jsonata"},{"t":"set","p":"payload.shape","pt":"msg","to":"dot","tot":"str"},{"t":"set","p":"payload.fill","pt":"msg","to":"grey","tot":"str"}],"action":"","property":"","from":"","to":"","reg":false,"x":2790,"y":500,"wires":[[]]},{"id":"48778410.e0076c","type":"change","z":"55a62a.5aaf59d8","name":"status","rules":[{"t":"set","p":"payload","pt":"msg","to":"{}","tot":"json"},{"t":"set","p":"payload.text","pt":"msg","to":"\"maxout: \" & maxout","tot":"jsonata"},{"t":"set","p":"payload.shape","pt":"msg","to":"dot","tot":"str"},{"t":"set","p":"payload.fill","pt":"msg","to":"grey","tot":"str"}],"action":"","property":"","from":"","to":"","reg":false,"x":2790,"y":700,"wires":[[]]},{"id":"e5ea631a.a3fcd","type":"change","z":"55a62a.5aaf59d8","name":"status","rules":[{"t":"set","p":"payload","pt":"msg","to":"{}","tot":"json"},{"t":"set","p":"payload.text","pt":"msg","to":"\"round: \" & round","tot":"jsonata"},{"t":"set","p":"payload.shape","pt":"msg","to":"dot","tot":"str"},{"t":"set","p":"payload.fill","pt":"msg","to":"grey","tot":"str"}],"action":"","property":"","from":"","to":"","reg":false,"x":2790,"y":900,"wires":[[]]},{"id":"92d56178.537de","type":"switch","z":"55a62a.5aaf59d8","name":"","property":"round","propertyType":"msg","rules":[{"t":"eq","v":"yes","vt":"str"},{"t":"eq","v":"no","vt":"str"},{"t":"else"}],"checkall":"true","repair":false,"outputs":3,"x":2080,"y":840,"wires":[["803445b1.6396c8"],["8e6132c3.478dd"],["4edd8b37.886d34"]]},{"id":"8e6132c3.478dd","type":"change","z":"55a62a.5aaf59d8","name":"edit","rules":[{"t":"set","p":"old","pt":"msg","to":"*[name = \"scale\" and type=\"range\"]","tot":"jsonata"},{"t":"set","p":"new","pt":"msg","to":"old","tot":"msg"},{"t":"delete","p":"new.round","pt":"msg"},{"t":"set","p":"payload","pt":"msg","to":"$eval($replace($string(payload),$string(old),$string(new)))","tot":"jsonata"}],"action":"","property":"","from":"","to":"","reg":false,"x":2250,"y":840,"wires":[["8b939a9e.d9fb28"]]},{"id":"4edd8b37.886d34","type":"change","z":"55a62a.5aaf59d8","name":"","rules":[{"t":"set","p":"payload","pt":"msg","to":"Allowed values: yes, no.","tot":"str"}],"action":"","property":"","from":"","to":"","reg":false,"x":2290,"y":880,"wires":[["c2e62201.3cec2"]]},{"id":"c2e62201.3cec2","type":"http response","z":"55a62a.5aaf59d8","name":"","statusCode":"400","headers":{},"x":2480,"y":880,"wires":[]},{"id":"c038222b.3170a","type":"change","z":"503a42b5.f37bac","name":"status","rules":[{"t":"set","p":"payload","pt":"msg","to":"{}","tot":"json"},{"t":"set","p":"payload.text","pt":"msg","to":"\"expr: \" & config","tot":"jsonata"},{"t":"set","p":"payload.shape","pt":"msg","to":"dot","tot":"str"},{"t":"set","p":"payload.fill","pt":"msg","to":"grey","tot":"str"}],"action":"","property":"","from":"","to":"","reg":false,"x":2790,"y":100,"wires":[[]]},{"id":"625e3810.215ae8","type":"change","z":"4fb04efc.9af29","name":"quarantine duration","rules":[{"t":"set","p":"delay","pt":"msg","to":"","tot":"num"}],"action":"","property":"","from":"","to":"","reg":false,"x":1030,"y":240,"wires":[["9e9bb631.e310a8"]]},{"id":"9e9bb631.e310a8","type":"switch","z":"4fb04efc.9af29","name":"","property":"$boolean(delay)","propertyType":"jsonata","rules":[{"t":"true"},{"t":"else"}],"checkall":"true","repair":false,"outputs":2,"x":1190,"y":240,"wires":[["6f8fd18d.6c9e9"],["ff1ed7e1.ad5968"]]},{"id":"ff1ed7e1.ad5968","type":"change","z":"4fb04efc.9af29","name":"error","rules":[{"t":"set","p":"v","pt":"msg","to":"payload","tot":"msg"},{"t":"set","p":"payload","pt":"msg","to":"{}","tot":"json"},{"t":"set","p":"payload.text","pt":"msg","to":"error: time not set","tot":"str"},{"t":"set","p":"payload.shape","pt":"msg","to":"dot","tot":"str"},{"t":"set","p":"payload.fill","pt":"msg","to":"red","tot":"str"}],"action":"","property":"","from":"","to":"","reg":false,"x":1350,"y":360,"wires":[[]]},{"id":"eed74d78.35d85","type":"change","z":"4fb04efc.9af29","name":"status","rules":[{"t":"set","p":"payload","pt":"msg","to":"{}","tot":"json"},{"t":"set","p":"payload.text","pt":"msg","to":"\"duration: \" & duration & \" ms\"","tot":"jsonata"},{"t":"set","p":"payload.shape","pt":"msg","to":"dot","tot":"str"},{"t":"set","p":"payload.fill","pt":"msg","to":"grey","tot":"str"}],"action":"","property":"","from":"","to":"","reg":false,"x":2770,"y":100,"wires":[[]]},{"id":"497bf4c2.4715bc","type":"change","z":"938f4ad2.352088","name":"switch duration","rules":[{"t":"set","p":"delay","pt":"msg","to":"","tot":"num"}],"action":"","property":"","from":"","to":"","reg":false,"x":200,"y":240,"wires":[["2bba0752.59b8d8"]]},{"id":"2bba0752.59b8d8","type":"switch","z":"938f4ad2.352088","name":"","property":"$boolean(delay)","propertyType":"jsonata","rules":[{"t":"true"},{"t":"else"}],"checkall":"true","repair":false,"outputs":2,"x":370,"y":240,"wires":[["89420d5d.3c3b"],["9a581880.4353a8"]]},{"id":"9a581880.4353a8","type":"change","z":"938f4ad2.352088","name":"status error","rules":[{"t":"set","p":"v","pt":"msg","to":"payload","tot":"msg"},{"t":"set","p":"payload","pt":"msg","to":"{}","tot":"json"},{"t":"set","p":"payload.text","pt":"msg","to":"error: duration not set","tot":"str"},{"t":"set","p":"payload.shape","pt":"msg","to":"dot","tot":"str"},{"t":"set","p":"payload.fill","pt":"msg","to":"red","tot":"str"}],"action":"","property":"","from":"","to":"","reg":false,"x":370,"y":360,"wires":[[]]},{"id":"c47e2ab0.f85f08","type":"change","z":"938f4ad2.352088","name":"status input","rules":[{"t":"set","p":"v","pt":"msg","to":"payload","tot":"msg"},{"t":"set","p":"payload","pt":"msg","to":"{}","tot":"json"},{"t":"set","p":"payload.text","pt":"msg","to":"\"received: \" & v","tot":"jsonata"},{"t":"set","p":"payload.shape","pt":"msg","to":"dot","tot":"str"},{"t":"set","p":"payload.fill","pt":"msg","to":"yellow","tot":"str"}],"action":"","property":"","from":"","to":"","reg":false,"x":190,"y":400,"wires":[[]]},{"id":"a3500328.d308","type":"change","z":"938f4ad2.352088","name":"status on","rules":[{"t":"set","p":"v","pt":"msg","to":"payload","tot":"msg"},{"t":"set","p":"payload","pt":"msg","to":"{}","tot":"json"},{"t":"set","p":"payload.text","pt":"msg","to":"switched on","tot":"str"},{"t":"set","p":"payload.shape","pt":"msg","to":"dot","tot":"str"},{"t":"set","p":"payload.fill","pt":"msg","to":"green","tot":"str"}],"action":"","property":"","from":"","to":"","reg":false,"x":840,"y":300,"wires":[[]]},{"id":"41c56ccd.724bb4","type":"change","z":"938f4ad2.352088","name":"status off","rules":[{"t":"set","p":"v","pt":"msg","to":"payload","tot":"msg"},{"t":"set","p":"payload","pt":"msg","to":"{}","tot":"json"},{"t":"set","p":"payload.text","pt":"msg","to":"switched off","tot":"str"},{"t":"set","p":"payload.shape","pt":"msg","to":"ring","tot":"str"},{"t":"set","p":"payload.fill","pt":"msg","to":"green","tot":"str"}],"action":"","property":"","from":"","to":"","reg":false,"x":840,"y":260,"wires":[[]]},{"id":"2ca550d7.a72d4","type":"change","z":"938f4ad2.352088","name":"status","rules":[{"t":"set","p":"payload","pt":"msg","to":"{}","tot":"json"},{"t":"set","p":"payload.text","pt":"msg","to":"\"duration: \" & duration & \" ms\"","tot":"jsonata"},{"t":"set","p":"payload.shape","pt":"msg","to":"dot","tot":"str"},{"t":"set","p":"payload.fill","pt":"msg","to":"grey","tot":"str"}],"action":"","property":"","from":"","to":"","reg":false,"x":2810,"y":100,"wires":[[]]},{"id":"6f8fd18d.6c9e9","type":"switch","z":"4fb04efc.9af29","name":"","property":"reset","propertyType":"msg","rules":[{"t":"null"},{"t":"else"}],"checkall":"true","repair":false,"outputs":2,"x":1330,"y":240,"wires":[["81f1188f.c69378"],["2150186d.67db48","d86c7d11.a24b5","2e5ae3f5.1fb5bc"]]},{"id":"2150186d.67db48","type":"change","z":"4fb04efc.9af29","name":"killed","rules":[{"t":"set","p":"v","pt":"msg","to":"payload","tot":"msg"},{"t":"set","p":"payload","pt":"msg","to":"{}","tot":"json"},{"t":"set","p":"payload.text","pt":"msg","to":"all killed","tot":"str"},{"t":"set","p":"payload.shape","pt":"msg","to":"dot","tot":"str"},{"t":"set","p":"payload.fill","pt":"msg","to":"grey","tot":"str"}],"action":"","property":"","from":"","to":"","reg":false,"x":1490,"y":320,"wires":[[]]},{"id":"d86c7d11.a24b5","type":"change","z":"4fb04efc.9af29","name":"DONE","rules":[{"t":"set","p":"payload","pt":"msg","to":"DONE","tot":"str"}],"action":"","property":"","from":"","to":"","reg":false,"x":1490,"y":280,"wires":[["278cf61d.4fde1a"]]},{"id":"278cf61d.4fde1a","type":"http response","z":"4fb04efc.9af29","name":"","statusCode":"","headers":{},"x":1650,"y":280,"wires":[]},{"id":"81f1188f.c69378","type":"switch","z":"4fb04efc.9af29","name":"","property":"flush","propertyType":"msg","rules":[{"t":"nnull"},{"t":"else"}],"checkall":"true","repair":false,"outputs":2,"x":1450,"y":200,"wires":[["2e5ae3f5.1fb5bc","21300ec0.b08762"],["2e5ae3f5.1fb5bc"]]},{"id":"5c91e356.ff75fc","type":"http response","z":"4fb04efc.9af29","name":"","statusCode":"","headers":{},"x":1750,"y":180,"wires":[]},{"id":"21300ec0.b08762","type":"change","z":"4fb04efc.9af29","name":"DONE","rules":[{"t":"set","p":"payload","pt":"msg","to":"DONE","tot":"str"}],"action":"","property":"","from":"","to":"","reg":false,"x":1610,"y":180,"wires":[["5c91e356.ff75fc"]]},{"id":"cdadb616.477e38","type":"switch","z":"4fb04efc.9af29","name":"","property":"flush","propertyType":"msg","rules":[{"t":"null"}],"checkall":"true","repair":false,"outputs":1,"x":1830,"y":240,"wires":[[]]},{"id":"6926a3d8.d83e1c","type":"change","z":"add93fe3.4654f","name":"status","rules":[{"t":"set","p":"payload","pt":"msg","to":"{}","tot":"json"},{"t":"set","p":"payload.text","pt":"msg","to":"\"interval: \" & interval & \" s\"","tot":"jsonata"},{"t":"set","p":"payload.shape","pt":"msg","to":"dot","tot":"str"},{"t":"set","p":"payload.fill","pt":"msg","to":"grey","tot":"str"}],"action":"","property":"","from":"","to":"","reg":false,"x":2790,"y":100,"wires":[[]]},{"id":"c76b73d.02e479","type":"switch","z":"938f4ad2.352088","name":"","property":"payload","propertyType":"msg","rules":[{"t":"eq","v":"0","vt":"str"},{"t":"eq","v":"1","vt":"str"}],"checkall":"true","repair":false,"outputs":2,"x":690,"y":280,"wires":[["41c56ccd.724bb4"],["a3500328.d308"]]},{"id":"d3e4dfd5.176f3","type":"change","z":"50618dc7.9fe494","name":"status received","rules":[{"t":"set","p":"v","pt":"msg","to":"payload","tot":"msg"},{"t":"set","p":"payload","pt":"msg","to":"{}","tot":"json"},{"t":"set","p":"payload.text","pt":"msg","to":"\"received: \" & v","tot":"jsonata"},{"t":"set","p":"payload.shape","pt":"msg","to":"dot","tot":"str"},{"t":"set","p":"payload.fill","pt":"msg","to":"green","tot":"str"}],"action":"","property":"","from":"","to":"","reg":false,"x":180,"y":340,"wires":[[]]},{"id":"21146aa0.b89206","type":"change","z":"50618dc7.9fe494","name":"status bau","rules":[{"t":"set","p":"v","pt":"msg","to":"payload","tot":"msg"},{"t":"set","p":"payload","pt":"msg","to":"{}","tot":"json"},{"t":"set","p":"payload.text","pt":"msg","to":"bau","tot":"str"},{"t":"set","p":"payload.shape","pt":"msg","to":"dot","tot":"str"},{"t":"set","p":"payload.fill","pt":"msg","to":"yellow","tot":"str"}],"action":"","property":"","from":"","to":"","reg":false,"x":330,"y":300,"wires":[[]]},{"id":"3b5cde00.c79a82","type":"change","z":"50618dc7.9fe494","name":"status","rules":[{"t":"set","p":"payload","pt":"msg","to":"{}","tot":"json"},{"t":"set","p":"payload.text","pt":"msg","to":"\"timeout: \" & timeout & \" ms\"","tot":"jsonata"},{"t":"set","p":"payload.shape","pt":"msg","to":"dot","tot":"str"},{"t":"set","p":"payload.fill","pt":"msg","to":"grey","tot":"str"}],"action":"","property":"","from":"","to":"","reg":false,"x":2790,"y":100,"wires":[[]]},{"id":"8302b8a9.d68c68","type":"Stackhero-MySQL","z":"440d357f.2f371c","server":"7b111c25.9e2314","name":"dbtail","x":450,"y":1720,"wires":[["c88f7618.1d6408"]]},{"id":"eeccb8d3.66cd48","type":"inject","z":"440d357f.2f371c","name":"dbtail clock","props":[{"p":"payload"}],"repeat":"59","crontab":"","once":false,"onceDelay":0.1,"topic":"","payload":"","payloadType":"date","x":110,"y":1720,"wires":[["2f44c285.e6a37e"]]},{"id":"2f44c285.e6a37e","type":"change","z":"440d357f.2f371c","name":"dbtail settings","rules":[{"t":"set","p":"table","pt":"msg","to":"","tot":"str"},{"t":"set","p":"timecol","pt":"msg","to":"","tot":"str"},{"t":"set","p":"timestamp","pt":"msg","to":"$round($number(payload) / 1000)","tot":"jsonata"},{"t":"set","p":"interval","pt":"msg","to":"59","tot":"num"},{"t":"set","p":"payload","pt":"msg","to":"{ \"from\": timestamp - interval   }","tot":"jsonata"},{"t":"set","p":"topic","pt":"msg","to":"\"select * from \" & table & \" where \" & timecol & \" >= :from \"","tot":"jsonata"}],"action":"","property":"","from":"","to":"","reg":false,"x":280,"y":1720,"wires":[["8302b8a9.d68c68"]]},{"id":"4aad2a10.88dea4","type":"http in","z":"440d357f.2f371c","name":"PUT interval","url":"/dbtail/interval","method":"put","upload":false,"swaggerDoc":"","x":90,"y":40,"wires":[["eddb4787.e8db08"]]},{"id":"6d63cc3e.cb3f54","type":"change","z":"440d357f.2f371c","name":"","rules":[{"t":"set","p":"payload","pt":"msg","to":"interval & \" s\"","tot":"jsonata"}],"action":"","property":"","from":"","to":"","reg":false,"x":2540,"y":40,"wires":[["436d6bc7.8b6254"]]},{"id":"8759eb41.a6e328","type":"http in","z":"440d357f.2f371c","name":"GET interval","url":"/dbtail/interval","method":"get","upload":false,"swaggerDoc":"","x":90,"y":140,"wires":[["f4cd5950.706138"]]},{"id":"8d7fb0ce.fe456","type":"http response","z":"440d357f.2f371c","name":"","statusCode":"","headers":{},"x":2290,"y":140,"wires":[]},{"id":"a34fbb53.307c18","type":"change","z":"440d357f.2f371c","name":"","rules":[{"t":"set","p":"headers","pt":"msg","to":"{\"Content-Type\":\"text/plain\"}","tot":"json"}],"action":"","property":"","from":"","to":"","reg":false,"x":2120,"y":140,"wires":[["8d7fb0ce.fe456"]]},{"id":"eddb4787.e8db08","type":"change","z":"440d357f.2f371c","name":"get inputs","rules":[{"t":"set","p":"interval","pt":"msg","to":"payload","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":240,"y":40,"wires":[["1e777fb1.9b3de"]]},{"id":"403a496.2afabb8","type":"http request","z":"440d357f.2f371c","name":"get flows","method":"GET","ret":"obj","paytoqs":"ignore","url":"https://localhost:1880/flows","tls":"b1a419c1.609c29","persist":false,"proxy":"","authType":"","x":1760,"y":40,"wires":[["6b8746bd.8eedd8"]]},{"id":"a409f89b.fed4c8","type":"http response","z":"440d357f.2f371c","name":"","statusCode":"","headers":{},"x":2910,"y":40,"wires":[]},{"id":"436d6bc7.8b6254","type":"change","z":"440d357f.2f371c","name":"","rules":[{"t":"set","p":"headers","pt":"msg","to":"{\"Content-Type\":\"text/plain\"}","tot":"json"}],"action":"","property":"","from":"","to":"","reg":false,"x":2740,"y":40,"wires":[["a409f89b.fed4c8","f8c213c5.c7599"]]},{"id":"9c26baf6.e88d58","type":"http request","z":"440d357f.2f371c","name":"get flows","method":"GET","ret":"obj","paytoqs":"ignore","url":"https://localhost:1880/flows","tls":"b1a419c1.609c29","persist":false,"proxy":"","authType":"","x":1600,"y":140,"wires":[["e1911e68.b8f87"]]},{"id":"8c7eb8a6.dd8d68","type":"http request","z":"440d357f.2f371c","name":"auth","method":"POST","ret":"obj","paytoqs":"ignore","url":"https://localhost:1880/auth/token","tls":"b1a419c1.609c29","persist":false,"proxy":"","authType":"","x":1090,"y":40,"wires":[["ec6db8fc.4a73e8"]]},{"id":"459916ac.3ca0c8","type":"change","z":"440d357f.2f371c","name":"auth payload","rules":[{"t":"set","p":"payload","pt":"msg","to":"{}","tot":"json"},{"t":"set","p":"payload.client_id","pt":"msg","to":"node-red-editor","tot":"str"},{"t":"set","p":"payload.grant_type","pt":"msg","to":"password","tot":"str"},{"t":"set","p":"payload.scope","pt":"msg","to":"","tot":"str"},{"t":"set","p":"payload.username","pt":"msg","to":"NRADM_USER","tot":"env"},{"t":"set","p":"payload.password","pt":"msg","to":"NRADM_PASS","tot":"env"}],"action":"","property":"","from":"","to":"","reg":false,"x":930,"y":40,"wires":[["8c7eb8a6.dd8d68"]]},{"id":"49cac901.103d08","type":"change","z":"440d357f.2f371c","name":"","rules":[{"t":"set","p":"accessToken","pt":"msg","to":"payload.access_token","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":1420,"y":40,"wires":[["d11e7bba.ca25d8"]]},{"id":"d11e7bba.ca25d8","type":"change","z":"440d357f.2f371c","name":"bearer","rules":[{"t":"set","p":"headers","pt":"msg","to":"{}","tot":"json"},{"t":"set","p":"headers.authorization","pt":"msg","to":"\"Bearer \" & msg.accessToken","tot":"jsonata"}],"action":"","property":"","from":"","to":"","reg":false,"x":1610,"y":40,"wires":[["403a496.2afabb8"]]},{"id":"2cc26969.006ca6","type":"http request","z":"440d357f.2f371c","name":"auth","method":"POST","ret":"obj","paytoqs":"ignore","url":"https://localhost:1880/auth/token","tls":"b1a419c1.609c29","persist":false,"proxy":"","authType":"","x":930,"y":140,"wires":[["648aa7d6.4a1ef8"]]},{"id":"559f5951.30cb68","type":"change","z":"440d357f.2f371c","name":"auth payload","rules":[{"t":"set","p":"payload.client_id","pt":"msg","to":"node-red-editor","tot":"str"},{"t":"set","p":"payload.grant_type","pt":"msg","to":"password","tot":"str"},{"t":"set","p":"payload.scope","pt":"msg","to":"","tot":"str"},{"t":"set","p":"payload.username","pt":"msg","to":"NRADM_USER","tot":"env"},{"t":"set","p":"payload.password","pt":"msg","to":"NRADM_PASS","tot":"env"}],"action":"","property":"","from":"","to":"","reg":false,"x":770,"y":140,"wires":[["2cc26969.006ca6"]]},{"id":"b15b6590.5b76b8","type":"change","z":"440d357f.2f371c","name":"","rules":[{"t":"set","p":"accessToken","pt":"msg","to":"payload.access_token","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":1260,"y":140,"wires":[["1fe59df7.23c152"]]},{"id":"1fe59df7.23c152","type":"change","z":"440d357f.2f371c","name":"bearer","rules":[{"t":"set","p":"headers","pt":"msg","to":"{}","tot":"json"},{"t":"set","p":"headers.authorization","pt":"msg","to":"\"Bearer \" & msg.accessToken","tot":"jsonata"}],"action":"","property":"","from":"","to":"","reg":false,"x":1450,"y":140,"wires":[["9c26baf6.e88d58"]]},{"id":"764a954.aca826c","type":"http request","z":"440d357f.2f371c","name":"","method":"POST","ret":"obj","paytoqs":"ignore","url":"${CFG_ACL_ENDP}","tls":"51b09598.a1114d","persist":false,"proxy":"","authType":"","x":610,"y":40,"wires":[["e34bc1f7.b2a66"]]},{"id":"e34bc1f7.b2a66","type":"switch","z":"440d357f.2f371c","name":"","property":"statusCode","propertyType":"msg","rules":[{"t":"eq","v":"200","vt":"num"},{"t":"else"}],"checkall":"true","repair":false,"outputs":2,"x":770,"y":40,"wires":[["459916ac.3ca0c8"],["eb56f993.b64508"]]},{"id":"6e197f14.feb1b","type":"http request","z":"440d357f.2f371c","name":"","method":"POST","ret":"obj","paytoqs":"ignore","url":"${CFG_ACL_ENDP}","tls":"51b09598.a1114d","persist":false,"proxy":"","authType":"","x":450,"y":140,"wires":[["32e69f80.35e7b"]]},{"id":"32e69f80.35e7b","type":"switch","z":"440d357f.2f371c","name":"","property":"statusCode","propertyType":"msg","rules":[{"t":"eq","v":"200","vt":"num"},{"t":"else"}],"checkall":"true","repair":false,"outputs":2,"x":610,"y":140,"wires":[["559f5951.30cb68"],["7e239f29.b5758"]]},{"id":"f4cd5950.706138","type":"change","z":"440d357f.2f371c","name":"acl req payload","rules":[{"t":"set","p":"headers","pt":"msg","to":"{}","tot":"json"},{"t":"set","p":"payload","pt":"msg","to":"{}","tot":"json"},{"t":"set","p":"payload.url","pt":"msg","to":"req.url","tot":"msg"},{"t":"set","p":"payload.method","pt":"msg","to":"req.method","tot":"msg"},{"t":"set","p":"payload.headers","pt":"msg","to":"req.headers","tot":"msg"},{"t":"set","p":"payload.params","pt":"msg","to":"req.params","tot":"msg"},{"t":"set","p":"payload.query","pt":"msg","to":"req.query","tot":"msg"},{"t":"set","p":"payload.body","pt":"msg","to":"req.body","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":260,"y":140,"wires":[["6e197f14.feb1b"]]},{"id":"1e777fb1.9b3de","type":"change","z":"440d357f.2f371c","name":"acl req payload","rules":[{"t":"set","p":"headers","pt":"msg","to":"{}","tot":"json"},{"t":"set","p":"payload","pt":"msg","to":"{}","tot":"json"},{"t":"set","p":"payload.url","pt":"msg","to":"req.url","tot":"msg"},{"t":"set","p":"payload.method","pt":"msg","to":"req.method","tot":"msg"},{"t":"set","p":"payload.headers","pt":"msg","to":"req.headers","tot":"msg"},{"t":"set","p":"payload.params","pt":"msg","to":"req.params","tot":"msg"},{"t":"set","p":"payload.query","pt":"msg","to":"req.query","tot":"msg"},{"t":"set","p":"payload.body","pt":"msg","to":"req.body","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":420,"y":40,"wires":[["764a954.aca826c"]]},{"id":"7e239f29.b5758","type":"http response","z":"440d357f.2f371c","name":"","statusCode":"","headers":{},"x":750,"y":180,"wires":[]},{"id":"5ba65e78.89775","type":"change","z":"440d357f.2f371c","name":"","rules":[{"t":"set","p":"payload","pt":"msg","to":"*[name = \"dbtail clock\" and type=\"inject\"].repeat & \" s\"","tot":"jsonata"}],"action":"","property":"","from":"","to":"","reg":false,"x":1920,"y":140,"wires":[["a34fbb53.307c18"]]},{"id":"792078b9.d235e8","type":"change","z":"440d357f.2f371c","name":"edit","rules":[{"t":"set","p":"old","pt":"msg","to":"*[name = \"dbtail clock\" and type=\"inject\"]","tot":"jsonata"},{"t":"set","p":"new","pt":"msg","to":"old","tot":"msg"},{"t":"set","p":"new.repeat","pt":"msg","to":"interval","tot":"msg"},{"t":"set","p":"payload","pt":"msg","to":"$eval($replace($string(payload),$string(old),$string(new)))","tot":"jsonata"}],"action":"","property":"","from":"","to":"","reg":false,"x":2050,"y":40,"wires":[["73149e72.6e841"]]},{"id":"eb56f993.b64508","type":"http response","z":"440d357f.2f371c","name":"","statusCode":"","headers":{},"x":910,"y":80,"wires":[]},{"id":"ec6db8fc.4a73e8","type":"switch","z":"440d357f.2f371c","name":"","property":"statusCode","propertyType":"msg","rules":[{"t":"eq","v":"200","vt":"num"},{"t":"else"}],"checkall":"true","repair":false,"outputs":2,"x":1230,"y":40,"wires":[["49cac901.103d08"],["a258b94b.259e48"]]},{"id":"a258b94b.259e48","type":"http response","z":"440d357f.2f371c","name":"","statusCode":"","headers":{},"x":1370,"y":80,"wires":[]},{"id":"6b8746bd.8eedd8","type":"switch","z":"440d357f.2f371c","name":"","property":"statusCode","propertyType":"msg","rules":[{"t":"eq","v":"200","vt":"num"},{"t":"else"}],"checkall":"true","repair":false,"outputs":2,"x":1910,"y":40,"wires":[["792078b9.d235e8"],["83b55be3.b8e828"]]},{"id":"83b55be3.b8e828","type":"http response","z":"440d357f.2f371c","name":"","statusCode":"","headers":{},"x":2050,"y":80,"wires":[]},{"id":"de8efcc.a7246","type":"function","z":"440d357f.2f371c","name":"update flows","func":"const http = global.get('https');\nconst data = JSON.stringify(msg.payload);\nconst options = {\n  hostname: 'localhost',\n  port: 1880,\n  path: '/flows',\n  method: 'POST',\n  headers: {\n    'Content-Type': 'application/json',\n    'Content-Length': data.length,\n    'Authorization': 'Bearer '+msg.accessToken\n  },\n  rejectUnauthorized: false\n};\nconst req = http.request(options);\nreq.write(data);\nreq.end();\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":2350,"y":40,"wires":[["6d63cc3e.cb3f54"]]},{"id":"648aa7d6.4a1ef8","type":"switch","z":"440d357f.2f371c","name":"","property":"statusCode","propertyType":"msg","rules":[{"t":"eq","v":"200","vt":"num"},{"t":"else"}],"checkall":"true","repair":false,"outputs":2,"x":1070,"y":140,"wires":[["b15b6590.5b76b8"],["b15697b0.b87f68"]]},{"id":"b15697b0.b87f68","type":"http response","z":"440d357f.2f371c","name":"","statusCode":"","headers":{},"x":1210,"y":180,"wires":[]},{"id":"e1911e68.b8f87","type":"switch","z":"440d357f.2f371c","name":"","property":"statusCode","propertyType":"msg","rules":[{"t":"eq","v":"200","vt":"num"},{"t":"else"}],"checkall":"true","repair":false,"outputs":2,"x":1750,"y":140,"wires":[["5ba65e78.89775"],["fbb30d56.eda69"]]},{"id":"fbb30d56.eda69","type":"http response","z":"440d357f.2f371c","name":"","statusCode":"","headers":{},"x":1890,"y":180,"wires":[]},{"id":"f8c213c5.c7599","type":"change","z":"440d357f.2f371c","name":"status","rules":[{"t":"set","p":"payload","pt":"msg","to":"{}","tot":"json"},{"t":"set","p":"payload.text","pt":"msg","to":"\"interval: \" & interval & \" s\"","tot":"jsonata"},{"t":"set","p":"payload.shape","pt":"msg","to":"dot","tot":"str"},{"t":"set","p":"payload.fill","pt":"msg","to":"grey","tot":"str"}],"action":"","property":"","from":"","to":"","reg":false,"x":2910,"y":100,"wires":[[]]},{"id":"d1020d68.da815","type":"http in","z":"440d357f.2f371c","name":"PUT table","url":"/dbtail/table","method":"put","upload":false,"swaggerDoc":"","x":80,"y":440,"wires":[["eee5a2b0.dee7d"]]},{"id":"5f18f5ef.f3cf7c","type":"change","z":"440d357f.2f371c","name":"","rules":[{"t":"set","p":"payload","pt":"msg","to":"table","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":2400,"y":440,"wires":[["b0b80ec3.cd0b2"]]},{"id":"74aef3f5.f3e9dc","type":"http in","z":"440d357f.2f371c","name":"GET table","url":"/dbtail/table","method":"get","upload":false,"swaggerDoc":"","x":80,"y":540,"wires":[["b33499aa.c2c058"]]},{"id":"52dd42f3.83c50c","type":"http response","z":"440d357f.2f371c","name":"","statusCode":"","headers":{},"x":2290,"y":540,"wires":[]},{"id":"e45e5d84.77a0f","type":"change","z":"440d357f.2f371c","name":"","rules":[{"t":"set","p":"headers","pt":"msg","to":"{\"Content-Type\":\"text/plain\"}","tot":"json"}],"action":"","property":"","from":"","to":"","reg":false,"x":2120,"y":540,"wires":[["52dd42f3.83c50c"]]},{"id":"eee5a2b0.dee7d","type":"change","z":"440d357f.2f371c","name":"get inputs","rules":[{"t":"set","p":"table","pt":"msg","to":"payload","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":240,"y":440,"wires":[["e67fc58a.bee028"]]},{"id":"daab03a0.4748e","type":"http request","z":"440d357f.2f371c","name":"get flows","method":"GET","ret":"obj","paytoqs":"ignore","url":"https://localhost:1880/flows","tls":"b1a419c1.609c29","persist":false,"proxy":"","authType":"","x":1760,"y":440,"wires":[["c49f5c8.6a1a2a"]]},{"id":"bad8480.bad16b8","type":"http response","z":"440d357f.2f371c","name":"","statusCode":"","headers":{},"x":2770,"y":440,"wires":[]},{"id":"b0b80ec3.cd0b2","type":"change","z":"440d357f.2f371c","name":"","rules":[{"t":"set","p":"headers","pt":"msg","to":"{\"Content-Type\":\"text/plain\"}","tot":"json"}],"action":"","property":"","from":"","to":"","reg":false,"x":2600,"y":440,"wires":[["bad8480.bad16b8","9626873d.857678"]]},{"id":"e4368ebe.627cb","type":"http request","z":"440d357f.2f371c","name":"get flows","method":"GET","ret":"obj","paytoqs":"ignore","url":"https://localhost:1880/flows","tls":"b1a419c1.609c29","persist":false,"proxy":"","authType":"","x":1600,"y":540,"wires":[["2b223f2f.ca3f8"]]},{"id":"ce3e4335.93942","type":"http request","z":"440d357f.2f371c","name":"auth","method":"POST","ret":"obj","paytoqs":"ignore","url":"https://localhost:1880/auth/token","tls":"b1a419c1.609c29","persist":false,"proxy":"","authType":"","x":1090,"y":440,"wires":[["96a1a819.82bc08"]]},{"id":"96b40f79.e2fb7","type":"change","z":"440d357f.2f371c","name":"auth payload","rules":[{"t":"set","p":"payload","pt":"msg","to":"{}","tot":"json"},{"t":"set","p":"payload.client_id","pt":"msg","to":"node-red-editor","tot":"str"},{"t":"set","p":"payload.grant_type","pt":"msg","to":"password","tot":"str"},{"t":"set","p":"payload.scope","pt":"msg","to":"","tot":"str"},{"t":"set","p":"payload.username","pt":"msg","to":"NRADM_USER","tot":"env"},{"t":"set","p":"payload.password","pt":"msg","to":"NRADM_PASS","tot":"env"}],"action":"","property":"","from":"","to":"","reg":false,"x":930,"y":440,"wires":[["ce3e4335.93942"]]},{"id":"502dd411.ff3a9c","type":"change","z":"440d357f.2f371c","name":"","rules":[{"t":"set","p":"accessToken","pt":"msg","to":"payload.access_token","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":1420,"y":440,"wires":[["7ff36d73.55b714"]]},{"id":"7ff36d73.55b714","type":"change","z":"440d357f.2f371c","name":"bearer","rules":[{"t":"set","p":"headers","pt":"msg","to":"{}","tot":"json"},{"t":"set","p":"headers.authorization","pt":"msg","to":"\"Bearer \" & msg.accessToken","tot":"jsonata"}],"action":"","property":"","from":"","to":"","reg":false,"x":1610,"y":440,"wires":[["daab03a0.4748e"]]},{"id":"68be468f.5911e8","type":"http request","z":"440d357f.2f371c","name":"auth","method":"POST","ret":"obj","paytoqs":"ignore","url":"https://localhost:1880/auth/token","tls":"b1a419c1.609c29","persist":false,"proxy":"","authType":"","x":930,"y":540,"wires":[["d3650102.78a5c"]]},{"id":"e56fc5e4.605b78","type":"change","z":"440d357f.2f371c","name":"auth payload","rules":[{"t":"set","p":"payload.client_id","pt":"msg","to":"node-red-editor","tot":"str"},{"t":"set","p":"payload.grant_type","pt":"msg","to":"password","tot":"str"},{"t":"set","p":"payload.scope","pt":"msg","to":"","tot":"str"},{"t":"set","p":"payload.username","pt":"msg","to":"NRADM_USER","tot":"env"},{"t":"set","p":"payload.password","pt":"msg","to":"NRADM_PASS","tot":"env"}],"action":"","property":"","from":"","to":"","reg":false,"x":770,"y":540,"wires":[["68be468f.5911e8"]]},{"id":"b5229e72.3194f","type":"change","z":"440d357f.2f371c","name":"","rules":[{"t":"set","p":"accessToken","pt":"msg","to":"payload.access_token","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":1260,"y":540,"wires":[["852279ab.58f1e8"]]},{"id":"852279ab.58f1e8","type":"change","z":"440d357f.2f371c","name":"bearer","rules":[{"t":"set","p":"headers","pt":"msg","to":"{}","tot":"json"},{"t":"set","p":"headers.authorization","pt":"msg","to":"\"Bearer \" & msg.accessToken","tot":"jsonata"}],"action":"","property":"","from":"","to":"","reg":false,"x":1450,"y":540,"wires":[["e4368ebe.627cb"]]},{"id":"e9791fb3.0a477","type":"http request","z":"440d357f.2f371c","name":"","method":"POST","ret":"obj","paytoqs":"ignore","url":"${CFG_ACL_ENDP}","tls":"51b09598.a1114d","persist":false,"proxy":"","authType":"","x":610,"y":440,"wires":[["55d31a73.bac1d4"]]},{"id":"55d31a73.bac1d4","type":"switch","z":"440d357f.2f371c","name":"","property":"statusCode","propertyType":"msg","rules":[{"t":"eq","v":"200","vt":"num"},{"t":"else"}],"checkall":"true","repair":false,"outputs":2,"x":770,"y":440,"wires":[["96b40f79.e2fb7"],["f9c48cfc.b653b"]]},{"id":"f617b295.85ba7","type":"http request","z":"440d357f.2f371c","name":"","method":"POST","ret":"obj","paytoqs":"ignore","url":"${CFG_ACL_ENDP}","tls":"51b09598.a1114d","persist":false,"proxy":"","authType":"","x":450,"y":540,"wires":[["9019e268.2a1cd"]]},{"id":"9019e268.2a1cd","type":"switch","z":"440d357f.2f371c","name":"","property":"statusCode","propertyType":"msg","rules":[{"t":"eq","v":"200","vt":"num"},{"t":"else"}],"checkall":"true","repair":false,"outputs":2,"x":610,"y":540,"wires":[["e56fc5e4.605b78"],["e5334b7.2230db8"]]},{"id":"b33499aa.c2c058","type":"change","z":"440d357f.2f371c","name":"acl req payload","rules":[{"t":"set","p":"headers","pt":"msg","to":"{}","tot":"json"},{"t":"set","p":"payload","pt":"msg","to":"{}","tot":"json"},{"t":"set","p":"payload.url","pt":"msg","to":"req.url","tot":"msg"},{"t":"set","p":"payload.method","pt":"msg","to":"req.method","tot":"msg"},{"t":"set","p":"payload.headers","pt":"msg","to":"req.headers","tot":"msg"},{"t":"set","p":"payload.params","pt":"msg","to":"req.params","tot":"msg"},{"t":"set","p":"payload.query","pt":"msg","to":"req.query","tot":"msg"},{"t":"set","p":"payload.body","pt":"msg","to":"req.body","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":260,"y":540,"wires":[["f617b295.85ba7"]]},{"id":"e67fc58a.bee028","type":"change","z":"440d357f.2f371c","name":"acl req payload","rules":[{"t":"set","p":"headers","pt":"msg","to":"{}","tot":"json"},{"t":"set","p":"payload","pt":"msg","to":"{}","tot":"json"},{"t":"set","p":"payload.url","pt":"msg","to":"req.url","tot":"msg"},{"t":"set","p":"payload.method","pt":"msg","to":"req.method","tot":"msg"},{"t":"set","p":"payload.headers","pt":"msg","to":"req.headers","tot":"msg"},{"t":"set","p":"payload.params","pt":"msg","to":"req.params","tot":"msg"},{"t":"set","p":"payload.query","pt":"msg","to":"req.query","tot":"msg"},{"t":"set","p":"payload.body","pt":"msg","to":"req.body","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":420,"y":440,"wires":[["e9791fb3.0a477"]]},{"id":"e5334b7.2230db8","type":"http response","z":"440d357f.2f371c","name":"","statusCode":"","headers":{},"x":750,"y":580,"wires":[]},{"id":"e4750418.ce8d58","type":"change","z":"440d357f.2f371c","name":"","rules":[{"t":"set","p":"payload","pt":"msg","to":"*[name = \"dbtail settings\" and type=\"change\"].rules[0].to","tot":"jsonata"}],"action":"","property":"","from":"","to":"","reg":false,"x":1920,"y":540,"wires":[["e45e5d84.77a0f"]]},{"id":"63e9c714.3b1b58","type":"change","z":"440d357f.2f371c","name":"edit","rules":[{"t":"set","p":"old","pt":"msg","to":"*[name = \"dbtail settings\" and type=\"change\"]","tot":"jsonata"},{"t":"set","p":"new","pt":"msg","to":"old","tot":"msg"},{"t":"set","p":"new.rules[0].to","pt":"msg","to":"table","tot":"msg"},{"t":"set","p":"payload","pt":"msg","to":"$eval($replace($string(payload),$string(old),$string(new)))","tot":"jsonata"}],"action":"","property":"","from":"","to":"","reg":false,"x":2050,"y":440,"wires":[["c000a4bc.552e78"]]},{"id":"f9c48cfc.b653b","type":"http response","z":"440d357f.2f371c","name":"","statusCode":"","headers":{},"x":910,"y":480,"wires":[]},{"id":"96a1a819.82bc08","type":"switch","z":"440d357f.2f371c","name":"","property":"statusCode","propertyType":"msg","rules":[{"t":"eq","v":"200","vt":"num"},{"t":"else"}],"checkall":"true","repair":false,"outputs":2,"x":1230,"y":440,"wires":[["502dd411.ff3a9c"],["7953182c.f2c398"]]},{"id":"7953182c.f2c398","type":"http response","z":"440d357f.2f371c","name":"","statusCode":"","headers":{},"x":1370,"y":480,"wires":[]},{"id":"c49f5c8.6a1a2a","type":"switch","z":"440d357f.2f371c","name":"","property":"statusCode","propertyType":"msg","rules":[{"t":"eq","v":"200","vt":"num"},{"t":"else"}],"checkall":"true","repair":false,"outputs":2,"x":1910,"y":440,"wires":[["63e9c714.3b1b58"],["924389cf.2079c8"]]},{"id":"924389cf.2079c8","type":"http response","z":"440d357f.2f371c","name":"","statusCode":"","headers":{},"x":2050,"y":480,"wires":[]},{"id":"c000a4bc.552e78","type":"function","z":"440d357f.2f371c","name":"update flows","func":"const http = global.get('https');\nconst data = JSON.stringify(msg.payload);\nconst options = {\n  hostname: 'localhost',\n  port: 1880,\n  path: '/flows',\n  method: 'POST',\n  headers: {\n    'Content-Type': 'application/json',\n    'Content-Length': data.length,\n    'Authorization': 'Bearer '+msg.accessToken\n  },\n  rejectUnauthorized: false\n};\nconst req = http.request(options);\nreq.write(data);\nreq.end();\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":2210,"y":440,"wires":[["5f18f5ef.f3cf7c"]]},{"id":"d3650102.78a5c","type":"switch","z":"440d357f.2f371c","name":"","property":"statusCode","propertyType":"msg","rules":[{"t":"eq","v":"200","vt":"num"},{"t":"else"}],"checkall":"true","repair":false,"outputs":2,"x":1070,"y":540,"wires":[["b5229e72.3194f"],["6f3dd0f9.41bbb"]]},{"id":"6f3dd0f9.41bbb","type":"http response","z":"440d357f.2f371c","name":"","statusCode":"","headers":{},"x":1210,"y":580,"wires":[]},{"id":"2b223f2f.ca3f8","type":"switch","z":"440d357f.2f371c","name":"","property":"statusCode","propertyType":"msg","rules":[{"t":"eq","v":"200","vt":"num"},{"t":"else"}],"checkall":"true","repair":false,"outputs":2,"x":1750,"y":540,"wires":[["e4750418.ce8d58"],["238972d0.09f4be"]]},{"id":"238972d0.09f4be","type":"http response","z":"440d357f.2f371c","name":"","statusCode":"","headers":{},"x":1890,"y":580,"wires":[]},{"id":"9626873d.857678","type":"change","z":"440d357f.2f371c","name":"status","rules":[{"t":"set","p":"payload","pt":"msg","to":"{}","tot":"json"},{"t":"set","p":"payload.text","pt":"msg","to":"\"table: \" & table","tot":"jsonata"},{"t":"set","p":"payload.shape","pt":"msg","to":"dot","tot":"str"},{"t":"set","p":"payload.fill","pt":"msg","to":"grey","tot":"str"}],"action":"","property":"","from":"","to":"","reg":false,"x":2770,"y":500,"wires":[[]]},{"id":"97d12f24.ad0d3","type":"http in","z":"440d357f.2f371c","name":"PUT timecol","url":"/dbtail/timecol","method":"put","upload":false,"swaggerDoc":"","x":90,"y":640,"wires":[["7246b633.06c168"]]},{"id":"8eb302bb.621e9","type":"change","z":"440d357f.2f371c","name":"","rules":[{"t":"set","p":"payload","pt":"msg","to":"timecol","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":2400,"y":640,"wires":[["8f452a5e.c4a988"]]},{"id":"c8b445a3.e41508","type":"http in","z":"440d357f.2f371c","name":"GET timecol","url":"/dbtail/timecol","method":"get","upload":false,"swaggerDoc":"","x":90,"y":740,"wires":[["62b02e8d.39aad"]]},{"id":"2331aacb.4a6c16","type":"http response","z":"440d357f.2f371c","name":"","statusCode":"","headers":{},"x":2290,"y":740,"wires":[]},{"id":"484bad48.542414","type":"change","z":"440d357f.2f371c","name":"","rules":[{"t":"set","p":"headers","pt":"msg","to":"{\"Content-Type\":\"text/plain\"}","tot":"json"}],"action":"","property":"","from":"","to":"","reg":false,"x":2120,"y":740,"wires":[["2331aacb.4a6c16"]]},{"id":"7246b633.06c168","type":"change","z":"440d357f.2f371c","name":"get inputs","rules":[{"t":"set","p":"timecol","pt":"msg","to":"payload","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":240,"y":640,"wires":[["6fa3b516.6e1bfc"]]},{"id":"6a4178a1.2ebc18","type":"http request","z":"440d357f.2f371c","name":"get flows","method":"GET","ret":"obj","paytoqs":"ignore","url":"https://localhost:1880/flows","tls":"b1a419c1.609c29","persist":false,"proxy":"","authType":"","x":1760,"y":640,"wires":[["d3d11ed9.95a3a"]]},{"id":"ca2df5a4.8a4058","type":"http response","z":"440d357f.2f371c","name":"","statusCode":"","headers":{},"x":2770,"y":640,"wires":[]},{"id":"8f452a5e.c4a988","type":"change","z":"440d357f.2f371c","name":"","rules":[{"t":"set","p":"headers","pt":"msg","to":"{\"Content-Type\":\"text/plain\"}","tot":"json"}],"action":"","property":"","from":"","to":"","reg":false,"x":2600,"y":640,"wires":[["ca2df5a4.8a4058","15b2d699.0a0369"]]},{"id":"db89433d.e7f36","type":"http request","z":"440d357f.2f371c","name":"get flows","method":"GET","ret":"obj","paytoqs":"ignore","url":"https://localhost:1880/flows","tls":"b1a419c1.609c29","persist":false,"proxy":"","authType":"","x":1600,"y":740,"wires":[["23a25eaa.9f6352"]]},{"id":"13da6e8f.188101","type":"http request","z":"440d357f.2f371c","name":"auth","method":"POST","ret":"obj","paytoqs":"ignore","url":"https://localhost:1880/auth/token","tls":"b1a419c1.609c29","persist":false,"proxy":"","authType":"","x":1090,"y":640,"wires":[["3fce525e.63a7be"]]},{"id":"cecb700d.61a7b","type":"change","z":"440d357f.2f371c","name":"auth payload","rules":[{"t":"set","p":"payload","pt":"msg","to":"{}","tot":"json"},{"t":"set","p":"payload.client_id","pt":"msg","to":"node-red-editor","tot":"str"},{"t":"set","p":"payload.grant_type","pt":"msg","to":"password","tot":"str"},{"t":"set","p":"payload.scope","pt":"msg","to":"","tot":"str"},{"t":"set","p":"payload.username","pt":"msg","to":"NRADM_USER","tot":"env"},{"t":"set","p":"payload.password","pt":"msg","to":"NRADM_PASS","tot":"env"}],"action":"","property":"","from":"","to":"","reg":false,"x":930,"y":640,"wires":[["13da6e8f.188101"]]},{"id":"d46d0413.247b48","type":"change","z":"440d357f.2f371c","name":"","rules":[{"t":"set","p":"accessToken","pt":"msg","to":"payload.access_token","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":1420,"y":640,"wires":[["6230a3a.04c375c"]]},{"id":"6230a3a.04c375c","type":"change","z":"440d357f.2f371c","name":"bearer","rules":[{"t":"set","p":"headers","pt":"msg","to":"{}","tot":"json"},{"t":"set","p":"headers.authorization","pt":"msg","to":"\"Bearer \" & msg.accessToken","tot":"jsonata"}],"action":"","property":"","from":"","to":"","reg":false,"x":1610,"y":640,"wires":[["6a4178a1.2ebc18"]]},{"id":"eb56c272.45f43","type":"http request","z":"440d357f.2f371c","name":"auth","method":"POST","ret":"obj","paytoqs":"ignore","url":"https://localhost:1880/auth/token","tls":"b1a419c1.609c29","persist":false,"proxy":"","authType":"","x":930,"y":740,"wires":[["c6ee17f1.c34818"]]},{"id":"d62fc276.dec9b","type":"change","z":"440d357f.2f371c","name":"auth payload","rules":[{"t":"set","p":"payload.client_id","pt":"msg","to":"node-red-editor","tot":"str"},{"t":"set","p":"payload.grant_type","pt":"msg","to":"password","tot":"str"},{"t":"set","p":"payload.scope","pt":"msg","to":"","tot":"str"},{"t":"set","p":"payload.username","pt":"msg","to":"NRADM_USER","tot":"env"},{"t":"set","p":"payload.password","pt":"msg","to":"NRADM_PASS","tot":"env"}],"action":"","property":"","from":"","to":"","reg":false,"x":770,"y":740,"wires":[["eb56c272.45f43"]]},{"id":"d8c9c62.dd79338","type":"change","z":"440d357f.2f371c","name":"","rules":[{"t":"set","p":"accessToken","pt":"msg","to":"payload.access_token","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":1260,"y":740,"wires":[["633fef71.d6797"]]},{"id":"633fef71.d6797","type":"change","z":"440d357f.2f371c","name":"bearer","rules":[{"t":"set","p":"headers","pt":"msg","to":"{}","tot":"json"},{"t":"set","p":"headers.authorization","pt":"msg","to":"\"Bearer \" & msg.accessToken","tot":"jsonata"}],"action":"","property":"","from":"","to":"","reg":false,"x":1450,"y":740,"wires":[["db89433d.e7f36"]]},{"id":"aae9f389.0a85c","type":"http request","z":"440d357f.2f371c","name":"","method":"POST","ret":"obj","paytoqs":"ignore","url":"${CFG_ACL_ENDP}","tls":"51b09598.a1114d","persist":false,"proxy":"","authType":"","x":610,"y":640,"wires":[["5ac5e326.cc704c"]]},{"id":"5ac5e326.cc704c","type":"switch","z":"440d357f.2f371c","name":"","property":"statusCode","propertyType":"msg","rules":[{"t":"eq","v":"200","vt":"num"},{"t":"else"}],"checkall":"true","repair":false,"outputs":2,"x":770,"y":640,"wires":[["cecb700d.61a7b"],["5717ce4.e7af23"]]},{"id":"34389388.f5bdac","type":"http request","z":"440d357f.2f371c","name":"","method":"POST","ret":"obj","paytoqs":"ignore","url":"${CFG_ACL_ENDP}","tls":"51b09598.a1114d","persist":false,"proxy":"","authType":"","x":450,"y":740,"wires":[["10c682fd.66c3bd"]]},{"id":"10c682fd.66c3bd","type":"switch","z":"440d357f.2f371c","name":"","property":"statusCode","propertyType":"msg","rules":[{"t":"eq","v":"200","vt":"num"},{"t":"else"}],"checkall":"true","repair":false,"outputs":2,"x":610,"y":740,"wires":[["d62fc276.dec9b"],["e9e3834d.681f9"]]},{"id":"62b02e8d.39aad","type":"change","z":"440d357f.2f371c","name":"acl req payload","rules":[{"t":"set","p":"headers","pt":"msg","to":"{}","tot":"json"},{"t":"set","p":"payload","pt":"msg","to":"{}","tot":"json"},{"t":"set","p":"payload.url","pt":"msg","to":"req.url","tot":"msg"},{"t":"set","p":"payload.method","pt":"msg","to":"req.method","tot":"msg"},{"t":"set","p":"payload.headers","pt":"msg","to":"req.headers","tot":"msg"},{"t":"set","p":"payload.params","pt":"msg","to":"req.params","tot":"msg"},{"t":"set","p":"payload.query","pt":"msg","to":"req.query","tot":"msg"},{"t":"set","p":"payload.body","pt":"msg","to":"req.body","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":260,"y":740,"wires":[["34389388.f5bdac"]]},{"id":"6fa3b516.6e1bfc","type":"change","z":"440d357f.2f371c","name":"acl req payload","rules":[{"t":"set","p":"headers","pt":"msg","to":"{}","tot":"json"},{"t":"set","p":"payload","pt":"msg","to":"{}","tot":"json"},{"t":"set","p":"payload.url","pt":"msg","to":"req.url","tot":"msg"},{"t":"set","p":"payload.method","pt":"msg","to":"req.method","tot":"msg"},{"t":"set","p":"payload.headers","pt":"msg","to":"req.headers","tot":"msg"},{"t":"set","p":"payload.params","pt":"msg","to":"req.params","tot":"msg"},{"t":"set","p":"payload.query","pt":"msg","to":"req.query","tot":"msg"},{"t":"set","p":"payload.body","pt":"msg","to":"req.body","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":420,"y":640,"wires":[["aae9f389.0a85c"]]},{"id":"e9e3834d.681f9","type":"http response","z":"440d357f.2f371c","name":"","statusCode":"","headers":{},"x":750,"y":780,"wires":[]},{"id":"60e94bcd.f193c4","type":"change","z":"440d357f.2f371c","name":"","rules":[{"t":"set","p":"payload","pt":"msg","to":"*[name = \"dbtail settings\" and type=\"change\"].rules[1].to","tot":"jsonata"}],"action":"","property":"","from":"","to":"","reg":false,"x":1920,"y":740,"wires":[["484bad48.542414"]]},{"id":"146e9d3b.b3b3a3","type":"change","z":"440d357f.2f371c","name":"edit","rules":[{"t":"set","p":"old","pt":"msg","to":"*[name = \"dbtail settings\" and type=\"change\"]","tot":"jsonata"},{"t":"set","p":"new","pt":"msg","to":"old","tot":"msg"},{"t":"set","p":"new.rules[1].to","pt":"msg","to":"timecol","tot":"msg"},{"t":"set","p":"payload","pt":"msg","to":"$eval($replace($string(payload),$string(old),$string(new)))","tot":"jsonata"}],"action":"","property":"","from":"","to":"","reg":false,"x":2050,"y":640,"wires":[["71d347dc.82b328"]]},{"id":"5717ce4.e7af23","type":"http response","z":"440d357f.2f371c","name":"","statusCode":"","headers":{},"x":910,"y":680,"wires":[]},{"id":"3fce525e.63a7be","type":"switch","z":"440d357f.2f371c","name":"","property":"statusCode","propertyType":"msg","rules":[{"t":"eq","v":"200","vt":"num"},{"t":"else"}],"checkall":"true","repair":false,"outputs":2,"x":1230,"y":640,"wires":[["d46d0413.247b48"],["80aba974.a88988"]]},{"id":"80aba974.a88988","type":"http response","z":"440d357f.2f371c","name":"","statusCode":"","headers":{},"x":1370,"y":680,"wires":[]},{"id":"d3d11ed9.95a3a","type":"switch","z":"440d357f.2f371c","name":"","property":"statusCode","propertyType":"msg","rules":[{"t":"eq","v":"200","vt":"num"},{"t":"else"}],"checkall":"true","repair":false,"outputs":2,"x":1910,"y":640,"wires":[["146e9d3b.b3b3a3"],["4ff85439.b59bdc"]]},{"id":"4ff85439.b59bdc","type":"http response","z":"440d357f.2f371c","name":"","statusCode":"","headers":{},"x":2050,"y":680,"wires":[]},{"id":"71d347dc.82b328","type":"function","z":"440d357f.2f371c","name":"update flows","func":"const http = global.get('https');\nconst data = JSON.stringify(msg.payload);\nconst options = {\n  hostname: 'localhost',\n  port: 1880,\n  path: '/flows',\n  method: 'POST',\n  headers: {\n    'Content-Type': 'application/json',\n    'Content-Length': data.length,\n    'Authorization': 'Bearer '+msg.accessToken\n  },\n  rejectUnauthorized: false\n};\nconst req = http.request(options);\nreq.write(data);\nreq.end();\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":2210,"y":640,"wires":[["8eb302bb.621e9"]]},{"id":"c6ee17f1.c34818","type":"switch","z":"440d357f.2f371c","name":"","property":"statusCode","propertyType":"msg","rules":[{"t":"eq","v":"200","vt":"num"},{"t":"else"}],"checkall":"true","repair":false,"outputs":2,"x":1070,"y":740,"wires":[["d8c9c62.dd79338"],["b1adf00d.70492"]]},{"id":"b1adf00d.70492","type":"http response","z":"440d357f.2f371c","name":"","statusCode":"","headers":{},"x":1210,"y":780,"wires":[]},{"id":"23a25eaa.9f6352","type":"switch","z":"440d357f.2f371c","name":"","property":"statusCode","propertyType":"msg","rules":[{"t":"eq","v":"200","vt":"num"},{"t":"else"}],"checkall":"true","repair":false,"outputs":2,"x":1750,"y":740,"wires":[["60e94bcd.f193c4"],["7a1f7fd0.a7117"]]},{"id":"7a1f7fd0.a7117","type":"http response","z":"440d357f.2f371c","name":"","statusCode":"","headers":{},"x":1890,"y":780,"wires":[]},{"id":"15b2d699.0a0369","type":"change","z":"440d357f.2f371c","name":"status","rules":[{"t":"set","p":"payload","pt":"msg","to":"{}","tot":"json"},{"t":"set","p":"payload.text","pt":"msg","to":"\"timecol: \" & timecol","tot":"jsonata"},{"t":"set","p":"payload.shape","pt":"msg","to":"dot","tot":"str"},{"t":"set","p":"payload.fill","pt":"msg","to":"grey","tot":"str"}],"action":"","property":"","from":"","to":"","reg":false,"x":2770,"y":700,"wires":[[]]},{"id":"73149e72.6e841","type":"change","z":"440d357f.2f371c","name":"edit","rules":[{"t":"set","p":"old","pt":"msg","to":"*[name = \"dbtail settings\" and type=\"change\"]","tot":"jsonata"},{"t":"set","p":"new","pt":"msg","to":"old","tot":"msg"},{"t":"set","p":"new.rules[3].to","pt":"msg","to":"interval","tot":"msg"},{"t":"set","p":"payload","pt":"msg","to":"$eval($replace($string(payload),$string(old),$string(new)))","tot":"jsonata"}],"action":"","property":"","from":"","to":"","reg":false,"x":2190,"y":40,"wires":[["de8efcc.a7246"]]},{"id":"3c3c9765.3bc088","type":"http in","z":"440d357f.2f371c","name":"PUT host","url":"/dbtail/host","method":"put","upload":false,"swaggerDoc":"","x":80,"y":840,"wires":[["ed5116e.036b8e8"]]},{"id":"e9c1252f.78b988","type":"change","z":"440d357f.2f371c","name":"","rules":[{"t":"set","p":"payload","pt":"msg","to":"host","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":2400,"y":840,"wires":[["cf8c3c33.46981"]]},{"id":"d5c11c00.a3c7f","type":"http in","z":"440d357f.2f371c","name":"GET host","url":"/dbtail/host","method":"get","upload":false,"swaggerDoc":"","x":80,"y":940,"wires":[["e2b32814.315158"]]},{"id":"d53c7bd2.a37d18","type":"http response","z":"440d357f.2f371c","name":"","statusCode":"","headers":{},"x":2290,"y":940,"wires":[]},{"id":"6d6016db.cd8268","type":"change","z":"440d357f.2f371c","name":"","rules":[{"t":"set","p":"headers","pt":"msg","to":"{\"Content-Type\":\"text/plain\"}","tot":"json"}],"action":"","property":"","from":"","to":"","reg":false,"x":2120,"y":940,"wires":[["d53c7bd2.a37d18"]]},{"id":"ed5116e.036b8e8","type":"change","z":"440d357f.2f371c","name":"get inputs","rules":[{"t":"set","p":"host","pt":"msg","to":"payload","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":240,"y":840,"wires":[["d9397acb.722e08"]]},{"id":"2bd69e91.9b7b52","type":"http request","z":"440d357f.2f371c","name":"get flows","method":"GET","ret":"obj","paytoqs":"ignore","url":"https://localhost:1880/flows","tls":"b1a419c1.609c29","persist":false,"proxy":"","authType":"","x":1760,"y":840,"wires":[["34ef1887.b2aaa8"]]},{"id":"fdd1dbb1.a6bba8","type":"http response","z":"440d357f.2f371c","name":"","statusCode":"","headers":{},"x":2770,"y":840,"wires":[]},{"id":"cf8c3c33.46981","type":"change","z":"440d357f.2f371c","name":"","rules":[{"t":"set","p":"headers","pt":"msg","to":"{\"Content-Type\":\"text/plain\"}","tot":"json"}],"action":"","property":"","from":"","to":"","reg":false,"x":2600,"y":840,"wires":[["fdd1dbb1.a6bba8","488f1813.50f308"]]},{"id":"3f88ca1c.6ae036","type":"http request","z":"440d357f.2f371c","name":"get flows","method":"GET","ret":"obj","paytoqs":"ignore","url":"https://localhost:1880/flows","tls":"b1a419c1.609c29","persist":false,"proxy":"","authType":"","x":1600,"y":940,"wires":[["2280f06e.de0b1"]]},{"id":"b556388a.f01718","type":"http request","z":"440d357f.2f371c","name":"auth","method":"POST","ret":"obj","paytoqs":"ignore","url":"https://localhost:1880/auth/token","tls":"b1a419c1.609c29","persist":false,"proxy":"","authType":"","x":1090,"y":840,"wires":[["c3494df8.dfb7a"]]},{"id":"9e04462a.17dfa8","type":"change","z":"440d357f.2f371c","name":"auth payload","rules":[{"t":"set","p":"payload","pt":"msg","to":"{}","tot":"json"},{"t":"set","p":"payload.client_id","pt":"msg","to":"node-red-editor","tot":"str"},{"t":"set","p":"payload.grant_type","pt":"msg","to":"password","tot":"str"},{"t":"set","p":"payload.scope","pt":"msg","to":"","tot":"str"},{"t":"set","p":"payload.username","pt":"msg","to":"NRADM_USER","tot":"env"},{"t":"set","p":"payload.password","pt":"msg","to":"NRADM_PASS","tot":"env"}],"action":"","property":"","from":"","to":"","reg":false,"x":930,"y":840,"wires":[["b556388a.f01718"]]},{"id":"c11e6fd4.d6eb8","type":"change","z":"440d357f.2f371c","name":"","rules":[{"t":"set","p":"accessToken","pt":"msg","to":"payload.access_token","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":1420,"y":840,"wires":[["e896ea4.1848518"]]},{"id":"e896ea4.1848518","type":"change","z":"440d357f.2f371c","name":"bearer","rules":[{"t":"set","p":"headers","pt":"msg","to":"{}","tot":"json"},{"t":"set","p":"headers.authorization","pt":"msg","to":"\"Bearer \" & msg.accessToken","tot":"jsonata"}],"action":"","property":"","from":"","to":"","reg":false,"x":1610,"y":840,"wires":[["2bd69e91.9b7b52"]]},{"id":"82b0889a.cd2bb8","type":"http request","z":"440d357f.2f371c","name":"auth","method":"POST","ret":"obj","paytoqs":"ignore","url":"https://localhost:1880/auth/token","tls":"b1a419c1.609c29","persist":false,"proxy":"","authType":"","x":930,"y":940,"wires":[["9cd33733.fc6ba8"]]},{"id":"c6e5b695.f14768","type":"change","z":"440d357f.2f371c","name":"auth payload","rules":[{"t":"set","p":"payload.client_id","pt":"msg","to":"node-red-editor","tot":"str"},{"t":"set","p":"payload.grant_type","pt":"msg","to":"password","tot":"str"},{"t":"set","p":"payload.scope","pt":"msg","to":"","tot":"str"},{"t":"set","p":"payload.username","pt":"msg","to":"NRADM_USER","tot":"env"},{"t":"set","p":"payload.password","pt":"msg","to":"NRADM_PASS","tot":"env"}],"action":"","property":"","from":"","to":"","reg":false,"x":770,"y":940,"wires":[["82b0889a.cd2bb8"]]},{"id":"e5da9743.393c08","type":"change","z":"440d357f.2f371c","name":"","rules":[{"t":"set","p":"accessToken","pt":"msg","to":"payload.access_token","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":1260,"y":940,"wires":[["85a7a34d.ab7ed"]]},{"id":"85a7a34d.ab7ed","type":"change","z":"440d357f.2f371c","name":"bearer","rules":[{"t":"set","p":"headers","pt":"msg","to":"{}","tot":"json"},{"t":"set","p":"headers.authorization","pt":"msg","to":"\"Bearer \" & msg.accessToken","tot":"jsonata"}],"action":"","property":"","from":"","to":"","reg":false,"x":1450,"y":940,"wires":[["3f88ca1c.6ae036"]]},{"id":"51a56c64.5f2b74","type":"http request","z":"440d357f.2f371c","name":"","method":"POST","ret":"obj","paytoqs":"ignore","url":"${CFG_ACL_ENDP}","tls":"51b09598.a1114d","persist":false,"proxy":"","authType":"","x":610,"y":840,"wires":[["5f247d16.ee8bd4"]]},{"id":"5f247d16.ee8bd4","type":"switch","z":"440d357f.2f371c","name":"","property":"statusCode","propertyType":"msg","rules":[{"t":"eq","v":"200","vt":"num"},{"t":"else"}],"checkall":"true","repair":false,"outputs":2,"x":770,"y":840,"wires":[["9e04462a.17dfa8"],["4b6d4bf6.ba97b4"]]},{"id":"b696e170.7957c","type":"http request","z":"440d357f.2f371c","name":"","method":"POST","ret":"obj","paytoqs":"ignore","url":"${CFG_ACL_ENDP}","tls":"51b09598.a1114d","persist":false,"proxy":"","authType":"","x":450,"y":940,"wires":[["5e2fbf6f.dc803"]]},{"id":"5e2fbf6f.dc803","type":"switch","z":"440d357f.2f371c","name":"","property":"statusCode","propertyType":"msg","rules":[{"t":"eq","v":"200","vt":"num"},{"t":"else"}],"checkall":"true","repair":false,"outputs":2,"x":610,"y":940,"wires":[["c6e5b695.f14768"],["44a9daff.0281c4"]]},{"id":"e2b32814.315158","type":"change","z":"440d357f.2f371c","name":"acl req payload","rules":[{"t":"set","p":"headers","pt":"msg","to":"{}","tot":"json"},{"t":"set","p":"payload","pt":"msg","to":"{}","tot":"json"},{"t":"set","p":"payload.url","pt":"msg","to":"req.url","tot":"msg"},{"t":"set","p":"payload.method","pt":"msg","to":"req.method","tot":"msg"},{"t":"set","p":"payload.headers","pt":"msg","to":"req.headers","tot":"msg"},{"t":"set","p":"payload.params","pt":"msg","to":"req.params","tot":"msg"},{"t":"set","p":"payload.query","pt":"msg","to":"req.query","tot":"msg"},{"t":"set","p":"payload.body","pt":"msg","to":"req.body","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":260,"y":940,"wires":[["b696e170.7957c"]]},{"id":"d9397acb.722e08","type":"change","z":"440d357f.2f371c","name":"acl req payload","rules":[{"t":"set","p":"headers","pt":"msg","to":"{}","tot":"json"},{"t":"set","p":"payload","pt":"msg","to":"{}","tot":"json"},{"t":"set","p":"payload.url","pt":"msg","to":"req.url","tot":"msg"},{"t":"set","p":"payload.method","pt":"msg","to":"req.method","tot":"msg"},{"t":"set","p":"payload.headers","pt":"msg","to":"req.headers","tot":"msg"},{"t":"set","p":"payload.params","pt":"msg","to":"req.params","tot":"msg"},{"t":"set","p":"payload.query","pt":"msg","to":"req.query","tot":"msg"},{"t":"set","p":"payload.body","pt":"msg","to":"req.body","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":420,"y":840,"wires":[["51a56c64.5f2b74"]]},{"id":"44a9daff.0281c4","type":"http response","z":"440d357f.2f371c","name":"","statusCode":"","headers":{},"x":750,"y":980,"wires":[]},{"id":"c41b88b3.52b128","type":"change","z":"440d357f.2f371c","name":"","rules":[{"t":"set","p":"payload","pt":"msg","to":"*[name = \"dbtail mysql server config\" and type=\"Stackhero-MySQL-Server\"].host","tot":"jsonata"}],"action":"","property":"","from":"","to":"","reg":false,"x":1920,"y":940,"wires":[["6d6016db.cd8268"]]},{"id":"747599ea.1aa1f8","type":"change","z":"440d357f.2f371c","name":"edit","rules":[{"t":"set","p":"old","pt":"msg","to":"*[name = \"dbtail mysql server config\" and type=\"Stackhero-MySQL-Server\"]","tot":"jsonata"},{"t":"set","p":"new","pt":"msg","to":"old","tot":"msg"},{"t":"set","p":"new.host","pt":"msg","to":"host","tot":"msg"},{"t":"set","p":"payload","pt":"msg","to":"$eval($replace($string(payload),$string(old),$string(new)))","tot":"jsonata"}],"action":"","property":"","from":"","to":"","reg":false,"x":2050,"y":840,"wires":[["ca11a464.178dc8"]]},{"id":"4b6d4bf6.ba97b4","type":"http response","z":"440d357f.2f371c","name":"","statusCode":"","headers":{},"x":910,"y":880,"wires":[]},{"id":"c3494df8.dfb7a","type":"switch","z":"440d357f.2f371c","name":"","property":"statusCode","propertyType":"msg","rules":[{"t":"eq","v":"200","vt":"num"},{"t":"else"}],"checkall":"true","repair":false,"outputs":2,"x":1230,"y":840,"wires":[["c11e6fd4.d6eb8"],["b4d5a27a.2eeb"]]},{"id":"b4d5a27a.2eeb","type":"http response","z":"440d357f.2f371c","name":"","statusCode":"","headers":{},"x":1370,"y":880,"wires":[]},{"id":"34ef1887.b2aaa8","type":"switch","z":"440d357f.2f371c","name":"","property":"statusCode","propertyType":"msg","rules":[{"t":"eq","v":"200","vt":"num"},{"t":"else"}],"checkall":"true","repair":false,"outputs":2,"x":1910,"y":840,"wires":[["747599ea.1aa1f8"],["cf0e0e9e.9adad"]]},{"id":"cf0e0e9e.9adad","type":"http response","z":"440d357f.2f371c","name":"","statusCode":"","headers":{},"x":2050,"y":880,"wires":[]},{"id":"ca11a464.178dc8","type":"function","z":"440d357f.2f371c","name":"update flows","func":"const http = global.get('https');\nconst data = JSON.stringify(msg.payload);\nconst options = {\n  hostname: 'localhost',\n  port: 1880,\n  path: '/flows',\n  method: 'POST',\n  headers: {\n    'Content-Type': 'application/json',\n    'Content-Length': data.length,\n    'Authorization': 'Bearer '+msg.accessToken\n  },\n  rejectUnauthorized: false\n};\nconst req = http.request(options);\nreq.write(data);\nreq.end();\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":2210,"y":840,"wires":[["e9c1252f.78b988"]]},{"id":"9cd33733.fc6ba8","type":"switch","z":"440d357f.2f371c","name":"","property":"statusCode","propertyType":"msg","rules":[{"t":"eq","v":"200","vt":"num"},{"t":"else"}],"checkall":"true","repair":false,"outputs":2,"x":1070,"y":940,"wires":[["e5da9743.393c08"],["89538bbf.9913c8"]]},{"id":"89538bbf.9913c8","type":"http response","z":"440d357f.2f371c","name":"","statusCode":"","headers":{},"x":1210,"y":980,"wires":[]},{"id":"2280f06e.de0b1","type":"switch","z":"440d357f.2f371c","name":"","property":"statusCode","propertyType":"msg","rules":[{"t":"eq","v":"200","vt":"num"},{"t":"else"}],"checkall":"true","repair":false,"outputs":2,"x":1750,"y":940,"wires":[["c41b88b3.52b128"],["63430991.bd0c38"]]},{"id":"63430991.bd0c38","type":"http response","z":"440d357f.2f371c","name":"","statusCode":"","headers":{},"x":1890,"y":980,"wires":[]},{"id":"488f1813.50f308","type":"change","z":"440d357f.2f371c","name":"status","rules":[{"t":"set","p":"payload","pt":"msg","to":"{}","tot":"json"},{"t":"set","p":"payload.text","pt":"msg","to":"\"host: \" & host","tot":"jsonata"},{"t":"set","p":"payload.shape","pt":"msg","to":"dot","tot":"str"},{"t":"set","p":"payload.fill","pt":"msg","to":"grey","tot":"str"}],"action":"","property":"","from":"","to":"","reg":false,"x":2770,"y":900,"wires":[[]]},{"id":"1ab42880.1d9948","type":"http in","z":"440d357f.2f371c","name":"PUT port","url":"/dbtail/port","method":"put","upload":false,"swaggerDoc":"","x":80,"y":1040,"wires":[["9d77d904.a966a8"]]},{"id":"adf0e051.7854e","type":"change","z":"440d357f.2f371c","name":"","rules":[{"t":"set","p":"payload","pt":"msg","to":"port","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":2400,"y":1040,"wires":[["19479288.5182fd"]]},{"id":"abd2e239.81105","type":"http in","z":"440d357f.2f371c","name":"GET port","url":"/dbtail/port","method":"get","upload":false,"swaggerDoc":"","x":80,"y":1140,"wires":[["7bc6ff8f.d4693"]]},{"id":"4e66da91.3b50a4","type":"http response","z":"440d357f.2f371c","name":"","statusCode":"","headers":{},"x":2290,"y":1140,"wires":[]},{"id":"51326369.bb1fac","type":"change","z":"440d357f.2f371c","name":"","rules":[{"t":"set","p":"headers","pt":"msg","to":"{\"Content-Type\":\"text/plain\"}","tot":"json"}],"action":"","property":"","from":"","to":"","reg":false,"x":2120,"y":1140,"wires":[["4e66da91.3b50a4"]]},{"id":"9d77d904.a966a8","type":"change","z":"440d357f.2f371c","name":"get inputs","rules":[{"t":"set","p":"port","pt":"msg","to":"payload","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":240,"y":1040,"wires":[["a4e0ef25.bdd5e"]]},{"id":"52347b3d.911a24","type":"http request","z":"440d357f.2f371c","name":"get flows","method":"GET","ret":"obj","paytoqs":"ignore","url":"https://localhost:1880/flows","tls":"b1a419c1.609c29","persist":false,"proxy":"","authType":"","x":1760,"y":1040,"wires":[["745967bc.d511a8"]]},{"id":"8c6a190.02015e8","type":"http response","z":"440d357f.2f371c","name":"","statusCode":"","headers":{},"x":2770,"y":1040,"wires":[]},{"id":"19479288.5182fd","type":"change","z":"440d357f.2f371c","name":"","rules":[{"t":"set","p":"headers","pt":"msg","to":"{\"Content-Type\":\"text/plain\"}","tot":"json"}],"action":"","property":"","from":"","to":"","reg":false,"x":2600,"y":1040,"wires":[["8c6a190.02015e8","7a3a7a93.ea7844"]]},{"id":"ada57b78.9adbe8","type":"http request","z":"440d357f.2f371c","name":"get flows","method":"GET","ret":"obj","paytoqs":"ignore","url":"https://localhost:1880/flows","tls":"b1a419c1.609c29","persist":false,"proxy":"","authType":"","x":1600,"y":1140,"wires":[["f89a9d0d.f334a"]]},{"id":"8f215077.f8a65","type":"http request","z":"440d357f.2f371c","name":"auth","method":"POST","ret":"obj","paytoqs":"ignore","url":"https://localhost:1880/auth/token","tls":"b1a419c1.609c29","persist":false,"proxy":"","authType":"","x":1090,"y":1040,"wires":[["a8235f01.d70cb"]]},{"id":"638d2882.ae98a8","type":"change","z":"440d357f.2f371c","name":"auth payload","rules":[{"t":"set","p":"payload","pt":"msg","to":"{}","tot":"json"},{"t":"set","p":"payload.client_id","pt":"msg","to":"node-red-editor","tot":"str"},{"t":"set","p":"payload.grant_type","pt":"msg","to":"password","tot":"str"},{"t":"set","p":"payload.scope","pt":"msg","to":"","tot":"str"},{"t":"set","p":"payload.username","pt":"msg","to":"NRADM_USER","tot":"env"},{"t":"set","p":"payload.password","pt":"msg","to":"NRADM_PASS","tot":"env"}],"action":"","property":"","from":"","to":"","reg":false,"x":930,"y":1040,"wires":[["8f215077.f8a65"]]},{"id":"d0ac5ccb.db9d3","type":"change","z":"440d357f.2f371c","name":"","rules":[{"t":"set","p":"accessToken","pt":"msg","to":"payload.access_token","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":1420,"y":1040,"wires":[["31db02ad.1b5d3e"]]},{"id":"31db02ad.1b5d3e","type":"change","z":"440d357f.2f371c","name":"bearer","rules":[{"t":"set","p":"headers","pt":"msg","to":"{}","tot":"json"},{"t":"set","p":"headers.authorization","pt":"msg","to":"\"Bearer \" & msg.accessToken","tot":"jsonata"}],"action":"","property":"","from":"","to":"","reg":false,"x":1610,"y":1040,"wires":[["52347b3d.911a24"]]},{"id":"d792026d.f2c77","type":"http request","z":"440d357f.2f371c","name":"auth","method":"POST","ret":"obj","paytoqs":"ignore","url":"https://localhost:1880/auth/token","tls":"b1a419c1.609c29","persist":false,"proxy":"","authType":"","x":930,"y":1140,"wires":[["c98b8eec.0dfb"]]},{"id":"7d6bb736.c81e08","type":"change","z":"440d357f.2f371c","name":"auth payload","rules":[{"t":"set","p":"payload.client_id","pt":"msg","to":"node-red-editor","tot":"str"},{"t":"set","p":"payload.grant_type","pt":"msg","to":"password","tot":"str"},{"t":"set","p":"payload.scope","pt":"msg","to":"","tot":"str"},{"t":"set","p":"payload.username","pt":"msg","to":"NRADM_USER","tot":"env"},{"t":"set","p":"payload.password","pt":"msg","to":"NRADM_PASS","tot":"env"}],"action":"","property":"","from":"","to":"","reg":false,"x":770,"y":1140,"wires":[["d792026d.f2c77"]]},{"id":"ec81b08d.041fb","type":"change","z":"440d357f.2f371c","name":"","rules":[{"t":"set","p":"accessToken","pt":"msg","to":"payload.access_token","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":1260,"y":1140,"wires":[["9c06f01c.3d77e"]]},{"id":"9c06f01c.3d77e","type":"change","z":"440d357f.2f371c","name":"bearer","rules":[{"t":"set","p":"headers","pt":"msg","to":"{}","tot":"json"},{"t":"set","p":"headers.authorization","pt":"msg","to":"\"Bearer \" & msg.accessToken","tot":"jsonata"}],"action":"","property":"","from":"","to":"","reg":false,"x":1450,"y":1140,"wires":[["ada57b78.9adbe8"]]},{"id":"97acb5ce.bfedb8","type":"http request","z":"440d357f.2f371c","name":"","method":"POST","ret":"obj","paytoqs":"ignore","url":"${CFG_ACL_ENDP}","tls":"51b09598.a1114d","persist":false,"proxy":"","authType":"","x":610,"y":1040,"wires":[["c402ad9f.8dd8c"]]},{"id":"c402ad9f.8dd8c","type":"switch","z":"440d357f.2f371c","name":"","property":"statusCode","propertyType":"msg","rules":[{"t":"eq","v":"200","vt":"num"},{"t":"else"}],"checkall":"true","repair":false,"outputs":2,"x":770,"y":1040,"wires":[["638d2882.ae98a8"],["af107f49.50dcb"]]},{"id":"f1f9e944.bdb7f8","type":"http request","z":"440d357f.2f371c","name":"","method":"POST","ret":"obj","paytoqs":"ignore","url":"${CFG_ACL_ENDP}","tls":"51b09598.a1114d","persist":false,"proxy":"","authType":"","x":450,"y":1140,"wires":[["4d9750f1.8a868"]]},{"id":"4d9750f1.8a868","type":"switch","z":"440d357f.2f371c","name":"","property":"statusCode","propertyType":"msg","rules":[{"t":"eq","v":"200","vt":"num"},{"t":"else"}],"checkall":"true","repair":false,"outputs":2,"x":610,"y":1140,"wires":[["7d6bb736.c81e08"],["1a34258b.0a810a"]]},{"id":"7bc6ff8f.d4693","type":"change","z":"440d357f.2f371c","name":"acl req payload","rules":[{"t":"set","p":"headers","pt":"msg","to":"{}","tot":"json"},{"t":"set","p":"payload","pt":"msg","to":"{}","tot":"json"},{"t":"set","p":"payload.url","pt":"msg","to":"req.url","tot":"msg"},{"t":"set","p":"payload.method","pt":"msg","to":"req.method","tot":"msg"},{"t":"set","p":"payload.headers","pt":"msg","to":"req.headers","tot":"msg"},{"t":"set","p":"payload.params","pt":"msg","to":"req.params","tot":"msg"},{"t":"set","p":"payload.query","pt":"msg","to":"req.query","tot":"msg"},{"t":"set","p":"payload.body","pt":"msg","to":"req.body","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":260,"y":1140,"wires":[["f1f9e944.bdb7f8"]]},{"id":"a4e0ef25.bdd5e","type":"change","z":"440d357f.2f371c","name":"acl req payload","rules":[{"t":"set","p":"headers","pt":"msg","to":"{}","tot":"json"},{"t":"set","p":"payload","pt":"msg","to":"{}","tot":"json"},{"t":"set","p":"payload.url","pt":"msg","to":"req.url","tot":"msg"},{"t":"set","p":"payload.method","pt":"msg","to":"req.method","tot":"msg"},{"t":"set","p":"payload.headers","pt":"msg","to":"req.headers","tot":"msg"},{"t":"set","p":"payload.params","pt":"msg","to":"req.params","tot":"msg"},{"t":"set","p":"payload.query","pt":"msg","to":"req.query","tot":"msg"},{"t":"set","p":"payload.body","pt":"msg","to":"req.body","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":420,"y":1040,"wires":[["97acb5ce.bfedb8"]]},{"id":"1a34258b.0a810a","type":"http response","z":"440d357f.2f371c","name":"","statusCode":"","headers":{},"x":750,"y":1180,"wires":[]},{"id":"8ce32064.e2882","type":"change","z":"440d357f.2f371c","name":"","rules":[{"t":"set","p":"payload","pt":"msg","to":"*[name = \"dbtail mysql server config\" and type=\"Stackhero-MySQL-Server\"].port","tot":"jsonata"}],"action":"","property":"","from":"","to":"","reg":false,"x":1920,"y":1140,"wires":[["51326369.bb1fac"]]},{"id":"878cac23.30385","type":"change","z":"440d357f.2f371c","name":"edit","rules":[{"t":"set","p":"old","pt":"msg","to":"*[name = \"dbtail mysql server config\" and type=\"Stackhero-MySQL-Server\"]","tot":"jsonata"},{"t":"set","p":"new","pt":"msg","to":"old","tot":"msg"},{"t":"set","p":"new.port","pt":"msg","to":"port","tot":"msg"},{"t":"set","p":"payload","pt":"msg","to":"$eval($replace($string(payload),$string(old),$string(new)))","tot":"jsonata"}],"action":"","property":"","from":"","to":"","reg":false,"x":2050,"y":1040,"wires":[["d1fadf90.a0f6e"]]},{"id":"af107f49.50dcb","type":"http response","z":"440d357f.2f371c","name":"","statusCode":"","headers":{},"x":910,"y":1080,"wires":[]},{"id":"a8235f01.d70cb","type":"switch","z":"440d357f.2f371c","name":"","property":"statusCode","propertyType":"msg","rules":[{"t":"eq","v":"200","vt":"num"},{"t":"else"}],"checkall":"true","repair":false,"outputs":2,"x":1230,"y":1040,"wires":[["d0ac5ccb.db9d3"],["25ed80b.d99908"]]},{"id":"25ed80b.d99908","type":"http response","z":"440d357f.2f371c","name":"","statusCode":"","headers":{},"x":1370,"y":1080,"wires":[]},{"id":"745967bc.d511a8","type":"switch","z":"440d357f.2f371c","name":"","property":"statusCode","propertyType":"msg","rules":[{"t":"eq","v":"200","vt":"num"},{"t":"else"}],"checkall":"true","repair":false,"outputs":2,"x":1910,"y":1040,"wires":[["878cac23.30385"],["6d9acc37.ccf664"]]},{"id":"6d9acc37.ccf664","type":"http response","z":"440d357f.2f371c","name":"","statusCode":"","headers":{},"x":2050,"y":1080,"wires":[]},{"id":"d1fadf90.a0f6e","type":"function","z":"440d357f.2f371c","name":"update flows","func":"const http = global.get('https');\nconst data = JSON.stringify(msg.payload);\nconst options = {\n  hostname: 'localhost',\n  port: 1880,\n  path: '/flows',\n  method: 'POST',\n  headers: {\n    'Content-Type': 'application/json',\n    'Content-Length': data.length,\n    'Authorization': 'Bearer '+msg.accessToken\n  },\n  rejectUnauthorized: false\n};\nconst req = http.request(options);\nreq.write(data);\nreq.end();\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":2210,"y":1040,"wires":[["adf0e051.7854e"]]},{"id":"c98b8eec.0dfb","type":"switch","z":"440d357f.2f371c","name":"","property":"statusCode","propertyType":"msg","rules":[{"t":"eq","v":"200","vt":"num"},{"t":"else"}],"checkall":"true","repair":false,"outputs":2,"x":1070,"y":1140,"wires":[["ec81b08d.041fb"],["b7e4cb5f.734788"]]},{"id":"b7e4cb5f.734788","type":"http response","z":"440d357f.2f371c","name":"","statusCode":"","headers":{},"x":1210,"y":1180,"wires":[]},{"id":"f89a9d0d.f334a","type":"switch","z":"440d357f.2f371c","name":"","property":"statusCode","propertyType":"msg","rules":[{"t":"eq","v":"200","vt":"num"},{"t":"else"}],"checkall":"true","repair":false,"outputs":2,"x":1750,"y":1140,"wires":[["8ce32064.e2882"],["cb12a709.0e9b08"]]},{"id":"cb12a709.0e9b08","type":"http response","z":"440d357f.2f371c","name":"","statusCode":"","headers":{},"x":1890,"y":1180,"wires":[]},{"id":"7a3a7a93.ea7844","type":"change","z":"440d357f.2f371c","name":"status","rules":[{"t":"set","p":"payload","pt":"msg","to":"{}","tot":"json"},{"t":"set","p":"payload.text","pt":"msg","to":"\"port: \" & port","tot":"jsonata"},{"t":"set","p":"payload.shape","pt":"msg","to":"dot","tot":"str"},{"t":"set","p":"payload.fill","pt":"msg","to":"grey","tot":"str"}],"action":"","property":"","from":"","to":"","reg":false,"x":2770,"y":1100,"wires":[[]]},{"id":"ce391882.193a18","type":"http in","z":"440d357f.2f371c","name":"PUT tls","url":"/dbtail/tls","method":"put","upload":false,"swaggerDoc":"","x":70,"y":1280,"wires":[["1e28d111.ff84bf"]]},{"id":"29f55ecc.f09062","type":"change","z":"440d357f.2f371c","name":"","rules":[{"t":"set","p":"payload","pt":"msg","to":"tls ? \"yes\" : \"no\"","tot":"jsonata"}],"action":"","property":"","from":"","to":"","reg":false,"x":2520,"y":1280,"wires":[["9515de32.8f636"]]},{"id":"56be8d63.8eb2f4","type":"http in","z":"440d357f.2f371c","name":"GET tls","url":"/dbtail/tls","method":"get","upload":false,"swaggerDoc":"","x":70,"y":1380,"wires":[["6e85d462.7edefc"]]},{"id":"63708039.1367c","type":"http response","z":"440d357f.2f371c","name":"","statusCode":"","headers":{},"x":2290,"y":1380,"wires":[]},{"id":"3eb7fa17.b52366","type":"change","z":"440d357f.2f371c","name":"","rules":[{"t":"set","p":"headers","pt":"msg","to":"{\"Content-Type\":\"text/plain\"}","tot":"json"}],"action":"","property":"","from":"","to":"","reg":false,"x":2120,"y":1380,"wires":[["63708039.1367c"]]},{"id":"7091ab6.9593c54","type":"change","z":"440d357f.2f371c","name":"get inputs","rules":[{"t":"set","p":"tls","pt":"msg","to":"false","tot":"bool"}],"action":"","property":"","from":"","to":"","reg":false,"x":360,"y":1280,"wires":[["4fb8ae3d.00b28"]]},{"id":"f43da39b.12822","type":"http request","z":"440d357f.2f371c","name":"get flows","method":"GET","ret":"obj","paytoqs":"ignore","url":"https://localhost:1880/flows","tls":"b1a419c1.609c29","persist":false,"proxy":"","authType":"","x":1880,"y":1280,"wires":[["d5df1595.501ed8"]]},{"id":"783a0716.a55528","type":"http response","z":"440d357f.2f371c","name":"","statusCode":"","headers":{},"x":2890,"y":1280,"wires":[]},{"id":"9515de32.8f636","type":"change","z":"440d357f.2f371c","name":"","rules":[{"t":"set","p":"headers","pt":"msg","to":"{\"Content-Type\":\"text/plain\"}","tot":"json"}],"action":"","property":"","from":"","to":"","reg":false,"x":2720,"y":1280,"wires":[["783a0716.a55528","bcae30a8.c249f"]]},{"id":"8ea50ac7.86a598","type":"http request","z":"440d357f.2f371c","name":"get flows","method":"GET","ret":"obj","paytoqs":"ignore","url":"https://localhost:1880/flows","tls":"b1a419c1.609c29","persist":false,"proxy":"","authType":"","x":1600,"y":1380,"wires":[["a5a9ac26.ee115"]]},{"id":"179a6219.3ddbbe","type":"http request","z":"440d357f.2f371c","name":"auth","method":"POST","ret":"obj","paytoqs":"ignore","url":"https://localhost:1880/auth/token","tls":"b1a419c1.609c29","persist":false,"proxy":"","authType":"","x":1210,"y":1280,"wires":[["2007af71.bcbd1"]]},{"id":"1f3f270c.e0c769","type":"change","z":"440d357f.2f371c","name":"auth payload","rules":[{"t":"set","p":"payload","pt":"msg","to":"{}","tot":"json"},{"t":"set","p":"payload.client_id","pt":"msg","to":"node-red-editor","tot":"str"},{"t":"set","p":"payload.grant_type","pt":"msg","to":"password","tot":"str"},{"t":"set","p":"payload.scope","pt":"msg","to":"","tot":"str"},{"t":"set","p":"payload.username","pt":"msg","to":"NRADM_USER","tot":"env"},{"t":"set","p":"payload.password","pt":"msg","to":"NRADM_PASS","tot":"env"}],"action":"","property":"","from":"","to":"","reg":false,"x":1050,"y":1280,"wires":[["179a6219.3ddbbe"]]},{"id":"d071cdb1.d8a81","type":"change","z":"440d357f.2f371c","name":"","rules":[{"t":"set","p":"accessToken","pt":"msg","to":"payload.access_token","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":1540,"y":1280,"wires":[["529e9048.965ac"]]},{"id":"529e9048.965ac","type":"change","z":"440d357f.2f371c","name":"bearer","rules":[{"t":"set","p":"headers","pt":"msg","to":"{}","tot":"json"},{"t":"set","p":"headers.authorization","pt":"msg","to":"\"Bearer \" & msg.accessToken","tot":"jsonata"}],"action":"","property":"","from":"","to":"","reg":false,"x":1730,"y":1280,"wires":[["f43da39b.12822"]]},{"id":"35a7f5ae.797fea","type":"http request","z":"440d357f.2f371c","name":"auth","method":"POST","ret":"obj","paytoqs":"ignore","url":"https://localhost:1880/auth/token","tls":"b1a419c1.609c29","persist":false,"proxy":"","authType":"","x":930,"y":1380,"wires":[["3c6858f5.8ce938"]]},{"id":"dfe15971.d03cb8","type":"change","z":"440d357f.2f371c","name":"auth payload","rules":[{"t":"set","p":"payload.client_id","pt":"msg","to":"node-red-editor","tot":"str"},{"t":"set","p":"payload.grant_type","pt":"msg","to":"password","tot":"str"},{"t":"set","p":"payload.scope","pt":"msg","to":"","tot":"str"},{"t":"set","p":"payload.username","pt":"msg","to":"NRADM_USER","tot":"env"},{"t":"set","p":"payload.password","pt":"msg","to":"NRADM_PASS","tot":"env"}],"action":"","property":"","from":"","to":"","reg":false,"x":770,"y":1380,"wires":[["35a7f5ae.797fea"]]},{"id":"f6309c38.f65b4","type":"change","z":"440d357f.2f371c","name":"","rules":[{"t":"set","p":"accessToken","pt":"msg","to":"payload.access_token","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":1260,"y":1380,"wires":[["de65afef.8a973"]]},{"id":"de65afef.8a973","type":"change","z":"440d357f.2f371c","name":"bearer","rules":[{"t":"set","p":"headers","pt":"msg","to":"{}","tot":"json"},{"t":"set","p":"headers.authorization","pt":"msg","to":"\"Bearer \" & msg.accessToken","tot":"jsonata"}],"action":"","property":"","from":"","to":"","reg":false,"x":1450,"y":1380,"wires":[["8ea50ac7.86a598"]]},{"id":"a3a01b18.46d998","type":"http request","z":"440d357f.2f371c","name":"","method":"POST","ret":"obj","paytoqs":"ignore","url":"${CFG_ACL_ENDP}","tls":"51b09598.a1114d","persist":false,"proxy":"","authType":"","x":730,"y":1280,"wires":[["d7058755.a91538"]]},{"id":"d7058755.a91538","type":"switch","z":"440d357f.2f371c","name":"","property":"statusCode","propertyType":"msg","rules":[{"t":"eq","v":"200","vt":"num"},{"t":"else"}],"checkall":"true","repair":false,"outputs":2,"x":890,"y":1280,"wires":[["1f3f270c.e0c769"],["c79dd8fd.fcf708"]]},{"id":"61662e2c.25a9e","type":"http request","z":"440d357f.2f371c","name":"","method":"POST","ret":"obj","paytoqs":"ignore","url":"${CFG_ACL_ENDP}","tls":"51b09598.a1114d","persist":false,"proxy":"","authType":"","x":450,"y":1380,"wires":[["3f156713.ae1518"]]},{"id":"3f156713.ae1518","type":"switch","z":"440d357f.2f371c","name":"","property":"statusCode","propertyType":"msg","rules":[{"t":"eq","v":"200","vt":"num"},{"t":"else"}],"checkall":"true","repair":false,"outputs":2,"x":610,"y":1380,"wires":[["dfe15971.d03cb8"],["4f640cdd.636804"]]},{"id":"6e85d462.7edefc","type":"change","z":"440d357f.2f371c","name":"acl req payload","rules":[{"t":"set","p":"headers","pt":"msg","to":"{}","tot":"json"},{"t":"set","p":"payload","pt":"msg","to":"{}","tot":"json"},{"t":"set","p":"payload.url","pt":"msg","to":"req.url","tot":"msg"},{"t":"set","p":"payload.method","pt":"msg","to":"req.method","tot":"msg"},{"t":"set","p":"payload.headers","pt":"msg","to":"req.headers","tot":"msg"},{"t":"set","p":"payload.params","pt":"msg","to":"req.params","tot":"msg"},{"t":"set","p":"payload.query","pt":"msg","to":"req.query","tot":"msg"},{"t":"set","p":"payload.body","pt":"msg","to":"req.body","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":260,"y":1380,"wires":[["61662e2c.25a9e"]]},{"id":"4fb8ae3d.00b28","type":"change","z":"440d357f.2f371c","name":"acl req payload","rules":[{"t":"set","p":"headers","pt":"msg","to":"{}","tot":"json"},{"t":"set","p":"payload","pt":"msg","to":"{}","tot":"json"},{"t":"set","p":"payload.url","pt":"msg","to":"req.url","tot":"msg"},{"t":"set","p":"payload.method","pt":"msg","to":"req.method","tot":"msg"},{"t":"set","p":"payload.headers","pt":"msg","to":"req.headers","tot":"msg"},{"t":"set","p":"payload.params","pt":"msg","to":"req.params","tot":"msg"},{"t":"set","p":"payload.query","pt":"msg","to":"req.query","tot":"msg"},{"t":"set","p":"payload.body","pt":"msg","to":"req.body","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":540,"y":1280,"wires":[["a3a01b18.46d998"]]},{"id":"4f640cdd.636804","type":"http response","z":"440d357f.2f371c","name":"","statusCode":"","headers":{},"x":750,"y":1420,"wires":[]},{"id":"e68b97cc.c7df08","type":"change","z":"440d357f.2f371c","name":"","rules":[{"t":"set","p":"payload","pt":"msg","to":"*[name = \"dbtail mysql server config\" and type=\"Stackhero-MySQL-Server\"].tls ? \"yes\" : \"no\"","tot":"jsonata"}],"action":"","property":"","from":"","to":"","reg":false,"x":1920,"y":1380,"wires":[["3eb7fa17.b52366"]]},{"id":"5ff459ec.d73808","type":"change","z":"440d357f.2f371c","name":"edit","rules":[{"t":"set","p":"old","pt":"msg","to":"*[name = \"dbtail mysql server config\" and type=\"Stackhero-MySQL-Server\"]","tot":"jsonata"},{"t":"set","p":"new","pt":"msg","to":"old","tot":"msg"},{"t":"set","p":"new.tls","pt":"msg","to":"tls","tot":"msg"},{"t":"set","p":"payload","pt":"msg","to":"$eval($replace($string(payload),$string(old),$string(new)))","tot":"jsonata"}],"action":"","property":"","from":"","to":"","reg":false,"x":2170,"y":1280,"wires":[["b6fbbd27.f0ac9"]]},{"id":"c79dd8fd.fcf708","type":"http response","z":"440d357f.2f371c","name":"","statusCode":"","headers":{},"x":1030,"y":1320,"wires":[]},{"id":"2007af71.bcbd1","type":"switch","z":"440d357f.2f371c","name":"","property":"statusCode","propertyType":"msg","rules":[{"t":"eq","v":"200","vt":"num"},{"t":"else"}],"checkall":"true","repair":false,"outputs":2,"x":1350,"y":1280,"wires":[["d071cdb1.d8a81"],["3f4a4bb2.6155a4"]]},{"id":"3f4a4bb2.6155a4","type":"http response","z":"440d357f.2f371c","name":"","statusCode":"","headers":{},"x":1490,"y":1320,"wires":[]},{"id":"d5df1595.501ed8","type":"switch","z":"440d357f.2f371c","name":"","property":"statusCode","propertyType":"msg","rules":[{"t":"eq","v":"200","vt":"num"},{"t":"else"}],"checkall":"true","repair":false,"outputs":2,"x":2030,"y":1280,"wires":[["5ff459ec.d73808"],["f0f76e34.d3936"]]},{"id":"f0f76e34.d3936","type":"http response","z":"440d357f.2f371c","name":"","statusCode":"","headers":{},"x":2170,"y":1320,"wires":[]},{"id":"b6fbbd27.f0ac9","type":"function","z":"440d357f.2f371c","name":"update flows","func":"const http = global.get('https');\nconst data = JSON.stringify(msg.payload);\nconst options = {\n  hostname: 'localhost',\n  port: 1880,\n  path: '/flows',\n  method: 'POST',\n  headers: {\n    'Content-Type': 'application/json',\n    'Content-Length': data.length,\n    'Authorization': 'Bearer '+msg.accessToken\n  },\n  rejectUnauthorized: false\n};\nconst req = http.request(options);\nreq.write(data);\nreq.end();\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":2330,"y":1280,"wires":[["29f55ecc.f09062"]]},{"id":"3c6858f5.8ce938","type":"switch","z":"440d357f.2f371c","name":"","property":"statusCode","propertyType":"msg","rules":[{"t":"eq","v":"200","vt":"num"},{"t":"else"}],"checkall":"true","repair":false,"outputs":2,"x":1070,"y":1380,"wires":[["f6309c38.f65b4"],["8a887200.ad1cb"]]},{"id":"8a887200.ad1cb","type":"http response","z":"440d357f.2f371c","name":"","statusCode":"","headers":{},"x":1210,"y":1420,"wires":[]},{"id":"a5a9ac26.ee115","type":"switch","z":"440d357f.2f371c","name":"","property":"statusCode","propertyType":"msg","rules":[{"t":"eq","v":"200","vt":"num"},{"t":"else"}],"checkall":"true","repair":false,"outputs":2,"x":1750,"y":1380,"wires":[["e68b97cc.c7df08"],["4d3894c4.e5821c"]]},{"id":"4d3894c4.e5821c","type":"http response","z":"440d357f.2f371c","name":"","statusCode":"","headers":{},"x":1890,"y":1420,"wires":[]},{"id":"bcae30a8.c249f","type":"change","z":"440d357f.2f371c","name":"status","rules":[{"t":"set","p":"payload","pt":"msg","to":"{}","tot":"json"},{"t":"set","p":"payload.text","pt":"msg","to":"\"tls: \" & tls","tot":"jsonata"},{"t":"set","p":"payload.shape","pt":"msg","to":"dot","tot":"str"},{"t":"set","p":"payload.fill","pt":"msg","to":"grey","tot":"str"}],"action":"","property":"","from":"","to":"","reg":false,"x":2890,"y":1340,"wires":[[]]},{"id":"1e28d111.ff84bf","type":"switch","z":"440d357f.2f371c","name":"","property":"payload","propertyType":"msg","rules":[{"t":"eq","v":"yes","vt":"str"},{"t":"eq","v":"no","vt":"str"},{"t":"else"}],"checkall":"true","repair":false,"outputs":3,"x":210,"y":1280,"wires":[["92d65d12.4c16b"],["7091ab6.9593c54"],["eb342e4e.5e3ad"]]},{"id":"eb342e4e.5e3ad","type":"change","z":"440d357f.2f371c","name":"get inputs","rules":[{"t":"set","p":"payload","pt":"msg","to":"Allowed values: yes, no.","tot":"str"}],"action":"","property":"","from":"","to":"","reg":false,"x":360,"y":1320,"wires":[["b20e7a6e.51a378"]]},{"id":"92d65d12.4c16b","type":"change","z":"440d357f.2f371c","name":"get inputs","rules":[{"t":"set","p":"tls","pt":"msg","to":"true","tot":"bool"}],"action":"","property":"","from":"","to":"","reg":false,"x":360,"y":1240,"wires":[["4fb8ae3d.00b28"]]},{"id":"b20e7a6e.51a378","type":"http response","z":"440d357f.2f371c","name":"","statusCode":"400","headers":{},"x":520,"y":1320,"wires":[]},{"id":"c88f7618.1d6408","type":"switch","z":"440d357f.2f371c","name":"","property":"payload","propertyType":"msg","rules":[{"t":"nempty"},{"t":"else"}],"checkall":"true","repair":false,"outputs":2,"x":590,"y":1720,"wires":[["3c5252bb.77294e"],["59ef9561.2ad03c"]]},{"id":"496bcdd4.325114","type":"http in","z":"440d357f.2f371c","name":"PUT credentials","url":"/dbtail/credentials","method":"put","upload":false,"swaggerDoc":"","x":100,"y":1500,"wires":[["71907b56.9ee7f4"]]},{"id":"71907b56.9ee7f4","type":"change","z":"440d357f.2f371c","name":"get inputs","rules":[{"t":"set","p":"user","pt":"msg","to":"payload.user","tot":"msg"},{"t":"set","p":"password","pt":"msg","to":"payload.password","tot":"msg"},{"t":"set","p":"nodeName","pt":"msg","to":"req.params.nodeName","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":280,"y":1500,"wires":[["29bc2af3.224dc6"]]},{"id":"40f23ef0.d235e","type":"http request","z":"440d357f.2f371c","name":"get flows","method":"GET","ret":"obj","paytoqs":"ignore","url":"https://localhost:1880/flows","tls":"b1a419c1.609c29","persist":false,"proxy":"","authType":"","x":1800,"y":1500,"wires":[["f8d5cfe0.29b41"]]},{"id":"a9ccb331.b40fb","type":"function","z":"440d357f.2f371c","name":"update flows","func":"const http = global.get('https');\nconst data = JSON.stringify(msg.payload);\nconst options = {\n  hostname: 'localhost',\n  port: 1880,\n  path: '/flows',\n  method: 'POST',\n  headers: {\n    'Content-Type': 'application/json',\n    'Content-Length': data.length,\n    'Authorization': 'Bearer '+msg.accessToken\n  },\n  rejectUnauthorized: false\n};\nconst req = http.request(options);\nreq.write(data);\nreq.end();\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":2250,"y":1500,"wires":[["f9654820.bdfd58"]]},{"id":"f9654820.bdfd58","type":"change","z":"440d357f.2f371c","name":"set payload","rules":[{"t":"set","p":"payload","pt":"msg","to":"{}","tot":"json"},{"t":"set","p":"payload.user","pt":"msg","to":"user","tot":"msg"},{"t":"set","p":"payload.password","pt":"msg","to":"password","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":2430,"y":1500,"wires":[["b518fbcb.ad3868"]]},{"id":"b518fbcb.ad3868","type":"change","z":"440d357f.2f371c","name":"","rules":[{"t":"set","p":"headers","pt":"msg","to":"{\"Content-Type\":\"application/json\"}","tot":"json"}],"action":"","property":"","from":"","to":"","reg":false,"x":2620,"y":1500,"wires":[["f5be6d73.9232a","81229b66.07d2d8"]]},{"id":"f5be6d73.9232a","type":"http response","z":"440d357f.2f371c","name":"","statusCode":"","headers":{},"x":2790,"y":1500,"wires":[]},{"id":"3b2f5ef7.d8a0e2","type":"http request","z":"440d357f.2f371c","name":"auth","method":"POST","ret":"obj","paytoqs":"ignore","url":"https://localhost:1880/auth/token","tls":"b1a419c1.609c29","persist":false,"proxy":"","authType":"","x":1130,"y":1500,"wires":[["30019adb.590e66"]]},{"id":"4b261f0c.23717","type":"change","z":"440d357f.2f371c","name":"auth payload","rules":[{"t":"set","p":"payload","pt":"msg","to":"{}","tot":"json"},{"t":"set","p":"payload.client_id","pt":"msg","to":"node-red-editor","tot":"str"},{"t":"set","p":"payload.grant_type","pt":"msg","to":"password","tot":"str"},{"t":"set","p":"payload.scope","pt":"msg","to":"","tot":"str"},{"t":"set","p":"payload.username","pt":"msg","to":"NRADM_USER","tot":"env"},{"t":"set","p":"payload.password","pt":"msg","to":"NRADM_PASS","tot":"env"}],"action":"","property":"","from":"","to":"","reg":false,"x":970,"y":1500,"wires":[["3b2f5ef7.d8a0e2"]]},{"id":"c091e361.70a33","type":"change","z":"440d357f.2f371c","name":"","rules":[{"t":"set","p":"accessToken","pt":"msg","to":"payload.access_token","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":1460,"y":1500,"wires":[["e8c574c6.fcd508"]]},{"id":"e8c574c6.fcd508","type":"change","z":"440d357f.2f371c","name":"bearer","rules":[{"t":"set","p":"headers","pt":"msg","to":"{}","tot":"json"},{"t":"set","p":"headers.authorization","pt":"msg","to":"\"Bearer \" & msg.accessToken","tot":"jsonata"}],"action":"","property":"","from":"","to":"","reg":false,"x":1650,"y":1500,"wires":[["40f23ef0.d235e"]]},{"id":"ad50170a.5bd958","type":"http request","z":"440d357f.2f371c","name":"","method":"POST","ret":"obj","paytoqs":"ignore","url":"${CFG_ACL_ENDP}","tls":"51b09598.a1114d","persist":false,"proxy":"","authType":"","x":650,"y":1500,"wires":[["fdca1170.c0d6a"]]},{"id":"fdca1170.c0d6a","type":"switch","z":"440d357f.2f371c","name":"","property":"statusCode","propertyType":"msg","rules":[{"t":"eq","v":"200","vt":"num"},{"t":"else"}],"checkall":"true","repair":false,"outputs":2,"x":810,"y":1500,"wires":[["4b261f0c.23717"],["87bb2ca8.133ef"]]},{"id":"29bc2af3.224dc6","type":"change","z":"440d357f.2f371c","name":"acl req payload","rules":[{"t":"set","p":"headers","pt":"msg","to":"{}","tot":"json"},{"t":"set","p":"payload","pt":"msg","to":"{}","tot":"json"},{"t":"set","p":"payload.url","pt":"msg","to":"req.url","tot":"msg"},{"t":"set","p":"payload.method","pt":"msg","to":"req.method","tot":"msg"},{"t":"set","p":"payload.headers","pt":"msg","to":"req.headers","tot":"msg"},{"t":"set","p":"payload.params","pt":"msg","to":"req.params","tot":"msg"},{"t":"set","p":"payload.query","pt":"msg","to":"req.query","tot":"msg"},{"t":"set","p":"payload.body","pt":"msg","to":"req.body","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":460,"y":1500,"wires":[["ad50170a.5bd958"]]},{"id":"87bb2ca8.133ef","type":"http response","z":"440d357f.2f371c","name":"","statusCode":"","headers":{},"x":950,"y":1540,"wires":[]},{"id":"dafe10ea.17852","type":"change","z":"440d357f.2f371c","name":"edit","rules":[{"t":"set","p":"old","pt":"msg","to":"*[name = \"dbtail mysql server config\" and type = \"Stackhero-MySQL-Server\"]","tot":"jsonata"},{"t":"set","p":"new","pt":"msg","to":"old","tot":"msg"},{"t":"set","p":"new.credentials","pt":"msg","to":"{}","tot":"json"},{"t":"set","p":"new.credentials.user","pt":"msg","to":"user","tot":"msg"},{"t":"set","p":"new.credentials.password","pt":"msg","to":"password","tot":"msg"},{"t":"set","p":"payload","pt":"msg","to":"$eval($replace($string(payload),$string(old),$string(new)))","tot":"jsonata"}],"action":"","property":"","from":"","to":"","reg":false,"x":2090,"y":1500,"wires":[["a9ccb331.b40fb"]]},{"id":"30019adb.590e66","type":"switch","z":"440d357f.2f371c","name":"","property":"statusCode","propertyType":"msg","rules":[{"t":"eq","v":"200","vt":"num"},{"t":"else"}],"checkall":"true","repair":false,"outputs":2,"x":1270,"y":1500,"wires":[["c091e361.70a33"],["38c515a5.3d10aa"]]},{"id":"38c515a5.3d10aa","type":"http response","z":"440d357f.2f371c","name":"","statusCode":"","headers":{},"x":1410,"y":1540,"wires":[]},{"id":"f8d5cfe0.29b41","type":"switch","z":"440d357f.2f371c","name":"","property":"statusCode","propertyType":"msg","rules":[{"t":"eq","v":"200","vt":"num"},{"t":"else"}],"checkall":"true","repair":false,"outputs":2,"x":1950,"y":1500,"wires":[["dafe10ea.17852"],["4bc27118.59d45"]]},{"id":"4bc27118.59d45","type":"http response","z":"440d357f.2f371c","name":"","statusCode":"","headers":{},"x":2090,"y":1540,"wires":[]},{"id":"40c4a6c1.2aa678","type":"http in","z":"440d357f.2f371c","name":"PUT database","url":"/dbtail/database","method":"put","upload":false,"swaggerDoc":"","x":90,"y":240,"wires":[["2af25c90.837794"]]},{"id":"d4b65c56.541c1","type":"change","z":"440d357f.2f371c","name":"","rules":[{"t":"set","p":"payload","pt":"msg","to":"dbname","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":2400,"y":240,"wires":[["aa82515c.3489b"]]},{"id":"e3a0135.83294f","type":"http in","z":"440d357f.2f371c","name":"GET database","url":"/dbtail/database","method":"get","upload":false,"swaggerDoc":"","x":90,"y":340,"wires":[["e27c6329.5b8b7"]]},{"id":"5fdfd85f.665398","type":"http response","z":"440d357f.2f371c","name":"","statusCode":"","headers":{},"x":2290,"y":340,"wires":[]},{"id":"32fa86b1.42c8ea","type":"change","z":"440d357f.2f371c","name":"","rules":[{"t":"set","p":"headers","pt":"msg","to":"{\"Content-Type\":\"text/plain\"}","tot":"json"}],"action":"","property":"","from":"","to":"","reg":false,"x":2120,"y":340,"wires":[["5fdfd85f.665398"]]},{"id":"2af25c90.837794","type":"change","z":"440d357f.2f371c","name":"get inputs","rules":[{"t":"set","p":"dbname","pt":"msg","to":"payload","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":240,"y":240,"wires":[["bd29c8a0.dd8a18"]]},{"id":"487604a1.b52f1c","type":"http request","z":"440d357f.2f371c","name":"get flows","method":"GET","ret":"obj","paytoqs":"ignore","url":"https://localhost:1880/flows","tls":"b1a419c1.609c29","persist":false,"proxy":"","authType":"","x":1760,"y":240,"wires":[["a070a7ae.4e7cb8"]]},{"id":"4f1bd05b.f0567","type":"http response","z":"440d357f.2f371c","name":"","statusCode":"","headers":{},"x":2770,"y":240,"wires":[]},{"id":"aa82515c.3489b","type":"change","z":"440d357f.2f371c","name":"","rules":[{"t":"set","p":"headers","pt":"msg","to":"{\"Content-Type\":\"text/plain\"}","tot":"json"}],"action":"","property":"","from":"","to":"","reg":false,"x":2600,"y":240,"wires":[["4f1bd05b.f0567","be14788e.3506c8"]]},{"id":"44e13f43.acb8","type":"http request","z":"440d357f.2f371c","name":"get flows","method":"GET","ret":"obj","paytoqs":"ignore","url":"https://localhost:1880/flows","tls":"b1a419c1.609c29","persist":false,"proxy":"","authType":"","x":1600,"y":340,"wires":[["5c1bc2f9.bcd22c"]]},{"id":"e575fa16.485058","type":"http request","z":"440d357f.2f371c","name":"auth","method":"POST","ret":"obj","paytoqs":"ignore","url":"https://localhost:1880/auth/token","tls":"b1a419c1.609c29","persist":false,"proxy":"","authType":"","x":1090,"y":240,"wires":[["45c324a6.3d9bec"]]},{"id":"ef926c9c.1e6","type":"change","z":"440d357f.2f371c","name":"auth payload","rules":[{"t":"set","p":"payload","pt":"msg","to":"{}","tot":"json"},{"t":"set","p":"payload.client_id","pt":"msg","to":"node-red-editor","tot":"str"},{"t":"set","p":"payload.grant_type","pt":"msg","to":"password","tot":"str"},{"t":"set","p":"payload.scope","pt":"msg","to":"","tot":"str"},{"t":"set","p":"payload.username","pt":"msg","to":"NRADM_USER","tot":"env"},{"t":"set","p":"payload.password","pt":"msg","to":"NRADM_PASS","tot":"env"}],"action":"","property":"","from":"","to":"","reg":false,"x":930,"y":240,"wires":[["e575fa16.485058"]]},{"id":"69b0f4c7.451d0c","type":"change","z":"440d357f.2f371c","name":"","rules":[{"t":"set","p":"accessToken","pt":"msg","to":"payload.access_token","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":1420,"y":240,"wires":[["497e8f9f.6f2b"]]},{"id":"497e8f9f.6f2b","type":"change","z":"440d357f.2f371c","name":"bearer","rules":[{"t":"set","p":"headers","pt":"msg","to":"{}","tot":"json"},{"t":"set","p":"headers.authorization","pt":"msg","to":"\"Bearer \" & msg.accessToken","tot":"jsonata"}],"action":"","property":"","from":"","to":"","reg":false,"x":1610,"y":240,"wires":[["487604a1.b52f1c"]]},{"id":"5cd424b.00857dc","type":"http request","z":"440d357f.2f371c","name":"auth","method":"POST","ret":"obj","paytoqs":"ignore","url":"https://localhost:1880/auth/token","tls":"b1a419c1.609c29","persist":false,"proxy":"","authType":"","x":930,"y":340,"wires":[["1d85e4c5.f7620b"]]},{"id":"fd321d63.06bbb","type":"change","z":"440d357f.2f371c","name":"auth payload","rules":[{"t":"set","p":"payload.client_id","pt":"msg","to":"node-red-editor","tot":"str"},{"t":"set","p":"payload.grant_type","pt":"msg","to":"password","tot":"str"},{"t":"set","p":"payload.scope","pt":"msg","to":"","tot":"str"},{"t":"set","p":"payload.username","pt":"msg","to":"NRADM_USER","tot":"env"},{"t":"set","p":"payload.password","pt":"msg","to":"NRADM_PASS","tot":"env"}],"action":"","property":"","from":"","to":"","reg":false,"x":770,"y":340,"wires":[["5cd424b.00857dc"]]},{"id":"6512253c.74fa7c","type":"change","z":"440d357f.2f371c","name":"","rules":[{"t":"set","p":"accessToken","pt":"msg","to":"payload.access_token","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":1260,"y":340,"wires":[["893ad422.ac0608"]]},{"id":"893ad422.ac0608","type":"change","z":"440d357f.2f371c","name":"bearer","rules":[{"t":"set","p":"headers","pt":"msg","to":"{}","tot":"json"},{"t":"set","p":"headers.authorization","pt":"msg","to":"\"Bearer \" & msg.accessToken","tot":"jsonata"}],"action":"","property":"","from":"","to":"","reg":false,"x":1450,"y":340,"wires":[["44e13f43.acb8"]]},{"id":"d57f7072.da6f4","type":"http request","z":"440d357f.2f371c","name":"","method":"POST","ret":"obj","paytoqs":"ignore","url":"${CFG_ACL_ENDP}","tls":"51b09598.a1114d","persist":false,"proxy":"","authType":"","x":610,"y":240,"wires":[["f8aa2a8.8ec71d8"]]},{"id":"f8aa2a8.8ec71d8","type":"switch","z":"440d357f.2f371c","name":"","property":"statusCode","propertyType":"msg","rules":[{"t":"eq","v":"200","vt":"num"},{"t":"else"}],"checkall":"true","repair":false,"outputs":2,"x":770,"y":240,"wires":[["ef926c9c.1e6"],["ffd49ab.561db68"]]},{"id":"79fbdf46.a2c5f","type":"http request","z":"440d357f.2f371c","name":"","method":"POST","ret":"obj","paytoqs":"ignore","url":"${CFG_ACL_ENDP}","tls":"51b09598.a1114d","persist":false,"proxy":"","authType":"","x":450,"y":340,"wires":[["f1884f3.c46bdb"]]},{"id":"f1884f3.c46bdb","type":"switch","z":"440d357f.2f371c","name":"","property":"statusCode","propertyType":"msg","rules":[{"t":"eq","v":"200","vt":"num"},{"t":"else"}],"checkall":"true","repair":false,"outputs":2,"x":610,"y":340,"wires":[["fd321d63.06bbb"],["59c1a40d.ce7e5c"]]},{"id":"e27c6329.5b8b7","type":"change","z":"440d357f.2f371c","name":"acl req payload","rules":[{"t":"set","p":"headers","pt":"msg","to":"{}","tot":"json"},{"t":"set","p":"payload","pt":"msg","to":"{}","tot":"json"},{"t":"set","p":"payload.url","pt":"msg","to":"req.url","tot":"msg"},{"t":"set","p":"payload.method","pt":"msg","to":"req.method","tot":"msg"},{"t":"set","p":"payload.headers","pt":"msg","to":"req.headers","tot":"msg"},{"t":"set","p":"payload.params","pt":"msg","to":"req.params","tot":"msg"},{"t":"set","p":"payload.query","pt":"msg","to":"req.query","tot":"msg"},{"t":"set","p":"payload.body","pt":"msg","to":"req.body","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":260,"y":340,"wires":[["79fbdf46.a2c5f"]]},{"id":"bd29c8a0.dd8a18","type":"change","z":"440d357f.2f371c","name":"acl req payload","rules":[{"t":"set","p":"headers","pt":"msg","to":"{}","tot":"json"},{"t":"set","p":"payload","pt":"msg","to":"{}","tot":"json"},{"t":"set","p":"payload.url","pt":"msg","to":"req.url","tot":"msg"},{"t":"set","p":"payload.method","pt":"msg","to":"req.method","tot":"msg"},{"t":"set","p":"payload.headers","pt":"msg","to":"req.headers","tot":"msg"},{"t":"set","p":"payload.params","pt":"msg","to":"req.params","tot":"msg"},{"t":"set","p":"payload.query","pt":"msg","to":"req.query","tot":"msg"},{"t":"set","p":"payload.body","pt":"msg","to":"req.body","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":420,"y":240,"wires":[["d57f7072.da6f4"]]},{"id":"59c1a40d.ce7e5c","type":"http response","z":"440d357f.2f371c","name":"","statusCode":"","headers":{},"x":750,"y":380,"wires":[]},{"id":"c231e04d.f1cb2","type":"change","z":"440d357f.2f371c","name":"","rules":[{"t":"set","p":"payload","pt":"msg","to":"*[name = \"dbtail mysql server config\" and type=\"Stackhero-MySQL-Server\"].database","tot":"jsonata"}],"action":"","property":"","from":"","to":"","reg":false,"x":1920,"y":340,"wires":[["32fa86b1.42c8ea"]]},{"id":"18ffc907.068147","type":"change","z":"440d357f.2f371c","name":"edit","rules":[{"t":"set","p":"old","pt":"msg","to":"*[name = \"dbtail mysql server config\" and type=\"Stackhero-MySQL-Server\"]","tot":"jsonata"},{"t":"set","p":"new","pt":"msg","to":"old","tot":"msg"},{"t":"set","p":"new.database","pt":"msg","to":"dbname","tot":"msg"},{"t":"set","p":"payload","pt":"msg","to":"$eval($replace($string(payload),$string(old),$string(new)))","tot":"jsonata"}],"action":"","property":"","from":"","to":"","reg":false,"x":2050,"y":240,"wires":[["61eb97bf.9cb4e8"]]},{"id":"ffd49ab.561db68","type":"http response","z":"440d357f.2f371c","name":"","statusCode":"","headers":{},"x":910,"y":280,"wires":[]},{"id":"45c324a6.3d9bec","type":"switch","z":"440d357f.2f371c","name":"","property":"statusCode","propertyType":"msg","rules":[{"t":"eq","v":"200","vt":"num"},{"t":"else"}],"checkall":"true","repair":false,"outputs":2,"x":1230,"y":240,"wires":[["69b0f4c7.451d0c"],["3344cef3.c1c912"]]},{"id":"3344cef3.c1c912","type":"http response","z":"440d357f.2f371c","name":"","statusCode":"","headers":{},"x":1370,"y":280,"wires":[]},{"id":"a070a7ae.4e7cb8","type":"switch","z":"440d357f.2f371c","name":"","property":"statusCode","propertyType":"msg","rules":[{"t":"eq","v":"200","vt":"num"},{"t":"else"}],"checkall":"true","repair":false,"outputs":2,"x":1910,"y":240,"wires":[["18ffc907.068147"],["1ee43f1c.815ba1"]]},{"id":"1ee43f1c.815ba1","type":"http response","z":"440d357f.2f371c","name":"","statusCode":"","headers":{},"x":2050,"y":280,"wires":[]},{"id":"61eb97bf.9cb4e8","type":"function","z":"440d357f.2f371c","name":"update flows","func":"const http = global.get('https');\nconst data = JSON.stringify(msg.payload);\nconst options = {\n  hostname: 'localhost',\n  port: 1880,\n  path: '/flows',\n  method: 'POST',\n  headers: {\n    'Content-Type': 'application/json',\n    'Content-Length': data.length,\n    'Authorization': 'Bearer '+msg.accessToken\n  },\n  rejectUnauthorized: false\n};\nconst req = http.request(options);\nreq.write(data);\nreq.end();\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":2210,"y":240,"wires":[["d4b65c56.541c1"]]},{"id":"1d85e4c5.f7620b","type":"switch","z":"440d357f.2f371c","name":"","property":"statusCode","propertyType":"msg","rules":[{"t":"eq","v":"200","vt":"num"},{"t":"else"}],"checkall":"true","repair":false,"outputs":2,"x":1070,"y":340,"wires":[["6512253c.74fa7c"],["3d124083.bb095"]]},{"id":"3d124083.bb095","type":"http response","z":"440d357f.2f371c","name":"","statusCode":"","headers":{},"x":1210,"y":380,"wires":[]},{"id":"5c1bc2f9.bcd22c","type":"switch","z":"440d357f.2f371c","name":"","property":"statusCode","propertyType":"msg","rules":[{"t":"eq","v":"200","vt":"num"},{"t":"else"}],"checkall":"true","repair":false,"outputs":2,"x":1750,"y":340,"wires":[["c231e04d.f1cb2"],["a4f64b8c.5afc78"]]},{"id":"a4f64b8c.5afc78","type":"http response","z":"440d357f.2f371c","name":"","statusCode":"","headers":{},"x":1890,"y":380,"wires":[]},{"id":"be14788e.3506c8","type":"change","z":"440d357f.2f371c","name":"status","rules":[{"t":"set","p":"payload","pt":"msg","to":"{}","tot":"json"},{"t":"set","p":"payload.text","pt":"msg","to":"\"database: \" & dbname","tot":"jsonata"},{"t":"set","p":"payload.shape","pt":"msg","to":"dot","tot":"str"},{"t":"set","p":"payload.fill","pt":"msg","to":"grey","tot":"str"}],"action":"","property":"","from":"","to":"","reg":false,"x":2770,"y":300,"wires":[[]]},{"id":"81229b66.07d2d8","type":"change","z":"440d357f.2f371c","name":"status","rules":[{"t":"set","p":"payload","pt":"msg","to":"{}","tot":"json"},{"t":"set","p":"payload.text","pt":"msg","to":"DB credentials updated.","tot":"str"},{"t":"set","p":"payload.shape","pt":"msg","to":"dot","tot":"str"},{"t":"set","p":"payload.fill","pt":"msg","to":"grey","tot":"str"}],"action":"","property":"","from":"","to":"","reg":false,"x":2790,"y":1560,"wires":[[]]},{"id":"59ef9561.2ad03c","type":"change","z":"440d357f.2f371c","name":"status","rules":[{"t":"set","p":"payload","pt":"msg","to":"{}","tot":"json"},{"t":"set","p":"payload.text","pt":"msg","to":"no recent changes","tot":"str"},{"t":"set","p":"payload.shape","pt":"msg","to":"ring","tot":"str"},{"t":"set","p":"payload.fill","pt":"msg","to":"green","tot":"str"}],"action":"","property":"","from":"","to":"","reg":false,"x":750,"y":1740,"wires":[[]]},{"id":"3c5252bb.77294e","type":"change","z":"440d357f.2f371c","name":"status","rules":[{"t":"set","p":"changes","pt":"msg","to":"payload.length","tot":"msg"},{"t":"set","p":"payload","pt":"msg","to":"{}","tot":"json"},{"t":"set","p":"payload.text","pt":"msg","to":"changes & \" recent change(s)\"","tot":"jsonata"},{"t":"set","p":"payload.shape","pt":"msg","to":"dot","tot":"str"},{"t":"set","p":"payload.fill","pt":"msg","to":"green","tot":"str"}],"action":"","property":"","from":"","to":"","reg":false,"x":750,"y":1700,"wires":[[]]},{"id":"2138ff5e.ffe87","type":"Stackhero-MySQL","z":"5bbedfa3.e6454","server":"84be6cee.0293c","name":"dbread","x":360,"y":1420,"wires":[["695b34fd.215afc"]]},{"id":"5574250e.49e45c","type":"change","z":"5bbedfa3.e6454","name":"dbread settings","rules":[{"t":"set","p":"table","pt":"msg","to":"","tot":"str"},{"t":"set","p":"keycol","pt":"msg","to":"","tot":"str"},{"t":"set","p":"payload","pt":"msg","to":"{ \"keyval\": payload   }","tot":"jsonata"},{"t":"set","p":"topic","pt":"msg","to":"\"select * from \" & table & \" where \" & keycol & \" = :keyval \"","tot":"jsonata"}],"action":"","property":"","from":"","to":"","reg":false,"x":180,"y":1420,"wires":[["2138ff5e.ffe87"]]},{"id":"fa5f1d0b.19eec","type":"http in","z":"5bbedfa3.e6454","name":"PUT table","url":"/dbread/table","method":"put","upload":false,"swaggerDoc":"","x":80,"y":240,"wires":[["cf762737.832d48"]]},{"id":"4536f111.fee31","type":"change","z":"5bbedfa3.e6454","name":"","rules":[{"t":"set","p":"payload","pt":"msg","to":"table","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":2400,"y":240,"wires":[["b55c8d72.f7d31"]]},{"id":"7064299e.aad018","type":"http in","z":"5bbedfa3.e6454","name":"GET table","url":"/dbread/table","method":"get","upload":false,"swaggerDoc":"","x":80,"y":340,"wires":[["f8ba632d.4056c"]]},{"id":"663fdea7.73f95","type":"http response","z":"5bbedfa3.e6454","name":"","statusCode":"","headers":{},"x":2290,"y":340,"wires":[]},{"id":"32e0824a.441bfe","type":"change","z":"5bbedfa3.e6454","name":"","rules":[{"t":"set","p":"headers","pt":"msg","to":"{\"Content-Type\":\"text/plain\"}","tot":"json"}],"action":"","property":"","from":"","to":"","reg":false,"x":2120,"y":340,"wires":[["663fdea7.73f95"]]},{"id":"cf762737.832d48","type":"change","z":"5bbedfa3.e6454","name":"get inputs","rules":[{"t":"set","p":"table","pt":"msg","to":"payload","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":240,"y":240,"wires":[["61b74fbc.c3b6a"]]},{"id":"6036d13b.dfdea","type":"http request","z":"5bbedfa3.e6454","name":"get flows","method":"GET","ret":"obj","paytoqs":"ignore","url":"https://localhost:1880/flows","tls":"b1a419c1.609c29","persist":false,"proxy":"","authType":"","x":1760,"y":240,"wires":[["1acdf678.ad0b0a"]]},{"id":"6c3ccd87.8c9b94","type":"http response","z":"5bbedfa3.e6454","name":"","statusCode":"","headers":{},"x":2770,"y":240,"wires":[]},{"id":"b55c8d72.f7d31","type":"change","z":"5bbedfa3.e6454","name":"","rules":[{"t":"set","p":"headers","pt":"msg","to":"{\"Content-Type\":\"text/plain\"}","tot":"json"}],"action":"","property":"","from":"","to":"","reg":false,"x":2600,"y":240,"wires":[["6c3ccd87.8c9b94","e87fa74f.0f97c8"]]},{"id":"e98cdc61.f0533","type":"http request","z":"5bbedfa3.e6454","name":"get flows","method":"GET","ret":"obj","paytoqs":"ignore","url":"https://localhost:1880/flows","tls":"b1a419c1.609c29","persist":false,"proxy":"","authType":"","x":1600,"y":340,"wires":[["a25c4514.ba9b58"]]},{"id":"f3bf935e.ec18a","type":"http request","z":"5bbedfa3.e6454","name":"auth","method":"POST","ret":"obj","paytoqs":"ignore","url":"https://localhost:1880/auth/token","tls":"b1a419c1.609c29","persist":false,"proxy":"","authType":"","x":1090,"y":240,"wires":[["1ff5103b.3c371"]]},{"id":"607daaf5.3d5424","type":"change","z":"5bbedfa3.e6454","name":"auth payload","rules":[{"t":"set","p":"payload","pt":"msg","to":"{}","tot":"json"},{"t":"set","p":"payload.client_id","pt":"msg","to":"node-red-editor","tot":"str"},{"t":"set","p":"payload.grant_type","pt":"msg","to":"password","tot":"str"},{"t":"set","p":"payload.scope","pt":"msg","to":"","tot":"str"},{"t":"set","p":"payload.username","pt":"msg","to":"NRADM_USER","tot":"env"},{"t":"set","p":"payload.password","pt":"msg","to":"NRADM_PASS","tot":"env"}],"action":"","property":"","from":"","to":"","reg":false,"x":930,"y":240,"wires":[["f3bf935e.ec18a"]]},{"id":"1011526.85c9cae","type":"change","z":"5bbedfa3.e6454","name":"","rules":[{"t":"set","p":"accessToken","pt":"msg","to":"payload.access_token","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":1420,"y":240,"wires":[["ab2cfb94.f5bcf8"]]},{"id":"ab2cfb94.f5bcf8","type":"change","z":"5bbedfa3.e6454","name":"bearer","rules":[{"t":"set","p":"headers","pt":"msg","to":"{}","tot":"json"},{"t":"set","p":"headers.authorization","pt":"msg","to":"\"Bearer \" & msg.accessToken","tot":"jsonata"}],"action":"","property":"","from":"","to":"","reg":false,"x":1610,"y":240,"wires":[["6036d13b.dfdea"]]},{"id":"b54b563f.189008","type":"http request","z":"5bbedfa3.e6454","name":"auth","method":"POST","ret":"obj","paytoqs":"ignore","url":"https://localhost:1880/auth/token","tls":"b1a419c1.609c29","persist":false,"proxy":"","authType":"","x":930,"y":340,"wires":[["4bd1b53b.89a06c"]]},{"id":"1e0b3c01.bb3224","type":"change","z":"5bbedfa3.e6454","name":"auth payload","rules":[{"t":"set","p":"payload.client_id","pt":"msg","to":"node-red-editor","tot":"str"},{"t":"set","p":"payload.grant_type","pt":"msg","to":"password","tot":"str"},{"t":"set","p":"payload.scope","pt":"msg","to":"","tot":"str"},{"t":"set","p":"payload.username","pt":"msg","to":"NRADM_USER","tot":"env"},{"t":"set","p":"payload.password","pt":"msg","to":"NRADM_PASS","tot":"env"}],"action":"","property":"","from":"","to":"","reg":false,"x":770,"y":340,"wires":[["b54b563f.189008"]]},{"id":"15508d7d.0c1533","type":"change","z":"5bbedfa3.e6454","name":"","rules":[{"t":"set","p":"accessToken","pt":"msg","to":"payload.access_token","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":1260,"y":340,"wires":[["10af3c38.d86284"]]},{"id":"10af3c38.d86284","type":"change","z":"5bbedfa3.e6454","name":"bearer","rules":[{"t":"set","p":"headers","pt":"msg","to":"{}","tot":"json"},{"t":"set","p":"headers.authorization","pt":"msg","to":"\"Bearer \" & msg.accessToken","tot":"jsonata"}],"action":"","property":"","from":"","to":"","reg":false,"x":1450,"y":340,"wires":[["e98cdc61.f0533"]]},{"id":"1acb823f.4d978e","type":"http request","z":"5bbedfa3.e6454","name":"","method":"POST","ret":"obj","paytoqs":"ignore","url":"${CFG_ACL_ENDP}","tls":"51b09598.a1114d","persist":false,"proxy":"","authType":"","x":610,"y":240,"wires":[["ac123d4d.40faa"]]},{"id":"ac123d4d.40faa","type":"switch","z":"5bbedfa3.e6454","name":"","property":"statusCode","propertyType":"msg","rules":[{"t":"eq","v":"200","vt":"num"},{"t":"else"}],"checkall":"true","repair":false,"outputs":2,"x":770,"y":240,"wires":[["607daaf5.3d5424"],["9c4e468.3a3e1b8"]]},{"id":"29391940.98c0f6","type":"http request","z":"5bbedfa3.e6454","name":"","method":"POST","ret":"obj","paytoqs":"ignore","url":"${CFG_ACL_ENDP}","tls":"51b09598.a1114d","persist":false,"proxy":"","authType":"","x":450,"y":340,"wires":[["471fc585.22270c"]]},{"id":"471fc585.22270c","type":"switch","z":"5bbedfa3.e6454","name":"","property":"statusCode","propertyType":"msg","rules":[{"t":"eq","v":"200","vt":"num"},{"t":"else"}],"checkall":"true","repair":false,"outputs":2,"x":610,"y":340,"wires":[["1e0b3c01.bb3224"],["abd8b465.ffd018"]]},{"id":"f8ba632d.4056c","type":"change","z":"5bbedfa3.e6454","name":"acl req payload","rules":[{"t":"set","p":"headers","pt":"msg","to":"{}","tot":"json"},{"t":"set","p":"payload","pt":"msg","to":"{}","tot":"json"},{"t":"set","p":"payload.url","pt":"msg","to":"req.url","tot":"msg"},{"t":"set","p":"payload.method","pt":"msg","to":"req.method","tot":"msg"},{"t":"set","p":"payload.headers","pt":"msg","to":"req.headers","tot":"msg"},{"t":"set","p":"payload.params","pt":"msg","to":"req.params","tot":"msg"},{"t":"set","p":"payload.query","pt":"msg","to":"req.query","tot":"msg"},{"t":"set","p":"payload.body","pt":"msg","to":"req.body","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":260,"y":340,"wires":[["29391940.98c0f6"]]},{"id":"61b74fbc.c3b6a","type":"change","z":"5bbedfa3.e6454","name":"acl req payload","rules":[{"t":"set","p":"headers","pt":"msg","to":"{}","tot":"json"},{"t":"set","p":"payload","pt":"msg","to":"{}","tot":"json"},{"t":"set","p":"payload.url","pt":"msg","to":"req.url","tot":"msg"},{"t":"set","p":"payload.method","pt":"msg","to":"req.method","tot":"msg"},{"t":"set","p":"payload.headers","pt":"msg","to":"req.headers","tot":"msg"},{"t":"set","p":"payload.params","pt":"msg","to":"req.params","tot":"msg"},{"t":"set","p":"payload.query","pt":"msg","to":"req.query","tot":"msg"},{"t":"set","p":"payload.body","pt":"msg","to":"req.body","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":420,"y":240,"wires":[["1acb823f.4d978e"]]},{"id":"abd8b465.ffd018","type":"http response","z":"5bbedfa3.e6454","name":"","statusCode":"","headers":{},"x":750,"y":380,"wires":[]},{"id":"31791bf6.fb9144","type":"change","z":"5bbedfa3.e6454","name":"","rules":[{"t":"set","p":"payload","pt":"msg","to":"*[name = \"dbread settings\" and type=\"change\"].rules[0].to","tot":"jsonata"}],"action":"","property":"","from":"","to":"","reg":false,"x":1920,"y":340,"wires":[["32e0824a.441bfe"]]},{"id":"b1fe324.70e3ed","type":"change","z":"5bbedfa3.e6454","name":"edit","rules":[{"t":"set","p":"old","pt":"msg","to":"*[name = \"dbread settings\" and type=\"change\"]","tot":"jsonata"},{"t":"set","p":"new","pt":"msg","to":"old","tot":"msg"},{"t":"set","p":"new.rules[0].to","pt":"msg","to":"table","tot":"msg"},{"t":"set","p":"payload","pt":"msg","to":"$eval($replace($string(payload),$string(old),$string(new)))","tot":"jsonata"}],"action":"","property":"","from":"","to":"","reg":false,"x":2050,"y":240,"wires":[["c4b22cd2.b2876"]]},{"id":"9c4e468.3a3e1b8","type":"http response","z":"5bbedfa3.e6454","name":"","statusCode":"","headers":{},"x":910,"y":280,"wires":[]},{"id":"1ff5103b.3c371","type":"switch","z":"5bbedfa3.e6454","name":"","property":"statusCode","propertyType":"msg","rules":[{"t":"eq","v":"200","vt":"num"},{"t":"else"}],"checkall":"true","repair":false,"outputs":2,"x":1230,"y":240,"wires":[["1011526.85c9cae"],["3edb1a52.96ef06"]]},{"id":"3edb1a52.96ef06","type":"http response","z":"5bbedfa3.e6454","name":"","statusCode":"","headers":{},"x":1370,"y":280,"wires":[]},{"id":"1acdf678.ad0b0a","type":"switch","z":"5bbedfa3.e6454","name":"","property":"statusCode","propertyType":"msg","rules":[{"t":"eq","v":"200","vt":"num"},{"t":"else"}],"checkall":"true","repair":false,"outputs":2,"x":1910,"y":240,"wires":[["b1fe324.70e3ed"],["12094b94.504d04"]]},{"id":"12094b94.504d04","type":"http response","z":"5bbedfa3.e6454","name":"","statusCode":"","headers":{},"x":2050,"y":280,"wires":[]},{"id":"c4b22cd2.b2876","type":"function","z":"5bbedfa3.e6454","name":"update flows","func":"const http = global.get('https');\nconst data = JSON.stringify(msg.payload);\nconst options = {\n  hostname: 'localhost',\n  port: 1880,\n  path: '/flows',\n  method: 'POST',\n  headers: {\n    'Content-Type': 'application/json',\n    'Content-Length': data.length,\n    'Authorization': 'Bearer '+msg.accessToken\n  },\n  rejectUnauthorized: false\n};\nconst req = http.request(options);\nreq.write(data);\nreq.end();\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":2210,"y":240,"wires":[["4536f111.fee31"]]},{"id":"4bd1b53b.89a06c","type":"switch","z":"5bbedfa3.e6454","name":"","property":"statusCode","propertyType":"msg","rules":[{"t":"eq","v":"200","vt":"num"},{"t":"else"}],"checkall":"true","repair":false,"outputs":2,"x":1070,"y":340,"wires":[["15508d7d.0c1533"],["63a39fda.1cdf8"]]},{"id":"63a39fda.1cdf8","type":"http response","z":"5bbedfa3.e6454","name":"","statusCode":"","headers":{},"x":1210,"y":380,"wires":[]},{"id":"a25c4514.ba9b58","type":"switch","z":"5bbedfa3.e6454","name":"","property":"statusCode","propertyType":"msg","rules":[{"t":"eq","v":"200","vt":"num"},{"t":"else"}],"checkall":"true","repair":false,"outputs":2,"x":1750,"y":340,"wires":[["31791bf6.fb9144"],["ed5fce59.5388b"]]},{"id":"ed5fce59.5388b","type":"http response","z":"5bbedfa3.e6454","name":"","statusCode":"","headers":{},"x":1890,"y":380,"wires":[]},{"id":"e87fa74f.0f97c8","type":"change","z":"5bbedfa3.e6454","name":"status","rules":[{"t":"set","p":"payload","pt":"msg","to":"{}","tot":"json"},{"t":"set","p":"payload.text","pt":"msg","to":"\"table: \" & table","tot":"jsonata"},{"t":"set","p":"payload.shape","pt":"msg","to":"dot","tot":"str"},{"t":"set","p":"payload.fill","pt":"msg","to":"grey","tot":"str"}],"action":"","property":"","from":"","to":"","reg":false,"x":2770,"y":300,"wires":[[]]},{"id":"e0060fca.6cc2d","type":"http in","z":"5bbedfa3.e6454","name":"PUT keycol","url":"/dbread/keycol","method":"put","upload":false,"swaggerDoc":"","x":90,"y":440,"wires":[["946f7561.9f66f8"]]},{"id":"5fd2a2af.f649ac","type":"change","z":"5bbedfa3.e6454","name":"","rules":[{"t":"set","p":"payload","pt":"msg","to":"keycol","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":2400,"y":440,"wires":[["4f9a3298.276f7c"]]},{"id":"e7f9aab0.72b6a8","type":"http in","z":"5bbedfa3.e6454","name":"GET keycol","url":"/dbread/keycol","method":"get","upload":false,"swaggerDoc":"","x":90,"y":540,"wires":[["e4724079.2c24f"]]},{"id":"62653bb5.3a79c4","type":"http response","z":"5bbedfa3.e6454","name":"","statusCode":"","headers":{},"x":2290,"y":540,"wires":[]},{"id":"4693b786.d834e8","type":"change","z":"5bbedfa3.e6454","name":"","rules":[{"t":"set","p":"headers","pt":"msg","to":"{\"Content-Type\":\"text/plain\"}","tot":"json"}],"action":"","property":"","from":"","to":"","reg":false,"x":2120,"y":540,"wires":[["62653bb5.3a79c4"]]},{"id":"946f7561.9f66f8","type":"change","z":"5bbedfa3.e6454","name":"get inputs","rules":[{"t":"set","p":"keycol","pt":"msg","to":"payload","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":240,"y":440,"wires":[["cf991f7f.f0c7b"]]},{"id":"6004a566.90190c","type":"http request","z":"5bbedfa3.e6454","name":"get flows","method":"GET","ret":"obj","paytoqs":"ignore","url":"https://localhost:1880/flows","tls":"b1a419c1.609c29","persist":false,"proxy":"","authType":"","x":1760,"y":440,"wires":[["185e2906.62f857"]]},{"id":"64251121.3951","type":"http response","z":"5bbedfa3.e6454","name":"","statusCode":"","headers":{},"x":2770,"y":440,"wires":[]},{"id":"4f9a3298.276f7c","type":"change","z":"5bbedfa3.e6454","name":"","rules":[{"t":"set","p":"headers","pt":"msg","to":"{\"Content-Type\":\"text/plain\"}","tot":"json"}],"action":"","property":"","from":"","to":"","reg":false,"x":2600,"y":440,"wires":[["64251121.3951","219133b8.980e3c"]]},{"id":"a4db111f.2373b","type":"http request","z":"5bbedfa3.e6454","name":"get flows","method":"GET","ret":"obj","paytoqs":"ignore","url":"https://localhost:1880/flows","tls":"b1a419c1.609c29","persist":false,"proxy":"","authType":"","x":1600,"y":540,"wires":[["c2606d71.67bee"]]},{"id":"21a71796.aadc08","type":"http request","z":"5bbedfa3.e6454","name":"auth","method":"POST","ret":"obj","paytoqs":"ignore","url":"https://localhost:1880/auth/token","tls":"b1a419c1.609c29","persist":false,"proxy":"","authType":"","x":1090,"y":440,"wires":[["27db8700.dedf08"]]},{"id":"333d0f6d.4f599","type":"change","z":"5bbedfa3.e6454","name":"auth payload","rules":[{"t":"set","p":"payload","pt":"msg","to":"{}","tot":"json"},{"t":"set","p":"payload.client_id","pt":"msg","to":"node-red-editor","tot":"str"},{"t":"set","p":"payload.grant_type","pt":"msg","to":"password","tot":"str"},{"t":"set","p":"payload.scope","pt":"msg","to":"","tot":"str"},{"t":"set","p":"payload.username","pt":"msg","to":"NRADM_USER","tot":"env"},{"t":"set","p":"payload.password","pt":"msg","to":"NRADM_PASS","tot":"env"}],"action":"","property":"","from":"","to":"","reg":false,"x":930,"y":440,"wires":[["21a71796.aadc08"]]},{"id":"4b3654b4.0d53bc","type":"change","z":"5bbedfa3.e6454","name":"","rules":[{"t":"set","p":"accessToken","pt":"msg","to":"payload.access_token","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":1420,"y":440,"wires":[["eeef112d.d9feb"]]},{"id":"eeef112d.d9feb","type":"change","z":"5bbedfa3.e6454","name":"bearer","rules":[{"t":"set","p":"headers","pt":"msg","to":"{}","tot":"json"},{"t":"set","p":"headers.authorization","pt":"msg","to":"\"Bearer \" & msg.accessToken","tot":"jsonata"}],"action":"","property":"","from":"","to":"","reg":false,"x":1610,"y":440,"wires":[["6004a566.90190c"]]},{"id":"d08b94ea.d47ba8","type":"http request","z":"5bbedfa3.e6454","name":"auth","method":"POST","ret":"obj","paytoqs":"ignore","url":"https://localhost:1880/auth/token","tls":"b1a419c1.609c29","persist":false,"proxy":"","authType":"","x":930,"y":540,"wires":[["ab5d297c.46d568"]]},{"id":"9336ed5b.11b84","type":"change","z":"5bbedfa3.e6454","name":"auth payload","rules":[{"t":"set","p":"payload.client_id","pt":"msg","to":"node-red-editor","tot":"str"},{"t":"set","p":"payload.grant_type","pt":"msg","to":"password","tot":"str"},{"t":"set","p":"payload.scope","pt":"msg","to":"","tot":"str"},{"t":"set","p":"payload.username","pt":"msg","to":"NRADM_USER","tot":"env"},{"t":"set","p":"payload.password","pt":"msg","to":"NRADM_PASS","tot":"env"}],"action":"","property":"","from":"","to":"","reg":false,"x":770,"y":540,"wires":[["d08b94ea.d47ba8"]]},{"id":"e3782341.a77df","type":"change","z":"5bbedfa3.e6454","name":"","rules":[{"t":"set","p":"accessToken","pt":"msg","to":"payload.access_token","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":1260,"y":540,"wires":[["9f57bfde.933bf"]]},{"id":"9f57bfde.933bf","type":"change","z":"5bbedfa3.e6454","name":"bearer","rules":[{"t":"set","p":"headers","pt":"msg","to":"{}","tot":"json"},{"t":"set","p":"headers.authorization","pt":"msg","to":"\"Bearer \" & msg.accessToken","tot":"jsonata"}],"action":"","property":"","from":"","to":"","reg":false,"x":1450,"y":540,"wires":[["a4db111f.2373b"]]},{"id":"4920cc6a.d5bcb4","type":"http request","z":"5bbedfa3.e6454","name":"","method":"POST","ret":"obj","paytoqs":"ignore","url":"${CFG_ACL_ENDP}","tls":"51b09598.a1114d","persist":false,"proxy":"","authType":"","x":610,"y":440,"wires":[["6ca94176.500a9"]]},{"id":"6ca94176.500a9","type":"switch","z":"5bbedfa3.e6454","name":"","property":"statusCode","propertyType":"msg","rules":[{"t":"eq","v":"200","vt":"num"},{"t":"else"}],"checkall":"true","repair":false,"outputs":2,"x":770,"y":440,"wires":[["333d0f6d.4f599"],["946d3923.258f58"]]},{"id":"4cf130d3.a46cf","type":"http request","z":"5bbedfa3.e6454","name":"","method":"POST","ret":"obj","paytoqs":"ignore","url":"${CFG_ACL_ENDP}","tls":"51b09598.a1114d","persist":false,"proxy":"","authType":"","x":450,"y":540,"wires":[["940b5769.126288"]]},{"id":"940b5769.126288","type":"switch","z":"5bbedfa3.e6454","name":"","property":"statusCode","propertyType":"msg","rules":[{"t":"eq","v":"200","vt":"num"},{"t":"else"}],"checkall":"true","repair":false,"outputs":2,"x":610,"y":540,"wires":[["9336ed5b.11b84"],["567a22fb.cc564c"]]},{"id":"e4724079.2c24f","type":"change","z":"5bbedfa3.e6454","name":"acl req payload","rules":[{"t":"set","p":"headers","pt":"msg","to":"{}","tot":"json"},{"t":"set","p":"payload","pt":"msg","to":"{}","tot":"json"},{"t":"set","p":"payload.url","pt":"msg","to":"req.url","tot":"msg"},{"t":"set","p":"payload.method","pt":"msg","to":"req.method","tot":"msg"},{"t":"set","p":"payload.headers","pt":"msg","to":"req.headers","tot":"msg"},{"t":"set","p":"payload.params","pt":"msg","to":"req.params","tot":"msg"},{"t":"set","p":"payload.query","pt":"msg","to":"req.query","tot":"msg"},{"t":"set","p":"payload.body","pt":"msg","to":"req.body","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":260,"y":540,"wires":[["4cf130d3.a46cf"]]},{"id":"cf991f7f.f0c7b","type":"change","z":"5bbedfa3.e6454","name":"acl req payload","rules":[{"t":"set","p":"headers","pt":"msg","to":"{}","tot":"json"},{"t":"set","p":"payload","pt":"msg","to":"{}","tot":"json"},{"t":"set","p":"payload.url","pt":"msg","to":"req.url","tot":"msg"},{"t":"set","p":"payload.method","pt":"msg","to":"req.method","tot":"msg"},{"t":"set","p":"payload.headers","pt":"msg","to":"req.headers","tot":"msg"},{"t":"set","p":"payload.params","pt":"msg","to":"req.params","tot":"msg"},{"t":"set","p":"payload.query","pt":"msg","to":"req.query","tot":"msg"},{"t":"set","p":"payload.body","pt":"msg","to":"req.body","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":420,"y":440,"wires":[["4920cc6a.d5bcb4"]]},{"id":"567a22fb.cc564c","type":"http response","z":"5bbedfa3.e6454","name":"","statusCode":"","headers":{},"x":750,"y":580,"wires":[]},{"id":"3684755f.9783fa","type":"change","z":"5bbedfa3.e6454","name":"","rules":[{"t":"set","p":"payload","pt":"msg","to":"*[name = \"dbread settings\" and type=\"change\"].rules[1].to","tot":"jsonata"}],"action":"","property":"","from":"","to":"","reg":false,"x":1920,"y":540,"wires":[["4693b786.d834e8"]]},{"id":"33b5b0a7.63f93","type":"change","z":"5bbedfa3.e6454","name":"edit","rules":[{"t":"set","p":"old","pt":"msg","to":"*[name = \"dbread settings\" and type=\"change\"]","tot":"jsonata"},{"t":"set","p":"new","pt":"msg","to":"old","tot":"msg"},{"t":"set","p":"new.rules[1].to","pt":"msg","to":"keycol","tot":"msg"},{"t":"set","p":"payload","pt":"msg","to":"$eval($replace($string(payload),$string(old),$string(new)))","tot":"jsonata"}],"action":"","property":"","from":"","to":"","reg":false,"x":2050,"y":440,"wires":[["dcf621e.e6588e"]]},{"id":"946d3923.258f58","type":"http response","z":"5bbedfa3.e6454","name":"","statusCode":"","headers":{},"x":910,"y":480,"wires":[]},{"id":"27db8700.dedf08","type":"switch","z":"5bbedfa3.e6454","name":"","property":"statusCode","propertyType":"msg","rules":[{"t":"eq","v":"200","vt":"num"},{"t":"else"}],"checkall":"true","repair":false,"outputs":2,"x":1230,"y":440,"wires":[["4b3654b4.0d53bc"],["bd38481d.602788"]]},{"id":"bd38481d.602788","type":"http response","z":"5bbedfa3.e6454","name":"","statusCode":"","headers":{},"x":1370,"y":480,"wires":[]},{"id":"185e2906.62f857","type":"switch","z":"5bbedfa3.e6454","name":"","property":"statusCode","propertyType":"msg","rules":[{"t":"eq","v":"200","vt":"num"},{"t":"else"}],"checkall":"true","repair":false,"outputs":2,"x":1910,"y":440,"wires":[["33b5b0a7.63f93"],["1b6b597c.ff6a47"]]},{"id":"1b6b597c.ff6a47","type":"http response","z":"5bbedfa3.e6454","name":"","statusCode":"","headers":{},"x":2050,"y":480,"wires":[]},{"id":"dcf621e.e6588e","type":"function","z":"5bbedfa3.e6454","name":"update flows","func":"const http = global.get('https');\nconst data = JSON.stringify(msg.payload);\nconst options = {\n  hostname: 'localhost',\n  port: 1880,\n  path: '/flows',\n  method: 'POST',\n  headers: {\n    'Content-Type': 'application/json',\n    'Content-Length': data.length,\n    'Authorization': 'Bearer '+msg.accessToken\n  },\n  rejectUnauthorized: false\n};\nconst req = http.request(options);\nreq.write(data);\nreq.end();\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":2210,"y":440,"wires":[["5fd2a2af.f649ac"]]},{"id":"ab5d297c.46d568","type":"switch","z":"5bbedfa3.e6454","name":"","property":"statusCode","propertyType":"msg","rules":[{"t":"eq","v":"200","vt":"num"},{"t":"else"}],"checkall":"true","repair":false,"outputs":2,"x":1070,"y":540,"wires":[["e3782341.a77df"],["d1a876ee.a33558"]]},{"id":"d1a876ee.a33558","type":"http response","z":"5bbedfa3.e6454","name":"","statusCode":"","headers":{},"x":1210,"y":580,"wires":[]},{"id":"c2606d71.67bee","type":"switch","z":"5bbedfa3.e6454","name":"","property":"statusCode","propertyType":"msg","rules":[{"t":"eq","v":"200","vt":"num"},{"t":"else"}],"checkall":"true","repair":false,"outputs":2,"x":1750,"y":540,"wires":[["3684755f.9783fa"],["382dec58.93ce44"]]},{"id":"382dec58.93ce44","type":"http response","z":"5bbedfa3.e6454","name":"","statusCode":"","headers":{},"x":1890,"y":580,"wires":[]},{"id":"219133b8.980e3c","type":"change","z":"5bbedfa3.e6454","name":"status","rules":[{"t":"set","p":"payload","pt":"msg","to":"{}","tot":"json"},{"t":"set","p":"payload.text","pt":"msg","to":"\"keycol: \" & keycol","tot":"jsonata"},{"t":"set","p":"payload.shape","pt":"msg","to":"dot","tot":"str"},{"t":"set","p":"payload.fill","pt":"msg","to":"grey","tot":"str"}],"action":"","property":"","from":"","to":"","reg":false,"x":2770,"y":500,"wires":[[]]},{"id":"ff42ecf4.12e67","type":"http in","z":"5bbedfa3.e6454","name":"PUT host","url":"/dbread/host","method":"put","upload":false,"swaggerDoc":"","x":80,"y":640,"wires":[["f0bf4465.c6c618"]]},{"id":"73800450.bd184c","type":"change","z":"5bbedfa3.e6454","name":"","rules":[{"t":"set","p":"payload","pt":"msg","to":"host","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":2400,"y":640,"wires":[["cb065eca.3e18a"]]},{"id":"dbeb40ae.77f1a","type":"http in","z":"5bbedfa3.e6454","name":"GET host","url":"/dbread/host","method":"get","upload":false,"swaggerDoc":"","x":80,"y":740,"wires":[["773675cd.d2d26c"]]},{"id":"5355e5f7.2a942c","type":"http response","z":"5bbedfa3.e6454","name":"","statusCode":"","headers":{},"x":2290,"y":740,"wires":[]},{"id":"91310233.8e954","type":"change","z":"5bbedfa3.e6454","name":"","rules":[{"t":"set","p":"headers","pt":"msg","to":"{\"Content-Type\":\"text/plain\"}","tot":"json"}],"action":"","property":"","from":"","to":"","reg":false,"x":2120,"y":740,"wires":[["5355e5f7.2a942c"]]},{"id":"f0bf4465.c6c618","type":"change","z":"5bbedfa3.e6454","name":"get inputs","rules":[{"t":"set","p":"host","pt":"msg","to":"payload","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":240,"y":640,"wires":[["c30b9f75.d3b2e"]]},{"id":"db494d9.68104b","type":"http request","z":"5bbedfa3.e6454","name":"get flows","method":"GET","ret":"obj","paytoqs":"ignore","url":"https://localhost:1880/flows","tls":"b1a419c1.609c29","persist":false,"proxy":"","authType":"","x":1760,"y":640,"wires":[["bbf76539.3a1cd8"]]},{"id":"a3b612bd.d7c2f","type":"http response","z":"5bbedfa3.e6454","name":"","statusCode":"","headers":{},"x":2770,"y":640,"wires":[]},{"id":"cb065eca.3e18a","type":"change","z":"5bbedfa3.e6454","name":"","rules":[{"t":"set","p":"headers","pt":"msg","to":"{\"Content-Type\":\"text/plain\"}","tot":"json"}],"action":"","property":"","from":"","to":"","reg":false,"x":2600,"y":640,"wires":[["a3b612bd.d7c2f","c9d4768f.cddc18"]]},{"id":"bb6807a7.f59768","type":"http request","z":"5bbedfa3.e6454","name":"get flows","method":"GET","ret":"obj","paytoqs":"ignore","url":"https://localhost:1880/flows","tls":"b1a419c1.609c29","persist":false,"proxy":"","authType":"","x":1600,"y":740,"wires":[["3270db55.7026a4"]]},{"id":"24094ca9.aa5264","type":"http request","z":"5bbedfa3.e6454","name":"auth","method":"POST","ret":"obj","paytoqs":"ignore","url":"https://localhost:1880/auth/token","tls":"b1a419c1.609c29","persist":false,"proxy":"","authType":"","x":1090,"y":640,"wires":[["24e0d740.58b258"]]},{"id":"e21612fb.0c168","type":"change","z":"5bbedfa3.e6454","name":"auth payload","rules":[{"t":"set","p":"payload","pt":"msg","to":"{}","tot":"json"},{"t":"set","p":"payload.client_id","pt":"msg","to":"node-red-editor","tot":"str"},{"t":"set","p":"payload.grant_type","pt":"msg","to":"password","tot":"str"},{"t":"set","p":"payload.scope","pt":"msg","to":"","tot":"str"},{"t":"set","p":"payload.username","pt":"msg","to":"NRADM_USER","tot":"env"},{"t":"set","p":"payload.password","pt":"msg","to":"NRADM_PASS","tot":"env"}],"action":"","property":"","from":"","to":"","reg":false,"x":930,"y":640,"wires":[["24094ca9.aa5264"]]},{"id":"34029de5.073e62","type":"change","z":"5bbedfa3.e6454","name":"","rules":[{"t":"set","p":"accessToken","pt":"msg","to":"payload.access_token","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":1420,"y":640,"wires":[["56f40702.6ad228"]]},{"id":"56f40702.6ad228","type":"change","z":"5bbedfa3.e6454","name":"bearer","rules":[{"t":"set","p":"headers","pt":"msg","to":"{}","tot":"json"},{"t":"set","p":"headers.authorization","pt":"msg","to":"\"Bearer \" & msg.accessToken","tot":"jsonata"}],"action":"","property":"","from":"","to":"","reg":false,"x":1610,"y":640,"wires":[["db494d9.68104b"]]},{"id":"7998ca37.632aa4","type":"http request","z":"5bbedfa3.e6454","name":"auth","method":"POST","ret":"obj","paytoqs":"ignore","url":"https://localhost:1880/auth/token","tls":"b1a419c1.609c29","persist":false,"proxy":"","authType":"","x":930,"y":740,"wires":[["4e3d03a8.ef3c1c"]]},{"id":"739166ba.87e6d8","type":"change","z":"5bbedfa3.e6454","name":"auth payload","rules":[{"t":"set","p":"payload.client_id","pt":"msg","to":"node-red-editor","tot":"str"},{"t":"set","p":"payload.grant_type","pt":"msg","to":"password","tot":"str"},{"t":"set","p":"payload.scope","pt":"msg","to":"","tot":"str"},{"t":"set","p":"payload.username","pt":"msg","to":"NRADM_USER","tot":"env"},{"t":"set","p":"payload.password","pt":"msg","to":"NRADM_PASS","tot":"env"}],"action":"","property":"","from":"","to":"","reg":false,"x":770,"y":740,"wires":[["7998ca37.632aa4"]]},{"id":"85697d1f.3c3f9","type":"change","z":"5bbedfa3.e6454","name":"","rules":[{"t":"set","p":"accessToken","pt":"msg","to":"payload.access_token","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":1260,"y":740,"wires":[["47bf9963.483398"]]},{"id":"47bf9963.483398","type":"change","z":"5bbedfa3.e6454","name":"bearer","rules":[{"t":"set","p":"headers","pt":"msg","to":"{}","tot":"json"},{"t":"set","p":"headers.authorization","pt":"msg","to":"\"Bearer \" & msg.accessToken","tot":"jsonata"}],"action":"","property":"","from":"","to":"","reg":false,"x":1450,"y":740,"wires":[["bb6807a7.f59768"]]},{"id":"b59da63e.a6cf98","type":"http request","z":"5bbedfa3.e6454","name":"","method":"POST","ret":"obj","paytoqs":"ignore","url":"${CFG_ACL_ENDP}","tls":"51b09598.a1114d","persist":false,"proxy":"","authType":"","x":610,"y":640,"wires":[["13cee79b.3e86f8"]]},{"id":"13cee79b.3e86f8","type":"switch","z":"5bbedfa3.e6454","name":"","property":"statusCode","propertyType":"msg","rules":[{"t":"eq","v":"200","vt":"num"},{"t":"else"}],"checkall":"true","repair":false,"outputs":2,"x":770,"y":640,"wires":[["e21612fb.0c168"],["d798d5c2.688ad8"]]},{"id":"9f65b072.cde04","type":"http request","z":"5bbedfa3.e6454","name":"","method":"POST","ret":"obj","paytoqs":"ignore","url":"${CFG_ACL_ENDP}","tls":"51b09598.a1114d","persist":false,"proxy":"","authType":"","x":450,"y":740,"wires":[["ef68905.ac3aa7"]]},{"id":"ef68905.ac3aa7","type":"switch","z":"5bbedfa3.e6454","name":"","property":"statusCode","propertyType":"msg","rules":[{"t":"eq","v":"200","vt":"num"},{"t":"else"}],"checkall":"true","repair":false,"outputs":2,"x":610,"y":740,"wires":[["739166ba.87e6d8"],["48ed3dfa.582d94"]]},{"id":"773675cd.d2d26c","type":"change","z":"5bbedfa3.e6454","name":"acl req payload","rules":[{"t":"set","p":"headers","pt":"msg","to":"{}","tot":"json"},{"t":"set","p":"payload","pt":"msg","to":"{}","tot":"json"},{"t":"set","p":"payload.url","pt":"msg","to":"req.url","tot":"msg"},{"t":"set","p":"payload.method","pt":"msg","to":"req.method","tot":"msg"},{"t":"set","p":"payload.headers","pt":"msg","to":"req.headers","tot":"msg"},{"t":"set","p":"payload.params","pt":"msg","to":"req.params","tot":"msg"},{"t":"set","p":"payload.query","pt":"msg","to":"req.query","tot":"msg"},{"t":"set","p":"payload.body","pt":"msg","to":"req.body","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":260,"y":740,"wires":[["9f65b072.cde04"]]},{"id":"c30b9f75.d3b2e","type":"change","z":"5bbedfa3.e6454","name":"acl req payload","rules":[{"t":"set","p":"headers","pt":"msg","to":"{}","tot":"json"},{"t":"set","p":"payload","pt":"msg","to":"{}","tot":"json"},{"t":"set","p":"payload.url","pt":"msg","to":"req.url","tot":"msg"},{"t":"set","p":"payload.method","pt":"msg","to":"req.method","tot":"msg"},{"t":"set","p":"payload.headers","pt":"msg","to":"req.headers","tot":"msg"},{"t":"set","p":"payload.params","pt":"msg","to":"req.params","tot":"msg"},{"t":"set","p":"payload.query","pt":"msg","to":"req.query","tot":"msg"},{"t":"set","p":"payload.body","pt":"msg","to":"req.body","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":420,"y":640,"wires":[["b59da63e.a6cf98"]]},{"id":"48ed3dfa.582d94","type":"http response","z":"5bbedfa3.e6454","name":"","statusCode":"","headers":{},"x":750,"y":780,"wires":[]},{"id":"5a7e49a3.d6df48","type":"change","z":"5bbedfa3.e6454","name":"","rules":[{"t":"set","p":"payload","pt":"msg","to":"*[name = \"dbread mysql server config\" and type=\"Stackhero-MySQL-Server\"].host","tot":"jsonata"}],"action":"","property":"","from":"","to":"","reg":false,"x":1920,"y":740,"wires":[["91310233.8e954"]]},{"id":"6cc696fd.3f1158","type":"change","z":"5bbedfa3.e6454","name":"edit","rules":[{"t":"set","p":"old","pt":"msg","to":"*[name = \"dbread mysql server config\" and type=\"Stackhero-MySQL-Server\"]","tot":"jsonata"},{"t":"set","p":"new","pt":"msg","to":"old","tot":"msg"},{"t":"set","p":"new.host","pt":"msg","to":"host","tot":"msg"},{"t":"set","p":"payload","pt":"msg","to":"$eval($replace($string(payload),$string(old),$string(new)))","tot":"jsonata"}],"action":"","property":"","from":"","to":"","reg":false,"x":2050,"y":640,"wires":[["150b3844.940f78"]]},{"id":"d798d5c2.688ad8","type":"http response","z":"5bbedfa3.e6454","name":"","statusCode":"","headers":{},"x":910,"y":680,"wires":[]},{"id":"24e0d740.58b258","type":"switch","z":"5bbedfa3.e6454","name":"","property":"statusCode","propertyType":"msg","rules":[{"t":"eq","v":"200","vt":"num"},{"t":"else"}],"checkall":"true","repair":false,"outputs":2,"x":1230,"y":640,"wires":[["34029de5.073e62"],["36cabe1.2634a42"]]},{"id":"36cabe1.2634a42","type":"http response","z":"5bbedfa3.e6454","name":"","statusCode":"","headers":{},"x":1370,"y":680,"wires":[]},{"id":"bbf76539.3a1cd8","type":"switch","z":"5bbedfa3.e6454","name":"","property":"statusCode","propertyType":"msg","rules":[{"t":"eq","v":"200","vt":"num"},{"t":"else"}],"checkall":"true","repair":false,"outputs":2,"x":1910,"y":640,"wires":[["6cc696fd.3f1158"],["8f28ca6f.d788d8"]]},{"id":"8f28ca6f.d788d8","type":"http response","z":"5bbedfa3.e6454","name":"","statusCode":"","headers":{},"x":2050,"y":680,"wires":[]},{"id":"150b3844.940f78","type":"function","z":"5bbedfa3.e6454","name":"update flows","func":"const http = global.get('https');\nconst data = JSON.stringify(msg.payload);\nconst options = {\n  hostname: 'localhost',\n  port: 1880,\n  path: '/flows',\n  method: 'POST',\n  headers: {\n    'Content-Type': 'application/json',\n    'Content-Length': data.length,\n    'Authorization': 'Bearer '+msg.accessToken\n  },\n  rejectUnauthorized: false\n};\nconst req = http.request(options);\nreq.write(data);\nreq.end();\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":2210,"y":640,"wires":[["73800450.bd184c"]]},{"id":"4e3d03a8.ef3c1c","type":"switch","z":"5bbedfa3.e6454","name":"","property":"statusCode","propertyType":"msg","rules":[{"t":"eq","v":"200","vt":"num"},{"t":"else"}],"checkall":"true","repair":false,"outputs":2,"x":1070,"y":740,"wires":[["85697d1f.3c3f9"],["d61cdf1a.7f761"]]},{"id":"d61cdf1a.7f761","type":"http response","z":"5bbedfa3.e6454","name":"","statusCode":"","headers":{},"x":1210,"y":780,"wires":[]},{"id":"3270db55.7026a4","type":"switch","z":"5bbedfa3.e6454","name":"","property":"statusCode","propertyType":"msg","rules":[{"t":"eq","v":"200","vt":"num"},{"t":"else"}],"checkall":"true","repair":false,"outputs":2,"x":1750,"y":740,"wires":[["5a7e49a3.d6df48"],["bc6f32b0.4a1a5"]]},{"id":"bc6f32b0.4a1a5","type":"http response","z":"5bbedfa3.e6454","name":"","statusCode":"","headers":{},"x":1890,"y":780,"wires":[]},{"id":"c9d4768f.cddc18","type":"change","z":"5bbedfa3.e6454","name":"status","rules":[{"t":"set","p":"payload","pt":"msg","to":"{}","tot":"json"},{"t":"set","p":"payload.text","pt":"msg","to":"\"host: \" & host","tot":"jsonata"},{"t":"set","p":"payload.shape","pt":"msg","to":"dot","tot":"str"},{"t":"set","p":"payload.fill","pt":"msg","to":"grey","tot":"str"}],"action":"","property":"","from":"","to":"","reg":false,"x":2770,"y":700,"wires":[[]]},{"id":"39d2d899.9979b8","type":"http in","z":"5bbedfa3.e6454","name":"PUT port","url":"/dbread/port","method":"put","upload":false,"swaggerDoc":"","x":80,"y":840,"wires":[["a7698e6e.bcf44"]]},{"id":"3e75359d.a951ca","type":"change","z":"5bbedfa3.e6454","name":"","rules":[{"t":"set","p":"payload","pt":"msg","to":"port","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":2400,"y":840,"wires":[["a2469c59.953c8"]]},{"id":"de89fbb2.7da0d8","type":"http in","z":"5bbedfa3.e6454","name":"GET port","url":"/dbread/port","method":"get","upload":false,"swaggerDoc":"","x":80,"y":940,"wires":[["dc10f339.b3daf"]]},{"id":"f6f12e2c.242f6","type":"http response","z":"5bbedfa3.e6454","name":"","statusCode":"","headers":{},"x":2290,"y":940,"wires":[]},{"id":"66aac69e.3d6338","type":"change","z":"5bbedfa3.e6454","name":"","rules":[{"t":"set","p":"headers","pt":"msg","to":"{\"Content-Type\":\"text/plain\"}","tot":"json"}],"action":"","property":"","from":"","to":"","reg":false,"x":2120,"y":940,"wires":[["f6f12e2c.242f6"]]},{"id":"a7698e6e.bcf44","type":"change","z":"5bbedfa3.e6454","name":"get inputs","rules":[{"t":"set","p":"port","pt":"msg","to":"payload","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":240,"y":840,"wires":[["23544a7b.1ee046"]]},{"id":"bfe8fefc.97c48","type":"http request","z":"5bbedfa3.e6454","name":"get flows","method":"GET","ret":"obj","paytoqs":"ignore","url":"https://localhost:1880/flows","tls":"b1a419c1.609c29","persist":false,"proxy":"","authType":"","x":1760,"y":840,"wires":[["e2a57dd1.11c7f"]]},{"id":"3135e454.37fb6c","type":"http response","z":"5bbedfa3.e6454","name":"","statusCode":"","headers":{},"x":2770,"y":840,"wires":[]},{"id":"a2469c59.953c8","type":"change","z":"5bbedfa3.e6454","name":"","rules":[{"t":"set","p":"headers","pt":"msg","to":"{\"Content-Type\":\"text/plain\"}","tot":"json"}],"action":"","property":"","from":"","to":"","reg":false,"x":2600,"y":840,"wires":[["3135e454.37fb6c","b2418d00.738b9"]]},{"id":"6cca9e00.068e24","type":"http request","z":"5bbedfa3.e6454","name":"get flows","method":"GET","ret":"obj","paytoqs":"ignore","url":"https://localhost:1880/flows","tls":"b1a419c1.609c29","persist":false,"proxy":"","authType":"","x":1600,"y":940,"wires":[["5707cf05.dc4d6"]]},{"id":"fc1ee665.28e248","type":"http request","z":"5bbedfa3.e6454","name":"auth","method":"POST","ret":"obj","paytoqs":"ignore","url":"https://localhost:1880/auth/token","tls":"b1a419c1.609c29","persist":false,"proxy":"","authType":"","x":1090,"y":840,"wires":[["72e3244a.bb495c"]]},{"id":"8500f02c.2486d","type":"change","z":"5bbedfa3.e6454","name":"auth payload","rules":[{"t":"set","p":"payload","pt":"msg","to":"{}","tot":"json"},{"t":"set","p":"payload.client_id","pt":"msg","to":"node-red-editor","tot":"str"},{"t":"set","p":"payload.grant_type","pt":"msg","to":"password","tot":"str"},{"t":"set","p":"payload.scope","pt":"msg","to":"","tot":"str"},{"t":"set","p":"payload.username","pt":"msg","to":"NRADM_USER","tot":"env"},{"t":"set","p":"payload.password","pt":"msg","to":"NRADM_PASS","tot":"env"}],"action":"","property":"","from":"","to":"","reg":false,"x":930,"y":840,"wires":[["fc1ee665.28e248"]]},{"id":"adb1cfa9.b218c","type":"change","z":"5bbedfa3.e6454","name":"","rules":[{"t":"set","p":"accessToken","pt":"msg","to":"payload.access_token","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":1420,"y":840,"wires":[["5de808eb.545e28"]]},{"id":"5de808eb.545e28","type":"change","z":"5bbedfa3.e6454","name":"bearer","rules":[{"t":"set","p":"headers","pt":"msg","to":"{}","tot":"json"},{"t":"set","p":"headers.authorization","pt":"msg","to":"\"Bearer \" & msg.accessToken","tot":"jsonata"}],"action":"","property":"","from":"","to":"","reg":false,"x":1610,"y":840,"wires":[["bfe8fefc.97c48"]]},{"id":"e2cd2625.466588","type":"http request","z":"5bbedfa3.e6454","name":"auth","method":"POST","ret":"obj","paytoqs":"ignore","url":"https://localhost:1880/auth/token","tls":"b1a419c1.609c29","persist":false,"proxy":"","authType":"","x":930,"y":940,"wires":[["377719bd.eba6b6"]]},{"id":"fec03683.cbcf88","type":"change","z":"5bbedfa3.e6454","name":"auth payload","rules":[{"t":"set","p":"payload.client_id","pt":"msg","to":"node-red-editor","tot":"str"},{"t":"set","p":"payload.grant_type","pt":"msg","to":"password","tot":"str"},{"t":"set","p":"payload.scope","pt":"msg","to":"","tot":"str"},{"t":"set","p":"payload.username","pt":"msg","to":"NRADM_USER","tot":"env"},{"t":"set","p":"payload.password","pt":"msg","to":"NRADM_PASS","tot":"env"}],"action":"","property":"","from":"","to":"","reg":false,"x":770,"y":940,"wires":[["e2cd2625.466588"]]},{"id":"9ddda104.03a19","type":"change","z":"5bbedfa3.e6454","name":"","rules":[{"t":"set","p":"accessToken","pt":"msg","to":"payload.access_token","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":1260,"y":940,"wires":[["63222001.1bea3"]]},{"id":"63222001.1bea3","type":"change","z":"5bbedfa3.e6454","name":"bearer","rules":[{"t":"set","p":"headers","pt":"msg","to":"{}","tot":"json"},{"t":"set","p":"headers.authorization","pt":"msg","to":"\"Bearer \" & msg.accessToken","tot":"jsonata"}],"action":"","property":"","from":"","to":"","reg":false,"x":1450,"y":940,"wires":[["6cca9e00.068e24"]]},{"id":"8b535aeb.cdf5b8","type":"http request","z":"5bbedfa3.e6454","name":"","method":"POST","ret":"obj","paytoqs":"ignore","url":"${CFG_ACL_ENDP}","tls":"51b09598.a1114d","persist":false,"proxy":"","authType":"","x":610,"y":840,"wires":[["43c33b58.20a804"]]},{"id":"43c33b58.20a804","type":"switch","z":"5bbedfa3.e6454","name":"","property":"statusCode","propertyType":"msg","rules":[{"t":"eq","v":"200","vt":"num"},{"t":"else"}],"checkall":"true","repair":false,"outputs":2,"x":770,"y":840,"wires":[["8500f02c.2486d"],["23c65149.f6865e"]]},{"id":"82b28a94.c26c58","type":"http request","z":"5bbedfa3.e6454","name":"","method":"POST","ret":"obj","paytoqs":"ignore","url":"${CFG_ACL_ENDP}","tls":"51b09598.a1114d","persist":false,"proxy":"","authType":"","x":450,"y":940,"wires":[["c265ac06.6695"]]},{"id":"c265ac06.6695","type":"switch","z":"5bbedfa3.e6454","name":"","property":"statusCode","propertyType":"msg","rules":[{"t":"eq","v":"200","vt":"num"},{"t":"else"}],"checkall":"true","repair":false,"outputs":2,"x":610,"y":940,"wires":[["fec03683.cbcf88"],["df729a40.8d46b8"]]},{"id":"dc10f339.b3daf","type":"change","z":"5bbedfa3.e6454","name":"acl req payload","rules":[{"t":"set","p":"headers","pt":"msg","to":"{}","tot":"json"},{"t":"set","p":"payload","pt":"msg","to":"{}","tot":"json"},{"t":"set","p":"payload.url","pt":"msg","to":"req.url","tot":"msg"},{"t":"set","p":"payload.method","pt":"msg","to":"req.method","tot":"msg"},{"t":"set","p":"payload.headers","pt":"msg","to":"req.headers","tot":"msg"},{"t":"set","p":"payload.params","pt":"msg","to":"req.params","tot":"msg"},{"t":"set","p":"payload.query","pt":"msg","to":"req.query","tot":"msg"},{"t":"set","p":"payload.body","pt":"msg","to":"req.body","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":260,"y":940,"wires":[["82b28a94.c26c58"]]},{"id":"23544a7b.1ee046","type":"change","z":"5bbedfa3.e6454","name":"acl req payload","rules":[{"t":"set","p":"headers","pt":"msg","to":"{}","tot":"json"},{"t":"set","p":"payload","pt":"msg","to":"{}","tot":"json"},{"t":"set","p":"payload.url","pt":"msg","to":"req.url","tot":"msg"},{"t":"set","p":"payload.method","pt":"msg","to":"req.method","tot":"msg"},{"t":"set","p":"payload.headers","pt":"msg","to":"req.headers","tot":"msg"},{"t":"set","p":"payload.params","pt":"msg","to":"req.params","tot":"msg"},{"t":"set","p":"payload.query","pt":"msg","to":"req.query","tot":"msg"},{"t":"set","p":"payload.body","pt":"msg","to":"req.body","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":420,"y":840,"wires":[["8b535aeb.cdf5b8"]]},{"id":"df729a40.8d46b8","type":"http response","z":"5bbedfa3.e6454","name":"","statusCode":"","headers":{},"x":750,"y":980,"wires":[]},{"id":"f3797c1e.cc2a8","type":"change","z":"5bbedfa3.e6454","name":"","rules":[{"t":"set","p":"payload","pt":"msg","to":"*[name = \"dbread mysql server config\" and type=\"Stackhero-MySQL-Server\"].port","tot":"jsonata"}],"action":"","property":"","from":"","to":"","reg":false,"x":1920,"y":940,"wires":[["66aac69e.3d6338"]]},{"id":"743248b0.ff3f58","type":"change","z":"5bbedfa3.e6454","name":"edit","rules":[{"t":"set","p":"old","pt":"msg","to":"*[name = \"dbread mysql server config\" and type=\"Stackhero-MySQL-Server\"]","tot":"jsonata"},{"t":"set","p":"new","pt":"msg","to":"old","tot":"msg"},{"t":"set","p":"new.port","pt":"msg","to":"port","tot":"msg"},{"t":"set","p":"payload","pt":"msg","to":"$eval($replace($string(payload),$string(old),$string(new)))","tot":"jsonata"}],"action":"","property":"","from":"","to":"","reg":false,"x":2050,"y":840,"wires":[["be7c6a16.c90d38"]]},{"id":"23c65149.f6865e","type":"http response","z":"5bbedfa3.e6454","name":"","statusCode":"","headers":{},"x":910,"y":880,"wires":[]},{"id":"72e3244a.bb495c","type":"switch","z":"5bbedfa3.e6454","name":"","property":"statusCode","propertyType":"msg","rules":[{"t":"eq","v":"200","vt":"num"},{"t":"else"}],"checkall":"true","repair":false,"outputs":2,"x":1230,"y":840,"wires":[["adb1cfa9.b218c"],["783c6a52.ba3344"]]},{"id":"783c6a52.ba3344","type":"http response","z":"5bbedfa3.e6454","name":"","statusCode":"","headers":{},"x":1370,"y":880,"wires":[]},{"id":"e2a57dd1.11c7f","type":"switch","z":"5bbedfa3.e6454","name":"","property":"statusCode","propertyType":"msg","rules":[{"t":"eq","v":"200","vt":"num"},{"t":"else"}],"checkall":"true","repair":false,"outputs":2,"x":1910,"y":840,"wires":[["743248b0.ff3f58"],["579a899a.b00c48"]]},{"id":"579a899a.b00c48","type":"http response","z":"5bbedfa3.e6454","name":"","statusCode":"","headers":{},"x":2050,"y":880,"wires":[]},{"id":"be7c6a16.c90d38","type":"function","z":"5bbedfa3.e6454","name":"update flows","func":"const http = global.get('https');\nconst data = JSON.stringify(msg.payload);\nconst options = {\n  hostname: 'localhost',\n  port: 1880,\n  path: '/flows',\n  method: 'POST',\n  headers: {\n    'Content-Type': 'application/json',\n    'Content-Length': data.length,\n    'Authorization': 'Bearer '+msg.accessToken\n  },\n  rejectUnauthorized: false\n};\nconst req = http.request(options);\nreq.write(data);\nreq.end();\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":2210,"y":840,"wires":[["3e75359d.a951ca"]]},{"id":"377719bd.eba6b6","type":"switch","z":"5bbedfa3.e6454","name":"","property":"statusCode","propertyType":"msg","rules":[{"t":"eq","v":"200","vt":"num"},{"t":"else"}],"checkall":"true","repair":false,"outputs":2,"x":1070,"y":940,"wires":[["9ddda104.03a19"],["e2e916d7.e15ac8"]]},{"id":"e2e916d7.e15ac8","type":"http response","z":"5bbedfa3.e6454","name":"","statusCode":"","headers":{},"x":1210,"y":980,"wires":[]},{"id":"5707cf05.dc4d6","type":"switch","z":"5bbedfa3.e6454","name":"","property":"statusCode","propertyType":"msg","rules":[{"t":"eq","v":"200","vt":"num"},{"t":"else"}],"checkall":"true","repair":false,"outputs":2,"x":1750,"y":940,"wires":[["f3797c1e.cc2a8"],["6554bda2.0f2864"]]},{"id":"6554bda2.0f2864","type":"http response","z":"5bbedfa3.e6454","name":"","statusCode":"","headers":{},"x":1890,"y":980,"wires":[]},{"id":"b2418d00.738b9","type":"change","z":"5bbedfa3.e6454","name":"status","rules":[{"t":"set","p":"payload","pt":"msg","to":"{}","tot":"json"},{"t":"set","p":"payload.text","pt":"msg","to":"\"port: \" & port","tot":"jsonata"},{"t":"set","p":"payload.shape","pt":"msg","to":"dot","tot":"str"},{"t":"set","p":"payload.fill","pt":"msg","to":"grey","tot":"str"}],"action":"","property":"","from":"","to":"","reg":false,"x":2770,"y":900,"wires":[[]]},{"id":"6bebb37a.91e53c","type":"http in","z":"5bbedfa3.e6454","name":"PUT tls","url":"/dbread/tls","method":"put","upload":false,"swaggerDoc":"","x":70,"y":1080,"wires":[["a6a72621.b2eda8"]]},{"id":"14cc7b2.cbdd385","type":"change","z":"5bbedfa3.e6454","name":"","rules":[{"t":"set","p":"payload","pt":"msg","to":"tls ? \"yes\" : \"no\"","tot":"jsonata"}],"action":"","property":"","from":"","to":"","reg":false,"x":2520,"y":1080,"wires":[["8dd21eb2.35f3f"]]},{"id":"189142e5.5375ad","type":"http in","z":"5bbedfa3.e6454","name":"GET tls","url":"/dbread/tls","method":"get","upload":false,"swaggerDoc":"","x":70,"y":1180,"wires":[["9ac2263b.4d4788"]]},{"id":"7d3b18ca.4fe7c8","type":"http response","z":"5bbedfa3.e6454","name":"","statusCode":"","headers":{},"x":2290,"y":1180,"wires":[]},{"id":"6438a003.c1592","type":"change","z":"5bbedfa3.e6454","name":"","rules":[{"t":"set","p":"headers","pt":"msg","to":"{\"Content-Type\":\"text/plain\"}","tot":"json"}],"action":"","property":"","from":"","to":"","reg":false,"x":2120,"y":1180,"wires":[["7d3b18ca.4fe7c8"]]},{"id":"bf80ad4d.46b18","type":"change","z":"5bbedfa3.e6454","name":"get inputs","rules":[{"t":"set","p":"tls","pt":"msg","to":"false","tot":"bool"}],"action":"","property":"","from":"","to":"","reg":false,"x":360,"y":1080,"wires":[["a5cdc093.1cf6c"]]},{"id":"6fcb1767.082c68","type":"http request","z":"5bbedfa3.e6454","name":"get flows","method":"GET","ret":"obj","paytoqs":"ignore","url":"https://localhost:1880/flows","tls":"b1a419c1.609c29","persist":false,"proxy":"","authType":"","x":1880,"y":1080,"wires":[["6786e229.5875fc"]]},{"id":"baf8806e.1a577","type":"http response","z":"5bbedfa3.e6454","name":"","statusCode":"","headers":{},"x":2890,"y":1080,"wires":[]},{"id":"8dd21eb2.35f3f","type":"change","z":"5bbedfa3.e6454","name":"","rules":[{"t":"set","p":"headers","pt":"msg","to":"{\"Content-Type\":\"text/plain\"}","tot":"json"}],"action":"","property":"","from":"","to":"","reg":false,"x":2720,"y":1080,"wires":[["baf8806e.1a577","d35ba105.d14ae"]]},{"id":"56a458c3.c716f8","type":"http request","z":"5bbedfa3.e6454","name":"get flows","method":"GET","ret":"obj","paytoqs":"ignore","url":"https://localhost:1880/flows","tls":"b1a419c1.609c29","persist":false,"proxy":"","authType":"","x":1600,"y":1180,"wires":[["34d9cce6.0d2564"]]},{"id":"67286979.555cd8","type":"http request","z":"5bbedfa3.e6454","name":"auth","method":"POST","ret":"obj","paytoqs":"ignore","url":"https://localhost:1880/auth/token","tls":"b1a419c1.609c29","persist":false,"proxy":"","authType":"","x":1210,"y":1080,"wires":[["76b86c6b.45dd44"]]},{"id":"1d3b625a.515b0e","type":"change","z":"5bbedfa3.e6454","name":"auth payload","rules":[{"t":"set","p":"payload","pt":"msg","to":"{}","tot":"json"},{"t":"set","p":"payload.client_id","pt":"msg","to":"node-red-editor","tot":"str"},{"t":"set","p":"payload.grant_type","pt":"msg","to":"password","tot":"str"},{"t":"set","p":"payload.scope","pt":"msg","to":"","tot":"str"},{"t":"set","p":"payload.username","pt":"msg","to":"NRADM_USER","tot":"env"},{"t":"set","p":"payload.password","pt":"msg","to":"NRADM_PASS","tot":"env"}],"action":"","property":"","from":"","to":"","reg":false,"x":1050,"y":1080,"wires":[["67286979.555cd8"]]},{"id":"641a183c.ae4208","type":"change","z":"5bbedfa3.e6454","name":"","rules":[{"t":"set","p":"accessToken","pt":"msg","to":"payload.access_token","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":1540,"y":1080,"wires":[["80a9dbf3.909058"]]},{"id":"80a9dbf3.909058","type":"change","z":"5bbedfa3.e6454","name":"bearer","rules":[{"t":"set","p":"headers","pt":"msg","to":"{}","tot":"json"},{"t":"set","p":"headers.authorization","pt":"msg","to":"\"Bearer \" & msg.accessToken","tot":"jsonata"}],"action":"","property":"","from":"","to":"","reg":false,"x":1730,"y":1080,"wires":[["6fcb1767.082c68"]]},{"id":"d8add478.641db8","type":"http request","z":"5bbedfa3.e6454","name":"auth","method":"POST","ret":"obj","paytoqs":"ignore","url":"https://localhost:1880/auth/token","tls":"b1a419c1.609c29","persist":false,"proxy":"","authType":"","x":930,"y":1180,"wires":[["2ab3584c.8da798"]]},{"id":"4a658e25.78f5a","type":"change","z":"5bbedfa3.e6454","name":"auth payload","rules":[{"t":"set","p":"payload.client_id","pt":"msg","to":"node-red-editor","tot":"str"},{"t":"set","p":"payload.grant_type","pt":"msg","to":"password","tot":"str"},{"t":"set","p":"payload.scope","pt":"msg","to":"","tot":"str"},{"t":"set","p":"payload.username","pt":"msg","to":"NRADM_USER","tot":"env"},{"t":"set","p":"payload.password","pt":"msg","to":"NRADM_PASS","tot":"env"}],"action":"","property":"","from":"","to":"","reg":false,"x":770,"y":1180,"wires":[["d8add478.641db8"]]},{"id":"82d3e020.b5123","type":"change","z":"5bbedfa3.e6454","name":"","rules":[{"t":"set","p":"accessToken","pt":"msg","to":"payload.access_token","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":1260,"y":1180,"wires":[["557ef73c.3c7b88"]]},{"id":"557ef73c.3c7b88","type":"change","z":"5bbedfa3.e6454","name":"bearer","rules":[{"t":"set","p":"headers","pt":"msg","to":"{}","tot":"json"},{"t":"set","p":"headers.authorization","pt":"msg","to":"\"Bearer \" & msg.accessToken","tot":"jsonata"}],"action":"","property":"","from":"","to":"","reg":false,"x":1450,"y":1180,"wires":[["56a458c3.c716f8"]]},{"id":"e7881a60.634558","type":"http request","z":"5bbedfa3.e6454","name":"","method":"POST","ret":"obj","paytoqs":"ignore","url":"${CFG_ACL_ENDP}","tls":"51b09598.a1114d","persist":false,"proxy":"","authType":"","x":730,"y":1080,"wires":[["ca48eaf1.b274e8"]]},{"id":"ca48eaf1.b274e8","type":"switch","z":"5bbedfa3.e6454","name":"","property":"statusCode","propertyType":"msg","rules":[{"t":"eq","v":"200","vt":"num"},{"t":"else"}],"checkall":"true","repair":false,"outputs":2,"x":890,"y":1080,"wires":[["1d3b625a.515b0e"],["9f8d1b58.0eba58"]]},{"id":"f1d893b8.3f136","type":"http request","z":"5bbedfa3.e6454","name":"","method":"POST","ret":"obj","paytoqs":"ignore","url":"${CFG_ACL_ENDP}","tls":"51b09598.a1114d","persist":false,"proxy":"","authType":"","x":450,"y":1180,"wires":[["766ef29c.86bd4c"]]},{"id":"766ef29c.86bd4c","type":"switch","z":"5bbedfa3.e6454","name":"","property":"statusCode","propertyType":"msg","rules":[{"t":"eq","v":"200","vt":"num"},{"t":"else"}],"checkall":"true","repair":false,"outputs":2,"x":610,"y":1180,"wires":[["4a658e25.78f5a"],["2f9a2621.fc241a"]]},{"id":"9ac2263b.4d4788","type":"change","z":"5bbedfa3.e6454","name":"acl req payload","rules":[{"t":"set","p":"headers","pt":"msg","to":"{}","tot":"json"},{"t":"set","p":"payload","pt":"msg","to":"{}","tot":"json"},{"t":"set","p":"payload.url","pt":"msg","to":"req.url","tot":"msg"},{"t":"set","p":"payload.method","pt":"msg","to":"req.method","tot":"msg"},{"t":"set","p":"payload.headers","pt":"msg","to":"req.headers","tot":"msg"},{"t":"set","p":"payload.params","pt":"msg","to":"req.params","tot":"msg"},{"t":"set","p":"payload.query","pt":"msg","to":"req.query","tot":"msg"},{"t":"set","p":"payload.body","pt":"msg","to":"req.body","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":260,"y":1180,"wires":[["f1d893b8.3f136"]]},{"id":"a5cdc093.1cf6c","type":"change","z":"5bbedfa3.e6454","name":"acl req payload","rules":[{"t":"set","p":"headers","pt":"msg","to":"{}","tot":"json"},{"t":"set","p":"payload","pt":"msg","to":"{}","tot":"json"},{"t":"set","p":"payload.url","pt":"msg","to":"req.url","tot":"msg"},{"t":"set","p":"payload.method","pt":"msg","to":"req.method","tot":"msg"},{"t":"set","p":"payload.headers","pt":"msg","to":"req.headers","tot":"msg"},{"t":"set","p":"payload.params","pt":"msg","to":"req.params","tot":"msg"},{"t":"set","p":"payload.query","pt":"msg","to":"req.query","tot":"msg"},{"t":"set","p":"payload.body","pt":"msg","to":"req.body","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":540,"y":1080,"wires":[["e7881a60.634558"]]},{"id":"2f9a2621.fc241a","type":"http response","z":"5bbedfa3.e6454","name":"","statusCode":"","headers":{},"x":750,"y":1220,"wires":[]},{"id":"e8313ec4.e5096","type":"change","z":"5bbedfa3.e6454","name":"","rules":[{"t":"set","p":"payload","pt":"msg","to":"*[name = \"dbread mysql server config\" and type=\"Stackhero-MySQL-Server\"].tls ? \"yes\" : \"no\"","tot":"jsonata"}],"action":"","property":"","from":"","to":"","reg":false,"x":1920,"y":1180,"wires":[["6438a003.c1592"]]},{"id":"dc6b1c37.a4635","type":"change","z":"5bbedfa3.e6454","name":"edit","rules":[{"t":"set","p":"old","pt":"msg","to":"*[name = \"dbread mysql server config\" and type=\"Stackhero-MySQL-Server\"]","tot":"jsonata"},{"t":"set","p":"new","pt":"msg","to":"old","tot":"msg"},{"t":"set","p":"new.tls","pt":"msg","to":"tls","tot":"msg"},{"t":"set","p":"payload","pt":"msg","to":"$eval($replace($string(payload),$string(old),$string(new)))","tot":"jsonata"}],"action":"","property":"","from":"","to":"","reg":false,"x":2170,"y":1080,"wires":[["4f9966d2.836cb8"]]},{"id":"9f8d1b58.0eba58","type":"http response","z":"5bbedfa3.e6454","name":"","statusCode":"","headers":{},"x":1030,"y":1120,"wires":[]},{"id":"76b86c6b.45dd44","type":"switch","z":"5bbedfa3.e6454","name":"","property":"statusCode","propertyType":"msg","rules":[{"t":"eq","v":"200","vt":"num"},{"t":"else"}],"checkall":"true","repair":false,"outputs":2,"x":1350,"y":1080,"wires":[["641a183c.ae4208"],["56149d9.a333764"]]},{"id":"56149d9.a333764","type":"http response","z":"5bbedfa3.e6454","name":"","statusCode":"","headers":{},"x":1490,"y":1120,"wires":[]},{"id":"6786e229.5875fc","type":"switch","z":"5bbedfa3.e6454","name":"","property":"statusCode","propertyType":"msg","rules":[{"t":"eq","v":"200","vt":"num"},{"t":"else"}],"checkall":"true","repair":false,"outputs":2,"x":2030,"y":1080,"wires":[["dc6b1c37.a4635"],["40f61444.e2279c"]]},{"id":"40f61444.e2279c","type":"http response","z":"5bbedfa3.e6454","name":"","statusCode":"","headers":{},"x":2170,"y":1120,"wires":[]},{"id":"4f9966d2.836cb8","type":"function","z":"5bbedfa3.e6454","name":"update flows","func":"const http = global.get('https');\nconst data = JSON.stringify(msg.payload);\nconst options = {\n  hostname: 'localhost',\n  port: 1880,\n  path: '/flows',\n  method: 'POST',\n  headers: {\n    'Content-Type': 'application/json',\n    'Content-Length': data.length,\n    'Authorization': 'Bearer '+msg.accessToken\n  },\n  rejectUnauthorized: false\n};\nconst req = http.request(options);\nreq.write(data);\nreq.end();\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":2330,"y":1080,"wires":[["14cc7b2.cbdd385"]]},{"id":"2ab3584c.8da798","type":"switch","z":"5bbedfa3.e6454","name":"","property":"statusCode","propertyType":"msg","rules":[{"t":"eq","v":"200","vt":"num"},{"t":"else"}],"checkall":"true","repair":false,"outputs":2,"x":1070,"y":1180,"wires":[["82d3e020.b5123"],["6cca4814.53bdd8"]]},{"id":"6cca4814.53bdd8","type":"http response","z":"5bbedfa3.e6454","name":"","statusCode":"","headers":{},"x":1210,"y":1220,"wires":[]},{"id":"34d9cce6.0d2564","type":"switch","z":"5bbedfa3.e6454","name":"","property":"statusCode","propertyType":"msg","rules":[{"t":"eq","v":"200","vt":"num"},{"t":"else"}],"checkall":"true","repair":false,"outputs":2,"x":1750,"y":1180,"wires":[["e8313ec4.e5096"],["6550167b.222cf8"]]},{"id":"6550167b.222cf8","type":"http response","z":"5bbedfa3.e6454","name":"","statusCode":"","headers":{},"x":1890,"y":1220,"wires":[]},{"id":"d35ba105.d14ae","type":"change","z":"5bbedfa3.e6454","name":"status","rules":[{"t":"set","p":"payload","pt":"msg","to":"{}","tot":"json"},{"t":"set","p":"payload.text","pt":"msg","to":"\"tls: \" & tls","tot":"jsonata"},{"t":"set","p":"payload.shape","pt":"msg","to":"dot","tot":"str"},{"t":"set","p":"payload.fill","pt":"msg","to":"grey","tot":"str"}],"action":"","property":"","from":"","to":"","reg":false,"x":2890,"y":1140,"wires":[[]]},{"id":"a6a72621.b2eda8","type":"switch","z":"5bbedfa3.e6454","name":"","property":"payload","propertyType":"msg","rules":[{"t":"eq","v":"yes","vt":"str"},{"t":"eq","v":"no","vt":"str"},{"t":"else"}],"checkall":"true","repair":false,"outputs":3,"x":210,"y":1080,"wires":[["974d5e55.81e73"],["bf80ad4d.46b18"],["1b66bcde.189b93"]]},{"id":"1b66bcde.189b93","type":"change","z":"5bbedfa3.e6454","name":"get inputs","rules":[{"t":"set","p":"payload","pt":"msg","to":"Allowed values: yes, no.","tot":"str"}],"action":"","property":"","from":"","to":"","reg":false,"x":360,"y":1120,"wires":[["80533a19.70ea08"]]},{"id":"974d5e55.81e73","type":"change","z":"5bbedfa3.e6454","name":"get inputs","rules":[{"t":"set","p":"tls","pt":"msg","to":"true","tot":"bool"}],"action":"","property":"","from":"","to":"","reg":false,"x":360,"y":1040,"wires":[["a5cdc093.1cf6c"]]},{"id":"80533a19.70ea08","type":"http response","z":"5bbedfa3.e6454","name":"","statusCode":"400","headers":{},"x":520,"y":1120,"wires":[]},{"id":"695b34fd.215afc","type":"switch","z":"5bbedfa3.e6454","name":"","property":"payload","propertyType":"msg","rules":[{"t":"nempty"},{"t":"else"}],"checkall":"true","repair":false,"outputs":2,"x":510,"y":1420,"wires":[["7e3bca58.242d64"],["ad73d791.2041c8"]]},{"id":"689c7df.fcf1784","type":"http in","z":"5bbedfa3.e6454","name":"PUT credentials","url":"/dbread/credentials","method":"put","upload":false,"swaggerDoc":"","x":100,"y":1300,"wires":[["4314685a.4a44b8"]]},{"id":"4314685a.4a44b8","type":"change","z":"5bbedfa3.e6454","name":"get inputs","rules":[{"t":"set","p":"user","pt":"msg","to":"payload.user","tot":"msg"},{"t":"set","p":"password","pt":"msg","to":"payload.password","tot":"msg"},{"t":"set","p":"nodeName","pt":"msg","to":"req.params.nodeName","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":280,"y":1300,"wires":[["2d84c61c.71c43a"]]},{"id":"e61ac747.287968","type":"http request","z":"5bbedfa3.e6454","name":"get flows","method":"GET","ret":"obj","paytoqs":"ignore","url":"https://localhost:1880/flows","tls":"b1a419c1.609c29","persist":false,"proxy":"","authType":"","x":1800,"y":1300,"wires":[["aafb4300.245c6"]]},{"id":"4895abdb.ee1744","type":"function","z":"5bbedfa3.e6454","name":"update flows","func":"const http = global.get('https');\nconst data = JSON.stringify(msg.payload);\nconst options = {\n  hostname: 'localhost',\n  port: 1880,\n  path: '/flows',\n  method: 'POST',\n  headers: {\n    'Content-Type': 'application/json',\n    'Content-Length': data.length,\n    'Authorization': 'Bearer '+msg.accessToken\n  },\n  rejectUnauthorized: false\n};\nconst req = http.request(options);\nreq.write(data);\nreq.end();\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":2250,"y":1300,"wires":[["f58de0b6.10291"]]},{"id":"f58de0b6.10291","type":"change","z":"5bbedfa3.e6454","name":"set payload","rules":[{"t":"set","p":"payload","pt":"msg","to":"{}","tot":"json"},{"t":"set","p":"payload.user","pt":"msg","to":"user","tot":"msg"},{"t":"set","p":"payload.password","pt":"msg","to":"password","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":2430,"y":1300,"wires":[["516093d9.9fab6c"]]},{"id":"516093d9.9fab6c","type":"change","z":"5bbedfa3.e6454","name":"","rules":[{"t":"set","p":"headers","pt":"msg","to":"{\"Content-Type\":\"application/json\"}","tot":"json"}],"action":"","property":"","from":"","to":"","reg":false,"x":2620,"y":1300,"wires":[["25686d03.e52fa2","f8990386.db346"]]},{"id":"25686d03.e52fa2","type":"http response","z":"5bbedfa3.e6454","name":"","statusCode":"","headers":{},"x":2790,"y":1300,"wires":[]},{"id":"12ebb6ce.b3f879","type":"http request","z":"5bbedfa3.e6454","name":"auth","method":"POST","ret":"obj","paytoqs":"ignore","url":"https://localhost:1880/auth/token","tls":"b1a419c1.609c29","persist":false,"proxy":"","authType":"","x":1130,"y":1300,"wires":[["631ed416.35ea6c"]]},{"id":"265f8a24.9234c6","type":"change","z":"5bbedfa3.e6454","name":"auth payload","rules":[{"t":"set","p":"payload","pt":"msg","to":"{}","tot":"json"},{"t":"set","p":"payload.client_id","pt":"msg","to":"node-red-editor","tot":"str"},{"t":"set","p":"payload.grant_type","pt":"msg","to":"password","tot":"str"},{"t":"set","p":"payload.scope","pt":"msg","to":"","tot":"str"},{"t":"set","p":"payload.username","pt":"msg","to":"NRADM_USER","tot":"env"},{"t":"set","p":"payload.password","pt":"msg","to":"NRADM_PASS","tot":"env"}],"action":"","property":"","from":"","to":"","reg":false,"x":970,"y":1300,"wires":[["12ebb6ce.b3f879"]]},{"id":"6ebec0b4.a70d5","type":"change","z":"5bbedfa3.e6454","name":"","rules":[{"t":"set","p":"accessToken","pt":"msg","to":"payload.access_token","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":1460,"y":1300,"wires":[["bba8a5e6.d7ed88"]]},{"id":"bba8a5e6.d7ed88","type":"change","z":"5bbedfa3.e6454","name":"bearer","rules":[{"t":"set","p":"headers","pt":"msg","to":"{}","tot":"json"},{"t":"set","p":"headers.authorization","pt":"msg","to":"\"Bearer \" & msg.accessToken","tot":"jsonata"}],"action":"","property":"","from":"","to":"","reg":false,"x":1650,"y":1300,"wires":[["e61ac747.287968"]]},{"id":"145f4b83.7e2994","type":"http request","z":"5bbedfa3.e6454","name":"","method":"POST","ret":"obj","paytoqs":"ignore","url":"${CFG_ACL_ENDP}","tls":"51b09598.a1114d","persist":false,"proxy":"","authType":"","x":650,"y":1300,"wires":[["34143938.92ed16"]]},{"id":"34143938.92ed16","type":"switch","z":"5bbedfa3.e6454","name":"","property":"statusCode","propertyType":"msg","rules":[{"t":"eq","v":"200","vt":"num"},{"t":"else"}],"checkall":"true","repair":false,"outputs":2,"x":810,"y":1300,"wires":[["265f8a24.9234c6"],["722174d7.f0ecfc"]]},{"id":"2d84c61c.71c43a","type":"change","z":"5bbedfa3.e6454","name":"acl req payload","rules":[{"t":"set","p":"headers","pt":"msg","to":"{}","tot":"json"},{"t":"set","p":"payload","pt":"msg","to":"{}","tot":"json"},{"t":"set","p":"payload.url","pt":"msg","to":"req.url","tot":"msg"},{"t":"set","p":"payload.method","pt":"msg","to":"req.method","tot":"msg"},{"t":"set","p":"payload.headers","pt":"msg","to":"req.headers","tot":"msg"},{"t":"set","p":"payload.params","pt":"msg","to":"req.params","tot":"msg"},{"t":"set","p":"payload.query","pt":"msg","to":"req.query","tot":"msg"},{"t":"set","p":"payload.body","pt":"msg","to":"req.body","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":460,"y":1300,"wires":[["145f4b83.7e2994"]]},{"id":"722174d7.f0ecfc","type":"http response","z":"5bbedfa3.e6454","name":"","statusCode":"","headers":{},"x":950,"y":1340,"wires":[]},{"id":"1bf31089.9127ff","type":"change","z":"5bbedfa3.e6454","name":"edit","rules":[{"t":"set","p":"old","pt":"msg","to":"*[name = \"dbread mysql server config\" and type = \"Stackhero-MySQL-Server\"]","tot":"jsonata"},{"t":"set","p":"new","pt":"msg","to":"old","tot":"msg"},{"t":"set","p":"new.credentials","pt":"msg","to":"{}","tot":"json"},{"t":"set","p":"new.credentials.user","pt":"msg","to":"user","tot":"msg"},{"t":"set","p":"new.credentials.password","pt":"msg","to":"password","tot":"msg"},{"t":"set","p":"payload","pt":"msg","to":"$eval($replace($string(payload),$string(old),$string(new)))","tot":"jsonata"}],"action":"","property":"","from":"","to":"","reg":false,"x":2090,"y":1300,"wires":[["4895abdb.ee1744"]]},{"id":"631ed416.35ea6c","type":"switch","z":"5bbedfa3.e6454","name":"","property":"statusCode","propertyType":"msg","rules":[{"t":"eq","v":"200","vt":"num"},{"t":"else"}],"checkall":"true","repair":false,"outputs":2,"x":1270,"y":1300,"wires":[["6ebec0b4.a70d5"],["b602579e.295c78"]]},{"id":"b602579e.295c78","type":"http response","z":"5bbedfa3.e6454","name":"","statusCode":"","headers":{},"x":1410,"y":1340,"wires":[]},{"id":"aafb4300.245c6","type":"switch","z":"5bbedfa3.e6454","name":"","property":"statusCode","propertyType":"msg","rules":[{"t":"eq","v":"200","vt":"num"},{"t":"else"}],"checkall":"true","repair":false,"outputs":2,"x":1950,"y":1300,"wires":[["1bf31089.9127ff"],["702afada.3798d4"]]},{"id":"702afada.3798d4","type":"http response","z":"5bbedfa3.e6454","name":"","statusCode":"","headers":{},"x":2090,"y":1340,"wires":[]},{"id":"93e35492.d12028","type":"http in","z":"5bbedfa3.e6454","name":"PUT database","url":"/dbread/database","method":"put","upload":false,"swaggerDoc":"","x":90,"y":40,"wires":[["c1c9c1d2.e5fc1"]]},{"id":"30bf7c2.8144984","type":"change","z":"5bbedfa3.e6454","name":"","rules":[{"t":"set","p":"payload","pt":"msg","to":"dbname","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":2400,"y":40,"wires":[["d99aa093.81c4f"]]},{"id":"50c23581.04fb0c","type":"http in","z":"5bbedfa3.e6454","name":"GET database","url":"/dbread/database","method":"get","upload":false,"swaggerDoc":"","x":90,"y":140,"wires":[["5e818f4.b21c67"]]},{"id":"8778f7a9.dabf38","type":"http response","z":"5bbedfa3.e6454","name":"","statusCode":"","headers":{},"x":2290,"y":140,"wires":[]},{"id":"afe2c0f1.00ef8","type":"change","z":"5bbedfa3.e6454","name":"","rules":[{"t":"set","p":"headers","pt":"msg","to":"{\"Content-Type\":\"text/plain\"}","tot":"json"}],"action":"","property":"","from":"","to":"","reg":false,"x":2120,"y":140,"wires":[["8778f7a9.dabf38"]]},{"id":"c1c9c1d2.e5fc1","type":"change","z":"5bbedfa3.e6454","name":"get inputs","rules":[{"t":"set","p":"dbname","pt":"msg","to":"payload","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":240,"y":40,"wires":[["e99e6f.75ecf19"]]},{"id":"6b7a040b.36ea0c","type":"http request","z":"5bbedfa3.e6454","name":"get flows","method":"GET","ret":"obj","paytoqs":"ignore","url":"https://localhost:1880/flows","tls":"b1a419c1.609c29","persist":false,"proxy":"","authType":"","x":1760,"y":40,"wires":[["fb4d066d.2a6998"]]},{"id":"7ff8d178.3958c","type":"http response","z":"5bbedfa3.e6454","name":"","statusCode":"","headers":{},"x":2770,"y":40,"wires":[]},{"id":"d99aa093.81c4f","type":"change","z":"5bbedfa3.e6454","name":"","rules":[{"t":"set","p":"headers","pt":"msg","to":"{\"Content-Type\":\"text/plain\"}","tot":"json"}],"action":"","property":"","from":"","to":"","reg":false,"x":2600,"y":40,"wires":[["7ff8d178.3958c","9d8c3c75.5e0f2"]]},{"id":"2c2ec915.6da916","type":"http request","z":"5bbedfa3.e6454","name":"get flows","method":"GET","ret":"obj","paytoqs":"ignore","url":"https://localhost:1880/flows","tls":"b1a419c1.609c29","persist":false,"proxy":"","authType":"","x":1600,"y":140,"wires":[["18d668d.15faa97"]]},{"id":"ae39bff.a42db4","type":"http request","z":"5bbedfa3.e6454","name":"auth","method":"POST","ret":"obj","paytoqs":"ignore","url":"https://localhost:1880/auth/token","tls":"b1a419c1.609c29","persist":false,"proxy":"","authType":"","x":1090,"y":40,"wires":[["6599cf82.21f9"]]},{"id":"345df225.ed095e","type":"change","z":"5bbedfa3.e6454","name":"auth payload","rules":[{"t":"set","p":"payload","pt":"msg","to":"{}","tot":"json"},{"t":"set","p":"payload.client_id","pt":"msg","to":"node-red-editor","tot":"str"},{"t":"set","p":"payload.grant_type","pt":"msg","to":"password","tot":"str"},{"t":"set","p":"payload.scope","pt":"msg","to":"","tot":"str"},{"t":"set","p":"payload.username","pt":"msg","to":"NRADM_USER","tot":"env"},{"t":"set","p":"payload.password","pt":"msg","to":"NRADM_PASS","tot":"env"}],"action":"","property":"","from":"","to":"","reg":false,"x":930,"y":40,"wires":[["ae39bff.a42db4"]]},{"id":"edc491a7.0809c","type":"change","z":"5bbedfa3.e6454","name":"","rules":[{"t":"set","p":"accessToken","pt":"msg","to":"payload.access_token","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":1420,"y":40,"wires":[["bf8d94cc.69a9d8"]]},{"id":"bf8d94cc.69a9d8","type":"change","z":"5bbedfa3.e6454","name":"bearer","rules":[{"t":"set","p":"headers","pt":"msg","to":"{}","tot":"json"},{"t":"set","p":"headers.authorization","pt":"msg","to":"\"Bearer \" & msg.accessToken","tot":"jsonata"}],"action":"","property":"","from":"","to":"","reg":false,"x":1610,"y":40,"wires":[["6b7a040b.36ea0c"]]},{"id":"50c4ba05.ca6804","type":"http request","z":"5bbedfa3.e6454","name":"auth","method":"POST","ret":"obj","paytoqs":"ignore","url":"https://localhost:1880/auth/token","tls":"b1a419c1.609c29","persist":false,"proxy":"","authType":"","x":930,"y":140,"wires":[["acb73621.84b9d8"]]},{"id":"2862dd8f.2ea702","type":"change","z":"5bbedfa3.e6454","name":"auth payload","rules":[{"t":"set","p":"payload.client_id","pt":"msg","to":"node-red-editor","tot":"str"},{"t":"set","p":"payload.grant_type","pt":"msg","to":"password","tot":"str"},{"t":"set","p":"payload.scope","pt":"msg","to":"","tot":"str"},{"t":"set","p":"payload.username","pt":"msg","to":"NRADM_USER","tot":"env"},{"t":"set","p":"payload.password","pt":"msg","to":"NRADM_PASS","tot":"env"}],"action":"","property":"","from":"","to":"","reg":false,"x":770,"y":140,"wires":[["50c4ba05.ca6804"]]},{"id":"4ff5e66f.578588","type":"change","z":"5bbedfa3.e6454","name":"","rules":[{"t":"set","p":"accessToken","pt":"msg","to":"payload.access_token","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":1260,"y":140,"wires":[["a988439c.950f"]]},{"id":"a988439c.950f","type":"change","z":"5bbedfa3.e6454","name":"bearer","rules":[{"t":"set","p":"headers","pt":"msg","to":"{}","tot":"json"},{"t":"set","p":"headers.authorization","pt":"msg","to":"\"Bearer \" & msg.accessToken","tot":"jsonata"}],"action":"","property":"","from":"","to":"","reg":false,"x":1450,"y":140,"wires":[["2c2ec915.6da916"]]},{"id":"6293510a.7a7c8","type":"http request","z":"5bbedfa3.e6454","name":"","method":"POST","ret":"obj","paytoqs":"ignore","url":"${CFG_ACL_ENDP}","tls":"51b09598.a1114d","persist":false,"proxy":"","authType":"","x":610,"y":40,"wires":[["61dc5156.2c705"]]},{"id":"61dc5156.2c705","type":"switch","z":"5bbedfa3.e6454","name":"","property":"statusCode","propertyType":"msg","rules":[{"t":"eq","v":"200","vt":"num"},{"t":"else"}],"checkall":"true","repair":false,"outputs":2,"x":770,"y":40,"wires":[["345df225.ed095e"],["f050226e.e27e7"]]},{"id":"4e0ed29b.35981c","type":"http request","z":"5bbedfa3.e6454","name":"","method":"POST","ret":"obj","paytoqs":"ignore","url":"${CFG_ACL_ENDP}","tls":"51b09598.a1114d","persist":false,"proxy":"","authType":"","x":450,"y":140,"wires":[["323af63c.9e891a"]]},{"id":"323af63c.9e891a","type":"switch","z":"5bbedfa3.e6454","name":"","property":"statusCode","propertyType":"msg","rules":[{"t":"eq","v":"200","vt":"num"},{"t":"else"}],"checkall":"true","repair":false,"outputs":2,"x":610,"y":140,"wires":[["2862dd8f.2ea702"],["ce91d997.522938"]]},{"id":"5e818f4.b21c67","type":"change","z":"5bbedfa3.e6454","name":"acl req payload","rules":[{"t":"set","p":"headers","pt":"msg","to":"{}","tot":"json"},{"t":"set","p":"payload","pt":"msg","to":"{}","tot":"json"},{"t":"set","p":"payload.url","pt":"msg","to":"req.url","tot":"msg"},{"t":"set","p":"payload.method","pt":"msg","to":"req.method","tot":"msg"},{"t":"set","p":"payload.headers","pt":"msg","to":"req.headers","tot":"msg"},{"t":"set","p":"payload.params","pt":"msg","to":"req.params","tot":"msg"},{"t":"set","p":"payload.query","pt":"msg","to":"req.query","tot":"msg"},{"t":"set","p":"payload.body","pt":"msg","to":"req.body","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":260,"y":140,"wires":[["4e0ed29b.35981c"]]},{"id":"e99e6f.75ecf19","type":"change","z":"5bbedfa3.e6454","name":"acl req payload","rules":[{"t":"set","p":"headers","pt":"msg","to":"{}","tot":"json"},{"t":"set","p":"payload","pt":"msg","to":"{}","tot":"json"},{"t":"set","p":"payload.url","pt":"msg","to":"req.url","tot":"msg"},{"t":"set","p":"payload.method","pt":"msg","to":"req.method","tot":"msg"},{"t":"set","p":"payload.headers","pt":"msg","to":"req.headers","tot":"msg"},{"t":"set","p":"payload.params","pt":"msg","to":"req.params","tot":"msg"},{"t":"set","p":"payload.query","pt":"msg","to":"req.query","tot":"msg"},{"t":"set","p":"payload.body","pt":"msg","to":"req.body","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":420,"y":40,"wires":[["6293510a.7a7c8"]]},{"id":"ce91d997.522938","type":"http response","z":"5bbedfa3.e6454","name":"","statusCode":"","headers":{},"x":750,"y":180,"wires":[]},{"id":"923350b9.04ad4","type":"change","z":"5bbedfa3.e6454","name":"","rules":[{"t":"set","p":"payload","pt":"msg","to":"*[name = \"dbread mysql server config\" and type=\"Stackhero-MySQL-Server\"].database","tot":"jsonata"}],"action":"","property":"","from":"","to":"","reg":false,"x":1920,"y":140,"wires":[["afe2c0f1.00ef8"]]},{"id":"550a7613.fc9818","type":"change","z":"5bbedfa3.e6454","name":"edit","rules":[{"t":"set","p":"old","pt":"msg","to":"*[name = \"dbread mysql server config\" and type=\"Stackhero-MySQL-Server\"]","tot":"jsonata"},{"t":"set","p":"new","pt":"msg","to":"old","tot":"msg"},{"t":"set","p":"new.database","pt":"msg","to":"dbname","tot":"msg"},{"t":"set","p":"payload","pt":"msg","to":"$eval($replace($string(payload),$string(old),$string(new)))","tot":"jsonata"}],"action":"","property":"","from":"","to":"","reg":false,"x":2050,"y":40,"wires":[["ea1a888e.dae5f8"]]},{"id":"f050226e.e27e7","type":"http response","z":"5bbedfa3.e6454","name":"","statusCode":"","headers":{},"x":910,"y":80,"wires":[]},{"id":"6599cf82.21f9","type":"switch","z":"5bbedfa3.e6454","name":"","property":"statusCode","propertyType":"msg","rules":[{"t":"eq","v":"200","vt":"num"},{"t":"else"}],"checkall":"true","repair":false,"outputs":2,"x":1230,"y":40,"wires":[["edc491a7.0809c"],["a846747b.776058"]]},{"id":"a846747b.776058","type":"http response","z":"5bbedfa3.e6454","name":"","statusCode":"","headers":{},"x":1370,"y":80,"wires":[]},{"id":"fb4d066d.2a6998","type":"switch","z":"5bbedfa3.e6454","name":"","property":"statusCode","propertyType":"msg","rules":[{"t":"eq","v":"200","vt":"num"},{"t":"else"}],"checkall":"true","repair":false,"outputs":2,"x":1910,"y":40,"wires":[["550a7613.fc9818"],["5635580b.25d1e8"]]},{"id":"5635580b.25d1e8","type":"http response","z":"5bbedfa3.e6454","name":"","statusCode":"","headers":{},"x":2050,"y":80,"wires":[]},{"id":"ea1a888e.dae5f8","type":"function","z":"5bbedfa3.e6454","name":"update flows","func":"const http = global.get('https');\nconst data = JSON.stringify(msg.payload);\nconst options = {\n  hostname: 'localhost',\n  port: 1880,\n  path: '/flows',\n  method: 'POST',\n  headers: {\n    'Content-Type': 'application/json',\n    'Content-Length': data.length,\n    'Authorization': 'Bearer '+msg.accessToken\n  },\n  rejectUnauthorized: false\n};\nconst req = http.request(options);\nreq.write(data);\nreq.end();\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":2210,"y":40,"wires":[["30bf7c2.8144984"]]},{"id":"acb73621.84b9d8","type":"switch","z":"5bbedfa3.e6454","name":"","property":"statusCode","propertyType":"msg","rules":[{"t":"eq","v":"200","vt":"num"},{"t":"else"}],"checkall":"true","repair":false,"outputs":2,"x":1070,"y":140,"wires":[["4ff5e66f.578588"],["eb31b75b.4d2358"]]},{"id":"eb31b75b.4d2358","type":"http response","z":"5bbedfa3.e6454","name":"","statusCode":"","headers":{},"x":1210,"y":180,"wires":[]},{"id":"18d668d.15faa97","type":"switch","z":"5bbedfa3.e6454","name":"","property":"statusCode","propertyType":"msg","rules":[{"t":"eq","v":"200","vt":"num"},{"t":"else"}],"checkall":"true","repair":false,"outputs":2,"x":1750,"y":140,"wires":[["923350b9.04ad4"],["a67cc499.da4358"]]},{"id":"a67cc499.da4358","type":"http response","z":"5bbedfa3.e6454","name":"","statusCode":"","headers":{},"x":1890,"y":180,"wires":[]},{"id":"9d8c3c75.5e0f2","type":"change","z":"5bbedfa3.e6454","name":"status","rules":[{"t":"set","p":"payload","pt":"msg","to":"{}","tot":"json"},{"t":"set","p":"payload.text","pt":"msg","to":"\"database: \" & dbname","tot":"jsonata"},{"t":"set","p":"payload.shape","pt":"msg","to":"dot","tot":"str"},{"t":"set","p":"payload.fill","pt":"msg","to":"grey","tot":"str"}],"action":"","property":"","from":"","to":"","reg":false,"x":2770,"y":100,"wires":[[]]},{"id":"f8990386.db346","type":"change","z":"5bbedfa3.e6454","name":"status","rules":[{"t":"set","p":"payload","pt":"msg","to":"{}","tot":"json"},{"t":"set","p":"payload.text","pt":"msg","to":"DB credentials updated.","tot":"str"},{"t":"set","p":"payload.shape","pt":"msg","to":"dot","tot":"str"},{"t":"set","p":"payload.fill","pt":"msg","to":"grey","tot":"str"}],"action":"","property":"","from":"","to":"","reg":false,"x":2790,"y":1360,"wires":[[]]},{"id":"ad73d791.2041c8","type":"change","z":"5bbedfa3.e6454","name":"status","rules":[{"t":"set","p":"payload","pt":"msg","to":"{}","tot":"json"},{"t":"set","p":"payload.text","pt":"msg","to":"\"key \" & keyval & \" not found\"","tot":"jsonata"},{"t":"set","p":"payload.shape","pt":"msg","to":"dot","tot":"str"},{"t":"set","p":"payload.fill","pt":"msg","to":"yellow","tot":"str"}],"action":"","property":"","from":"","to":"","reg":false,"x":770,"y":1440,"wires":[[]]},{"id":"7e3bca58.242d64","type":"change","z":"5bbedfa3.e6454","name":"status","rules":[{"t":"set","p":"changes","pt":"msg","to":"payload.length","tot":"msg"},{"t":"set","p":"payload","pt":"msg","to":"{}","tot":"json"},{"t":"set","p":"payload.text","pt":"msg","to":"\"key \" & keyval & \" found\"","tot":"jsonata"},{"t":"set","p":"payload.shape","pt":"msg","to":"dot","tot":"str"},{"t":"set","p":"payload.fill","pt":"msg","to":"green","tot":"str"}],"action":"","property":"","from":"","to":"","reg":false,"x":770,"y":1400,"wires":[[]]},{"id":"4bdd2950.7deec8","type":"Stackhero-MySQL","z":"a6602ce1.5b9f9","server":"fa4af4d5.61c8e8","name":"dbwrite","x":360,"y":1260,"wires":[[]]},{"id":"9cd370.1a5acc9","type":"change","z":"a6602ce1.5b9f9","name":"dbwrite settings","rules":[{"t":"set","p":"table","pt":"msg","to":"","tot":"str"},{"t":"set","p":"payload","pt":"msg","to":"$eval(payload)","tot":"jsonata"},{"t":"set","p":"topic","pt":"msg","to":"\"insert into \" & table & \"( \" & $join($keys(payload),\", \") & \" ) values ( :\" & $join($keys(payload),\" , :\") & \" )\"","tot":"jsonata"}],"action":"","property":"","from":"","to":"","reg":false,"x":180,"y":1260,"wires":[["4bdd2950.7deec8"]]},{"id":"aa703bc2.b95848","type":"http in","z":"a6602ce1.5b9f9","name":"PUT table","url":"/dbwrite/table","method":"put","upload":false,"swaggerDoc":"","x":80,"y":240,"wires":[["725d6242.f6a6bc"]]},{"id":"124e1972.32fae7","type":"change","z":"a6602ce1.5b9f9","name":"","rules":[{"t":"set","p":"payload","pt":"msg","to":"table","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":2400,"y":240,"wires":[["3942175.3aa34e8"]]},{"id":"b661767.a56d788","type":"http in","z":"a6602ce1.5b9f9","name":"GET table","url":"/dbwrite/table","method":"get","upload":false,"swaggerDoc":"","x":80,"y":340,"wires":[["c81155da.468b98"]]},{"id":"ad1c6d68.bbc36","type":"http response","z":"a6602ce1.5b9f9","name":"","statusCode":"","headers":{},"x":2290,"y":340,"wires":[]},{"id":"fe75a4b0.20a5a8","type":"change","z":"a6602ce1.5b9f9","name":"","rules":[{"t":"set","p":"headers","pt":"msg","to":"{\"Content-Type\":\"text/plain\"}","tot":"json"}],"action":"","property":"","from":"","to":"","reg":false,"x":2120,"y":340,"wires":[["ad1c6d68.bbc36"]]},{"id":"725d6242.f6a6bc","type":"change","z":"a6602ce1.5b9f9","name":"get inputs","rules":[{"t":"set","p":"table","pt":"msg","to":"payload","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":240,"y":240,"wires":[["585c72ef.45bbfc"]]},{"id":"5d8a5da3.e83054","type":"http request","z":"a6602ce1.5b9f9","name":"get flows","method":"GET","ret":"obj","paytoqs":"ignore","url":"https://localhost:1880/flows","tls":"b1a419c1.609c29","persist":false,"proxy":"","authType":"","x":1760,"y":240,"wires":[["f50e67c7.4c7278"]]},{"id":"e4013b97.c825d8","type":"http response","z":"a6602ce1.5b9f9","name":"","statusCode":"","headers":{},"x":2770,"y":240,"wires":[]},{"id":"3942175.3aa34e8","type":"change","z":"a6602ce1.5b9f9","name":"","rules":[{"t":"set","p":"headers","pt":"msg","to":"{\"Content-Type\":\"text/plain\"}","tot":"json"}],"action":"","property":"","from":"","to":"","reg":false,"x":2600,"y":240,"wires":[["e4013b97.c825d8","d9660ad.84876f8"]]},{"id":"4758af42.54342","type":"http request","z":"a6602ce1.5b9f9","name":"get flows","method":"GET","ret":"obj","paytoqs":"ignore","url":"https://localhost:1880/flows","tls":"b1a419c1.609c29","persist":false,"proxy":"","authType":"","x":1600,"y":340,"wires":[["66bb0f29.76635"]]},{"id":"3f78b4f8.28b8ac","type":"http request","z":"a6602ce1.5b9f9","name":"auth","method":"POST","ret":"obj","paytoqs":"ignore","url":"https://localhost:1880/auth/token","tls":"b1a419c1.609c29","persist":false,"proxy":"","authType":"","x":1090,"y":240,"wires":[["89c0577.a6dc4a8"]]},{"id":"aa8bc5a5.ad3848","type":"change","z":"a6602ce1.5b9f9","name":"auth payload","rules":[{"t":"set","p":"payload","pt":"msg","to":"{}","tot":"json"},{"t":"set","p":"payload.client_id","pt":"msg","to":"node-red-editor","tot":"str"},{"t":"set","p":"payload.grant_type","pt":"msg","to":"password","tot":"str"},{"t":"set","p":"payload.scope","pt":"msg","to":"","tot":"str"},{"t":"set","p":"payload.username","pt":"msg","to":"NRADM_USER","tot":"env"},{"t":"set","p":"payload.password","pt":"msg","to":"NRADM_PASS","tot":"env"}],"action":"","property":"","from":"","to":"","reg":false,"x":930,"y":240,"wires":[["3f78b4f8.28b8ac"]]},{"id":"73ac99cd.4b97f8","type":"change","z":"a6602ce1.5b9f9","name":"","rules":[{"t":"set","p":"accessToken","pt":"msg","to":"payload.access_token","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":1420,"y":240,"wires":[["c5309a38.6a2518"]]},{"id":"c5309a38.6a2518","type":"change","z":"a6602ce1.5b9f9","name":"bearer","rules":[{"t":"set","p":"headers","pt":"msg","to":"{}","tot":"json"},{"t":"set","p":"headers.authorization","pt":"msg","to":"\"Bearer \" & msg.accessToken","tot":"jsonata"}],"action":"","property":"","from":"","to":"","reg":false,"x":1610,"y":240,"wires":[["5d8a5da3.e83054"]]},{"id":"676d61a4.7b04f","type":"http request","z":"a6602ce1.5b9f9","name":"auth","method":"POST","ret":"obj","paytoqs":"ignore","url":"https://localhost:1880/auth/token","tls":"b1a419c1.609c29","persist":false,"proxy":"","authType":"","x":930,"y":340,"wires":[["ed2dde3f.e7edd"]]},{"id":"8d347e5f.46756","type":"change","z":"a6602ce1.5b9f9","name":"auth payload","rules":[{"t":"set","p":"payload.client_id","pt":"msg","to":"node-red-editor","tot":"str"},{"t":"set","p":"payload.grant_type","pt":"msg","to":"password","tot":"str"},{"t":"set","p":"payload.scope","pt":"msg","to":"","tot":"str"},{"t":"set","p":"payload.username","pt":"msg","to":"NRADM_USER","tot":"env"},{"t":"set","p":"payload.password","pt":"msg","to":"NRADM_PASS","tot":"env"}],"action":"","property":"","from":"","to":"","reg":false,"x":770,"y":340,"wires":[["676d61a4.7b04f"]]},{"id":"c2e67451.bb56c8","type":"change","z":"a6602ce1.5b9f9","name":"","rules":[{"t":"set","p":"accessToken","pt":"msg","to":"payload.access_token","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":1260,"y":340,"wires":[["94b5c8e.2997538"]]},{"id":"94b5c8e.2997538","type":"change","z":"a6602ce1.5b9f9","name":"bearer","rules":[{"t":"set","p":"headers","pt":"msg","to":"{}","tot":"json"},{"t":"set","p":"headers.authorization","pt":"msg","to":"\"Bearer \" & msg.accessToken","tot":"jsonata"}],"action":"","property":"","from":"","to":"","reg":false,"x":1450,"y":340,"wires":[["4758af42.54342"]]},{"id":"6c704b50.4d9c34","type":"http request","z":"a6602ce1.5b9f9","name":"","method":"POST","ret":"obj","paytoqs":"ignore","url":"${CFG_ACL_ENDP}","tls":"51b09598.a1114d","persist":false,"proxy":"","authType":"","x":610,"y":240,"wires":[["7d110a30.d74dd4"]]},{"id":"7d110a30.d74dd4","type":"switch","z":"a6602ce1.5b9f9","name":"","property":"statusCode","propertyType":"msg","rules":[{"t":"eq","v":"200","vt":"num"},{"t":"else"}],"checkall":"true","repair":false,"outputs":2,"x":770,"y":240,"wires":[["aa8bc5a5.ad3848"],["dd378308.47f05"]]},{"id":"c21435a7.28e4a8","type":"http request","z":"a6602ce1.5b9f9","name":"","method":"POST","ret":"obj","paytoqs":"ignore","url":"${CFG_ACL_ENDP}","tls":"51b09598.a1114d","persist":false,"proxy":"","authType":"","x":450,"y":340,"wires":[["e7023cb0.27b6e"]]},{"id":"e7023cb0.27b6e","type":"switch","z":"a6602ce1.5b9f9","name":"","property":"statusCode","propertyType":"msg","rules":[{"t":"eq","v":"200","vt":"num"},{"t":"else"}],"checkall":"true","repair":false,"outputs":2,"x":610,"y":340,"wires":[["8d347e5f.46756"],["9a3ea215.4d5b8"]]},{"id":"c81155da.468b98","type":"change","z":"a6602ce1.5b9f9","name":"acl req payload","rules":[{"t":"set","p":"headers","pt":"msg","to":"{}","tot":"json"},{"t":"set","p":"payload","pt":"msg","to":"{}","tot":"json"},{"t":"set","p":"payload.url","pt":"msg","to":"req.url","tot":"msg"},{"t":"set","p":"payload.method","pt":"msg","to":"req.method","tot":"msg"},{"t":"set","p":"payload.headers","pt":"msg","to":"req.headers","tot":"msg"},{"t":"set","p":"payload.params","pt":"msg","to":"req.params","tot":"msg"},{"t":"set","p":"payload.query","pt":"msg","to":"req.query","tot":"msg"},{"t":"set","p":"payload.body","pt":"msg","to":"req.body","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":260,"y":340,"wires":[["c21435a7.28e4a8"]]},{"id":"585c72ef.45bbfc","type":"change","z":"a6602ce1.5b9f9","name":"acl req payload","rules":[{"t":"set","p":"headers","pt":"msg","to":"{}","tot":"json"},{"t":"set","p":"payload","pt":"msg","to":"{}","tot":"json"},{"t":"set","p":"payload.url","pt":"msg","to":"req.url","tot":"msg"},{"t":"set","p":"payload.method","pt":"msg","to":"req.method","tot":"msg"},{"t":"set","p":"payload.headers","pt":"msg","to":"req.headers","tot":"msg"},{"t":"set","p":"payload.params","pt":"msg","to":"req.params","tot":"msg"},{"t":"set","p":"payload.query","pt":"msg","to":"req.query","tot":"msg"},{"t":"set","p":"payload.body","pt":"msg","to":"req.body","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":420,"y":240,"wires":[["6c704b50.4d9c34"]]},{"id":"9a3ea215.4d5b8","type":"http response","z":"a6602ce1.5b9f9","name":"","statusCode":"","headers":{},"x":750,"y":380,"wires":[]},{"id":"37d95fec.4002a","type":"change","z":"a6602ce1.5b9f9","name":"","rules":[{"t":"set","p":"payload","pt":"msg","to":"*[name = \"dbwrite settings\" and type=\"change\"].rules[0].to","tot":"jsonata"}],"action":"","property":"","from":"","to":"","reg":false,"x":1920,"y":340,"wires":[["fe75a4b0.20a5a8"]]},{"id":"6efc6386.c8949c","type":"change","z":"a6602ce1.5b9f9","name":"edit","rules":[{"t":"set","p":"old","pt":"msg","to":"*[name = \"dbwrite settings\" and type=\"change\"]","tot":"jsonata"},{"t":"set","p":"new","pt":"msg","to":"old","tot":"msg"},{"t":"set","p":"new.rules[0].to","pt":"msg","to":"table","tot":"msg"},{"t":"set","p":"payload","pt":"msg","to":"$eval($replace($string(payload),$string(old),$string(new)))","tot":"jsonata"}],"action":"","property":"","from":"","to":"","reg":false,"x":2050,"y":240,"wires":[["55a12410.3d276c"]]},{"id":"dd378308.47f05","type":"http response","z":"a6602ce1.5b9f9","name":"","statusCode":"","headers":{},"x":910,"y":280,"wires":[]},{"id":"89c0577.a6dc4a8","type":"switch","z":"a6602ce1.5b9f9","name":"","property":"statusCode","propertyType":"msg","rules":[{"t":"eq","v":"200","vt":"num"},{"t":"else"}],"checkall":"true","repair":false,"outputs":2,"x":1230,"y":240,"wires":[["73ac99cd.4b97f8"],["1e32a998.1457c6"]]},{"id":"1e32a998.1457c6","type":"http response","z":"a6602ce1.5b9f9","name":"","statusCode":"","headers":{},"x":1370,"y":280,"wires":[]},{"id":"f50e67c7.4c7278","type":"switch","z":"a6602ce1.5b9f9","name":"","property":"statusCode","propertyType":"msg","rules":[{"t":"eq","v":"200","vt":"num"},{"t":"else"}],"checkall":"true","repair":false,"outputs":2,"x":1910,"y":240,"wires":[["6efc6386.c8949c"],["a7660e99.0e04c"]]},{"id":"a7660e99.0e04c","type":"http response","z":"a6602ce1.5b9f9","name":"","statusCode":"","headers":{},"x":2050,"y":280,"wires":[]},{"id":"55a12410.3d276c","type":"function","z":"a6602ce1.5b9f9","name":"update flows","func":"const http = global.get('https');\nconst data = JSON.stringify(msg.payload);\nconst options = {\n  hostname: 'localhost',\n  port: 1880,\n  path: '/flows',\n  method: 'POST',\n  headers: {\n    'Content-Type': 'application/json',\n    'Content-Length': data.length,\n    'Authorization': 'Bearer '+msg.accessToken\n  },\n  rejectUnauthorized: false\n};\nconst req = http.request(options);\nreq.write(data);\nreq.end();\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":2210,"y":240,"wires":[["124e1972.32fae7"]]},{"id":"ed2dde3f.e7edd","type":"switch","z":"a6602ce1.5b9f9","name":"","property":"statusCode","propertyType":"msg","rules":[{"t":"eq","v":"200","vt":"num"},{"t":"else"}],"checkall":"true","repair":false,"outputs":2,"x":1070,"y":340,"wires":[["c2e67451.bb56c8"],["1ff8274f.c909d9"]]},{"id":"1ff8274f.c909d9","type":"http response","z":"a6602ce1.5b9f9","name":"","statusCode":"","headers":{},"x":1210,"y":380,"wires":[]},{"id":"66bb0f29.76635","type":"switch","z":"a6602ce1.5b9f9","name":"","property":"statusCode","propertyType":"msg","rules":[{"t":"eq","v":"200","vt":"num"},{"t":"else"}],"checkall":"true","repair":false,"outputs":2,"x":1750,"y":340,"wires":[["37d95fec.4002a"],["3d644c89.114c54"]]},{"id":"3d644c89.114c54","type":"http response","z":"a6602ce1.5b9f9","name":"","statusCode":"","headers":{},"x":1890,"y":380,"wires":[]},{"id":"d9660ad.84876f8","type":"change","z":"a6602ce1.5b9f9","name":"status","rules":[{"t":"set","p":"payload","pt":"msg","to":"{}","tot":"json"},{"t":"set","p":"payload.text","pt":"msg","to":"\"table: \" & table","tot":"jsonata"},{"t":"set","p":"payload.shape","pt":"msg","to":"dot","tot":"str"},{"t":"set","p":"payload.fill","pt":"msg","to":"grey","tot":"str"}],"action":"","property":"","from":"","to":"","reg":false,"x":2770,"y":300,"wires":[[]]},{"id":"2f19e68b.19b17a","type":"http in","z":"a6602ce1.5b9f9","name":"PUT host","url":"/dbwrite/host","method":"put","upload":false,"swaggerDoc":"","x":80,"y":440,"wires":[["6df47c54.c6b2e4"]]},{"id":"2b796077.1aad4","type":"change","z":"a6602ce1.5b9f9","name":"","rules":[{"t":"set","p":"payload","pt":"msg","to":"host","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":2400,"y":440,"wires":[["c632fbc2.191078"]]},{"id":"c391af90.1ec4e","type":"http in","z":"a6602ce1.5b9f9","name":"GET host","url":"/dbwrite/host","method":"get","upload":false,"swaggerDoc":"","x":80,"y":540,"wires":[["330b55f.29ad5aa"]]},{"id":"6099d911.822b78","type":"http response","z":"a6602ce1.5b9f9","name":"","statusCode":"","headers":{},"x":2290,"y":540,"wires":[]},{"id":"2777d509.d86c3a","type":"change","z":"a6602ce1.5b9f9","name":"","rules":[{"t":"set","p":"headers","pt":"msg","to":"{\"Content-Type\":\"text/plain\"}","tot":"json"}],"action":"","property":"","from":"","to":"","reg":false,"x":2120,"y":540,"wires":[["6099d911.822b78"]]},{"id":"6df47c54.c6b2e4","type":"change","z":"a6602ce1.5b9f9","name":"get inputs","rules":[{"t":"set","p":"host","pt":"msg","to":"payload","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":240,"y":440,"wires":[["946b93f6.803e7"]]},{"id":"9e67a3aa.29f7b","type":"http request","z":"a6602ce1.5b9f9","name":"get flows","method":"GET","ret":"obj","paytoqs":"ignore","url":"https://localhost:1880/flows","tls":"b1a419c1.609c29","persist":false,"proxy":"","authType":"","x":1760,"y":440,"wires":[["a7a2f65e.a1ba68"]]},{"id":"b8baea96.99de18","type":"http response","z":"a6602ce1.5b9f9","name":"","statusCode":"","headers":{},"x":2770,"y":440,"wires":[]},{"id":"c632fbc2.191078","type":"change","z":"a6602ce1.5b9f9","name":"","rules":[{"t":"set","p":"headers","pt":"msg","to":"{\"Content-Type\":\"text/plain\"}","tot":"json"}],"action":"","property":"","from":"","to":"","reg":false,"x":2600,"y":440,"wires":[["b8baea96.99de18","81e2c93f.295d88"]]},{"id":"cc114e5.85b46b","type":"http request","z":"a6602ce1.5b9f9","name":"get flows","method":"GET","ret":"obj","paytoqs":"ignore","url":"https://localhost:1880/flows","tls":"b1a419c1.609c29","persist":false,"proxy":"","authType":"","x":1600,"y":540,"wires":[["a8177cc9.0ec67"]]},{"id":"e04c2455.9f0fe8","type":"http request","z":"a6602ce1.5b9f9","name":"auth","method":"POST","ret":"obj","paytoqs":"ignore","url":"https://localhost:1880/auth/token","tls":"b1a419c1.609c29","persist":false,"proxy":"","authType":"","x":1090,"y":440,"wires":[["cb4c47b0.46c058"]]},{"id":"43fd655f.9c49bc","type":"change","z":"a6602ce1.5b9f9","name":"auth payload","rules":[{"t":"set","p":"payload","pt":"msg","to":"{}","tot":"json"},{"t":"set","p":"payload.client_id","pt":"msg","to":"node-red-editor","tot":"str"},{"t":"set","p":"payload.grant_type","pt":"msg","to":"password","tot":"str"},{"t":"set","p":"payload.scope","pt":"msg","to":"","tot":"str"},{"t":"set","p":"payload.username","pt":"msg","to":"NRADM_USER","tot":"env"},{"t":"set","p":"payload.password","pt":"msg","to":"NRADM_PASS","tot":"env"}],"action":"","property":"","from":"","to":"","reg":false,"x":930,"y":440,"wires":[["e04c2455.9f0fe8"]]},{"id":"2712410a.1f914e","type":"change","z":"a6602ce1.5b9f9","name":"","rules":[{"t":"set","p":"accessToken","pt":"msg","to":"payload.access_token","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":1420,"y":440,"wires":[["702a262a.1a35d8"]]},{"id":"702a262a.1a35d8","type":"change","z":"a6602ce1.5b9f9","name":"bearer","rules":[{"t":"set","p":"headers","pt":"msg","to":"{}","tot":"json"},{"t":"set","p":"headers.authorization","pt":"msg","to":"\"Bearer \" & msg.accessToken","tot":"jsonata"}],"action":"","property":"","from":"","to":"","reg":false,"x":1610,"y":440,"wires":[["9e67a3aa.29f7b"]]},{"id":"9cb54197.7d652","type":"http request","z":"a6602ce1.5b9f9","name":"auth","method":"POST","ret":"obj","paytoqs":"ignore","url":"https://localhost:1880/auth/token","tls":"b1a419c1.609c29","persist":false,"proxy":"","authType":"","x":930,"y":540,"wires":[["8631ab31.b31fa8"]]},{"id":"4380f15e.fc402","type":"change","z":"a6602ce1.5b9f9","name":"auth payload","rules":[{"t":"set","p":"payload.client_id","pt":"msg","to":"node-red-editor","tot":"str"},{"t":"set","p":"payload.grant_type","pt":"msg","to":"password","tot":"str"},{"t":"set","p":"payload.scope","pt":"msg","to":"","tot":"str"},{"t":"set","p":"payload.username","pt":"msg","to":"NRADM_USER","tot":"env"},{"t":"set","p":"payload.password","pt":"msg","to":"NRADM_PASS","tot":"env"}],"action":"","property":"","from":"","to":"","reg":false,"x":770,"y":540,"wires":[["9cb54197.7d652"]]},{"id":"d1f3fc1d.ba52b","type":"change","z":"a6602ce1.5b9f9","name":"","rules":[{"t":"set","p":"accessToken","pt":"msg","to":"payload.access_token","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":1260,"y":540,"wires":[["5260eb80.d4fea4"]]},{"id":"5260eb80.d4fea4","type":"change","z":"a6602ce1.5b9f9","name":"bearer","rules":[{"t":"set","p":"headers","pt":"msg","to":"{}","tot":"json"},{"t":"set","p":"headers.authorization","pt":"msg","to":"\"Bearer \" & msg.accessToken","tot":"jsonata"}],"action":"","property":"","from":"","to":"","reg":false,"x":1450,"y":540,"wires":[["cc114e5.85b46b"]]},{"id":"40ab5787.2f5828","type":"http request","z":"a6602ce1.5b9f9","name":"","method":"POST","ret":"obj","paytoqs":"ignore","url":"${CFG_ACL_ENDP}","tls":"51b09598.a1114d","persist":false,"proxy":"","authType":"","x":610,"y":440,"wires":[["a3c82d62.6367f"]]},{"id":"a3c82d62.6367f","type":"switch","z":"a6602ce1.5b9f9","name":"","property":"statusCode","propertyType":"msg","rules":[{"t":"eq","v":"200","vt":"num"},{"t":"else"}],"checkall":"true","repair":false,"outputs":2,"x":770,"y":440,"wires":[["43fd655f.9c49bc"],["f2d661b.01caca"]]},{"id":"c077c846.690ea8","type":"http request","z":"a6602ce1.5b9f9","name":"","method":"POST","ret":"obj","paytoqs":"ignore","url":"${CFG_ACL_ENDP}","tls":"51b09598.a1114d","persist":false,"proxy":"","authType":"","x":450,"y":540,"wires":[["6c514420.70d05c"]]},{"id":"6c514420.70d05c","type":"switch","z":"a6602ce1.5b9f9","name":"","property":"statusCode","propertyType":"msg","rules":[{"t":"eq","v":"200","vt":"num"},{"t":"else"}],"checkall":"true","repair":false,"outputs":2,"x":610,"y":540,"wires":[["4380f15e.fc402"],["2ec5ad74.0ebaf2"]]},{"id":"330b55f.29ad5aa","type":"change","z":"a6602ce1.5b9f9","name":"acl req payload","rules":[{"t":"set","p":"headers","pt":"msg","to":"{}","tot":"json"},{"t":"set","p":"payload","pt":"msg","to":"{}","tot":"json"},{"t":"set","p":"payload.url","pt":"msg","to":"req.url","tot":"msg"},{"t":"set","p":"payload.method","pt":"msg","to":"req.method","tot":"msg"},{"t":"set","p":"payload.headers","pt":"msg","to":"req.headers","tot":"msg"},{"t":"set","p":"payload.params","pt":"msg","to":"req.params","tot":"msg"},{"t":"set","p":"payload.query","pt":"msg","to":"req.query","tot":"msg"},{"t":"set","p":"payload.body","pt":"msg","to":"req.body","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":260,"y":540,"wires":[["c077c846.690ea8"]]},{"id":"946b93f6.803e7","type":"change","z":"a6602ce1.5b9f9","name":"acl req payload","rules":[{"t":"set","p":"headers","pt":"msg","to":"{}","tot":"json"},{"t":"set","p":"payload","pt":"msg","to":"{}","tot":"json"},{"t":"set","p":"payload.url","pt":"msg","to":"req.url","tot":"msg"},{"t":"set","p":"payload.method","pt":"msg","to":"req.method","tot":"msg"},{"t":"set","p":"payload.headers","pt":"msg","to":"req.headers","tot":"msg"},{"t":"set","p":"payload.params","pt":"msg","to":"req.params","tot":"msg"},{"t":"set","p":"payload.query","pt":"msg","to":"req.query","tot":"msg"},{"t":"set","p":"payload.body","pt":"msg","to":"req.body","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":420,"y":440,"wires":[["40ab5787.2f5828"]]},{"id":"2ec5ad74.0ebaf2","type":"http response","z":"a6602ce1.5b9f9","name":"","statusCode":"","headers":{},"x":750,"y":580,"wires":[]},{"id":"1e4d354a.a85feb","type":"change","z":"a6602ce1.5b9f9","name":"","rules":[{"t":"set","p":"payload","pt":"msg","to":"*[name = \"dbwrite mysql server config\" and type=\"Stackhero-MySQL-Server\"].host","tot":"jsonata"}],"action":"","property":"","from":"","to":"","reg":false,"x":1920,"y":540,"wires":[["2777d509.d86c3a"]]},{"id":"1c682e5a.a4f412","type":"change","z":"a6602ce1.5b9f9","name":"edit","rules":[{"t":"set","p":"old","pt":"msg","to":"*[name = \"dbwrite mysql server config\" and type=\"Stackhero-MySQL-Server\"]","tot":"jsonata"},{"t":"set","p":"new","pt":"msg","to":"old","tot":"msg"},{"t":"set","p":"new.host","pt":"msg","to":"host","tot":"msg"},{"t":"set","p":"payload","pt":"msg","to":"$eval($replace($string(payload),$string(old),$string(new)))","tot":"jsonata"}],"action":"","property":"","from":"","to":"","reg":false,"x":2050,"y":440,"wires":[["57de6dc6.4a6a64"]]},{"id":"f2d661b.01caca","type":"http response","z":"a6602ce1.5b9f9","name":"","statusCode":"","headers":{},"x":910,"y":480,"wires":[]},{"id":"cb4c47b0.46c058","type":"switch","z":"a6602ce1.5b9f9","name":"","property":"statusCode","propertyType":"msg","rules":[{"t":"eq","v":"200","vt":"num"},{"t":"else"}],"checkall":"true","repair":false,"outputs":2,"x":1230,"y":440,"wires":[["2712410a.1f914e"],["43ca5b10.1266e4"]]},{"id":"43ca5b10.1266e4","type":"http response","z":"a6602ce1.5b9f9","name":"","statusCode":"","headers":{},"x":1370,"y":480,"wires":[]},{"id":"a7a2f65e.a1ba68","type":"switch","z":"a6602ce1.5b9f9","name":"","property":"statusCode","propertyType":"msg","rules":[{"t":"eq","v":"200","vt":"num"},{"t":"else"}],"checkall":"true","repair":false,"outputs":2,"x":1910,"y":440,"wires":[["1c682e5a.a4f412"],["be3464b4.fb4388"]]},{"id":"be3464b4.fb4388","type":"http response","z":"a6602ce1.5b9f9","name":"","statusCode":"","headers":{},"x":2050,"y":480,"wires":[]},{"id":"57de6dc6.4a6a64","type":"function","z":"a6602ce1.5b9f9","name":"update flows","func":"const http = global.get('https');\nconst data = JSON.stringify(msg.payload);\nconst options = {\n  hostname: 'localhost',\n  port: 1880,\n  path: '/flows',\n  method: 'POST',\n  headers: {\n    'Content-Type': 'application/json',\n    'Content-Length': data.length,\n    'Authorization': 'Bearer '+msg.accessToken\n  },\n  rejectUnauthorized: false\n};\nconst req = http.request(options);\nreq.write(data);\nreq.end();\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":2210,"y":440,"wires":[["2b796077.1aad4"]]},{"id":"8631ab31.b31fa8","type":"switch","z":"a6602ce1.5b9f9","name":"","property":"statusCode","propertyType":"msg","rules":[{"t":"eq","v":"200","vt":"num"},{"t":"else"}],"checkall":"true","repair":false,"outputs":2,"x":1070,"y":540,"wires":[["d1f3fc1d.ba52b"],["4a7ddf37.da644"]]},{"id":"4a7ddf37.da644","type":"http response","z":"a6602ce1.5b9f9","name":"","statusCode":"","headers":{},"x":1210,"y":580,"wires":[]},{"id":"a8177cc9.0ec67","type":"switch","z":"a6602ce1.5b9f9","name":"","property":"statusCode","propertyType":"msg","rules":[{"t":"eq","v":"200","vt":"num"},{"t":"else"}],"checkall":"true","repair":false,"outputs":2,"x":1750,"y":540,"wires":[["1e4d354a.a85feb"],["b6a01aa9.def078"]]},{"id":"b6a01aa9.def078","type":"http response","z":"a6602ce1.5b9f9","name":"","statusCode":"","headers":{},"x":1890,"y":580,"wires":[]},{"id":"81e2c93f.295d88","type":"change","z":"a6602ce1.5b9f9","name":"status","rules":[{"t":"set","p":"payload","pt":"msg","to":"{}","tot":"json"},{"t":"set","p":"payload.text","pt":"msg","to":"\"host: \" & host","tot":"jsonata"},{"t":"set","p":"payload.shape","pt":"msg","to":"dot","tot":"str"},{"t":"set","p":"payload.fill","pt":"msg","to":"grey","tot":"str"}],"action":"","property":"","from":"","to":"","reg":false,"x":2770,"y":500,"wires":[[]]},{"id":"5b8bbcda.375dd4","type":"http in","z":"a6602ce1.5b9f9","name":"PUT port","url":"/dbwrite/port","method":"put","upload":false,"swaggerDoc":"","x":80,"y":640,"wires":[["e2d87f53.2a0d7"]]},{"id":"acad0aed.db7748","type":"change","z":"a6602ce1.5b9f9","name":"","rules":[{"t":"set","p":"payload","pt":"msg","to":"port","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":2400,"y":640,"wires":[["db6c478e.2ab268"]]},{"id":"668b2923.f53e28","type":"http in","z":"a6602ce1.5b9f9","name":"GET port","url":"/dbwrite/port","method":"get","upload":false,"swaggerDoc":"","x":80,"y":740,"wires":[["26c00002.bd7f2"]]},{"id":"f39ba473.8829b8","type":"http response","z":"a6602ce1.5b9f9","name":"","statusCode":"","headers":{},"x":2290,"y":740,"wires":[]},{"id":"b8c58c5b.f1d1e","type":"change","z":"a6602ce1.5b9f9","name":"","rules":[{"t":"set","p":"headers","pt":"msg","to":"{\"Content-Type\":\"text/plain\"}","tot":"json"}],"action":"","property":"","from":"","to":"","reg":false,"x":2120,"y":740,"wires":[["f39ba473.8829b8"]]},{"id":"e2d87f53.2a0d7","type":"change","z":"a6602ce1.5b9f9","name":"get inputs","rules":[{"t":"set","p":"port","pt":"msg","to":"payload","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":240,"y":640,"wires":[["35581aee.9edce6"]]},{"id":"cd4e272e.daa3f8","type":"http request","z":"a6602ce1.5b9f9","name":"get flows","method":"GET","ret":"obj","paytoqs":"ignore","url":"https://localhost:1880/flows","tls":"b1a419c1.609c29","persist":false,"proxy":"","authType":"","x":1760,"y":640,"wires":[["cb454fde.d637a"]]},{"id":"d12161fd.9d3b9","type":"http response","z":"a6602ce1.5b9f9","name":"","statusCode":"","headers":{},"x":2770,"y":640,"wires":[]},{"id":"db6c478e.2ab268","type":"change","z":"a6602ce1.5b9f9","name":"","rules":[{"t":"set","p":"headers","pt":"msg","to":"{\"Content-Type\":\"text/plain\"}","tot":"json"}],"action":"","property":"","from":"","to":"","reg":false,"x":2600,"y":640,"wires":[["d12161fd.9d3b9","8bb3fb63.d13c38"]]},{"id":"3429127d.94391e","type":"http request","z":"a6602ce1.5b9f9","name":"get flows","method":"GET","ret":"obj","paytoqs":"ignore","url":"https://localhost:1880/flows","tls":"b1a419c1.609c29","persist":false,"proxy":"","authType":"","x":1600,"y":740,"wires":[["c45feb35.0711e8"]]},{"id":"6c656906.d43148","type":"http request","z":"a6602ce1.5b9f9","name":"auth","method":"POST","ret":"obj","paytoqs":"ignore","url":"https://localhost:1880/auth/token","tls":"b1a419c1.609c29","persist":false,"proxy":"","authType":"","x":1090,"y":640,"wires":[["b1c4bd09.961a2"]]},{"id":"becb51cd.4f41c","type":"change","z":"a6602ce1.5b9f9","name":"auth payload","rules":[{"t":"set","p":"payload","pt":"msg","to":"{}","tot":"json"},{"t":"set","p":"payload.client_id","pt":"msg","to":"node-red-editor","tot":"str"},{"t":"set","p":"payload.grant_type","pt":"msg","to":"password","tot":"str"},{"t":"set","p":"payload.scope","pt":"msg","to":"","tot":"str"},{"t":"set","p":"payload.username","pt":"msg","to":"NRADM_USER","tot":"env"},{"t":"set","p":"payload.password","pt":"msg","to":"NRADM_PASS","tot":"env"}],"action":"","property":"","from":"","to":"","reg":false,"x":930,"y":640,"wires":[["6c656906.d43148"]]},{"id":"85d6daaf.6b3f58","type":"change","z":"a6602ce1.5b9f9","name":"","rules":[{"t":"set","p":"accessToken","pt":"msg","to":"payload.access_token","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":1420,"y":640,"wires":[["b423f31e.c8a7b"]]},{"id":"b423f31e.c8a7b","type":"change","z":"a6602ce1.5b9f9","name":"bearer","rules":[{"t":"set","p":"headers","pt":"msg","to":"{}","tot":"json"},{"t":"set","p":"headers.authorization","pt":"msg","to":"\"Bearer \" & msg.accessToken","tot":"jsonata"}],"action":"","property":"","from":"","to":"","reg":false,"x":1610,"y":640,"wires":[["cd4e272e.daa3f8"]]},{"id":"37a2380d.767098","type":"http request","z":"a6602ce1.5b9f9","name":"auth","method":"POST","ret":"obj","paytoqs":"ignore","url":"https://localhost:1880/auth/token","tls":"b1a419c1.609c29","persist":false,"proxy":"","authType":"","x":930,"y":740,"wires":[["d8905283.f9235"]]},{"id":"cf949698.5aa3e8","type":"change","z":"a6602ce1.5b9f9","name":"auth payload","rules":[{"t":"set","p":"payload.client_id","pt":"msg","to":"node-red-editor","tot":"str"},{"t":"set","p":"payload.grant_type","pt":"msg","to":"password","tot":"str"},{"t":"set","p":"payload.scope","pt":"msg","to":"","tot":"str"},{"t":"set","p":"payload.username","pt":"msg","to":"NRADM_USER","tot":"env"},{"t":"set","p":"payload.password","pt":"msg","to":"NRADM_PASS","tot":"env"}],"action":"","property":"","from":"","to":"","reg":false,"x":770,"y":740,"wires":[["37a2380d.767098"]]},{"id":"d8893a41.a748b8","type":"change","z":"a6602ce1.5b9f9","name":"","rules":[{"t":"set","p":"accessToken","pt":"msg","to":"payload.access_token","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":1260,"y":740,"wires":[["6a0becfa.c28b44"]]},{"id":"6a0becfa.c28b44","type":"change","z":"a6602ce1.5b9f9","name":"bearer","rules":[{"t":"set","p":"headers","pt":"msg","to":"{}","tot":"json"},{"t":"set","p":"headers.authorization","pt":"msg","to":"\"Bearer \" & msg.accessToken","tot":"jsonata"}],"action":"","property":"","from":"","to":"","reg":false,"x":1450,"y":740,"wires":[["3429127d.94391e"]]},{"id":"2cdd693d.92f046","type":"http request","z":"a6602ce1.5b9f9","name":"","method":"POST","ret":"obj","paytoqs":"ignore","url":"${CFG_ACL_ENDP}","tls":"51b09598.a1114d","persist":false,"proxy":"","authType":"","x":610,"y":640,"wires":[["fb5c0f7b.19f7a"]]},{"id":"fb5c0f7b.19f7a","type":"switch","z":"a6602ce1.5b9f9","name":"","property":"statusCode","propertyType":"msg","rules":[{"t":"eq","v":"200","vt":"num"},{"t":"else"}],"checkall":"true","repair":false,"outputs":2,"x":770,"y":640,"wires":[["becb51cd.4f41c"],["6684da22.0a82e4"]]},{"id":"43402d2a.3f00f4","type":"http request","z":"a6602ce1.5b9f9","name":"","method":"POST","ret":"obj","paytoqs":"ignore","url":"${CFG_ACL_ENDP}","tls":"51b09598.a1114d","persist":false,"proxy":"","authType":"","x":450,"y":740,"wires":[["657221bb.774dc"]]},{"id":"657221bb.774dc","type":"switch","z":"a6602ce1.5b9f9","name":"","property":"statusCode","propertyType":"msg","rules":[{"t":"eq","v":"200","vt":"num"},{"t":"else"}],"checkall":"true","repair":false,"outputs":2,"x":610,"y":740,"wires":[["cf949698.5aa3e8"],["c5b5e40.7a3ec2"]]},{"id":"26c00002.bd7f2","type":"change","z":"a6602ce1.5b9f9","name":"acl req payload","rules":[{"t":"set","p":"headers","pt":"msg","to":"{}","tot":"json"},{"t":"set","p":"payload","pt":"msg","to":"{}","tot":"json"},{"t":"set","p":"payload.url","pt":"msg","to":"req.url","tot":"msg"},{"t":"set","p":"payload.method","pt":"msg","to":"req.method","tot":"msg"},{"t":"set","p":"payload.headers","pt":"msg","to":"req.headers","tot":"msg"},{"t":"set","p":"payload.params","pt":"msg","to":"req.params","tot":"msg"},{"t":"set","p":"payload.query","pt":"msg","to":"req.query","tot":"msg"},{"t":"set","p":"payload.body","pt":"msg","to":"req.body","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":260,"y":740,"wires":[["43402d2a.3f00f4"]]},{"id":"35581aee.9edce6","type":"change","z":"a6602ce1.5b9f9","name":"acl req payload","rules":[{"t":"set","p":"headers","pt":"msg","to":"{}","tot":"json"},{"t":"set","p":"payload","pt":"msg","to":"{}","tot":"json"},{"t":"set","p":"payload.url","pt":"msg","to":"req.url","tot":"msg"},{"t":"set","p":"payload.method","pt":"msg","to":"req.method","tot":"msg"},{"t":"set","p":"payload.headers","pt":"msg","to":"req.headers","tot":"msg"},{"t":"set","p":"payload.params","pt":"msg","to":"req.params","tot":"msg"},{"t":"set","p":"payload.query","pt":"msg","to":"req.query","tot":"msg"},{"t":"set","p":"payload.body","pt":"msg","to":"req.body","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":420,"y":640,"wires":[["2cdd693d.92f046"]]},{"id":"c5b5e40.7a3ec2","type":"http response","z":"a6602ce1.5b9f9","name":"","statusCode":"","headers":{},"x":750,"y":780,"wires":[]},{"id":"25dff03a.9370e","type":"change","z":"a6602ce1.5b9f9","name":"","rules":[{"t":"set","p":"payload","pt":"msg","to":"*[name = \"dbwrite mysql server config\" and type=\"Stackhero-MySQL-Server\"].port","tot":"jsonata"}],"action":"","property":"","from":"","to":"","reg":false,"x":1920,"y":740,"wires":[["b8c58c5b.f1d1e"]]},{"id":"53e392f5.7a6cdc","type":"change","z":"a6602ce1.5b9f9","name":"edit","rules":[{"t":"set","p":"old","pt":"msg","to":"*[name = \"dbwrite mysql server config\" and type=\"Stackhero-MySQL-Server\"]","tot":"jsonata"},{"t":"set","p":"new","pt":"msg","to":"old","tot":"msg"},{"t":"set","p":"new.port","pt":"msg","to":"port","tot":"msg"},{"t":"set","p":"payload","pt":"msg","to":"$eval($replace($string(payload),$string(old),$string(new)))","tot":"jsonata"}],"action":"","property":"","from":"","to":"","reg":false,"x":2050,"y":640,"wires":[["6c06b4a5.0f275c"]]},{"id":"6684da22.0a82e4","type":"http response","z":"a6602ce1.5b9f9","name":"","statusCode":"","headers":{},"x":910,"y":680,"wires":[]},{"id":"b1c4bd09.961a2","type":"switch","z":"a6602ce1.5b9f9","name":"","property":"statusCode","propertyType":"msg","rules":[{"t":"eq","v":"200","vt":"num"},{"t":"else"}],"checkall":"true","repair":false,"outputs":2,"x":1230,"y":640,"wires":[["85d6daaf.6b3f58"],["95d15e85.8cd2e"]]},{"id":"95d15e85.8cd2e","type":"http response","z":"a6602ce1.5b9f9","name":"","statusCode":"","headers":{},"x":1370,"y":680,"wires":[]},{"id":"cb454fde.d637a","type":"switch","z":"a6602ce1.5b9f9","name":"","property":"statusCode","propertyType":"msg","rules":[{"t":"eq","v":"200","vt":"num"},{"t":"else"}],"checkall":"true","repair":false,"outputs":2,"x":1910,"y":640,"wires":[["53e392f5.7a6cdc"],["f57e7357.df1c7"]]},{"id":"f57e7357.df1c7","type":"http response","z":"a6602ce1.5b9f9","name":"","statusCode":"","headers":{},"x":2050,"y":680,"wires":[]},{"id":"6c06b4a5.0f275c","type":"function","z":"a6602ce1.5b9f9","name":"update flows","func":"const http = global.get('https');\nconst data = JSON.stringify(msg.payload);\nconst options = {\n  hostname: 'localhost',\n  port: 1880,\n  path: '/flows',\n  method: 'POST',\n  headers: {\n    'Content-Type': 'application/json',\n    'Content-Length': data.length,\n    'Authorization': 'Bearer '+msg.accessToken\n  },\n  rejectUnauthorized: false\n};\nconst req = http.request(options);\nreq.write(data);\nreq.end();\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":2210,"y":640,"wires":[["acad0aed.db7748"]]},{"id":"d8905283.f9235","type":"switch","z":"a6602ce1.5b9f9","name":"","property":"statusCode","propertyType":"msg","rules":[{"t":"eq","v":"200","vt":"num"},{"t":"else"}],"checkall":"true","repair":false,"outputs":2,"x":1070,"y":740,"wires":[["d8893a41.a748b8"],["86aa2e64.f27a4"]]},{"id":"86aa2e64.f27a4","type":"http response","z":"a6602ce1.5b9f9","name":"","statusCode":"","headers":{},"x":1210,"y":780,"wires":[]},{"id":"c45feb35.0711e8","type":"switch","z":"a6602ce1.5b9f9","name":"","property":"statusCode","propertyType":"msg","rules":[{"t":"eq","v":"200","vt":"num"},{"t":"else"}],"checkall":"true","repair":false,"outputs":2,"x":1750,"y":740,"wires":[["25dff03a.9370e"],["fe427579.70e048"]]},{"id":"fe427579.70e048","type":"http response","z":"a6602ce1.5b9f9","name":"","statusCode":"","headers":{},"x":1890,"y":780,"wires":[]},{"id":"8bb3fb63.d13c38","type":"change","z":"a6602ce1.5b9f9","name":"status","rules":[{"t":"set","p":"payload","pt":"msg","to":"{}","tot":"json"},{"t":"set","p":"payload.text","pt":"msg","to":"\"port: \" & port","tot":"jsonata"},{"t":"set","p":"payload.shape","pt":"msg","to":"dot","tot":"str"},{"t":"set","p":"payload.fill","pt":"msg","to":"grey","tot":"str"}],"action":"","property":"","from":"","to":"","reg":false,"x":2770,"y":700,"wires":[[]]},{"id":"1da7d2d1.8f244d","type":"http in","z":"a6602ce1.5b9f9","name":"PUT tls","url":"/dbwrite/tls","method":"put","upload":false,"swaggerDoc":"","x":70,"y":880,"wires":[["aaabce07.3be7c"]]},{"id":"36d82942.61bfc6","type":"change","z":"a6602ce1.5b9f9","name":"","rules":[{"t":"set","p":"payload","pt":"msg","to":"tls ? \"yes\" : \"no\"","tot":"jsonata"}],"action":"","property":"","from":"","to":"","reg":false,"x":2520,"y":880,"wires":[["6c9a181c.39cf08"]]},{"id":"37b80e3a.580822","type":"http in","z":"a6602ce1.5b9f9","name":"GET tls","url":"/dbwrite/tls","method":"get","upload":false,"swaggerDoc":"","x":70,"y":980,"wires":[["71ce69e1.64a778"]]},{"id":"4fbe3c9e.6c7874","type":"http response","z":"a6602ce1.5b9f9","name":"","statusCode":"","headers":{},"x":2290,"y":980,"wires":[]},{"id":"d1821f53.36a1a","type":"change","z":"a6602ce1.5b9f9","name":"","rules":[{"t":"set","p":"headers","pt":"msg","to":"{\"Content-Type\":\"text/plain\"}","tot":"json"}],"action":"","property":"","from":"","to":"","reg":false,"x":2120,"y":980,"wires":[["4fbe3c9e.6c7874"]]},{"id":"dae35c89.e37d7","type":"change","z":"a6602ce1.5b9f9","name":"get inputs","rules":[{"t":"set","p":"tls","pt":"msg","to":"false","tot":"bool"}],"action":"","property":"","from":"","to":"","reg":false,"x":360,"y":880,"wires":[["ca123a48.6ce548"]]},{"id":"bd5cdb6c.bddd88","type":"http request","z":"a6602ce1.5b9f9","name":"get flows","method":"GET","ret":"obj","paytoqs":"ignore","url":"https://localhost:1880/flows","tls":"b1a419c1.609c29","persist":false,"proxy":"","authType":"","x":1880,"y":880,"wires":[["9e7a868a.50c0f8"]]},{"id":"dc15c777.78d0f8","type":"http response","z":"a6602ce1.5b9f9","name":"","statusCode":"","headers":{},"x":2890,"y":880,"wires":[]},{"id":"6c9a181c.39cf08","type":"change","z":"a6602ce1.5b9f9","name":"","rules":[{"t":"set","p":"headers","pt":"msg","to":"{\"Content-Type\":\"text/plain\"}","tot":"json"}],"action":"","property":"","from":"","to":"","reg":false,"x":2720,"y":880,"wires":[["dc15c777.78d0f8","70dce66c.574e28"]]},{"id":"534f0fc8.2dc2d","type":"http request","z":"a6602ce1.5b9f9","name":"get flows","method":"GET","ret":"obj","paytoqs":"ignore","url":"https://localhost:1880/flows","tls":"b1a419c1.609c29","persist":false,"proxy":"","authType":"","x":1600,"y":980,"wires":[["9c3ce41a.f875e8"]]},{"id":"aec61d22.7763e","type":"http request","z":"a6602ce1.5b9f9","name":"auth","method":"POST","ret":"obj","paytoqs":"ignore","url":"https://localhost:1880/auth/token","tls":"b1a419c1.609c29","persist":false,"proxy":"","authType":"","x":1210,"y":880,"wires":[["cc534a94.f312a8"]]},{"id":"850c70f1.852d8","type":"change","z":"a6602ce1.5b9f9","name":"auth payload","rules":[{"t":"set","p":"payload","pt":"msg","to":"{}","tot":"json"},{"t":"set","p":"payload.client_id","pt":"msg","to":"node-red-editor","tot":"str"},{"t":"set","p":"payload.grant_type","pt":"msg","to":"password","tot":"str"},{"t":"set","p":"payload.scope","pt":"msg","to":"","tot":"str"},{"t":"set","p":"payload.username","pt":"msg","to":"NRADM_USER","tot":"env"},{"t":"set","p":"payload.password","pt":"msg","to":"NRADM_PASS","tot":"env"}],"action":"","property":"","from":"","to":"","reg":false,"x":1050,"y":880,"wires":[["aec61d22.7763e"]]},{"id":"38edfa27.161666","type":"change","z":"a6602ce1.5b9f9","name":"","rules":[{"t":"set","p":"accessToken","pt":"msg","to":"payload.access_token","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":1540,"y":880,"wires":[["5c9ebfc3.a2391"]]},{"id":"5c9ebfc3.a2391","type":"change","z":"a6602ce1.5b9f9","name":"bearer","rules":[{"t":"set","p":"headers","pt":"msg","to":"{}","tot":"json"},{"t":"set","p":"headers.authorization","pt":"msg","to":"\"Bearer \" & msg.accessToken","tot":"jsonata"}],"action":"","property":"","from":"","to":"","reg":false,"x":1730,"y":880,"wires":[["bd5cdb6c.bddd88"]]},{"id":"d5c23b63.8cd718","type":"http request","z":"a6602ce1.5b9f9","name":"auth","method":"POST","ret":"obj","paytoqs":"ignore","url":"https://localhost:1880/auth/token","tls":"b1a419c1.609c29","persist":false,"proxy":"","authType":"","x":930,"y":980,"wires":[["7dab2e7f.f5489"]]},{"id":"d2a5eeb8.1fb72","type":"change","z":"a6602ce1.5b9f9","name":"auth payload","rules":[{"t":"set","p":"payload.client_id","pt":"msg","to":"node-red-editor","tot":"str"},{"t":"set","p":"payload.grant_type","pt":"msg","to":"password","tot":"str"},{"t":"set","p":"payload.scope","pt":"msg","to":"","tot":"str"},{"t":"set","p":"payload.username","pt":"msg","to":"NRADM_USER","tot":"env"},{"t":"set","p":"payload.password","pt":"msg","to":"NRADM_PASS","tot":"env"}],"action":"","property":"","from":"","to":"","reg":false,"x":770,"y":980,"wires":[["d5c23b63.8cd718"]]},{"id":"adbb9d56.0ada6","type":"change","z":"a6602ce1.5b9f9","name":"","rules":[{"t":"set","p":"accessToken","pt":"msg","to":"payload.access_token","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":1260,"y":980,"wires":[["8c8f4be7.957ff8"]]},{"id":"8c8f4be7.957ff8","type":"change","z":"a6602ce1.5b9f9","name":"bearer","rules":[{"t":"set","p":"headers","pt":"msg","to":"{}","tot":"json"},{"t":"set","p":"headers.authorization","pt":"msg","to":"\"Bearer \" & msg.accessToken","tot":"jsonata"}],"action":"","property":"","from":"","to":"","reg":false,"x":1450,"y":980,"wires":[["534f0fc8.2dc2d"]]},{"id":"b2472127.35873","type":"http request","z":"a6602ce1.5b9f9","name":"","method":"POST","ret":"obj","paytoqs":"ignore","url":"${CFG_ACL_ENDP}","tls":"51b09598.a1114d","persist":false,"proxy":"","authType":"","x":730,"y":880,"wires":[["83c6137a.9907d"]]},{"id":"83c6137a.9907d","type":"switch","z":"a6602ce1.5b9f9","name":"","property":"statusCode","propertyType":"msg","rules":[{"t":"eq","v":"200","vt":"num"},{"t":"else"}],"checkall":"true","repair":false,"outputs":2,"x":890,"y":880,"wires":[["850c70f1.852d8"],["94ec601b.a045c"]]},{"id":"1e624c97.8e1583","type":"http request","z":"a6602ce1.5b9f9","name":"","method":"POST","ret":"obj","paytoqs":"ignore","url":"${CFG_ACL_ENDP}","tls":"51b09598.a1114d","persist":false,"proxy":"","authType":"","x":450,"y":980,"wires":[["9fc75f70.b014d"]]},{"id":"9fc75f70.b014d","type":"switch","z":"a6602ce1.5b9f9","name":"","property":"statusCode","propertyType":"msg","rules":[{"t":"eq","v":"200","vt":"num"},{"t":"else"}],"checkall":"true","repair":false,"outputs":2,"x":610,"y":980,"wires":[["d2a5eeb8.1fb72"],["3080d517.8935ea"]]},{"id":"71ce69e1.64a778","type":"change","z":"a6602ce1.5b9f9","name":"acl req payload","rules":[{"t":"set","p":"headers","pt":"msg","to":"{}","tot":"json"},{"t":"set","p":"payload","pt":"msg","to":"{}","tot":"json"},{"t":"set","p":"payload.url","pt":"msg","to":"req.url","tot":"msg"},{"t":"set","p":"payload.method","pt":"msg","to":"req.method","tot":"msg"},{"t":"set","p":"payload.headers","pt":"msg","to":"req.headers","tot":"msg"},{"t":"set","p":"payload.params","pt":"msg","to":"req.params","tot":"msg"},{"t":"set","p":"payload.query","pt":"msg","to":"req.query","tot":"msg"},{"t":"set","p":"payload.body","pt":"msg","to":"req.body","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":260,"y":980,"wires":[["1e624c97.8e1583"]]},{"id":"ca123a48.6ce548","type":"change","z":"a6602ce1.5b9f9","name":"acl req payload","rules":[{"t":"set","p":"headers","pt":"msg","to":"{}","tot":"json"},{"t":"set","p":"payload","pt":"msg","to":"{}","tot":"json"},{"t":"set","p":"payload.url","pt":"msg","to":"req.url","tot":"msg"},{"t":"set","p":"payload.method","pt":"msg","to":"req.method","tot":"msg"},{"t":"set","p":"payload.headers","pt":"msg","to":"req.headers","tot":"msg"},{"t":"set","p":"payload.params","pt":"msg","to":"req.params","tot":"msg"},{"t":"set","p":"payload.query","pt":"msg","to":"req.query","tot":"msg"},{"t":"set","p":"payload.body","pt":"msg","to":"req.body","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":540,"y":880,"wires":[["b2472127.35873"]]},{"id":"3080d517.8935ea","type":"http response","z":"a6602ce1.5b9f9","name":"","statusCode":"","headers":{},"x":750,"y":1020,"wires":[]},{"id":"8b966ee2.7e638","type":"change","z":"a6602ce1.5b9f9","name":"","rules":[{"t":"set","p":"payload","pt":"msg","to":"*[name = \"dbwrite mysql server config\" and type=\"Stackhero-MySQL-Server\"].tls ? \"yes\" : \"no\"","tot":"jsonata"}],"action":"","property":"","from":"","to":"","reg":false,"x":1920,"y":980,"wires":[["d1821f53.36a1a"]]},{"id":"12e0db54.d99935","type":"change","z":"a6602ce1.5b9f9","name":"edit","rules":[{"t":"set","p":"old","pt":"msg","to":"*[name = \"dbwrite mysql server config\" and type=\"Stackhero-MySQL-Server\"]","tot":"jsonata"},{"t":"set","p":"new","pt":"msg","to":"old","tot":"msg"},{"t":"set","p":"new.tls","pt":"msg","to":"tls","tot":"msg"},{"t":"set","p":"payload","pt":"msg","to":"$eval($replace($string(payload),$string(old),$string(new)))","tot":"jsonata"}],"action":"","property":"","from":"","to":"","reg":false,"x":2170,"y":880,"wires":[["556e27b9.7bfae8"]]},{"id":"94ec601b.a045c","type":"http response","z":"a6602ce1.5b9f9","name":"","statusCode":"","headers":{},"x":1030,"y":920,"wires":[]},{"id":"cc534a94.f312a8","type":"switch","z":"a6602ce1.5b9f9","name":"","property":"statusCode","propertyType":"msg","rules":[{"t":"eq","v":"200","vt":"num"},{"t":"else"}],"checkall":"true","repair":false,"outputs":2,"x":1350,"y":880,"wires":[["38edfa27.161666"],["16de3c9d.ab96b3"]]},{"id":"16de3c9d.ab96b3","type":"http response","z":"a6602ce1.5b9f9","name":"","statusCode":"","headers":{},"x":1490,"y":920,"wires":[]},{"id":"9e7a868a.50c0f8","type":"switch","z":"a6602ce1.5b9f9","name":"","property":"statusCode","propertyType":"msg","rules":[{"t":"eq","v":"200","vt":"num"},{"t":"else"}],"checkall":"true","repair":false,"outputs":2,"x":2030,"y":880,"wires":[["12e0db54.d99935"],["177c5140.99e25f"]]},{"id":"177c5140.99e25f","type":"http response","z":"a6602ce1.5b9f9","name":"","statusCode":"","headers":{},"x":2170,"y":920,"wires":[]},{"id":"556e27b9.7bfae8","type":"function","z":"a6602ce1.5b9f9","name":"update flows","func":"const http = global.get('https');\nconst data = JSON.stringify(msg.payload);\nconst options = {\n  hostname: 'localhost',\n  port: 1880,\n  path: '/flows',\n  method: 'POST',\n  headers: {\n    'Content-Type': 'application/json',\n    'Content-Length': data.length,\n    'Authorization': 'Bearer '+msg.accessToken\n  },\n  rejectUnauthorized: false\n};\nconst req = http.request(options);\nreq.write(data);\nreq.end();\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":2330,"y":880,"wires":[["36d82942.61bfc6"]]},{"id":"7dab2e7f.f5489","type":"switch","z":"a6602ce1.5b9f9","name":"","property":"statusCode","propertyType":"msg","rules":[{"t":"eq","v":"200","vt":"num"},{"t":"else"}],"checkall":"true","repair":false,"outputs":2,"x":1070,"y":980,"wires":[["adbb9d56.0ada6"],["ecdddb88.44ae88"]]},{"id":"ecdddb88.44ae88","type":"http response","z":"a6602ce1.5b9f9","name":"","statusCode":"","headers":{},"x":1210,"y":1020,"wires":[]},{"id":"9c3ce41a.f875e8","type":"switch","z":"a6602ce1.5b9f9","name":"","property":"statusCode","propertyType":"msg","rules":[{"t":"eq","v":"200","vt":"num"},{"t":"else"}],"checkall":"true","repair":false,"outputs":2,"x":1750,"y":980,"wires":[["8b966ee2.7e638"],["d9043553.f160e8"]]},{"id":"d9043553.f160e8","type":"http response","z":"a6602ce1.5b9f9","name":"","statusCode":"","headers":{},"x":1890,"y":1020,"wires":[]},{"id":"70dce66c.574e28","type":"change","z":"a6602ce1.5b9f9","name":"status","rules":[{"t":"set","p":"payload","pt":"msg","to":"{}","tot":"json"},{"t":"set","p":"payload.text","pt":"msg","to":"\"tls: \" & tls","tot":"jsonata"},{"t":"set","p":"payload.shape","pt":"msg","to":"dot","tot":"str"},{"t":"set","p":"payload.fill","pt":"msg","to":"grey","tot":"str"}],"action":"","property":"","from":"","to":"","reg":false,"x":2890,"y":940,"wires":[[]]},{"id":"aaabce07.3be7c","type":"switch","z":"a6602ce1.5b9f9","name":"","property":"payload","propertyType":"msg","rules":[{"t":"eq","v":"yes","vt":"str"},{"t":"eq","v":"no","vt":"str"},{"t":"else"}],"checkall":"true","repair":false,"outputs":3,"x":210,"y":880,"wires":[["daec2aa7.3dd3a8"],["dae35c89.e37d7"],["23cbfff4.55a91"]]},{"id":"23cbfff4.55a91","type":"change","z":"a6602ce1.5b9f9","name":"get inputs","rules":[{"t":"set","p":"payload","pt":"msg","to":"Allowed values: yes, no.","tot":"str"}],"action":"","property":"","from":"","to":"","reg":false,"x":360,"y":920,"wires":[["389e7584.3b1a6a"]]},{"id":"daec2aa7.3dd3a8","type":"change","z":"a6602ce1.5b9f9","name":"get inputs","rules":[{"t":"set","p":"tls","pt":"msg","to":"true","tot":"bool"}],"action":"","property":"","from":"","to":"","reg":false,"x":360,"y":840,"wires":[["ca123a48.6ce548"]]},{"id":"389e7584.3b1a6a","type":"http response","z":"a6602ce1.5b9f9","name":"","statusCode":"400","headers":{},"x":520,"y":920,"wires":[]},{"id":"8443449.ab1c1b8","type":"http in","z":"a6602ce1.5b9f9","name":"PUT credentials","url":"/dbwrite/credentials","method":"put","upload":false,"swaggerDoc":"","x":100,"y":1100,"wires":[["c64413b5.4158d"]]},{"id":"c64413b5.4158d","type":"change","z":"a6602ce1.5b9f9","name":"get inputs","rules":[{"t":"set","p":"user","pt":"msg","to":"payload.user","tot":"msg"},{"t":"set","p":"password","pt":"msg","to":"payload.password","tot":"msg"},{"t":"set","p":"nodeName","pt":"msg","to":"req.params.nodeName","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":280,"y":1100,"wires":[["1bb619a6.e9a086"]]},{"id":"3dd58fe8.6dc8c","type":"http request","z":"a6602ce1.5b9f9","name":"get flows","method":"GET","ret":"obj","paytoqs":"ignore","url":"https://localhost:1880/flows","tls":"b1a419c1.609c29","persist":false,"proxy":"","authType":"","x":1800,"y":1100,"wires":[["c488074.8e6bef8"]]},{"id":"c749b479.e96218","type":"function","z":"a6602ce1.5b9f9","name":"update flows","func":"const http = global.get('https');\nconst data = JSON.stringify(msg.payload);\nconst options = {\n  hostname: 'localhost',\n  port: 1880,\n  path: '/flows',\n  method: 'POST',\n  headers: {\n    'Content-Type': 'application/json',\n    'Content-Length': data.length,\n    'Authorization': 'Bearer '+msg.accessToken\n  },\n  rejectUnauthorized: false\n};\nconst req = http.request(options);\nreq.write(data);\nreq.end();\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":2250,"y":1100,"wires":[["932cd2d3.cdfb9"]]},{"id":"932cd2d3.cdfb9","type":"change","z":"a6602ce1.5b9f9","name":"set payload","rules":[{"t":"set","p":"payload","pt":"msg","to":"{}","tot":"json"},{"t":"set","p":"payload.user","pt":"msg","to":"user","tot":"msg"},{"t":"set","p":"payload.password","pt":"msg","to":"password","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":2430,"y":1100,"wires":[["5f993818.995018"]]},{"id":"5f993818.995018","type":"change","z":"a6602ce1.5b9f9","name":"","rules":[{"t":"set","p":"headers","pt":"msg","to":"{\"Content-Type\":\"application/json\"}","tot":"json"}],"action":"","property":"","from":"","to":"","reg":false,"x":2620,"y":1100,"wires":[["72c8297d.8883b8","bd380b00.e45568"]]},{"id":"72c8297d.8883b8","type":"http response","z":"a6602ce1.5b9f9","name":"","statusCode":"","headers":{},"x":2790,"y":1100,"wires":[]},{"id":"1c4c2463.1dfb4c","type":"http request","z":"a6602ce1.5b9f9","name":"auth","method":"POST","ret":"obj","paytoqs":"ignore","url":"https://localhost:1880/auth/token","tls":"b1a419c1.609c29","persist":false,"proxy":"","authType":"","x":1130,"y":1100,"wires":[["d147267.56481d8"]]},{"id":"58806e6c.b027f","type":"change","z":"a6602ce1.5b9f9","name":"auth payload","rules":[{"t":"set","p":"payload","pt":"msg","to":"{}","tot":"json"},{"t":"set","p":"payload.client_id","pt":"msg","to":"node-red-editor","tot":"str"},{"t":"set","p":"payload.grant_type","pt":"msg","to":"password","tot":"str"},{"t":"set","p":"payload.scope","pt":"msg","to":"","tot":"str"},{"t":"set","p":"payload.username","pt":"msg","to":"NRADM_USER","tot":"env"},{"t":"set","p":"payload.password","pt":"msg","to":"NRADM_PASS","tot":"env"}],"action":"","property":"","from":"","to":"","reg":false,"x":970,"y":1100,"wires":[["1c4c2463.1dfb4c"]]},{"id":"9ca10db1.3e2a8","type":"change","z":"a6602ce1.5b9f9","name":"","rules":[{"t":"set","p":"accessToken","pt":"msg","to":"payload.access_token","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":1460,"y":1100,"wires":[["7956ab7b.75fe74"]]},{"id":"7956ab7b.75fe74","type":"change","z":"a6602ce1.5b9f9","name":"bearer","rules":[{"t":"set","p":"headers","pt":"msg","to":"{}","tot":"json"},{"t":"set","p":"headers.authorization","pt":"msg","to":"\"Bearer \" & msg.accessToken","tot":"jsonata"}],"action":"","property":"","from":"","to":"","reg":false,"x":1650,"y":1100,"wires":[["3dd58fe8.6dc8c"]]},{"id":"1b6c85fe.1b371a","type":"http request","z":"a6602ce1.5b9f9","name":"","method":"POST","ret":"obj","paytoqs":"ignore","url":"${CFG_ACL_ENDP}","tls":"51b09598.a1114d","persist":false,"proxy":"","authType":"","x":650,"y":1100,"wires":[["d3d85363.f0c1a"]]},{"id":"d3d85363.f0c1a","type":"switch","z":"a6602ce1.5b9f9","name":"","property":"statusCode","propertyType":"msg","rules":[{"t":"eq","v":"200","vt":"num"},{"t":"else"}],"checkall":"true","repair":false,"outputs":2,"x":810,"y":1100,"wires":[["58806e6c.b027f"],["7bbd7768.2af5a8"]]},{"id":"1bb619a6.e9a086","type":"change","z":"a6602ce1.5b9f9","name":"acl req payload","rules":[{"t":"set","p":"headers","pt":"msg","to":"{}","tot":"json"},{"t":"set","p":"payload","pt":"msg","to":"{}","tot":"json"},{"t":"set","p":"payload.url","pt":"msg","to":"req.url","tot":"msg"},{"t":"set","p":"payload.method","pt":"msg","to":"req.method","tot":"msg"},{"t":"set","p":"payload.headers","pt":"msg","to":"req.headers","tot":"msg"},{"t":"set","p":"payload.params","pt":"msg","to":"req.params","tot":"msg"},{"t":"set","p":"payload.query","pt":"msg","to":"req.query","tot":"msg"},{"t":"set","p":"payload.body","pt":"msg","to":"req.body","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":460,"y":1100,"wires":[["1b6c85fe.1b371a"]]},{"id":"7bbd7768.2af5a8","type":"http response","z":"a6602ce1.5b9f9","name":"","statusCode":"","headers":{},"x":950,"y":1140,"wires":[]},{"id":"4598b44b.e23c6c","type":"change","z":"a6602ce1.5b9f9","name":"edit","rules":[{"t":"set","p":"old","pt":"msg","to":"*[name = \"dbwrite mysql server config\" and type = \"Stackhero-MySQL-Server\"]","tot":"jsonata"},{"t":"set","p":"new","pt":"msg","to":"old","tot":"msg"},{"t":"set","p":"new.credentials","pt":"msg","to":"{}","tot":"json"},{"t":"set","p":"new.credentials.user","pt":"msg","to":"user","tot":"msg"},{"t":"set","p":"new.credentials.password","pt":"msg","to":"password","tot":"msg"},{"t":"set","p":"payload","pt":"msg","to":"$eval($replace($string(payload),$string(old),$string(new)))","tot":"jsonata"}],"action":"","property":"","from":"","to":"","reg":false,"x":2090,"y":1100,"wires":[["c749b479.e96218"]]},{"id":"d147267.56481d8","type":"switch","z":"a6602ce1.5b9f9","name":"","property":"statusCode","propertyType":"msg","rules":[{"t":"eq","v":"200","vt":"num"},{"t":"else"}],"checkall":"true","repair":false,"outputs":2,"x":1270,"y":1100,"wires":[["9ca10db1.3e2a8"],["3891b2e1.020f5e"]]},{"id":"3891b2e1.020f5e","type":"http response","z":"a6602ce1.5b9f9","name":"","statusCode":"","headers":{},"x":1410,"y":1140,"wires":[]},{"id":"c488074.8e6bef8","type":"switch","z":"a6602ce1.5b9f9","name":"","property":"statusCode","propertyType":"msg","rules":[{"t":"eq","v":"200","vt":"num"},{"t":"else"}],"checkall":"true","repair":false,"outputs":2,"x":1950,"y":1100,"wires":[["4598b44b.e23c6c"],["919acd4a.f6309"]]},{"id":"919acd4a.f6309","type":"http response","z":"a6602ce1.5b9f9","name":"","statusCode":"","headers":{},"x":2090,"y":1140,"wires":[]},{"id":"fbd458cc.10e218","type":"http in","z":"a6602ce1.5b9f9","name":"PUT database","url":"/dbwrite/database","method":"put","upload":false,"swaggerDoc":"","x":90,"y":40,"wires":[["c5c85796.3cf8c8"]]},{"id":"bb672c4.e5ee3d","type":"change","z":"a6602ce1.5b9f9","name":"","rules":[{"t":"set","p":"payload","pt":"msg","to":"dbname","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":2400,"y":40,"wires":[["f17bd7e9.caae78"]]},{"id":"f7271a0e.936948","type":"http in","z":"a6602ce1.5b9f9","name":"GET database","url":"/dbwrite/database","method":"get","upload":false,"swaggerDoc":"","x":90,"y":140,"wires":[["e3d82ce1.1684f"]]},{"id":"3066c19a.bf477e","type":"http response","z":"a6602ce1.5b9f9","name":"","statusCode":"","headers":{},"x":2290,"y":140,"wires":[]},{"id":"3eaff1f4.9de39e","type":"change","z":"a6602ce1.5b9f9","name":"","rules":[{"t":"set","p":"headers","pt":"msg","to":"{\"Content-Type\":\"text/plain\"}","tot":"json"}],"action":"","property":"","from":"","to":"","reg":false,"x":2120,"y":140,"wires":[["3066c19a.bf477e"]]},{"id":"c5c85796.3cf8c8","type":"change","z":"a6602ce1.5b9f9","name":"get inputs","rules":[{"t":"set","p":"dbname","pt":"msg","to":"payload","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":240,"y":40,"wires":[["390b863d.b52d4a"]]},{"id":"362f419b.5b05ae","type":"http request","z":"a6602ce1.5b9f9","name":"get flows","method":"GET","ret":"obj","paytoqs":"ignore","url":"https://localhost:1880/flows","tls":"b1a419c1.609c29","persist":false,"proxy":"","authType":"","x":1760,"y":40,"wires":[["7fef4053.14ed2"]]},{"id":"338a8181.a8525e","type":"http response","z":"a6602ce1.5b9f9","name":"","statusCode":"","headers":{},"x":2770,"y":40,"wires":[]},{"id":"f17bd7e9.caae78","type":"change","z":"a6602ce1.5b9f9","name":"","rules":[{"t":"set","p":"headers","pt":"msg","to":"{\"Content-Type\":\"text/plain\"}","tot":"json"}],"action":"","property":"","from":"","to":"","reg":false,"x":2600,"y":40,"wires":[["338a8181.a8525e","162a04c5.861afb"]]},{"id":"3129bde8.7febd2","type":"http request","z":"a6602ce1.5b9f9","name":"get flows","method":"GET","ret":"obj","paytoqs":"ignore","url":"https://localhost:1880/flows","tls":"b1a419c1.609c29","persist":false,"proxy":"","authType":"","x":1600,"y":140,"wires":[["5f26cbb6.309ed4"]]},{"id":"9033e8a1.339128","type":"http request","z":"a6602ce1.5b9f9","name":"auth","method":"POST","ret":"obj","paytoqs":"ignore","url":"https://localhost:1880/auth/token","tls":"b1a419c1.609c29","persist":false,"proxy":"","authType":"","x":1090,"y":40,"wires":[["f6005892.1db538"]]},{"id":"337aeb25.8e62a4","type":"change","z":"a6602ce1.5b9f9","name":"auth payload","rules":[{"t":"set","p":"payload","pt":"msg","to":"{}","tot":"json"},{"t":"set","p":"payload.client_id","pt":"msg","to":"node-red-editor","tot":"str"},{"t":"set","p":"payload.grant_type","pt":"msg","to":"password","tot":"str"},{"t":"set","p":"payload.scope","pt":"msg","to":"","tot":"str"},{"t":"set","p":"payload.username","pt":"msg","to":"NRADM_USER","tot":"env"},{"t":"set","p":"payload.password","pt":"msg","to":"NRADM_PASS","tot":"env"}],"action":"","property":"","from":"","to":"","reg":false,"x":930,"y":40,"wires":[["9033e8a1.339128"]]},{"id":"a9174815.131d28","type":"change","z":"a6602ce1.5b9f9","name":"","rules":[{"t":"set","p":"accessToken","pt":"msg","to":"payload.access_token","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":1420,"y":40,"wires":[["ed9e78ef.f98f08"]]},{"id":"ed9e78ef.f98f08","type":"change","z":"a6602ce1.5b9f9","name":"bearer","rules":[{"t":"set","p":"headers","pt":"msg","to":"{}","tot":"json"},{"t":"set","p":"headers.authorization","pt":"msg","to":"\"Bearer \" & msg.accessToken","tot":"jsonata"}],"action":"","property":"","from":"","to":"","reg":false,"x":1610,"y":40,"wires":[["362f419b.5b05ae"]]},{"id":"6365f050.765fa","type":"http request","z":"a6602ce1.5b9f9","name":"auth","method":"POST","ret":"obj","paytoqs":"ignore","url":"https://localhost:1880/auth/token","tls":"b1a419c1.609c29","persist":false,"proxy":"","authType":"","x":930,"y":140,"wires":[["16371b82.d5c654"]]},{"id":"ccaab484.d64bc8","type":"change","z":"a6602ce1.5b9f9","name":"auth payload","rules":[{"t":"set","p":"payload.client_id","pt":"msg","to":"node-red-editor","tot":"str"},{"t":"set","p":"payload.grant_type","pt":"msg","to":"password","tot":"str"},{"t":"set","p":"payload.scope","pt":"msg","to":"","tot":"str"},{"t":"set","p":"payload.username","pt":"msg","to":"NRADM_USER","tot":"env"},{"t":"set","p":"payload.password","pt":"msg","to":"NRADM_PASS","tot":"env"}],"action":"","property":"","from":"","to":"","reg":false,"x":770,"y":140,"wires":[["6365f050.765fa"]]},{"id":"560c5bf4.308574","type":"change","z":"a6602ce1.5b9f9","name":"","rules":[{"t":"set","p":"accessToken","pt":"msg","to":"payload.access_token","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":1260,"y":140,"wires":[["d556d6a0.0b9278"]]},{"id":"d556d6a0.0b9278","type":"change","z":"a6602ce1.5b9f9","name":"bearer","rules":[{"t":"set","p":"headers","pt":"msg","to":"{}","tot":"json"},{"t":"set","p":"headers.authorization","pt":"msg","to":"\"Bearer \" & msg.accessToken","tot":"jsonata"}],"action":"","property":"","from":"","to":"","reg":false,"x":1450,"y":140,"wires":[["3129bde8.7febd2"]]},{"id":"3b1cd771.511a28","type":"http request","z":"a6602ce1.5b9f9","name":"","method":"POST","ret":"obj","paytoqs":"ignore","url":"${CFG_ACL_ENDP}","tls":"51b09598.a1114d","persist":false,"proxy":"","authType":"","x":610,"y":40,"wires":[["fc7c7224.6f8d5"]]},{"id":"fc7c7224.6f8d5","type":"switch","z":"a6602ce1.5b9f9","name":"","property":"statusCode","propertyType":"msg","rules":[{"t":"eq","v":"200","vt":"num"},{"t":"else"}],"checkall":"true","repair":false,"outputs":2,"x":770,"y":40,"wires":[["337aeb25.8e62a4"],["9261b015.7686d"]]},{"id":"4973611c.dddc2","type":"http request","z":"a6602ce1.5b9f9","name":"","method":"POST","ret":"obj","paytoqs":"ignore","url":"${CFG_ACL_ENDP}","tls":"51b09598.a1114d","persist":false,"proxy":"","authType":"","x":450,"y":140,"wires":[["c4a4a536.39a268"]]},{"id":"c4a4a536.39a268","type":"switch","z":"a6602ce1.5b9f9","name":"","property":"statusCode","propertyType":"msg","rules":[{"t":"eq","v":"200","vt":"num"},{"t":"else"}],"checkall":"true","repair":false,"outputs":2,"x":610,"y":140,"wires":[["ccaab484.d64bc8"],["6f606b6b.f7f934"]]},{"id":"e3d82ce1.1684f","type":"change","z":"a6602ce1.5b9f9","name":"acl req payload","rules":[{"t":"set","p":"headers","pt":"msg","to":"{}","tot":"json"},{"t":"set","p":"payload","pt":"msg","to":"{}","tot":"json"},{"t":"set","p":"payload.url","pt":"msg","to":"req.url","tot":"msg"},{"t":"set","p":"payload.method","pt":"msg","to":"req.method","tot":"msg"},{"t":"set","p":"payload.headers","pt":"msg","to":"req.headers","tot":"msg"},{"t":"set","p":"payload.params","pt":"msg","to":"req.params","tot":"msg"},{"t":"set","p":"payload.query","pt":"msg","to":"req.query","tot":"msg"},{"t":"set","p":"payload.body","pt":"msg","to":"req.body","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":260,"y":140,"wires":[["4973611c.dddc2"]]},{"id":"390b863d.b52d4a","type":"change","z":"a6602ce1.5b9f9","name":"acl req payload","rules":[{"t":"set","p":"headers","pt":"msg","to":"{}","tot":"json"},{"t":"set","p":"payload","pt":"msg","to":"{}","tot":"json"},{"t":"set","p":"payload.url","pt":"msg","to":"req.url","tot":"msg"},{"t":"set","p":"payload.method","pt":"msg","to":"req.method","tot":"msg"},{"t":"set","p":"payload.headers","pt":"msg","to":"req.headers","tot":"msg"},{"t":"set","p":"payload.params","pt":"msg","to":"req.params","tot":"msg"},{"t":"set","p":"payload.query","pt":"msg","to":"req.query","tot":"msg"},{"t":"set","p":"payload.body","pt":"msg","to":"req.body","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":420,"y":40,"wires":[["3b1cd771.511a28"]]},{"id":"6f606b6b.f7f934","type":"http response","z":"a6602ce1.5b9f9","name":"","statusCode":"","headers":{},"x":750,"y":180,"wires":[]},{"id":"b58de5c8.16b988","type":"change","z":"a6602ce1.5b9f9","name":"","rules":[{"t":"set","p":"payload","pt":"msg","to":"*[name = \"dbwrite mysql server config\" and type=\"Stackhero-MySQL-Server\"].database","tot":"jsonata"}],"action":"","property":"","from":"","to":"","reg":false,"x":1920,"y":140,"wires":[["3eaff1f4.9de39e"]]},{"id":"2d686def.ddb3c2","type":"change","z":"a6602ce1.5b9f9","name":"edit","rules":[{"t":"set","p":"old","pt":"msg","to":"*[name = \"dbwrite mysql server config\" and type=\"Stackhero-MySQL-Server\"]","tot":"jsonata"},{"t":"set","p":"new","pt":"msg","to":"old","tot":"msg"},{"t":"set","p":"new.database","pt":"msg","to":"dbname","tot":"msg"},{"t":"set","p":"payload","pt":"msg","to":"$eval($replace($string(payload),$string(old),$string(new)))","tot":"jsonata"}],"action":"","property":"","from":"","to":"","reg":false,"x":2050,"y":40,"wires":[["9f8fe552.bc1ae8"]]},{"id":"9261b015.7686d","type":"http response","z":"a6602ce1.5b9f9","name":"","statusCode":"","headers":{},"x":910,"y":80,"wires":[]},{"id":"f6005892.1db538","type":"switch","z":"a6602ce1.5b9f9","name":"","property":"statusCode","propertyType":"msg","rules":[{"t":"eq","v":"200","vt":"num"},{"t":"else"}],"checkall":"true","repair":false,"outputs":2,"x":1230,"y":40,"wires":[["a9174815.131d28"],["a0a55d89.e868a"]]},{"id":"a0a55d89.e868a","type":"http response","z":"a6602ce1.5b9f9","name":"","statusCode":"","headers":{},"x":1370,"y":80,"wires":[]},{"id":"7fef4053.14ed2","type":"switch","z":"a6602ce1.5b9f9","name":"","property":"statusCode","propertyType":"msg","rules":[{"t":"eq","v":"200","vt":"num"},{"t":"else"}],"checkall":"true","repair":false,"outputs":2,"x":1910,"y":40,"wires":[["2d686def.ddb3c2"],["494d6b2c.c4e524"]]},{"id":"494d6b2c.c4e524","type":"http response","z":"a6602ce1.5b9f9","name":"","statusCode":"","headers":{},"x":2050,"y":80,"wires":[]},{"id":"9f8fe552.bc1ae8","type":"function","z":"a6602ce1.5b9f9","name":"update flows","func":"const http = global.get('https');\nconst data = JSON.stringify(msg.payload);\nconst options = {\n  hostname: 'localhost',\n  port: 1880,\n  path: '/flows',\n  method: 'POST',\n  headers: {\n    'Content-Type': 'application/json',\n    'Content-Length': data.length,\n    'Authorization': 'Bearer '+msg.accessToken\n  },\n  rejectUnauthorized: false\n};\nconst req = http.request(options);\nreq.write(data);\nreq.end();\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":2210,"y":40,"wires":[["bb672c4.e5ee3d"]]},{"id":"16371b82.d5c654","type":"switch","z":"a6602ce1.5b9f9","name":"","property":"statusCode","propertyType":"msg","rules":[{"t":"eq","v":"200","vt":"num"},{"t":"else"}],"checkall":"true","repair":false,"outputs":2,"x":1070,"y":140,"wires":[["560c5bf4.308574"],["93d67035.49be"]]},{"id":"93d67035.49be","type":"http response","z":"a6602ce1.5b9f9","name":"","statusCode":"","headers":{},"x":1210,"y":180,"wires":[]},{"id":"5f26cbb6.309ed4","type":"switch","z":"a6602ce1.5b9f9","name":"","property":"statusCode","propertyType":"msg","rules":[{"t":"eq","v":"200","vt":"num"},{"t":"else"}],"checkall":"true","repair":false,"outputs":2,"x":1750,"y":140,"wires":[["b58de5c8.16b988"],["2b42d7d0.38d168"]]},{"id":"2b42d7d0.38d168","type":"http response","z":"a6602ce1.5b9f9","name":"","statusCode":"","headers":{},"x":1890,"y":180,"wires":[]},{"id":"162a04c5.861afb","type":"change","z":"a6602ce1.5b9f9","name":"status","rules":[{"t":"set","p":"payload","pt":"msg","to":"{}","tot":"json"},{"t":"set","p":"payload.text","pt":"msg","to":"\"database: \" & dbname","tot":"jsonata"},{"t":"set","p":"payload.shape","pt":"msg","to":"dot","tot":"str"},{"t":"set","p":"payload.fill","pt":"msg","to":"grey","tot":"str"}],"action":"","property":"","from":"","to":"","reg":false,"x":2770,"y":100,"wires":[[]]},{"id":"bd380b00.e45568","type":"change","z":"a6602ce1.5b9f9","name":"status","rules":[{"t":"set","p":"payload","pt":"msg","to":"{}","tot":"json"},{"t":"set","p":"payload.text","pt":"msg","to":"DB credentials updated.","tot":"str"},{"t":"set","p":"payload.shape","pt":"msg","to":"dot","tot":"str"},{"t":"set","p":"payload.fill","pt":"msg","to":"grey","tot":"str"}],"action":"","property":"","from":"","to":"","reg":false,"x":2790,"y":1160,"wires":[[]]},{"id":"c8cc962d.c9f418","type":"inject","z":"b2d45fd.e73bca","name":"","props":[{"p":"payload"}],"repeat":"1","crontab":"","once":true,"onceDelay":0.1,"topic":"","payload":"","payloadType":"date","x":110,"y":40,"wires":[["e1da28a2.81d398"]]},{"id":"e1da28a2.81d398","type":"change","z":"b2d45fd.e73bca","name":"status","rules":[{"t":"set","p":"time","pt":"msg","to":"payload","tot":"msg"},{"t":"set","p":"payload","pt":"msg","to":"{}","tot":"json"},{"t":"set","p":"payload.text","pt":"msg","to":"time","tot":"msg"},{"t":"set","p":"payload.shape","pt":"msg","to":"dot","tot":"str"},{"t":"set","p":"payload.fill","pt":"msg","to":"green","tot":"str"}],"action":"","property":"","from":"","to":"","reg":false,"x":270,"y":100,"wires":[[]]},{"id":"898c8758.921b88","type":"switch","z":"dcf52b9f.7e2b28","name":"fork","property":"$boolean(payload)","propertyType":"jsonata","rules":[{"t":"true"},{"t":"else"}],"checkall":"true","repair":false,"outputs":2,"x":170,"y":340,"wires":[["a2716cb5.12f77"],["2a168b2a.272314"]]},{"id":"2a168b2a.272314","type":"change","z":"dcf52b9f.7e2b28","name":"status otherwise","rules":[{"t":"set","p":"v","pt":"msg","to":"payload","tot":"msg"},{"t":"set","p":"payload","pt":"msg","to":"{}","tot":"json"},{"t":"set","p":"payload.text","pt":"msg","to":"v","tot":"msg"},{"t":"set","p":"payload.shape","pt":"msg","to":"dot","tot":"str"},{"t":"set","p":"payload.fill","pt":"msg","to":"yellow","tot":"str"}],"action":"","property":"","from":"","to":"","reg":false,"x":360,"y":380,"wires":[[]]},{"id":"a2716cb5.12f77","type":"change","z":"dcf52b9f.7e2b28","name":"status true","rules":[{"t":"set","p":"v","pt":"msg","to":"payload","tot":"msg"},{"t":"set","p":"payload","pt":"msg","to":"{}","tot":"json"},{"t":"set","p":"payload.text","pt":"msg","to":"v","tot":"msg"},{"t":"set","p":"payload.shape","pt":"msg","to":"dot","tot":"str"},{"t":"set","p":"payload.fill","pt":"msg","to":"green","tot":"str"}],"action":"","property":"","from":"","to":"","reg":false,"x":350,"y":300,"wires":[[]]},{"id":"fb458213.81c22","type":"http in","z":"dcf52b9f.7e2b28","name":"PUT condition","url":"/fork/condition","method":"put","upload":false,"swaggerDoc":"","x":90,"y":40,"wires":[["ba940770.3160c8"]]},{"id":"6268dd5d.3d70d4","type":"change","z":"dcf52b9f.7e2b28","name":"","rules":[{"t":"set","p":"payload","pt":"msg","to":"condition","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":2400,"y":40,"wires":[["a457a6e8.b5cc88"]]},{"id":"143e971b.12cb19","type":"http in","z":"dcf52b9f.7e2b28","name":"GET condition","url":"/fork/condition","method":"get","upload":false,"swaggerDoc":"","x":90,"y":140,"wires":[["67e5c510.0cb30c"]]},{"id":"a30691aa.febaf","type":"http response","z":"dcf52b9f.7e2b28","name":"","statusCode":"","headers":{},"x":2290,"y":140,"wires":[]},{"id":"ae676a33.1006f8","type":"change","z":"dcf52b9f.7e2b28","name":"","rules":[{"t":"set","p":"headers","pt":"msg","to":"{\"Content-Type\":\"text/plain\"}","tot":"json"}],"action":"","property":"","from":"","to":"","reg":false,"x":2120,"y":140,"wires":[["a30691aa.febaf"]]},{"id":"ba940770.3160c8","type":"change","z":"dcf52b9f.7e2b28","name":"get inputs","rules":[{"t":"set","p":"condition","pt":"msg","to":"payload","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":240,"y":40,"wires":[["b403886d.c21d88"]]},{"id":"26de82e.3ab057e","type":"http request","z":"dcf52b9f.7e2b28","name":"get flows","method":"GET","ret":"obj","paytoqs":"ignore","url":"https://localhost:1880/flows","tls":"b1a419c1.609c29","persist":false,"proxy":"","authType":"","x":1760,"y":40,"wires":[["55b9a1a9.368df"]]},{"id":"d21734d6.0af898","type":"http response","z":"dcf52b9f.7e2b28","name":"","statusCode":"","headers":{},"x":2770,"y":40,"wires":[]},{"id":"a457a6e8.b5cc88","type":"change","z":"dcf52b9f.7e2b28","name":"","rules":[{"t":"set","p":"headers","pt":"msg","to":"{\"Content-Type\":\"text/plain\"}","tot":"json"}],"action":"","property":"","from":"","to":"","reg":false,"x":2600,"y":40,"wires":[["d21734d6.0af898","8a0b8d5d.d4ff"]]},{"id":"e37b452a.945ce8","type":"http request","z":"dcf52b9f.7e2b28","name":"get flows","method":"GET","ret":"obj","paytoqs":"ignore","url":"https://localhost:1880/flows","tls":"b1a419c1.609c29","persist":false,"proxy":"","authType":"","x":1600,"y":140,"wires":[["cda0c703.4922d8"]]},{"id":"b24b4deb.1ccfb","type":"http request","z":"dcf52b9f.7e2b28","name":"auth","method":"POST","ret":"obj","paytoqs":"ignore","url":"https://localhost:1880/auth/token","tls":"b1a419c1.609c29","persist":false,"proxy":"","authType":"","x":1090,"y":40,"wires":[["968cbd4d.f0bfe"]]},{"id":"feb2755f.05f7d8","type":"change","z":"dcf52b9f.7e2b28","name":"auth payload","rules":[{"t":"set","p":"payload","pt":"msg","to":"{}","tot":"json"},{"t":"set","p":"payload.client_id","pt":"msg","to":"node-red-editor","tot":"str"},{"t":"set","p":"payload.grant_type","pt":"msg","to":"password","tot":"str"},{"t":"set","p":"payload.scope","pt":"msg","to":"","tot":"str"},{"t":"set","p":"payload.username","pt":"msg","to":"NRADM_USER","tot":"env"},{"t":"set","p":"payload.password","pt":"msg","to":"NRADM_PASS","tot":"env"}],"action":"","property":"","from":"","to":"","reg":false,"x":930,"y":40,"wires":[["b24b4deb.1ccfb"]]},{"id":"e9c6f54a.961078","type":"change","z":"dcf52b9f.7e2b28","name":"","rules":[{"t":"set","p":"accessToken","pt":"msg","to":"payload.access_token","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":1420,"y":40,"wires":[["6b410ef8.ffc9c"]]},{"id":"6b410ef8.ffc9c","type":"change","z":"dcf52b9f.7e2b28","name":"bearer","rules":[{"t":"set","p":"headers","pt":"msg","to":"{}","tot":"json"},{"t":"set","p":"headers.authorization","pt":"msg","to":"\"Bearer \" & msg.accessToken","tot":"jsonata"}],"action":"","property":"","from":"","to":"","reg":false,"x":1610,"y":40,"wires":[["26de82e.3ab057e"]]},{"id":"13694f24.ca8241","type":"http request","z":"dcf52b9f.7e2b28","name":"auth","method":"POST","ret":"obj","paytoqs":"ignore","url":"https://localhost:1880/auth/token","tls":"b1a419c1.609c29","persist":false,"proxy":"","authType":"","x":930,"y":140,"wires":[["d6ef4bcf.38da58"]]},{"id":"5706565f.0550c8","type":"change","z":"dcf52b9f.7e2b28","name":"auth payload","rules":[{"t":"set","p":"payload.client_id","pt":"msg","to":"node-red-editor","tot":"str"},{"t":"set","p":"payload.grant_type","pt":"msg","to":"password","tot":"str"},{"t":"set","p":"payload.scope","pt":"msg","to":"","tot":"str"},{"t":"set","p":"payload.username","pt":"msg","to":"NRADM_USER","tot":"env"},{"t":"set","p":"payload.password","pt":"msg","to":"NRADM_PASS","tot":"env"}],"action":"","property":"","from":"","to":"","reg":false,"x":770,"y":140,"wires":[["13694f24.ca8241"]]},{"id":"5b31f83f.6254c8","type":"change","z":"dcf52b9f.7e2b28","name":"","rules":[{"t":"set","p":"accessToken","pt":"msg","to":"payload.access_token","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":1260,"y":140,"wires":[["7c24a4e0.a9f46c"]]},{"id":"7c24a4e0.a9f46c","type":"change","z":"dcf52b9f.7e2b28","name":"bearer","rules":[{"t":"set","p":"headers","pt":"msg","to":"{}","tot":"json"},{"t":"set","p":"headers.authorization","pt":"msg","to":"\"Bearer \" & msg.accessToken","tot":"jsonata"}],"action":"","property":"","from":"","to":"","reg":false,"x":1450,"y":140,"wires":[["e37b452a.945ce8"]]},{"id":"5c7006f7.6e2368","type":"http request","z":"dcf52b9f.7e2b28","name":"","method":"POST","ret":"obj","paytoqs":"ignore","url":"${CFG_ACL_ENDP}","tls":"51b09598.a1114d","persist":false,"proxy":"","authType":"","x":610,"y":40,"wires":[["b7cf3d2f.7f4ec"]]},{"id":"b7cf3d2f.7f4ec","type":"switch","z":"dcf52b9f.7e2b28","name":"","property":"statusCode","propertyType":"msg","rules":[{"t":"eq","v":"200","vt":"num"},{"t":"else"}],"checkall":"true","repair":false,"outputs":2,"x":770,"y":40,"wires":[["feb2755f.05f7d8"],["69a2ce80.e3984"]]},{"id":"502e5de.7654fa4","type":"http request","z":"dcf52b9f.7e2b28","name":"","method":"POST","ret":"obj","paytoqs":"ignore","url":"${CFG_ACL_ENDP}","tls":"51b09598.a1114d","persist":false,"proxy":"","authType":"","x":450,"y":140,"wires":[["e55d1caf.3bdd5"]]},{"id":"e55d1caf.3bdd5","type":"switch","z":"dcf52b9f.7e2b28","name":"","property":"statusCode","propertyType":"msg","rules":[{"t":"eq","v":"200","vt":"num"},{"t":"else"}],"checkall":"true","repair":false,"outputs":2,"x":610,"y":140,"wires":[["5706565f.0550c8"],["f8ac2656.9b59a8"]]},{"id":"67e5c510.0cb30c","type":"change","z":"dcf52b9f.7e2b28","name":"acl req payload","rules":[{"t":"set","p":"headers","pt":"msg","to":"{}","tot":"json"},{"t":"set","p":"payload","pt":"msg","to":"{}","tot":"json"},{"t":"set","p":"payload.url","pt":"msg","to":"req.url","tot":"msg"},{"t":"set","p":"payload.method","pt":"msg","to":"req.method","tot":"msg"},{"t":"set","p":"payload.headers","pt":"msg","to":"req.headers","tot":"msg"},{"t":"set","p":"payload.params","pt":"msg","to":"req.params","tot":"msg"},{"t":"set","p":"payload.query","pt":"msg","to":"req.query","tot":"msg"},{"t":"set","p":"payload.body","pt":"msg","to":"req.body","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":260,"y":140,"wires":[["502e5de.7654fa4"]]},{"id":"b403886d.c21d88","type":"change","z":"dcf52b9f.7e2b28","name":"acl req payload","rules":[{"t":"set","p":"headers","pt":"msg","to":"{}","tot":"json"},{"t":"set","p":"payload","pt":"msg","to":"{}","tot":"json"},{"t":"set","p":"payload.url","pt":"msg","to":"req.url","tot":"msg"},{"t":"set","p":"payload.method","pt":"msg","to":"req.method","tot":"msg"},{"t":"set","p":"payload.headers","pt":"msg","to":"req.headers","tot":"msg"},{"t":"set","p":"payload.params","pt":"msg","to":"req.params","tot":"msg"},{"t":"set","p":"payload.query","pt":"msg","to":"req.query","tot":"msg"},{"t":"set","p":"payload.body","pt":"msg","to":"req.body","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":420,"y":40,"wires":[["5c7006f7.6e2368"]]},{"id":"f8ac2656.9b59a8","type":"http response","z":"dcf52b9f.7e2b28","name":"","statusCode":"","headers":{},"x":750,"y":180,"wires":[]},{"id":"70698a7a.1b9ac4","type":"change","z":"dcf52b9f.7e2b28","name":"","rules":[{"t":"set","p":"payload","pt":"msg","to":"*[name = \"fork\" and type=\"switch\"].property","tot":"jsonata"}],"action":"","property":"","from":"","to":"","reg":false,"x":1920,"y":140,"wires":[["ae676a33.1006f8"]]},{"id":"59edcda2.f65e14","type":"change","z":"dcf52b9f.7e2b28","name":"edit","rules":[{"t":"set","p":"old","pt":"msg","to":"*[name = \"fork\" and type=\"switch\"]","tot":"jsonata"},{"t":"set","p":"new","pt":"msg","to":"old","tot":"msg"},{"t":"set","p":"new.property","pt":"msg","to":"condition","tot":"msg"},{"t":"set","p":"payload","pt":"msg","to":"$eval($replace($string(payload),$string(old),$string(new)))","tot":"jsonata"}],"action":"","property":"","from":"","to":"","reg":false,"x":2050,"y":40,"wires":[["d9ec6ec9.c8a4b"]]},{"id":"69a2ce80.e3984","type":"http response","z":"dcf52b9f.7e2b28","name":"","statusCode":"","headers":{},"x":910,"y":80,"wires":[]},{"id":"968cbd4d.f0bfe","type":"switch","z":"dcf52b9f.7e2b28","name":"","property":"statusCode","propertyType":"msg","rules":[{"t":"eq","v":"200","vt":"num"},{"t":"else"}],"checkall":"true","repair":false,"outputs":2,"x":1230,"y":40,"wires":[["e9c6f54a.961078"],["17737fd1.a373d"]]},{"id":"17737fd1.a373d","type":"http response","z":"dcf52b9f.7e2b28","name":"","statusCode":"","headers":{},"x":1370,"y":80,"wires":[]},{"id":"55b9a1a9.368df","type":"switch","z":"dcf52b9f.7e2b28","name":"","property":"statusCode","propertyType":"msg","rules":[{"t":"eq","v":"200","vt":"num"},{"t":"else"}],"checkall":"true","repair":false,"outputs":2,"x":1910,"y":40,"wires":[["59edcda2.f65e14"],["e884d954.b3c7d8"]]},{"id":"e884d954.b3c7d8","type":"http response","z":"dcf52b9f.7e2b28","name":"","statusCode":"","headers":{},"x":2050,"y":80,"wires":[]},{"id":"d9ec6ec9.c8a4b","type":"function","z":"dcf52b9f.7e2b28","name":"update flows","func":"const http = global.get('https');\nconst data = JSON.stringify(msg.payload);\nconst options = {\n  hostname: 'localhost',\n  port: 1880,\n  path: '/flows',\n  method: 'POST',\n  headers: {\n    'Content-Type': 'application/json',\n    'Content-Length': data.length,\n    'Authorization': 'Bearer '+msg.accessToken\n  },\n  rejectUnauthorized: false\n};\nconst req = http.request(options);\nreq.write(data);\nreq.end();\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":2210,"y":40,"wires":[["6268dd5d.3d70d4"]]},{"id":"d6ef4bcf.38da58","type":"switch","z":"dcf52b9f.7e2b28","name":"","property":"statusCode","propertyType":"msg","rules":[{"t":"eq","v":"200","vt":"num"},{"t":"else"}],"checkall":"true","repair":false,"outputs":2,"x":1070,"y":140,"wires":[["5b31f83f.6254c8"],["9ac4cb2b.f50e68"]]},{"id":"9ac4cb2b.f50e68","type":"http response","z":"dcf52b9f.7e2b28","name":"","statusCode":"","headers":{},"x":1210,"y":180,"wires":[]},{"id":"cda0c703.4922d8","type":"switch","z":"dcf52b9f.7e2b28","name":"","property":"statusCode","propertyType":"msg","rules":[{"t":"eq","v":"200","vt":"num"},{"t":"else"}],"checkall":"true","repair":false,"outputs":2,"x":1750,"y":140,"wires":[["70698a7a.1b9ac4"],["e904dd7c.d8f0c"]]},{"id":"e904dd7c.d8f0c","type":"http response","z":"dcf52b9f.7e2b28","name":"","statusCode":"","headers":{},"x":1890,"y":180,"wires":[]},{"id":"8a0b8d5d.d4ff","type":"change","z":"dcf52b9f.7e2b28","name":"status","rules":[{"t":"set","p":"payload","pt":"msg","to":"{}","tot":"json"},{"t":"set","p":"payload.text","pt":"msg","to":"\"condition: \" & condition","tot":"jsonata"},{"t":"set","p":"payload.shape","pt":"msg","to":"dot","tot":"str"},{"t":"set","p":"payload.fill","pt":"msg","to":"grey","tot":"str"}],"action":"","property":"","from":"","to":"","reg":false,"x":2770,"y":100,"wires":[[]]},{"id":"2b120e60.ec81c2","type":"tail","z":"a479104f.4f835","name":"filetail","filetype":"text","split":"[\\r]{0,1}\\n","filename":"","inputs":1,"x":70,"y":440,"wires":[["cf6917fd.dd12a8"]]},{"id":"cf6917fd.dd12a8","type":"change","z":"a479104f.4f835","name":"status","rules":[{"t":"set","p":"v","pt":"msg","to":"payload","tot":"msg"},{"t":"set","p":"payload","pt":"msg","to":"{}","tot":"json"},{"t":"set","p":"payload.text","pt":"msg","to":"v","tot":"msg"},{"t":"set","p":"payload.shape","pt":"msg","to":"dot","tot":"str"},{"t":"set","p":"payload.fill","pt":"msg","to":"green","tot":"str"}],"action":"","property":"","from":"","to":"","reg":false,"x":210,"y":500,"wires":[[]]},{"id":"6249d50e.1432cc","type":"http in","z":"a479104f.4f835","name":"PUT filename","url":"/filetail/filename","method":"put","upload":false,"swaggerDoc":"","x":310,"y":40,"wires":[["82a026d8.b0cc18"]]},{"id":"3348f7f3.513af8","type":"change","z":"a479104f.4f835","name":"","rules":[{"t":"set","p":"payload","pt":"msg","to":"filename","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":2640,"y":40,"wires":[["8184cf57.3ab51"]]},{"id":"b623b7ce.8f57b8","type":"http in","z":"a479104f.4f835","name":"GET filename","url":"/filetail/filename","method":"get","upload":false,"swaggerDoc":"","x":90,"y":140,"wires":[["6fc8c9c5.7d8248"]]},{"id":"11a8a12a.759e6f","type":"http response","z":"a479104f.4f835","name":"","statusCode":"","headers":{},"x":2310,"y":140,"wires":[]},{"id":"ff1146b1.34f5d8","type":"change","z":"a479104f.4f835","name":"","rules":[{"t":"set","p":"headers","pt":"msg","to":"{\"Content-Type\":\"text/plain\"}","tot":"json"}],"action":"","property":"","from":"","to":"","reg":false,"x":2140,"y":140,"wires":[["11a8a12a.759e6f"]]},{"id":"82a026d8.b0cc18","type":"change","z":"a479104f.4f835","name":"get inputs","rules":[{"t":"set","p":"filename","pt":"msg","to":"payload","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":480,"y":40,"wires":[["c73c6904.a2f398"]]},{"id":"a2ee4bbf.1b3c08","type":"http request","z":"a479104f.4f835","name":"get flows","method":"GET","ret":"obj","paytoqs":"ignore","url":"https://localhost:1880/flows","tls":"b1a419c1.609c29","persist":false,"proxy":"","authType":"","x":2000,"y":40,"wires":[["5496e46e.bddcfc"]]},{"id":"88348d51.6dabe","type":"http response","z":"a479104f.4f835","name":"","statusCode":"","headers":{},"x":3010,"y":40,"wires":[]},{"id":"8184cf57.3ab51","type":"change","z":"a479104f.4f835","name":"","rules":[{"t":"set","p":"headers","pt":"msg","to":"{\"Content-Type\":\"text/plain\"}","tot":"json"}],"action":"","property":"","from":"","to":"","reg":false,"x":2840,"y":40,"wires":[["88348d51.6dabe","3027acc4.9322a4"]]},{"id":"259b8c59.31f9b4","type":"http request","z":"a479104f.4f835","name":"get flows","method":"GET","ret":"obj","paytoqs":"ignore","url":"https://localhost:1880/flows","tls":"b1a419c1.609c29","persist":false,"proxy":"","authType":"","x":1620,"y":140,"wires":[["b7c96724.920a48"]]},{"id":"cdc674d3.e50538","type":"http request","z":"a479104f.4f835","name":"auth","method":"POST","ret":"obj","paytoqs":"ignore","url":"https://localhost:1880/auth/token","tls":"b1a419c1.609c29","persist":false,"proxy":"","authType":"","x":1330,"y":40,"wires":[["b1dcff51.e4025"]]},{"id":"9aeb48e5.d29d98","type":"change","z":"a479104f.4f835","name":"auth payload","rules":[{"t":"set","p":"payload","pt":"msg","to":"{}","tot":"json"},{"t":"set","p":"payload.client_id","pt":"msg","to":"node-red-editor","tot":"str"},{"t":"set","p":"payload.grant_type","pt":"msg","to":"password","tot":"str"},{"t":"set","p":"payload.scope","pt":"msg","to":"","tot":"str"},{"t":"set","p":"payload.username","pt":"msg","to":"NRADM_USER","tot":"env"},{"t":"set","p":"payload.password","pt":"msg","to":"NRADM_PASS","tot":"env"}],"action":"","property":"","from":"","to":"","reg":false,"x":1170,"y":40,"wires":[["cdc674d3.e50538"]]},{"id":"1382be8a.4bcf51","type":"change","z":"a479104f.4f835","name":"","rules":[{"t":"set","p":"accessToken","pt":"msg","to":"payload.access_token","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":1660,"y":40,"wires":[["30ddbf74.373d9"]]},{"id":"30ddbf74.373d9","type":"change","z":"a479104f.4f835","name":"bearer","rules":[{"t":"set","p":"headers","pt":"msg","to":"{}","tot":"json"},{"t":"set","p":"headers.authorization","pt":"msg","to":"\"Bearer \" & msg.accessToken","tot":"jsonata"}],"action":"","property":"","from":"","to":"","reg":false,"x":1850,"y":40,"wires":[["a2ee4bbf.1b3c08"]]},{"id":"99c5d575.9bc478","type":"http request","z":"a479104f.4f835","name":"auth","method":"POST","ret":"obj","paytoqs":"ignore","url":"https://localhost:1880/auth/token","tls":"b1a419c1.609c29","persist":false,"proxy":"","authType":"","x":950,"y":140,"wires":[["7e8b9586.d96e9c"]]},{"id":"6fcba78e.376698","type":"change","z":"a479104f.4f835","name":"auth payload","rules":[{"t":"set","p":"payload.client_id","pt":"msg","to":"node-red-editor","tot":"str"},{"t":"set","p":"payload.grant_type","pt":"msg","to":"password","tot":"str"},{"t":"set","p":"payload.scope","pt":"msg","to":"","tot":"str"},{"t":"set","p":"payload.username","pt":"msg","to":"NRADM_USER","tot":"env"},{"t":"set","p":"payload.password","pt":"msg","to":"NRADM_PASS","tot":"env"}],"action":"","property":"","from":"","to":"","reg":false,"x":790,"y":140,"wires":[["99c5d575.9bc478"]]},{"id":"f6e6d801.dabce8","type":"change","z":"a479104f.4f835","name":"","rules":[{"t":"set","p":"accessToken","pt":"msg","to":"payload.access_token","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":1280,"y":140,"wires":[["25d2937.ddd6f6c"]]},{"id":"25d2937.ddd6f6c","type":"change","z":"a479104f.4f835","name":"bearer","rules":[{"t":"set","p":"headers","pt":"msg","to":"{}","tot":"json"},{"t":"set","p":"headers.authorization","pt":"msg","to":"\"Bearer \" & msg.accessToken","tot":"jsonata"}],"action":"","property":"","from":"","to":"","reg":false,"x":1470,"y":140,"wires":[["259b8c59.31f9b4"]]},{"id":"6488ff21.025f9","type":"http request","z":"a479104f.4f835","name":"","method":"POST","ret":"obj","paytoqs":"ignore","url":"${CFG_ACL_ENDP}","tls":"51b09598.a1114d","persist":false,"proxy":"","authType":"","x":850,"y":40,"wires":[["a16b0d8f.dc66c"]]},{"id":"a16b0d8f.dc66c","type":"switch","z":"a479104f.4f835","name":"","property":"statusCode","propertyType":"msg","rules":[{"t":"eq","v":"200","vt":"num"},{"t":"else"}],"checkall":"true","repair":false,"outputs":2,"x":1010,"y":40,"wires":[["9aeb48e5.d29d98"],["f9f39bee.c191f8"]]},{"id":"a77fb0c5.90c1b","type":"http request","z":"a479104f.4f835","name":"","method":"POST","ret":"obj","paytoqs":"ignore","url":"${CFG_ACL_ENDP}","tls":"51b09598.a1114d","persist":false,"proxy":"","authType":"","x":470,"y":140,"wires":[["2ac19a5a.7f86c6"]]},{"id":"2ac19a5a.7f86c6","type":"switch","z":"a479104f.4f835","name":"","property":"statusCode","propertyType":"msg","rules":[{"t":"eq","v":"200","vt":"num"},{"t":"else"}],"checkall":"true","repair":false,"outputs":2,"x":630,"y":140,"wires":[["6fcba78e.376698"],["dea0a6ec.ca0418"]]},{"id":"6fc8c9c5.7d8248","type":"change","z":"a479104f.4f835","name":"acl req payload","rules":[{"t":"set","p":"headers","pt":"msg","to":"{}","tot":"json"},{"t":"set","p":"payload","pt":"msg","to":"{}","tot":"json"},{"t":"set","p":"payload.url","pt":"msg","to":"req.url","tot":"msg"},{"t":"set","p":"payload.method","pt":"msg","to":"req.method","tot":"msg"},{"t":"set","p":"payload.headers","pt":"msg","to":"req.headers","tot":"msg"},{"t":"set","p":"payload.params","pt":"msg","to":"req.params","tot":"msg"},{"t":"set","p":"payload.query","pt":"msg","to":"req.query","tot":"msg"},{"t":"set","p":"payload.body","pt":"msg","to":"req.body","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":280,"y":140,"wires":[["a77fb0c5.90c1b"]]},{"id":"c73c6904.a2f398","type":"change","z":"a479104f.4f835","name":"acl req payload","rules":[{"t":"set","p":"headers","pt":"msg","to":"{}","tot":"json"},{"t":"set","p":"payload","pt":"msg","to":"{}","tot":"json"},{"t":"set","p":"payload.url","pt":"msg","to":"req.url","tot":"msg"},{"t":"set","p":"payload.method","pt":"msg","to":"req.method","tot":"msg"},{"t":"set","p":"payload.headers","pt":"msg","to":"req.headers","tot":"msg"},{"t":"set","p":"payload.params","pt":"msg","to":"req.params","tot":"msg"},{"t":"set","p":"payload.query","pt":"msg","to":"req.query","tot":"msg"},{"t":"set","p":"payload.body","pt":"msg","to":"req.body","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":660,"y":40,"wires":[["6488ff21.025f9"]]},{"id":"dea0a6ec.ca0418","type":"http response","z":"a479104f.4f835","name":"","statusCode":"","headers":{},"x":770,"y":180,"wires":[]},{"id":"ee4bd9ef.bfea18","type":"change","z":"a479104f.4f835","name":"","rules":[{"t":"set","p":"payload","pt":"msg","to":"*[name = \"filetail\" and type=\"tail\"].filename","tot":"jsonata"}],"action":"","property":"","from":"","to":"","reg":false,"x":1940,"y":140,"wires":[["ff1146b1.34f5d8"]]},{"id":"e0e587a0.3cdc48","type":"change","z":"a479104f.4f835","name":"edit","rules":[{"t":"set","p":"old","pt":"msg","to":"*[name = \"filetail\" and type=\"tail\"]","tot":"jsonata"},{"t":"set","p":"new","pt":"msg","to":"old","tot":"msg"},{"t":"set","p":"new.filename","pt":"msg","to":"filename","tot":"msg"},{"t":"set","p":"payload","pt":"msg","to":"$eval($replace($string(payload),$string(old),$string(new)))","tot":"jsonata"}],"action":"","property":"","from":"","to":"","reg":false,"x":2290,"y":40,"wires":[["e9a1bdd2.8402c"]]},{"id":"f9f39bee.c191f8","type":"http response","z":"a479104f.4f835","name":"","statusCode":"","headers":{},"x":1150,"y":80,"wires":[]},{"id":"b1dcff51.e4025","type":"switch","z":"a479104f.4f835","name":"","property":"statusCode","propertyType":"msg","rules":[{"t":"eq","v":"200","vt":"num"},{"t":"else"}],"checkall":"true","repair":false,"outputs":2,"x":1470,"y":40,"wires":[["1382be8a.4bcf51"],["d2431335.06645"]]},{"id":"d2431335.06645","type":"http response","z":"a479104f.4f835","name":"","statusCode":"","headers":{},"x":1610,"y":80,"wires":[]},{"id":"5496e46e.bddcfc","type":"switch","z":"a479104f.4f835","name":"","property":"statusCode","propertyType":"msg","rules":[{"t":"eq","v":"200","vt":"num"},{"t":"else"}],"checkall":"true","repair":false,"outputs":2,"x":2150,"y":40,"wires":[["e0e587a0.3cdc48"],["54018ba6.547d74"]]},{"id":"54018ba6.547d74","type":"http response","z":"a479104f.4f835","name":"","statusCode":"","headers":{},"x":2290,"y":80,"wires":[]},{"id":"e9a1bdd2.8402c","type":"function","z":"a479104f.4f835","name":"update flows","func":"const http = global.get('https');\nconst data = JSON.stringify(msg.payload);\nconst options = {\n  hostname: 'localhost',\n  port: 1880,\n  path: '/flows',\n  method: 'POST',\n  headers: {\n    'Content-Type': 'application/json',\n    'Content-Length': data.length,\n    'Authorization': 'Bearer '+msg.accessToken\n  },\n  rejectUnauthorized: false\n};\nconst req = http.request(options);\nreq.write(data);\nreq.end();\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":2450,"y":40,"wires":[["3348f7f3.513af8"]]},{"id":"7e8b9586.d96e9c","type":"switch","z":"a479104f.4f835","name":"","property":"statusCode","propertyType":"msg","rules":[{"t":"eq","v":"200","vt":"num"},{"t":"else"}],"checkall":"true","repair":false,"outputs":2,"x":1090,"y":140,"wires":[["f6e6d801.dabce8"],["5b660999.3d6e78"]]},{"id":"5b660999.3d6e78","type":"http response","z":"a479104f.4f835","name":"","statusCode":"","headers":{},"x":1230,"y":180,"wires":[]},{"id":"b7c96724.920a48","type":"switch","z":"a479104f.4f835","name":"","property":"statusCode","propertyType":"msg","rules":[{"t":"eq","v":"200","vt":"num"},{"t":"else"}],"checkall":"true","repair":false,"outputs":2,"x":1770,"y":140,"wires":[["ee4bd9ef.bfea18"],["e60f4615.5aae58"]]},{"id":"e60f4615.5aae58","type":"http response","z":"a479104f.4f835","name":"","statusCode":"","headers":{},"x":1910,"y":180,"wires":[]},{"id":"3027acc4.9322a4","type":"change","z":"a479104f.4f835","name":"status","rules":[{"t":"set","p":"payload","pt":"msg","to":"{}","tot":"json"},{"t":"set","p":"payload.text","pt":"msg","to":"\"filename: \" & filename","tot":"jsonata"},{"t":"set","p":"payload.shape","pt":"msg","to":"dot","tot":"str"},{"t":"set","p":"payload.fill","pt":"msg","to":"grey","tot":"str"}],"action":"","property":"","from":"","to":"","reg":false,"x":3010,"y":100,"wires":[[]]},{"id":"d9fffc1f.d4fba","type":"http in","z":"a479104f.4f835","name":"PUT separator","url":"/filetail/separator","method":"put","upload":false,"swaggerDoc":"","x":90,"y":240,"wires":[["c556f854.aca278"]]},{"id":"97bfc2fd.380e3","type":"change","z":"a479104f.4f835","name":"","rules":[{"t":"set","p":"payload","pt":"msg","to":"separator","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":2420,"y":240,"wires":[["f6df80d6.e1cc6"]]},{"id":"d75e8332.65d72","type":"http in","z":"a479104f.4f835","name":"GET separator","url":"/filetail/separator","method":"get","upload":false,"swaggerDoc":"","x":100,"y":340,"wires":[["f523f2fc.d5815"]]},{"id":"d383af26.f219a","type":"http response","z":"a479104f.4f835","name":"","statusCode":"","headers":{},"x":2330,"y":340,"wires":[]},{"id":"3ceddc71.24f694","type":"change","z":"a479104f.4f835","name":"","rules":[{"t":"set","p":"headers","pt":"msg","to":"{\"Content-Type\":\"text/plain\"}","tot":"json"}],"action":"","property":"","from":"","to":"","reg":false,"x":2160,"y":340,"wires":[["d383af26.f219a"]]},{"id":"c556f854.aca278","type":"change","z":"a479104f.4f835","name":"get inputs","rules":[{"t":"set","p":"separator","pt":"msg","to":"payload","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":260,"y":240,"wires":[["d753137e.d37e3"]]},{"id":"47b17b7c.cc95e4","type":"http request","z":"a479104f.4f835","name":"get flows","method":"GET","ret":"obj","paytoqs":"ignore","url":"https://localhost:1880/flows","tls":"b1a419c1.609c29","persist":false,"proxy":"","authType":"","x":1780,"y":240,"wires":[["8633764b.e07ed8"]]},{"id":"da02e0b1.f0431","type":"http response","z":"a479104f.4f835","name":"","statusCode":"","headers":{},"x":2790,"y":240,"wires":[]},{"id":"f6df80d6.e1cc6","type":"change","z":"a479104f.4f835","name":"","rules":[{"t":"set","p":"headers","pt":"msg","to":"{\"Content-Type\":\"text/plain\"}","tot":"json"}],"action":"","property":"","from":"","to":"","reg":false,"x":2620,"y":240,"wires":[["da02e0b1.f0431","88ebe607.4ca4b8"]]},{"id":"3f9a7c27.4e79a4","type":"http request","z":"a479104f.4f835","name":"get flows","method":"GET","ret":"obj","paytoqs":"ignore","url":"https://localhost:1880/flows","tls":"b1a419c1.609c29","persist":false,"proxy":"","authType":"","x":1640,"y":340,"wires":[["aebd1115.58b13"]]},{"id":"796cdf60.d9219","type":"http request","z":"a479104f.4f835","name":"auth","method":"POST","ret":"obj","paytoqs":"ignore","url":"https://localhost:1880/auth/token","tls":"b1a419c1.609c29","persist":false,"proxy":"","authType":"","x":1110,"y":240,"wires":[["47dcea0.acd0f18"]]},{"id":"4e389e12.4e03c","type":"change","z":"a479104f.4f835","name":"auth payload","rules":[{"t":"set","p":"payload","pt":"msg","to":"{}","tot":"json"},{"t":"set","p":"payload.client_id","pt":"msg","to":"node-red-editor","tot":"str"},{"t":"set","p":"payload.grant_type","pt":"msg","to":"password","tot":"str"},{"t":"set","p":"payload.scope","pt":"msg","to":"","tot":"str"},{"t":"set","p":"payload.username","pt":"msg","to":"NRADM_USER","tot":"env"},{"t":"set","p":"payload.password","pt":"msg","to":"NRADM_PASS","tot":"env"}],"action":"","property":"","from":"","to":"","reg":false,"x":950,"y":240,"wires":[["796cdf60.d9219"]]},{"id":"387fe21f.1ef1be","type":"change","z":"a479104f.4f835","name":"","rules":[{"t":"set","p":"accessToken","pt":"msg","to":"payload.access_token","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":1440,"y":240,"wires":[["fa4d9518.1b56d8"]]},{"id":"fa4d9518.1b56d8","type":"change","z":"a479104f.4f835","name":"bearer","rules":[{"t":"set","p":"headers","pt":"msg","to":"{}","tot":"json"},{"t":"set","p":"headers.authorization","pt":"msg","to":"\"Bearer \" & msg.accessToken","tot":"jsonata"}],"action":"","property":"","from":"","to":"","reg":false,"x":1630,"y":240,"wires":[["47b17b7c.cc95e4"]]},{"id":"ce260618.59fa68","type":"http request","z":"a479104f.4f835","name":"auth","method":"POST","ret":"obj","paytoqs":"ignore","url":"https://localhost:1880/auth/token","tls":"b1a419c1.609c29","persist":false,"proxy":"","authType":"","x":970,"y":340,"wires":[["ea368a26.130058"]]},{"id":"19098a5b.aafd26","type":"change","z":"a479104f.4f835","name":"auth payload","rules":[{"t":"set","p":"payload.client_id","pt":"msg","to":"node-red-editor","tot":"str"},{"t":"set","p":"payload.grant_type","pt":"msg","to":"password","tot":"str"},{"t":"set","p":"payload.scope","pt":"msg","to":"","tot":"str"},{"t":"set","p":"payload.username","pt":"msg","to":"NRADM_USER","tot":"env"},{"t":"set","p":"payload.password","pt":"msg","to":"NRADM_PASS","tot":"env"}],"action":"","property":"","from":"","to":"","reg":false,"x":810,"y":340,"wires":[["ce260618.59fa68"]]},{"id":"423bf12a.e5f2","type":"change","z":"a479104f.4f835","name":"","rules":[{"t":"set","p":"accessToken","pt":"msg","to":"payload.access_token","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":1300,"y":340,"wires":[["a87fa9bc.923298"]]},{"id":"a87fa9bc.923298","type":"change","z":"a479104f.4f835","name":"bearer","rules":[{"t":"set","p":"headers","pt":"msg","to":"{}","tot":"json"},{"t":"set","p":"headers.authorization","pt":"msg","to":"\"Bearer \" & msg.accessToken","tot":"jsonata"}],"action":"","property":"","from":"","to":"","reg":false,"x":1490,"y":340,"wires":[["3f9a7c27.4e79a4"]]},{"id":"72c37cbd.b6bfe4","type":"http request","z":"a479104f.4f835","name":"","method":"POST","ret":"obj","paytoqs":"ignore","url":"${CFG_ACL_ENDP}","tls":"51b09598.a1114d","persist":false,"proxy":"","authType":"","x":630,"y":240,"wires":[["7689fbc.a0e7504"]]},{"id":"7689fbc.a0e7504","type":"switch","z":"a479104f.4f835","name":"","property":"statusCode","propertyType":"msg","rules":[{"t":"eq","v":"200","vt":"num"},{"t":"else"}],"checkall":"true","repair":false,"outputs":2,"x":790,"y":240,"wires":[["4e389e12.4e03c"],["a8c278ac.35e658"]]},{"id":"166358c8.7a9ec7","type":"http request","z":"a479104f.4f835","name":"","method":"POST","ret":"obj","paytoqs":"ignore","url":"${CFG_ACL_ENDP}","tls":"51b09598.a1114d","persist":false,"proxy":"","authType":"","x":490,"y":340,"wires":[["9d25bd18.bfc"]]},{"id":"9d25bd18.bfc","type":"switch","z":"a479104f.4f835","name":"","property":"statusCode","propertyType":"msg","rules":[{"t":"eq","v":"200","vt":"num"},{"t":"else"}],"checkall":"true","repair":false,"outputs":2,"x":650,"y":340,"wires":[["19098a5b.aafd26"],["aa490b10.c9ae28"]]},{"id":"f523f2fc.d5815","type":"change","z":"a479104f.4f835","name":"acl req payload","rules":[{"t":"set","p":"headers","pt":"msg","to":"{}","tot":"json"},{"t":"set","p":"payload","pt":"msg","to":"{}","tot":"json"},{"t":"set","p":"payload.url","pt":"msg","to":"req.url","tot":"msg"},{"t":"set","p":"payload.method","pt":"msg","to":"req.method","tot":"msg"},{"t":"set","p":"payload.headers","pt":"msg","to":"req.headers","tot":"msg"},{"t":"set","p":"payload.params","pt":"msg","to":"req.params","tot":"msg"},{"t":"set","p":"payload.query","pt":"msg","to":"req.query","tot":"msg"},{"t":"set","p":"payload.body","pt":"msg","to":"req.body","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":300,"y":340,"wires":[["166358c8.7a9ec7"]]},{"id":"d753137e.d37e3","type":"change","z":"a479104f.4f835","name":"acl req payload","rules":[{"t":"set","p":"headers","pt":"msg","to":"{}","tot":"json"},{"t":"set","p":"payload","pt":"msg","to":"{}","tot":"json"},{"t":"set","p":"payload.url","pt":"msg","to":"req.url","tot":"msg"},{"t":"set","p":"payload.method","pt":"msg","to":"req.method","tot":"msg"},{"t":"set","p":"payload.headers","pt":"msg","to":"req.headers","tot":"msg"},{"t":"set","p":"payload.params","pt":"msg","to":"req.params","tot":"msg"},{"t":"set","p":"payload.query","pt":"msg","to":"req.query","tot":"msg"},{"t":"set","p":"payload.body","pt":"msg","to":"req.body","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":440,"y":240,"wires":[["72c37cbd.b6bfe4"]]},{"id":"aa490b10.c9ae28","type":"http response","z":"a479104f.4f835","name":"","statusCode":"","headers":{},"x":790,"y":380,"wires":[]},{"id":"1e4a66c7.8235a9","type":"change","z":"a479104f.4f835","name":"","rules":[{"t":"set","p":"payload","pt":"msg","to":"*[name = \"filetail\" and type=\"tail\"].separator","tot":"jsonata"}],"action":"","property":"","from":"","to":"","reg":false,"x":1960,"y":340,"wires":[["3ceddc71.24f694"]]},{"id":"e36734ae.e49fb8","type":"change","z":"a479104f.4f835","name":"edit","rules":[{"t":"set","p":"old","pt":"msg","to":"*[name = \"filetail\" and type=\"tail\"]","tot":"jsonata"},{"t":"set","p":"new","pt":"msg","to":"old","tot":"msg"},{"t":"set","p":"new.split","pt":"msg","to":"separator","tot":"msg"},{"t":"set","p":"payload","pt":"msg","to":"$eval($replace($string(payload),$string(old),$string(new)))","tot":"jsonata"}],"action":"","property":"","from":"","to":"","reg":false,"x":2070,"y":240,"wires":[["3b5dbafe.bb1566"]]},{"id":"a8c278ac.35e658","type":"http response","z":"a479104f.4f835","name":"","statusCode":"","headers":{},"x":930,"y":280,"wires":[]},{"id":"47dcea0.acd0f18","type":"switch","z":"a479104f.4f835","name":"","property":"statusCode","propertyType":"msg","rules":[{"t":"eq","v":"200","vt":"num"},{"t":"else"}],"checkall":"true","repair":false,"outputs":2,"x":1250,"y":240,"wires":[["387fe21f.1ef1be"],["a7fdb016.dca34"]]},{"id":"a7fdb016.dca34","type":"http response","z":"a479104f.4f835","name":"","statusCode":"","headers":{},"x":1390,"y":280,"wires":[]},{"id":"8633764b.e07ed8","type":"switch","z":"a479104f.4f835","name":"","property":"statusCode","propertyType":"msg","rules":[{"t":"eq","v":"200","vt":"num"},{"t":"else"}],"checkall":"true","repair":false,"outputs":2,"x":1930,"y":240,"wires":[["e36734ae.e49fb8"],["c395d7c4.f26cd8"]]},{"id":"c395d7c4.f26cd8","type":"http response","z":"a479104f.4f835","name":"","statusCode":"","headers":{},"x":2070,"y":280,"wires":[]},{"id":"3b5dbafe.bb1566","type":"function","z":"a479104f.4f835","name":"update flows","func":"const http = global.get('https');\nconst data = JSON.stringify(msg.payload);\nconst options = {\n  hostname: 'localhost',\n  port: 1880,\n  path: '/flows',\n  method: 'POST',\n  headers: {\n    'Content-Type': 'application/json',\n    'Content-Length': data.length,\n    'Authorization': 'Bearer '+msg.accessToken\n  },\n  rejectUnauthorized: false\n};\nconst req = http.request(options);\nreq.write(data);\nreq.end();\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":2230,"y":240,"wires":[["97bfc2fd.380e3"]]},{"id":"ea368a26.130058","type":"switch","z":"a479104f.4f835","name":"","property":"statusCode","propertyType":"msg","rules":[{"t":"eq","v":"200","vt":"num"},{"t":"else"}],"checkall":"true","repair":false,"outputs":2,"x":1110,"y":340,"wires":[["423bf12a.e5f2"],["ce083e3e.f8c49"]]},{"id":"ce083e3e.f8c49","type":"http response","z":"a479104f.4f835","name":"","statusCode":"","headers":{},"x":1250,"y":380,"wires":[]},{"id":"aebd1115.58b13","type":"switch","z":"a479104f.4f835","name":"","property":"statusCode","propertyType":"msg","rules":[{"t":"eq","v":"200","vt":"num"},{"t":"else"}],"checkall":"true","repair":false,"outputs":2,"x":1790,"y":340,"wires":[["1e4a66c7.8235a9"],["253c7a8b.ed8f26"]]},{"id":"253c7a8b.ed8f26","type":"http response","z":"a479104f.4f835","name":"","statusCode":"","headers":{},"x":1930,"y":380,"wires":[]},{"id":"88ebe607.4ca4b8","type":"change","z":"a479104f.4f835","name":"status","rules":[{"t":"set","p":"payload","pt":"msg","to":"{}","tot":"json"},{"t":"set","p":"payload.text","pt":"msg","to":"\"separator: \" & separator","tot":"jsonata"},{"t":"set","p":"payload.shape","pt":"msg","to":"dot","tot":"str"},{"t":"set","p":"payload.fill","pt":"msg","to":"grey","tot":"str"}],"action":"","property":"","from":"","to":"","reg":false,"x":2790,"y":300,"wires":[[]]},{"id":"4b154e0e.f2967","type":"file","z":"e6b796c2.8cc528","name":"filewrite","filename":"","appendNewline":true,"createDir":true,"overwriteFile":"false","encoding":"none","x":160,"y":240,"wires":[["575450d6.af156"]]},{"id":"575450d6.af156","type":"change","z":"e6b796c2.8cc528","name":"status","rules":[{"t":"set","p":"v","pt":"msg","to":"payload","tot":"msg"},{"t":"set","p":"payload","pt":"msg","to":"{}","tot":"json"},{"t":"set","p":"payload.text","pt":"msg","to":"v","tot":"msg"},{"t":"set","p":"payload.shape","pt":"msg","to":"dot","tot":"str"},{"t":"set","p":"payload.fill","pt":"msg","to":"green","tot":"str"}],"action":"","property":"","from":"","to":"","reg":false,"x":310,"y":300,"wires":[[]]},{"id":"3422e4cb.1066dc","type":"http in","z":"e6b796c2.8cc528","name":"PUT filename","url":"/filewrite/filename","method":"put","upload":false,"swaggerDoc":"","x":290,"y":40,"wires":[["b2ab658a.3d7bc8"]]},{"id":"21e49a2b.489646","type":"change","z":"e6b796c2.8cc528","name":"","rules":[{"t":"set","p":"payload","pt":"msg","to":"filename","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":2620,"y":40,"wires":[["7620bf92.cd293"]]},{"id":"14a29c03.b52d74","type":"http in","z":"e6b796c2.8cc528","name":"GET filename","url":"/filewrite/filename","method":"get","upload":false,"swaggerDoc":"","x":90,"y":140,"wires":[["5e83ff76.59236"]]},{"id":"dfd579d5.46f538","type":"http response","z":"e6b796c2.8cc528","name":"","statusCode":"","headers":{},"x":2310,"y":140,"wires":[]},{"id":"a98634c6.39e2f8","type":"change","z":"e6b796c2.8cc528","name":"","rules":[{"t":"set","p":"headers","pt":"msg","to":"{\"Content-Type\":\"text/plain\"}","tot":"json"}],"action":"","property":"","from":"","to":"","reg":false,"x":2140,"y":140,"wires":[["dfd579d5.46f538"]]},{"id":"b2ab658a.3d7bc8","type":"change","z":"e6b796c2.8cc528","name":"get inputs","rules":[{"t":"set","p":"filename","pt":"msg","to":"payload","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":460,"y":40,"wires":[["1ccd8c6c.c1dc14"]]},{"id":"782f2ac6.8cbd34","type":"http request","z":"e6b796c2.8cc528","name":"get flows","method":"GET","ret":"obj","paytoqs":"ignore","url":"https://localhost:1880/flows","tls":"b1a419c1.609c29","persist":false,"proxy":"","authType":"","x":1980,"y":40,"wires":[["30587c35.987be4"]]},{"id":"c72e6e1b.8d59a","type":"http response","z":"e6b796c2.8cc528","name":"","statusCode":"","headers":{},"x":2990,"y":40,"wires":[]},{"id":"7620bf92.cd293","type":"change","z":"e6b796c2.8cc528","name":"","rules":[{"t":"set","p":"headers","pt":"msg","to":"{\"Content-Type\":\"text/plain\"}","tot":"json"}],"action":"","property":"","from":"","to":"","reg":false,"x":2820,"y":40,"wires":[["c72e6e1b.8d59a","c6370c35.f3ea"]]},{"id":"c1de3ae1.df89a8","type":"http request","z":"e6b796c2.8cc528","name":"get flows","method":"GET","ret":"obj","paytoqs":"ignore","url":"https://localhost:1880/flows","tls":"b1a419c1.609c29","persist":false,"proxy":"","authType":"","x":1620,"y":140,"wires":[["f8390cfa.71564"]]},{"id":"5ed1e1d2.ffacf","type":"http request","z":"e6b796c2.8cc528","name":"auth","method":"POST","ret":"obj","paytoqs":"ignore","url":"https://localhost:1880/auth/token","tls":"b1a419c1.609c29","persist":false,"proxy":"","authType":"","x":1310,"y":40,"wires":[["2fb3719.49f098e"]]},{"id":"eda38ce5.6a8cf","type":"change","z":"e6b796c2.8cc528","name":"auth payload","rules":[{"t":"set","p":"payload","pt":"msg","to":"{}","tot":"json"},{"t":"set","p":"payload.client_id","pt":"msg","to":"node-red-editor","tot":"str"},{"t":"set","p":"payload.grant_type","pt":"msg","to":"password","tot":"str"},{"t":"set","p":"payload.scope","pt":"msg","to":"","tot":"str"},{"t":"set","p":"payload.username","pt":"msg","to":"NRADM_USER","tot":"env"},{"t":"set","p":"payload.password","pt":"msg","to":"NRADM_PASS","tot":"env"}],"action":"","property":"","from":"","to":"","reg":false,"x":1150,"y":40,"wires":[["5ed1e1d2.ffacf"]]},{"id":"1d3dcf5d.82ba01","type":"change","z":"e6b796c2.8cc528","name":"","rules":[{"t":"set","p":"accessToken","pt":"msg","to":"payload.access_token","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":1640,"y":40,"wires":[["18adddd1.4f1e62"]]},{"id":"18adddd1.4f1e62","type":"change","z":"e6b796c2.8cc528","name":"bearer","rules":[{"t":"set","p":"headers","pt":"msg","to":"{}","tot":"json"},{"t":"set","p":"headers.authorization","pt":"msg","to":"\"Bearer \" & msg.accessToken","tot":"jsonata"}],"action":"","property":"","from":"","to":"","reg":false,"x":1830,"y":40,"wires":[["782f2ac6.8cbd34"]]},{"id":"469aa686.ced2d8","type":"http request","z":"e6b796c2.8cc528","name":"auth","method":"POST","ret":"obj","paytoqs":"ignore","url":"https://localhost:1880/auth/token","tls":"b1a419c1.609c29","persist":false,"proxy":"","authType":"","x":950,"y":140,"wires":[["444d3002.00587"]]},{"id":"e5338776.2472c8","type":"change","z":"e6b796c2.8cc528","name":"auth payload","rules":[{"t":"set","p":"payload.client_id","pt":"msg","to":"node-red-editor","tot":"str"},{"t":"set","p":"payload.grant_type","pt":"msg","to":"password","tot":"str"},{"t":"set","p":"payload.scope","pt":"msg","to":"","tot":"str"},{"t":"set","p":"payload.username","pt":"msg","to":"NRADM_USER","tot":"env"},{"t":"set","p":"payload.password","pt":"msg","to":"NRADM_PASS","tot":"env"}],"action":"","property":"","from":"","to":"","reg":false,"x":790,"y":140,"wires":[["469aa686.ced2d8"]]},{"id":"9065a268.093f5","type":"change","z":"e6b796c2.8cc528","name":"","rules":[{"t":"set","p":"accessToken","pt":"msg","to":"payload.access_token","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":1280,"y":140,"wires":[["e4bb4d23.f5ea2"]]},{"id":"e4bb4d23.f5ea2","type":"change","z":"e6b796c2.8cc528","name":"bearer","rules":[{"t":"set","p":"headers","pt":"msg","to":"{}","tot":"json"},{"t":"set","p":"headers.authorization","pt":"msg","to":"\"Bearer \" & msg.accessToken","tot":"jsonata"}],"action":"","property":"","from":"","to":"","reg":false,"x":1470,"y":140,"wires":[["c1de3ae1.df89a8"]]},{"id":"c9d78f1.7abe47","type":"http request","z":"e6b796c2.8cc528","name":"","method":"POST","ret":"obj","paytoqs":"ignore","url":"${CFG_ACL_ENDP}","tls":"51b09598.a1114d","persist":false,"proxy":"","authType":"","x":830,"y":40,"wires":[["42252154.c49c"]]},{"id":"42252154.c49c","type":"switch","z":"e6b796c2.8cc528","name":"","property":"statusCode","propertyType":"msg","rules":[{"t":"eq","v":"200","vt":"num"},{"t":"else"}],"checkall":"true","repair":false,"outputs":2,"x":990,"y":40,"wires":[["eda38ce5.6a8cf"],["2dbb6d35.3fd7d2"]]},{"id":"93f96dba.ee2d3","type":"http request","z":"e6b796c2.8cc528","name":"","method":"POST","ret":"obj","paytoqs":"ignore","url":"${CFG_ACL_ENDP}","tls":"51b09598.a1114d","persist":false,"proxy":"","authType":"","x":470,"y":140,"wires":[["77a1334d.828d9c"]]},{"id":"77a1334d.828d9c","type":"switch","z":"e6b796c2.8cc528","name":"","property":"statusCode","propertyType":"msg","rules":[{"t":"eq","v":"200","vt":"num"},{"t":"else"}],"checkall":"true","repair":false,"outputs":2,"x":630,"y":140,"wires":[["e5338776.2472c8"],["e6936b49.d3df78"]]},{"id":"5e83ff76.59236","type":"change","z":"e6b796c2.8cc528","name":"acl req payload","rules":[{"t":"set","p":"headers","pt":"msg","to":"{}","tot":"json"},{"t":"set","p":"payload","pt":"msg","to":"{}","tot":"json"},{"t":"set","p":"payload.url","pt":"msg","to":"req.url","tot":"msg"},{"t":"set","p":"payload.method","pt":"msg","to":"req.method","tot":"msg"},{"t":"set","p":"payload.headers","pt":"msg","to":"req.headers","tot":"msg"},{"t":"set","p":"payload.params","pt":"msg","to":"req.params","tot":"msg"},{"t":"set","p":"payload.query","pt":"msg","to":"req.query","tot":"msg"},{"t":"set","p":"payload.body","pt":"msg","to":"req.body","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":280,"y":140,"wires":[["93f96dba.ee2d3"]]},{"id":"1ccd8c6c.c1dc14","type":"change","z":"e6b796c2.8cc528","name":"acl req payload","rules":[{"t":"set","p":"headers","pt":"msg","to":"{}","tot":"json"},{"t":"set","p":"payload","pt":"msg","to":"{}","tot":"json"},{"t":"set","p":"payload.url","pt":"msg","to":"req.url","tot":"msg"},{"t":"set","p":"payload.method","pt":"msg","to":"req.method","tot":"msg"},{"t":"set","p":"payload.headers","pt":"msg","to":"req.headers","tot":"msg"},{"t":"set","p":"payload.params","pt":"msg","to":"req.params","tot":"msg"},{"t":"set","p":"payload.query","pt":"msg","to":"req.query","tot":"msg"},{"t":"set","p":"payload.body","pt":"msg","to":"req.body","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":640,"y":40,"wires":[["c9d78f1.7abe47"]]},{"id":"e6936b49.d3df78","type":"http response","z":"e6b796c2.8cc528","name":"","statusCode":"","headers":{},"x":770,"y":180,"wires":[]},{"id":"14eb97de.553038","type":"change","z":"e6b796c2.8cc528","name":"","rules":[{"t":"set","p":"payload","pt":"msg","to":"*[name = \"filewrite\" and type=\"file\"].filename","tot":"jsonata"}],"action":"","property":"","from":"","to":"","reg":false,"x":1940,"y":140,"wires":[["a98634c6.39e2f8"]]},{"id":"a36668a2.9a73a8","type":"change","z":"e6b796c2.8cc528","name":"edit","rules":[{"t":"set","p":"old","pt":"msg","to":"*[name = \"filewrite\" and type=\"file\"]","tot":"jsonata"},{"t":"set","p":"new","pt":"msg","to":"old","tot":"msg"},{"t":"set","p":"new.filename","pt":"msg","to":"filename","tot":"msg"},{"t":"set","p":"payload","pt":"msg","to":"$eval($replace($string(payload),$string(old),$string(new)))","tot":"jsonata"}],"action":"","property":"","from":"","to":"","reg":false,"x":2270,"y":40,"wires":[["7746c6e9.f73428"]]},{"id":"2dbb6d35.3fd7d2","type":"http response","z":"e6b796c2.8cc528","name":"","statusCode":"","headers":{},"x":1130,"y":80,"wires":[]},{"id":"2fb3719.49f098e","type":"switch","z":"e6b796c2.8cc528","name":"","property":"statusCode","propertyType":"msg","rules":[{"t":"eq","v":"200","vt":"num"},{"t":"else"}],"checkall":"true","repair":false,"outputs":2,"x":1450,"y":40,"wires":[["1d3dcf5d.82ba01"],["28c7340f.e62bcc"]]},{"id":"28c7340f.e62bcc","type":"http response","z":"e6b796c2.8cc528","name":"","statusCode":"","headers":{},"x":1590,"y":80,"wires":[]},{"id":"30587c35.987be4","type":"switch","z":"e6b796c2.8cc528","name":"","property":"statusCode","propertyType":"msg","rules":[{"t":"eq","v":"200","vt":"num"},{"t":"else"}],"checkall":"true","repair":false,"outputs":2,"x":2130,"y":40,"wires":[["a36668a2.9a73a8"],["33a98657.39daca"]]},{"id":"33a98657.39daca","type":"http response","z":"e6b796c2.8cc528","name":"","statusCode":"","headers":{},"x":2270,"y":80,"wires":[]},{"id":"7746c6e9.f73428","type":"function","z":"e6b796c2.8cc528","name":"update flows","func":"const http = global.get('https');\nconst data = JSON.stringify(msg.payload);\nconst options = {\n  hostname: 'localhost',\n  port: 1880,\n  path: '/flows',\n  method: 'POST',\n  headers: {\n    'Content-Type': 'application/json',\n    'Content-Length': data.length,\n    'Authorization': 'Bearer '+msg.accessToken\n  },\n  rejectUnauthorized: false\n};\nconst req = http.request(options);\nreq.write(data);\nreq.end();\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":2430,"y":40,"wires":[["21e49a2b.489646"]]},{"id":"444d3002.00587","type":"switch","z":"e6b796c2.8cc528","name":"","property":"statusCode","propertyType":"msg","rules":[{"t":"eq","v":"200","vt":"num"},{"t":"else"}],"checkall":"true","repair":false,"outputs":2,"x":1090,"y":140,"wires":[["9065a268.093f5"],["c140b9e4.d56c78"]]},{"id":"c140b9e4.d56c78","type":"http response","z":"e6b796c2.8cc528","name":"","statusCode":"","headers":{},"x":1230,"y":180,"wires":[]},{"id":"f8390cfa.71564","type":"switch","z":"e6b796c2.8cc528","name":"","property":"statusCode","propertyType":"msg","rules":[{"t":"eq","v":"200","vt":"num"},{"t":"else"}],"checkall":"true","repair":false,"outputs":2,"x":1770,"y":140,"wires":[["14eb97de.553038"],["24d37e3c.30dbc2"]]},{"id":"24d37e3c.30dbc2","type":"http response","z":"e6b796c2.8cc528","name":"","statusCode":"","headers":{},"x":1910,"y":180,"wires":[]},{"id":"c6370c35.f3ea","type":"change","z":"e6b796c2.8cc528","name":"status","rules":[{"t":"set","p":"payload","pt":"msg","to":"{}","tot":"json"},{"t":"set","p":"payload.text","pt":"msg","to":"\"filename: \" & filename","tot":"jsonata"},{"t":"set","p":"payload.shape","pt":"msg","to":"dot","tot":"str"},{"t":"set","p":"payload.fill","pt":"msg","to":"grey","tot":"str"}],"action":"","property":"","from":"","to":"","reg":false,"x":2990,"y":100,"wires":[[]]},{"id":"a315898.5e00678","type":"comment","z":"e6b796c2.8cc528","name":"/usr/src/node-red/...","info":"/usr/src/node-red/...","x":110,"y":40,"wires":[]},{"id":"82127e79.30c95","type":"comment","z":"a479104f.4f835","name":"/usr/src/node-red/...","info":"/usr/src/node-red/...","x":110,"y":40,"wires":[]},{"id":"1383139f.dc87ec","type":"OpcUa-Item","z":"b93102f9.c90a7","item":"ns=0;i=0","datatype":"Int8","value":"","name":"opcuai","x":290,"y":260,"wires":[["c06036f1.e22af8"]]},{"id":"fe160907.8a27a8","type":"function","z":"b93102f9.c90a7","name":"parse","func":"try { \n    if( \"object\" === typeof JSON.parse(msg.payload) ) {\n        msg = JSON.parse(msg.payload); \n    }\n} \ncatch(e) {} \nfinally { return msg; }","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":150,"y":260,"wires":[["1383139f.dc87ec"]]},{"id":"29445897.c11438","type":"http in","z":"b93102f9.c90a7","name":"PUT property","url":"/opcuai/:property","method":"put","upload":false,"swaggerDoc":"","x":90,"y":40,"wires":[["436ef665.129018"]]},{"id":"a8028e65.892fd","type":"change","z":"b93102f9.c90a7","name":"","rules":[{"t":"set","p":"payload","pt":"msg","to":"value","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":2720,"y":40,"wires":[["7a7d10f5.23904"]]},{"id":"b5f56c69.b1feb","type":"http in","z":"b93102f9.c90a7","name":"GET property","url":"/opcuai/:property","method":"get","upload":false,"swaggerDoc":"","x":90,"y":140,"wires":[["3c32154c.49b0da"]]},{"id":"7d5414c1.ca9c1c","type":"http response","z":"b93102f9.c90a7","name":"","statusCode":"","headers":{},"x":2430,"y":140,"wires":[]},{"id":"c10258a.5662aa8","type":"change","z":"b93102f9.c90a7","name":"","rules":[{"t":"set","p":"headers","pt":"msg","to":"{\"Content-Type\":\"text/plain\"}","tot":"json"}],"action":"","property":"","from":"","to":"","reg":false,"x":2260,"y":140,"wires":[["7d5414c1.ca9c1c"]]},{"id":"436ef665.129018","type":"change","z":"b93102f9.c90a7","name":"get inputs","rules":[{"t":"set","p":"value","pt":"msg","to":"payload","tot":"msg"},{"t":"set","p":"property","pt":"msg","to":"req.params.property","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":240,"y":40,"wires":[["490a7d59.5396e4"]]},{"id":"2b467cc9.45ca94","type":"http request","z":"b93102f9.c90a7","name":"get flows","method":"GET","ret":"obj","paytoqs":"ignore","url":"https://localhost:1880/flows","tls":"b1a419c1.609c29","persist":false,"proxy":"","authType":"","x":1760,"y":40,"wires":[["36d07add.0e6556"]]},{"id":"2b746a87.8e33f6","type":"http response","z":"b93102f9.c90a7","name":"","statusCode":"","headers":{},"x":3090,"y":40,"wires":[]},{"id":"7a7d10f5.23904","type":"change","z":"b93102f9.c90a7","name":"","rules":[{"t":"set","p":"headers","pt":"msg","to":"{\"Content-Type\":\"text/plain\"}","tot":"json"}],"action":"","property":"","from":"","to":"","reg":false,"x":2920,"y":40,"wires":[["2b746a87.8e33f6","d4b81ab7.dcf228"]]},{"id":"66b35870.0d61a8","type":"http request","z":"b93102f9.c90a7","name":"get flows","method":"GET","ret":"obj","paytoqs":"ignore","url":"https://localhost:1880/flows","tls":"b1a419c1.609c29","persist":false,"proxy":"","authType":"","x":1600,"y":140,"wires":[["cf784489.cb97d8"]]},{"id":"534ed89f.adee18","type":"http request","z":"b93102f9.c90a7","name":"auth","method":"POST","ret":"obj","paytoqs":"ignore","url":"https://localhost:1880/auth/token","tls":"b1a419c1.609c29","persist":false,"proxy":"","authType":"","x":1090,"y":40,"wires":[["26b42ae6.796f06"]]},{"id":"82ca936e.eb485","type":"change","z":"b93102f9.c90a7","name":"auth payload","rules":[{"t":"set","p":"payload","pt":"msg","to":"{}","tot":"json"},{"t":"set","p":"payload.client_id","pt":"msg","to":"node-red-editor","tot":"str"},{"t":"set","p":"payload.grant_type","pt":"msg","to":"password","tot":"str"},{"t":"set","p":"payload.scope","pt":"msg","to":"","tot":"str"},{"t":"set","p":"payload.username","pt":"msg","to":"NRADM_USER","tot":"env"},{"t":"set","p":"payload.password","pt":"msg","to":"NRADM_PASS","tot":"env"}],"action":"","property":"","from":"","to":"","reg":false,"x":930,"y":40,"wires":[["534ed89f.adee18"]]},{"id":"90342283.cfcf","type":"change","z":"b93102f9.c90a7","name":"","rules":[{"t":"set","p":"accessToken","pt":"msg","to":"payload.access_token","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":1420,"y":40,"wires":[["d85b9995.71e6a8"]]},{"id":"d85b9995.71e6a8","type":"change","z":"b93102f9.c90a7","name":"bearer","rules":[{"t":"set","p":"headers","pt":"msg","to":"{}","tot":"json"},{"t":"set","p":"headers.authorization","pt":"msg","to":"\"Bearer \" & msg.accessToken","tot":"jsonata"}],"action":"","property":"","from":"","to":"","reg":false,"x":1610,"y":40,"wires":[["2b467cc9.45ca94"]]},{"id":"fd7b896a.2ab168","type":"http request","z":"b93102f9.c90a7","name":"auth","method":"POST","ret":"obj","paytoqs":"ignore","url":"https://localhost:1880/auth/token","tls":"b1a419c1.609c29","persist":false,"proxy":"","authType":"","x":930,"y":140,"wires":[["5a86efa7.1cda"]]},{"id":"334fd02d.ac552","type":"change","z":"b93102f9.c90a7","name":"auth payload","rules":[{"t":"set","p":"payload.client_id","pt":"msg","to":"node-red-editor","tot":"str"},{"t":"set","p":"payload.grant_type","pt":"msg","to":"password","tot":"str"},{"t":"set","p":"payload.scope","pt":"msg","to":"","tot":"str"},{"t":"set","p":"payload.username","pt":"msg","to":"NRADM_USER","tot":"env"},{"t":"set","p":"payload.password","pt":"msg","to":"NRADM_PASS","tot":"env"}],"action":"","property":"","from":"","to":"","reg":false,"x":770,"y":140,"wires":[["fd7b896a.2ab168"]]},{"id":"e312545a.69c1b8","type":"change","z":"b93102f9.c90a7","name":"","rules":[{"t":"set","p":"accessToken","pt":"msg","to":"payload.access_token","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":1260,"y":140,"wires":[["710871c4.bff2e"]]},{"id":"710871c4.bff2e","type":"change","z":"b93102f9.c90a7","name":"bearer","rules":[{"t":"set","p":"headers","pt":"msg","to":"{}","tot":"json"},{"t":"set","p":"headers.authorization","pt":"msg","to":"\"Bearer \" & msg.accessToken","tot":"jsonata"}],"action":"","property":"","from":"","to":"","reg":false,"x":1450,"y":140,"wires":[["66b35870.0d61a8"]]},{"id":"a7e44d74.b028d","type":"http request","z":"b93102f9.c90a7","name":"","method":"POST","ret":"obj","paytoqs":"ignore","url":"${CFG_ACL_ENDP}","tls":"51b09598.a1114d","persist":false,"proxy":"","authType":"","x":610,"y":40,"wires":[["9d6e1e97.6724d"]]},{"id":"9d6e1e97.6724d","type":"switch","z":"b93102f9.c90a7","name":"","property":"statusCode","propertyType":"msg","rules":[{"t":"eq","v":"200","vt":"num"},{"t":"else"}],"checkall":"true","repair":false,"outputs":2,"x":770,"y":40,"wires":[["82ca936e.eb485"],["63440f.57f7bbf"]]},{"id":"4086e2f4.d8d1fc","type":"http request","z":"b93102f9.c90a7","name":"","method":"POST","ret":"obj","paytoqs":"ignore","url":"${CFG_ACL_ENDP}","tls":"51b09598.a1114d","persist":false,"proxy":"","authType":"","x":450,"y":140,"wires":[["d9764a09.643ac8"]]},{"id":"d9764a09.643ac8","type":"switch","z":"b93102f9.c90a7","name":"","property":"statusCode","propertyType":"msg","rules":[{"t":"eq","v":"200","vt":"num"},{"t":"else"}],"checkall":"true","repair":false,"outputs":2,"x":610,"y":140,"wires":[["334fd02d.ac552"],["a7829ba5.ce0fd8"]]},{"id":"3c32154c.49b0da","type":"change","z":"b93102f9.c90a7","name":"acl req payload","rules":[{"t":"set","p":"headers","pt":"msg","to":"{}","tot":"json"},{"t":"set","p":"payload","pt":"msg","to":"{}","tot":"json"},{"t":"set","p":"payload.url","pt":"msg","to":"req.url","tot":"msg"},{"t":"set","p":"payload.method","pt":"msg","to":"req.method","tot":"msg"},{"t":"set","p":"payload.headers","pt":"msg","to":"req.headers","tot":"msg"},{"t":"set","p":"payload.params","pt":"msg","to":"req.params","tot":"msg"},{"t":"set","p":"payload.query","pt":"msg","to":"req.query","tot":"msg"},{"t":"set","p":"payload.body","pt":"msg","to":"req.body","tot":"msg"},{"t":"set","p":"property","pt":"msg","to":"req.params.property","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":260,"y":140,"wires":[["4086e2f4.d8d1fc"]]},{"id":"490a7d59.5396e4","type":"change","z":"b93102f9.c90a7","name":"acl req payload","rules":[{"t":"set","p":"headers","pt":"msg","to":"{}","tot":"json"},{"t":"set","p":"payload","pt":"msg","to":"{}","tot":"json"},{"t":"set","p":"payload.url","pt":"msg","to":"req.url","tot":"msg"},{"t":"set","p":"payload.method","pt":"msg","to":"req.method","tot":"msg"},{"t":"set","p":"payload.headers","pt":"msg","to":"req.headers","tot":"msg"},{"t":"set","p":"payload.params","pt":"msg","to":"req.params","tot":"msg"},{"t":"set","p":"payload.query","pt":"msg","to":"req.query","tot":"msg"},{"t":"set","p":"payload.body","pt":"msg","to":"req.body","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":420,"y":40,"wires":[["a7e44d74.b028d"]]},{"id":"a7829ba5.ce0fd8","type":"http response","z":"b93102f9.c90a7","name":"","statusCode":"","headers":{},"x":750,"y":180,"wires":[]},{"id":"53483f7c.2e159","type":"change","z":"b93102f9.c90a7","name":"","rules":[{"t":"set","p":"payload","pt":"msg","to":"*[name = \"opcuai\" and type=\"OpcUa-Item\"]","tot":"jsonata"}],"action":"","property":"","from":"","to":"","reg":false,"x":1920,"y":140,"wires":[["f6434c94.9eec7"]]},{"id":"54075542.47107c","type":"change","z":"b93102f9.c90a7","name":"pre edit","rules":[{"t":"set","p":"old","pt":"msg","to":"*[name = \"opcuai\" and type=\"OpcUa-Item\"]","tot":"jsonata"},{"t":"set","p":"new","pt":"msg","to":"old","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":2060,"y":40,"wires":[["88654fd5.efdb3"]]},{"id":"63440f.57f7bbf","type":"http response","z":"b93102f9.c90a7","name":"","statusCode":"","headers":{},"x":910,"y":80,"wires":[]},{"id":"26b42ae6.796f06","type":"switch","z":"b93102f9.c90a7","name":"","property":"statusCode","propertyType":"msg","rules":[{"t":"eq","v":"200","vt":"num"},{"t":"else"}],"checkall":"true","repair":false,"outputs":2,"x":1230,"y":40,"wires":[["90342283.cfcf"],["7e46e6b1.a4ef88"]]},{"id":"7e46e6b1.a4ef88","type":"http response","z":"b93102f9.c90a7","name":"","statusCode":"","headers":{},"x":1370,"y":80,"wires":[]},{"id":"36d07add.0e6556","type":"switch","z":"b93102f9.c90a7","name":"","property":"statusCode","propertyType":"msg","rules":[{"t":"eq","v":"200","vt":"num"},{"t":"else"}],"checkall":"true","repair":false,"outputs":2,"x":1910,"y":40,"wires":[["54075542.47107c"],["6a237c46.016554"]]},{"id":"6a237c46.016554","type":"http response","z":"b93102f9.c90a7","name":"","statusCode":"","headers":{},"x":2050,"y":80,"wires":[]},{"id":"e39e677e.f70098","type":"function","z":"b93102f9.c90a7","name":"update flows","func":"const http = global.get('https');\nconst data = JSON.stringify(msg.payload);\nconst options = {\n  hostname: 'localhost',\n  port: 1880,\n  path: '/flows',\n  method: 'POST',\n  headers: {\n    'Content-Type': 'application/json',\n    'Content-Length': data.length,\n    'Authorization': 'Bearer '+msg.accessToken\n  },\n  rejectUnauthorized: false\n};\nconst req = http.request(options);\nreq.write(data);\nreq.end();\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":2530,"y":40,"wires":[["a8028e65.892fd"]]},{"id":"5a86efa7.1cda","type":"switch","z":"b93102f9.c90a7","name":"","property":"statusCode","propertyType":"msg","rules":[{"t":"eq","v":"200","vt":"num"},{"t":"else"}],"checkall":"true","repair":false,"outputs":2,"x":1070,"y":140,"wires":[["e312545a.69c1b8"],["d13366d0.8631b8"]]},{"id":"d13366d0.8631b8","type":"http response","z":"b93102f9.c90a7","name":"","statusCode":"","headers":{},"x":1210,"y":180,"wires":[]},{"id":"cf784489.cb97d8","type":"switch","z":"b93102f9.c90a7","name":"","property":"statusCode","propertyType":"msg","rules":[{"t":"eq","v":"200","vt":"num"},{"t":"else"}],"checkall":"true","repair":false,"outputs":2,"x":1750,"y":140,"wires":[["53483f7c.2e159"],["4018ccbd.67ab14"]]},{"id":"4018ccbd.67ab14","type":"http response","z":"b93102f9.c90a7","name":"","statusCode":"","headers":{},"x":1890,"y":180,"wires":[]},{"id":"d4b81ab7.dcf228","type":"change","z":"b93102f9.c90a7","name":"status","rules":[{"t":"set","p":"payload","pt":"msg","to":"{}","tot":"json"},{"t":"set","p":"payload.text","pt":"msg","to":"property & \": \" & value","tot":"jsonata"},{"t":"set","p":"payload.shape","pt":"msg","to":"dot","tot":"str"},{"t":"set","p":"payload.fill","pt":"msg","to":"grey","tot":"str"}],"action":"","property":"","from":"","to":"","reg":false,"x":3090,"y":100,"wires":[[]]},{"id":"88654fd5.efdb3","type":"function","z":"b93102f9.c90a7","name":"edit","func":"if([\"x\",\"y\"].includes(msg.property)) msg[\"new\"][msg.property] = parseInt(msg.value);\nelse msg[\"new\"][msg.property] = msg.value;\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":2210,"y":40,"wires":[["f18e7d01.2dbac"]]},{"id":"f18e7d01.2dbac","type":"change","z":"b93102f9.c90a7","name":"post edit","rules":[{"t":"set","p":"payload","pt":"msg","to":"$eval($replace($string(payload),$string(old),$string(new)))","tot":"jsonata"}],"action":"","property":"","from":"","to":"","reg":false,"x":2360,"y":40,"wires":[["e39e677e.f70098"]]},{"id":"f6434c94.9eec7","type":"function","z":"b93102f9.c90a7","name":"get","func":"msg.payload = msg.payload[msg.property];\nif(msg.payload === true) msg.payload = \"true\";\nif(msg.payload === false) msg.payload = \"false\";\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":2090,"y":140,"wires":[["c10258a.5662aa8"]]},{"id":"4888a117.1d26d","type":"change","z":"b93102f9.c90a7","name":"status input","rules":[{"t":"set","p":"input","pt":"msg","to":"payload","tot":"msg"},{"t":"set","p":"payload","pt":"msg","to":"{}","tot":"json"},{"t":"set","p":"payload.text","pt":"msg","to":"\"input: \" & input","tot":"jsonata"},{"t":"set","p":"payload.shape","pt":"msg","to":"ring","tot":"str"},{"t":"set","p":"payload.fill","pt":"msg","to":"green","tot":"str"}],"action":"","property":"","from":"","to":"","reg":false,"x":170,"y":380,"wires":[[]]},{"id":"c06036f1.e22af8","type":"change","z":"b93102f9.c90a7","name":"status output","rules":[{"t":"set","p":"output","pt":"msg","to":"payload","tot":"msg"},{"t":"set","p":"payload","pt":"msg","to":"{}","tot":"json"},{"t":"set","p":"payload.text","pt":"msg","to":"\"output: \" & output","tot":"jsonata"},{"t":"set","p":"payload.shape","pt":"msg","to":"dot","tot":"str"},{"t":"set","p":"payload.fill","pt":"msg","to":"green","tot":"str"}],"action":"","property":"","from":"","to":"","reg":false,"x":450,"y":320,"wires":[[]]},{"id":"1d7d3b2a.ac79c5","type":"function","z":"19c7ab5e.875675","name":"parse","func":"try { \n    if( \"object\" === typeof JSON.parse(msg.payload) ) {\n        msg = JSON.parse(msg.payload); \n    }\n} \ncatch(e) {} \nfinally { return msg; }","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":150,"y":460,"wires":[["88e21160.eb7b7"]]},{"id":"48a72280.aba97c","type":"http in","z":"19c7ab5e.875675","name":"PUT property","url":"/opcuac/:property","method":"put","upload":false,"swaggerDoc":"","x":90,"y":40,"wires":[["3f5f19b2.733756"]]},{"id":"6cf52e72.f1468","type":"change","z":"19c7ab5e.875675","name":"","rules":[{"t":"set","p":"payload","pt":"msg","to":"value","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":2720,"y":40,"wires":[["9f9d2124.22e67"]]},{"id":"e970019a.5acf4","type":"http in","z":"19c7ab5e.875675","name":"GET property","url":"/opcuac/:property","method":"get","upload":false,"swaggerDoc":"","x":90,"y":140,"wires":[["5bbd61a9.02bd1"]]},{"id":"350f2b61.df7db4","type":"http response","z":"19c7ab5e.875675","name":"","statusCode":"","headers":{},"x":2430,"y":140,"wires":[]},{"id":"d2890a1e.1a1498","type":"change","z":"19c7ab5e.875675","name":"","rules":[{"t":"set","p":"headers","pt":"msg","to":"{\"Content-Type\":\"text/plain\"}","tot":"json"}],"action":"","property":"","from":"","to":"","reg":false,"x":2260,"y":140,"wires":[["350f2b61.df7db4"]]},{"id":"3f5f19b2.733756","type":"change","z":"19c7ab5e.875675","name":"get inputs","rules":[{"t":"set","p":"value","pt":"msg","to":"payload","tot":"msg"},{"t":"set","p":"property","pt":"msg","to":"req.params.property","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":240,"y":40,"wires":[["930e3023.4adf5"]]},{"id":"32b3d1bf.98b60e","type":"http request","z":"19c7ab5e.875675","name":"get flows","method":"GET","ret":"obj","paytoqs":"ignore","url":"https://localhost:1880/flows","tls":"b1a419c1.609c29","persist":false,"proxy":"","authType":"","x":1760,"y":40,"wires":[["5fe4b1ac.1f976"]]},{"id":"3ccfb663.0a216a","type":"http response","z":"19c7ab5e.875675","name":"","statusCode":"","headers":{},"x":3090,"y":40,"wires":[]},{"id":"9f9d2124.22e67","type":"change","z":"19c7ab5e.875675","name":"","rules":[{"t":"set","p":"headers","pt":"msg","to":"{\"Content-Type\":\"text/plain\"}","tot":"json"}],"action":"","property":"","from":"","to":"","reg":false,"x":2920,"y":40,"wires":[["3ccfb663.0a216a","d2e5300c.e6bf6"]]},{"id":"9a396873.3d2408","type":"http request","z":"19c7ab5e.875675","name":"get flows","method":"GET","ret":"obj","paytoqs":"ignore","url":"https://localhost:1880/flows","tls":"b1a419c1.609c29","persist":false,"proxy":"","authType":"","x":1600,"y":140,"wires":[["5474c9dc.68d158"]]},{"id":"5e5120b8.8c85","type":"http request","z":"19c7ab5e.875675","name":"auth","method":"POST","ret":"obj","paytoqs":"ignore","url":"https://localhost:1880/auth/token","tls":"b1a419c1.609c29","persist":false,"proxy":"","authType":"","x":1090,"y":40,"wires":[["fef27b9b.da1b58"]]},{"id":"bc1f32f1.3210f","type":"change","z":"19c7ab5e.875675","name":"auth payload","rules":[{"t":"set","p":"payload","pt":"msg","to":"{}","tot":"json"},{"t":"set","p":"payload.client_id","pt":"msg","to":"node-red-editor","tot":"str"},{"t":"set","p":"payload.grant_type","pt":"msg","to":"password","tot":"str"},{"t":"set","p":"payload.scope","pt":"msg","to":"","tot":"str"},{"t":"set","p":"payload.username","pt":"msg","to":"NRADM_USER","tot":"env"},{"t":"set","p":"payload.password","pt":"msg","to":"NRADM_PASS","tot":"env"}],"action":"","property":"","from":"","to":"","reg":false,"x":930,"y":40,"wires":[["5e5120b8.8c85"]]},{"id":"e8b65da.7b81ba","type":"change","z":"19c7ab5e.875675","name":"","rules":[{"t":"set","p":"accessToken","pt":"msg","to":"payload.access_token","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":1420,"y":40,"wires":[["8723e46b.e8b028"]]},{"id":"8723e46b.e8b028","type":"change","z":"19c7ab5e.875675","name":"bearer","rules":[{"t":"set","p":"headers","pt":"msg","to":"{}","tot":"json"},{"t":"set","p":"headers.authorization","pt":"msg","to":"\"Bearer \" & msg.accessToken","tot":"jsonata"}],"action":"","property":"","from":"","to":"","reg":false,"x":1610,"y":40,"wires":[["32b3d1bf.98b60e"]]},{"id":"cbc2c485.0840b8","type":"http request","z":"19c7ab5e.875675","name":"auth","method":"POST","ret":"obj","paytoqs":"ignore","url":"https://localhost:1880/auth/token","tls":"b1a419c1.609c29","persist":false,"proxy":"","authType":"","x":930,"y":140,"wires":[["9c0f4ee8.11639"]]},{"id":"f549e88.5bdbb18","type":"change","z":"19c7ab5e.875675","name":"auth payload","rules":[{"t":"set","p":"payload.client_id","pt":"msg","to":"node-red-editor","tot":"str"},{"t":"set","p":"payload.grant_type","pt":"msg","to":"password","tot":"str"},{"t":"set","p":"payload.scope","pt":"msg","to":"","tot":"str"},{"t":"set","p":"payload.username","pt":"msg","to":"NRADM_USER","tot":"env"},{"t":"set","p":"payload.password","pt":"msg","to":"NRADM_PASS","tot":"env"}],"action":"","property":"","from":"","to":"","reg":false,"x":770,"y":140,"wires":[["cbc2c485.0840b8"]]},{"id":"9301e0af.9cafe","type":"change","z":"19c7ab5e.875675","name":"","rules":[{"t":"set","p":"accessToken","pt":"msg","to":"payload.access_token","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":1260,"y":140,"wires":[["2149857b.18212a"]]},{"id":"2149857b.18212a","type":"change","z":"19c7ab5e.875675","name":"bearer","rules":[{"t":"set","p":"headers","pt":"msg","to":"{}","tot":"json"},{"t":"set","p":"headers.authorization","pt":"msg","to":"\"Bearer \" & msg.accessToken","tot":"jsonata"}],"action":"","property":"","from":"","to":"","reg":false,"x":1450,"y":140,"wires":[["9a396873.3d2408"]]},{"id":"6e201fb9.62266","type":"http request","z":"19c7ab5e.875675","name":"","method":"POST","ret":"obj","paytoqs":"ignore","url":"${CFG_ACL_ENDP}","tls":"51b09598.a1114d","persist":false,"proxy":"","authType":"","x":610,"y":40,"wires":[["bb1f73e9.327d9"]]},{"id":"bb1f73e9.327d9","type":"switch","z":"19c7ab5e.875675","name":"","property":"statusCode","propertyType":"msg","rules":[{"t":"eq","v":"200","vt":"num"},{"t":"else"}],"checkall":"true","repair":false,"outputs":2,"x":770,"y":40,"wires":[["bc1f32f1.3210f"],["41483a03.cd4f34"]]},{"id":"564ffd07.8ba7c4","type":"http request","z":"19c7ab5e.875675","name":"","method":"POST","ret":"obj","paytoqs":"ignore","url":"${CFG_ACL_ENDP}","tls":"51b09598.a1114d","persist":false,"proxy":"","authType":"","x":450,"y":140,"wires":[["d9dde669.405e88"]]},{"id":"d9dde669.405e88","type":"switch","z":"19c7ab5e.875675","name":"","property":"statusCode","propertyType":"msg","rules":[{"t":"eq","v":"200","vt":"num"},{"t":"else"}],"checkall":"true","repair":false,"outputs":2,"x":610,"y":140,"wires":[["f549e88.5bdbb18"],["34db05f9.9b850a"]]},{"id":"5bbd61a9.02bd1","type":"change","z":"19c7ab5e.875675","name":"acl req payload","rules":[{"t":"set","p":"headers","pt":"msg","to":"{}","tot":"json"},{"t":"set","p":"payload","pt":"msg","to":"{}","tot":"json"},{"t":"set","p":"payload.url","pt":"msg","to":"req.url","tot":"msg"},{"t":"set","p":"payload.method","pt":"msg","to":"req.method","tot":"msg"},{"t":"set","p":"payload.headers","pt":"msg","to":"req.headers","tot":"msg"},{"t":"set","p":"payload.params","pt":"msg","to":"req.params","tot":"msg"},{"t":"set","p":"payload.query","pt":"msg","to":"req.query","tot":"msg"},{"t":"set","p":"payload.body","pt":"msg","to":"req.body","tot":"msg"},{"t":"set","p":"property","pt":"msg","to":"req.params.property","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":260,"y":140,"wires":[["564ffd07.8ba7c4"]]},{"id":"930e3023.4adf5","type":"change","z":"19c7ab5e.875675","name":"acl req payload","rules":[{"t":"set","p":"headers","pt":"msg","to":"{}","tot":"json"},{"t":"set","p":"payload","pt":"msg","to":"{}","tot":"json"},{"t":"set","p":"payload.url","pt":"msg","to":"req.url","tot":"msg"},{"t":"set","p":"payload.method","pt":"msg","to":"req.method","tot":"msg"},{"t":"set","p":"payload.headers","pt":"msg","to":"req.headers","tot":"msg"},{"t":"set","p":"payload.params","pt":"msg","to":"req.params","tot":"msg"},{"t":"set","p":"payload.query","pt":"msg","to":"req.query","tot":"msg"},{"t":"set","p":"payload.body","pt":"msg","to":"req.body","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":420,"y":40,"wires":[["6e201fb9.62266"]]},{"id":"34db05f9.9b850a","type":"http response","z":"19c7ab5e.875675","name":"","statusCode":"","headers":{},"x":750,"y":180,"wires":[]},{"id":"32998f2b.67389","type":"change","z":"19c7ab5e.875675","name":"","rules":[{"t":"set","p":"payload","pt":"msg","to":"*[name = \"opcuac\" and type=\"OpcUa-Client\"]","tot":"jsonata"}],"action":"","property":"","from":"","to":"","reg":false,"x":1920,"y":140,"wires":[["7daaabb4.9d8094"]]},{"id":"7256dee8.b6574","type":"change","z":"19c7ab5e.875675","name":"pre edit","rules":[{"t":"set","p":"old","pt":"msg","to":"*[name = \"opcuac\" and type=\"OpcUa-Client\"]","tot":"jsonata"},{"t":"set","p":"new","pt":"msg","to":"old","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":2060,"y":40,"wires":[["cb8f1733.8310d8"]]},{"id":"41483a03.cd4f34","type":"http response","z":"19c7ab5e.875675","name":"","statusCode":"","headers":{},"x":910,"y":80,"wires":[]},{"id":"fef27b9b.da1b58","type":"switch","z":"19c7ab5e.875675","name":"","property":"statusCode","propertyType":"msg","rules":[{"t":"eq","v":"200","vt":"num"},{"t":"else"}],"checkall":"true","repair":false,"outputs":2,"x":1230,"y":40,"wires":[["e8b65da.7b81ba"],["e61bf509.d7dfe8"]]},{"id":"e61bf509.d7dfe8","type":"http response","z":"19c7ab5e.875675","name":"","statusCode":"","headers":{},"x":1370,"y":80,"wires":[]},{"id":"5fe4b1ac.1f976","type":"switch","z":"19c7ab5e.875675","name":"","property":"statusCode","propertyType":"msg","rules":[{"t":"eq","v":"200","vt":"num"},{"t":"else"}],"checkall":"true","repair":false,"outputs":2,"x":1910,"y":40,"wires":[["7256dee8.b6574"],["2c671f2c.03a7a"]]},{"id":"2c671f2c.03a7a","type":"http response","z":"19c7ab5e.875675","name":"","statusCode":"","headers":{},"x":2050,"y":80,"wires":[]},{"id":"c3be9f60.b651b","type":"function","z":"19c7ab5e.875675","name":"update flows","func":"const http = global.get('https');\nconst data = JSON.stringify(msg.payload);\nconst options = {\n  hostname: 'localhost',\n  port: 1880,\n  path: '/flows',\n  method: 'POST',\n  headers: {\n    'Content-Type': 'application/json',\n    'Content-Length': data.length,\n    'Authorization': 'Bearer '+msg.accessToken\n  },\n  rejectUnauthorized: false\n};\nconst req = http.request(options);\nreq.write(data);\nreq.end();\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":2530,"y":40,"wires":[["6cf52e72.f1468"]]},{"id":"9c0f4ee8.11639","type":"switch","z":"19c7ab5e.875675","name":"","property":"statusCode","propertyType":"msg","rules":[{"t":"eq","v":"200","vt":"num"},{"t":"else"}],"checkall":"true","repair":false,"outputs":2,"x":1070,"y":140,"wires":[["9301e0af.9cafe"],["25a578f5.036798"]]},{"id":"25a578f5.036798","type":"http response","z":"19c7ab5e.875675","name":"","statusCode":"","headers":{},"x":1210,"y":180,"wires":[]},{"id":"5474c9dc.68d158","type":"switch","z":"19c7ab5e.875675","name":"","property":"statusCode","propertyType":"msg","rules":[{"t":"eq","v":"200","vt":"num"},{"t":"else"}],"checkall":"true","repair":false,"outputs":2,"x":1750,"y":140,"wires":[["32998f2b.67389"],["80cd41e2.b8c32"]]},{"id":"80cd41e2.b8c32","type":"http response","z":"19c7ab5e.875675","name":"","statusCode":"","headers":{},"x":1890,"y":180,"wires":[]},{"id":"d2e5300c.e6bf6","type":"change","z":"19c7ab5e.875675","name":"status","rules":[{"t":"set","p":"payload","pt":"msg","to":"{}","tot":"json"},{"t":"set","p":"payload.text","pt":"msg","to":"property & \": \" & value","tot":"jsonata"},{"t":"set","p":"payload.shape","pt":"msg","to":"dot","tot":"str"},{"t":"set","p":"payload.fill","pt":"msg","to":"grey","tot":"str"}],"action":"","property":"","from":"","to":"","reg":false,"x":3090,"y":100,"wires":[[]]},{"id":"cb8f1733.8310d8","type":"function","z":"19c7ab5e.875675","name":"edit","func":"if([\"deadbandvalue\",\"time\",\"x\",\"y\"].includes(msg.property)) msg[\"new\"][msg.property] = parseInt(msg.value);\nelse msg[\"new\"][msg.property] = msg.value;\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":2210,"y":40,"wires":[["6c287aeb.187a24"]]},{"id":"6c287aeb.187a24","type":"change","z":"19c7ab5e.875675","name":"post edit","rules":[{"t":"set","p":"payload","pt":"msg","to":"$eval($replace($string(payload),$string(old),$string(new)))","tot":"jsonata"}],"action":"","property":"","from":"","to":"","reg":false,"x":2360,"y":40,"wires":[["c3be9f60.b651b"]]},{"id":"7daaabb4.9d8094","type":"function","z":"19c7ab5e.875675","name":"get","func":"msg.payload = msg.payload[msg.property];\nif(msg.payload === true) msg.payload = \"true\";\nif(msg.payload === false) msg.payload = \"false\";\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":2090,"y":140,"wires":[["d2890a1e.1a1498"]]},{"id":"2532828.a19017e","type":"change","z":"19c7ab5e.875675","name":"status input","rules":[{"t":"set","p":"input","pt":"msg","to":"payload","tot":"msg"},{"t":"set","p":"payload","pt":"msg","to":"{}","tot":"json"},{"t":"set","p":"payload.text","pt":"msg","to":"\"input: \" & input","tot":"jsonata"},{"t":"set","p":"payload.shape","pt":"msg","to":"ring","tot":"str"},{"t":"set","p":"payload.fill","pt":"msg","to":"green","tot":"str"}],"action":"","property":"","from":"","to":"","reg":false,"x":170,"y":580,"wires":[[]]},{"id":"35032696.c032ca","type":"change","z":"19c7ab5e.875675","name":"status output","rules":[{"t":"set","p":"output","pt":"msg","to":"payload","tot":"msg"},{"t":"set","p":"payload","pt":"msg","to":"{}","tot":"json"},{"t":"set","p":"payload.text","pt":"msg","to":"\"output: \" & output","tot":"jsonata"},{"t":"set","p":"payload.shape","pt":"msg","to":"dot","tot":"str"},{"t":"set","p":"payload.fill","pt":"msg","to":"green","tot":"str"}],"action":"","property":"","from":"","to":"","reg":false,"x":470,"y":520,"wires":[[]]},{"id":"ff688530.271608","type":"http in","z":"19c7ab5e.875675","name":"PUT endpoint property","url":"/opcuac/endpoint/:property","method":"put","upload":false,"swaggerDoc":"","x":120,"y":240,"wires":[["7814e9eb.53f188"]]},{"id":"42663c86.adf884","type":"change","z":"19c7ab5e.875675","name":"","rules":[{"t":"set","p":"payload","pt":"msg","to":"value","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":2800,"y":240,"wires":[["dfd463cc.e55be"]]},{"id":"b794b815.7d29a8","type":"http in","z":"19c7ab5e.875675","name":"GET endpoint property","url":"/opcuac/endpoint/:property","method":"get","upload":false,"swaggerDoc":"","x":120,"y":340,"wires":[["8fbf4b0f.3b6ec8"]]},{"id":"f62d0807.c9bf78","type":"http response","z":"19c7ab5e.875675","name":"","statusCode":"","headers":{},"x":2510,"y":340,"wires":[]},{"id":"7b5fa476.51095c","type":"change","z":"19c7ab5e.875675","name":"","rules":[{"t":"set","p":"headers","pt":"msg","to":"{\"Content-Type\":\"text/plain\"}","tot":"json"}],"action":"","property":"","from":"","to":"","reg":false,"x":2340,"y":340,"wires":[["f62d0807.c9bf78"]]},{"id":"7814e9eb.53f188","type":"change","z":"19c7ab5e.875675","name":"get inputs","rules":[{"t":"set","p":"value","pt":"msg","to":"payload","tot":"msg"},{"t":"set","p":"property","pt":"msg","to":"req.params.property","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":320,"y":240,"wires":[["7bebe8e7.524d98"]]},{"id":"c7526f88.6af4e","type":"http request","z":"19c7ab5e.875675","name":"get flows","method":"GET","ret":"obj","paytoqs":"ignore","url":"https://localhost:1880/flows","tls":"b1a419c1.609c29","persist":false,"proxy":"","authType":"","x":1840,"y":240,"wires":[["2a1da217.d8470e"]]},{"id":"fee48883.45be58","type":"http response","z":"19c7ab5e.875675","name":"","statusCode":"","headers":{},"x":3170,"y":240,"wires":[]},{"id":"dfd463cc.e55be","type":"change","z":"19c7ab5e.875675","name":"","rules":[{"t":"set","p":"headers","pt":"msg","to":"{\"Content-Type\":\"text/plain\"}","tot":"json"}],"action":"","property":"","from":"","to":"","reg":false,"x":3000,"y":240,"wires":[["fee48883.45be58","f08062ac.21387"]]},{"id":"44ed86cc.760cc8","type":"http request","z":"19c7ab5e.875675","name":"get flows","method":"GET","ret":"obj","paytoqs":"ignore","url":"https://localhost:1880/flows","tls":"b1a419c1.609c29","persist":false,"proxy":"","authType":"","x":1680,"y":340,"wires":[["709fc9b4.63e788"]]},{"id":"64b5dfff.b439","type":"http request","z":"19c7ab5e.875675","name":"auth","method":"POST","ret":"obj","paytoqs":"ignore","url":"https://localhost:1880/auth/token","tls":"b1a419c1.609c29","persist":false,"proxy":"","authType":"","x":1170,"y":240,"wires":[["79c3f6df.38b8b8"]]},{"id":"451db8cb.46c5d8","type":"change","z":"19c7ab5e.875675","name":"auth payload","rules":[{"t":"set","p":"payload","pt":"msg","to":"{}","tot":"json"},{"t":"set","p":"payload.client_id","pt":"msg","to":"node-red-editor","tot":"str"},{"t":"set","p":"payload.grant_type","pt":"msg","to":"password","tot":"str"},{"t":"set","p":"payload.scope","pt":"msg","to":"","tot":"str"},{"t":"set","p":"payload.username","pt":"msg","to":"NRADM_USER","tot":"env"},{"t":"set","p":"payload.password","pt":"msg","to":"NRADM_PASS","tot":"env"}],"action":"","property":"","from":"","to":"","reg":false,"x":1010,"y":240,"wires":[["64b5dfff.b439"]]},{"id":"17d07a6d.d84ab6","type":"change","z":"19c7ab5e.875675","name":"","rules":[{"t":"set","p":"accessToken","pt":"msg","to":"payload.access_token","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":1500,"y":240,"wires":[["9260a981.c823d8"]]},{"id":"9260a981.c823d8","type":"change","z":"19c7ab5e.875675","name":"bearer","rules":[{"t":"set","p":"headers","pt":"msg","to":"{}","tot":"json"},{"t":"set","p":"headers.authorization","pt":"msg","to":"\"Bearer \" & msg.accessToken","tot":"jsonata"}],"action":"","property":"","from":"","to":"","reg":false,"x":1690,"y":240,"wires":[["c7526f88.6af4e"]]},{"id":"56400fa8.8afd5","type":"http request","z":"19c7ab5e.875675","name":"auth","method":"POST","ret":"obj","paytoqs":"ignore","url":"https://localhost:1880/auth/token","tls":"b1a419c1.609c29","persist":false,"proxy":"","authType":"","x":1010,"y":340,"wires":[["dec13ea.38937c"]]},{"id":"3f9291f8.25190e","type":"change","z":"19c7ab5e.875675","name":"auth payload","rules":[{"t":"set","p":"payload.client_id","pt":"msg","to":"node-red-editor","tot":"str"},{"t":"set","p":"payload.grant_type","pt":"msg","to":"password","tot":"str"},{"t":"set","p":"payload.scope","pt":"msg","to":"","tot":"str"},{"t":"set","p":"payload.username","pt":"msg","to":"NRADM_USER","tot":"env"},{"t":"set","p":"payload.password","pt":"msg","to":"NRADM_PASS","tot":"env"}],"action":"","property":"","from":"","to":"","reg":false,"x":850,"y":340,"wires":[["56400fa8.8afd5"]]},{"id":"5a68de68.1a80c","type":"change","z":"19c7ab5e.875675","name":"","rules":[{"t":"set","p":"accessToken","pt":"msg","to":"payload.access_token","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":1340,"y":340,"wires":[["ca78995f.3b4fa8"]]},{"id":"ca78995f.3b4fa8","type":"change","z":"19c7ab5e.875675","name":"bearer","rules":[{"t":"set","p":"headers","pt":"msg","to":"{}","tot":"json"},{"t":"set","p":"headers.authorization","pt":"msg","to":"\"Bearer \" & msg.accessToken","tot":"jsonata"}],"action":"","property":"","from":"","to":"","reg":false,"x":1530,"y":340,"wires":[["44ed86cc.760cc8"]]},{"id":"a37c0c67.348ab","type":"http request","z":"19c7ab5e.875675","name":"","method":"POST","ret":"obj","paytoqs":"ignore","url":"${CFG_ACL_ENDP}","tls":"51b09598.a1114d","persist":false,"proxy":"","authType":"","x":690,"y":240,"wires":[["acc0638b.dcc3d"]]},{"id":"acc0638b.dcc3d","type":"switch","z":"19c7ab5e.875675","name":"","property":"statusCode","propertyType":"msg","rules":[{"t":"eq","v":"200","vt":"num"},{"t":"else"}],"checkall":"true","repair":false,"outputs":2,"x":850,"y":240,"wires":[["451db8cb.46c5d8"],["7238fd4.6a2d004"]]},{"id":"8fe96301.1a2cd","type":"http request","z":"19c7ab5e.875675","name":"","method":"POST","ret":"obj","paytoqs":"ignore","url":"${CFG_ACL_ENDP}","tls":"51b09598.a1114d","persist":false,"proxy":"","authType":"","x":530,"y":340,"wires":[["8733bb48.ae2128"]]},{"id":"8733bb48.ae2128","type":"switch","z":"19c7ab5e.875675","name":"","property":"statusCode","propertyType":"msg","rules":[{"t":"eq","v":"200","vt":"num"},{"t":"else"}],"checkall":"true","repair":false,"outputs":2,"x":690,"y":340,"wires":[["3f9291f8.25190e"],["e1b8582b.f74b88"]]},{"id":"8fbf4b0f.3b6ec8","type":"change","z":"19c7ab5e.875675","name":"acl req payload","rules":[{"t":"set","p":"headers","pt":"msg","to":"{}","tot":"json"},{"t":"set","p":"payload","pt":"msg","to":"{}","tot":"json"},{"t":"set","p":"payload.url","pt":"msg","to":"req.url","tot":"msg"},{"t":"set","p":"payload.method","pt":"msg","to":"req.method","tot":"msg"},{"t":"set","p":"payload.headers","pt":"msg","to":"req.headers","tot":"msg"},{"t":"set","p":"payload.params","pt":"msg","to":"req.params","tot":"msg"},{"t":"set","p":"payload.query","pt":"msg","to":"req.query","tot":"msg"},{"t":"set","p":"payload.body","pt":"msg","to":"req.body","tot":"msg"},{"t":"set","p":"property","pt":"msg","to":"req.params.property","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":340,"y":340,"wires":[["8fe96301.1a2cd"]]},{"id":"7bebe8e7.524d98","type":"change","z":"19c7ab5e.875675","name":"acl req payload","rules":[{"t":"set","p":"headers","pt":"msg","to":"{}","tot":"json"},{"t":"set","p":"payload","pt":"msg","to":"{}","tot":"json"},{"t":"set","p":"payload.url","pt":"msg","to":"req.url","tot":"msg"},{"t":"set","p":"payload.method","pt":"msg","to":"req.method","tot":"msg"},{"t":"set","p":"payload.headers","pt":"msg","to":"req.headers","tot":"msg"},{"t":"set","p":"payload.params","pt":"msg","to":"req.params","tot":"msg"},{"t":"set","p":"payload.query","pt":"msg","to":"req.query","tot":"msg"},{"t":"set","p":"payload.body","pt":"msg","to":"req.body","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":500,"y":240,"wires":[["a37c0c67.348ab"]]},{"id":"e1b8582b.f74b88","type":"http response","z":"19c7ab5e.875675","name":"","statusCode":"","headers":{},"x":830,"y":380,"wires":[]},{"id":"ff221cca.e4a","type":"change","z":"19c7ab5e.875675","name":"","rules":[{"t":"set","p":"payload","pt":"msg","to":"*[type=\"OpcUa-Endpoint\"]","tot":"jsonata"}],"action":"","property":"","from":"","to":"","reg":false,"x":2000,"y":340,"wires":[["302ac308.b8c65c"]]},{"id":"11b94c1f.3455c4","type":"change","z":"19c7ab5e.875675","name":"pre edit","rules":[{"t":"set","p":"old","pt":"msg","to":"*[type=\"OpcUa-Endpoint\"]","tot":"jsonata"},{"t":"set","p":"new","pt":"msg","to":"old","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":2140,"y":240,"wires":[["4697b8c0.bb4278"]]},{"id":"7238fd4.6a2d004","type":"http response","z":"19c7ab5e.875675","name":"","statusCode":"","headers":{},"x":990,"y":280,"wires":[]},{"id":"79c3f6df.38b8b8","type":"switch","z":"19c7ab5e.875675","name":"","property":"statusCode","propertyType":"msg","rules":[{"t":"eq","v":"200","vt":"num"},{"t":"else"}],"checkall":"true","repair":false,"outputs":2,"x":1310,"y":240,"wires":[["17d07a6d.d84ab6"],["585f764e.2600d8"]]},{"id":"585f764e.2600d8","type":"http response","z":"19c7ab5e.875675","name":"","statusCode":"","headers":{},"x":1450,"y":280,"wires":[]},{"id":"2a1da217.d8470e","type":"switch","z":"19c7ab5e.875675","name":"","property":"statusCode","propertyType":"msg","rules":[{"t":"eq","v":"200","vt":"num"},{"t":"else"}],"checkall":"true","repair":false,"outputs":2,"x":1990,"y":240,"wires":[["11b94c1f.3455c4"],["e3710722.846398"]]},{"id":"e3710722.846398","type":"http response","z":"19c7ab5e.875675","name":"","statusCode":"","headers":{},"x":2130,"y":280,"wires":[]},{"id":"1a3e57a7.8aedd8","type":"function","z":"19c7ab5e.875675","name":"update flows","func":"const http = global.get('https');\nconst data = JSON.stringify(msg.payload);\nconst options = {\n  hostname: 'localhost',\n  port: 1880,\n  path: '/flows',\n  method: 'POST',\n  headers: {\n    'Content-Type': 'application/json',\n    'Content-Length': data.length,\n    'Authorization': 'Bearer '+msg.accessToken\n  },\n  rejectUnauthorized: false\n};\nconst req = http.request(options);\nreq.write(data);\nreq.end();\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":2610,"y":240,"wires":[["42663c86.adf884"]]},{"id":"dec13ea.38937c","type":"switch","z":"19c7ab5e.875675","name":"","property":"statusCode","propertyType":"msg","rules":[{"t":"eq","v":"200","vt":"num"},{"t":"else"}],"checkall":"true","repair":false,"outputs":2,"x":1150,"y":340,"wires":[["5a68de68.1a80c"],["a499cd66.f26bb"]]},{"id":"a499cd66.f26bb","type":"http response","z":"19c7ab5e.875675","name":"","statusCode":"","headers":{},"x":1290,"y":380,"wires":[]},{"id":"709fc9b4.63e788","type":"switch","z":"19c7ab5e.875675","name":"","property":"statusCode","propertyType":"msg","rules":[{"t":"eq","v":"200","vt":"num"},{"t":"else"}],"checkall":"true","repair":false,"outputs":2,"x":1830,"y":340,"wires":[["ff221cca.e4a"],["d6172404.4c7e68"]]},{"id":"d6172404.4c7e68","type":"http response","z":"19c7ab5e.875675","name":"","statusCode":"","headers":{},"x":1970,"y":380,"wires":[]},{"id":"f08062ac.21387","type":"change","z":"19c7ab5e.875675","name":"status","rules":[{"t":"set","p":"payload","pt":"msg","to":"{}","tot":"json"},{"t":"set","p":"payload.text","pt":"msg","to":"\"endpoint \" & property & \": \" & value","tot":"jsonata"},{"t":"set","p":"payload.shape","pt":"msg","to":"dot","tot":"str"},{"t":"set","p":"payload.fill","pt":"msg","to":"grey","tot":"str"}],"action":"","property":"","from":"","to":"","reg":false,"x":3170,"y":300,"wires":[[]]},{"id":"4697b8c0.bb4278","type":"function","z":"19c7ab5e.875675","name":"edit","func":"if([\"login\"].includes(msg.property)) msg[\"new\"][msg.property] = (msg.value === 'true');\nelse msg[\"new\"][msg.property] = msg.value;\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":2290,"y":240,"wires":[["f5495a86.c86e88"]]},{"id":"f5495a86.c86e88","type":"change","z":"19c7ab5e.875675","name":"post edit","rules":[{"t":"set","p":"payload","pt":"msg","to":"$eval($replace($string(payload),$string(old),$string(new)))","tot":"jsonata"}],"action":"","property":"","from":"","to":"","reg":false,"x":2440,"y":240,"wires":[["1a3e57a7.8aedd8"]]},{"id":"302ac308.b8c65c","type":"function","z":"19c7ab5e.875675","name":"get","func":"msg.payload = msg.payload[msg.property];\nif(msg.payload === true) msg.payload = \"true\";\nif(msg.payload === false) msg.payload = \"false\";\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":2170,"y":340,"wires":[["7b5fa476.51095c"]]},{"id":"88e21160.eb7b7","type":"OpcUa-Client","z":"19c7ab5e.875675","endpoint":"b7aa8d43.59b97","action":"read","deadbandtype":"a","deadbandvalue":1,"time":10,"timeUnit":"s","certificate":"n","localfile":"","localkeyfile":"","securitymode":"None","securitypolicy":"None","name":"opcuac","x":300,"y":460,"wires":[["35032696.c032ca"]]},{"id":"13e50a7.f22caf6","type":"OpcUa-Browser","z":"e2448208.9f92f","endpoint":"f8430adc.f6c448","item":"","datatype":"","topic":"","items":[],"name":"opcuab","x":330,"y":460,"wires":[["27c75b44.fbcaa4"]]},{"id":"fc441026.5b48c","type":"function","z":"e2448208.9f92f","name":"parse","func":"try { \n    if( \"object\" === typeof JSON.parse(msg.payload) ) {\n        msg = JSON.parse(msg.payload); \n    }\n} \ncatch(e) {} \nfinally { return msg; }","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":150,"y":460,"wires":[["13e50a7.f22caf6"]]},{"id":"1a127c46.998444","type":"http in","z":"e2448208.9f92f","name":"PUT property","url":"/opcuab/:property","method":"put","upload":false,"swaggerDoc":"","x":90,"y":40,"wires":[["b01dcc78.a3432"]]},{"id":"cd9e8e57.c383a","type":"change","z":"e2448208.9f92f","name":"","rules":[{"t":"set","p":"payload","pt":"msg","to":"value","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":2720,"y":40,"wires":[["60dad415.250f9c"]]},{"id":"1dd1eb95.9d12f4","type":"http in","z":"e2448208.9f92f","name":"GET property","url":"/opcuab/:property","method":"get","upload":false,"swaggerDoc":"","x":90,"y":140,"wires":[["13d2d933.882b97"]]},{"id":"56e72b0d.f966a4","type":"http response","z":"e2448208.9f92f","name":"","statusCode":"","headers":{},"x":2430,"y":140,"wires":[]},{"id":"dad31123.f1155","type":"change","z":"e2448208.9f92f","name":"","rules":[{"t":"set","p":"headers","pt":"msg","to":"{\"Content-Type\":\"text/plain\"}","tot":"json"}],"action":"","property":"","from":"","to":"","reg":false,"x":2260,"y":140,"wires":[["56e72b0d.f966a4"]]},{"id":"b01dcc78.a3432","type":"change","z":"e2448208.9f92f","name":"get inputs","rules":[{"t":"set","p":"value","pt":"msg","to":"payload","tot":"msg"},{"t":"set","p":"property","pt":"msg","to":"req.params.property","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":240,"y":40,"wires":[["c7ca160a.bae8e8"]]},{"id":"9f1451ec.165fa","type":"http request","z":"e2448208.9f92f","name":"get flows","method":"GET","ret":"obj","paytoqs":"ignore","url":"https://localhost:1880/flows","tls":"b1a419c1.609c29","persist":false,"proxy":"","authType":"","x":1760,"y":40,"wires":[["42715ec7.2a0f4"]]},{"id":"f58c45b5.1612b8","type":"http response","z":"e2448208.9f92f","name":"","statusCode":"","headers":{},"x":3090,"y":40,"wires":[]},{"id":"60dad415.250f9c","type":"change","z":"e2448208.9f92f","name":"","rules":[{"t":"set","p":"headers","pt":"msg","to":"{\"Content-Type\":\"text/plain\"}","tot":"json"}],"action":"","property":"","from":"","to":"","reg":false,"x":2920,"y":40,"wires":[["f58c45b5.1612b8","f936895e.e29a88"]]},{"id":"588fbf9c.5a395","type":"http request","z":"e2448208.9f92f","name":"get flows","method":"GET","ret":"obj","paytoqs":"ignore","url":"https://localhost:1880/flows","tls":"b1a419c1.609c29","persist":false,"proxy":"","authType":"","x":1600,"y":140,"wires":[["404ff542.61c87c"]]},{"id":"b4ccfd19.7e485","type":"http request","z":"e2448208.9f92f","name":"auth","method":"POST","ret":"obj","paytoqs":"ignore","url":"https://localhost:1880/auth/token","tls":"b1a419c1.609c29","persist":false,"proxy":"","authType":"","x":1090,"y":40,"wires":[["7b785e6.979b0a"]]},{"id":"ae2d2685.2df6e8","type":"change","z":"e2448208.9f92f","name":"auth payload","rules":[{"t":"set","p":"payload","pt":"msg","to":"{}","tot":"json"},{"t":"set","p":"payload.client_id","pt":"msg","to":"node-red-editor","tot":"str"},{"t":"set","p":"payload.grant_type","pt":"msg","to":"password","tot":"str"},{"t":"set","p":"payload.scope","pt":"msg","to":"","tot":"str"},{"t":"set","p":"payload.username","pt":"msg","to":"NRADM_USER","tot":"env"},{"t":"set","p":"payload.password","pt":"msg","to":"NRADM_PASS","tot":"env"}],"action":"","property":"","from":"","to":"","reg":false,"x":930,"y":40,"wires":[["b4ccfd19.7e485"]]},{"id":"903c9b16.2a5f08","type":"change","z":"e2448208.9f92f","name":"","rules":[{"t":"set","p":"accessToken","pt":"msg","to":"payload.access_token","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":1420,"y":40,"wires":[["8a6e0169.74d9a"]]},{"id":"8a6e0169.74d9a","type":"change","z":"e2448208.9f92f","name":"bearer","rules":[{"t":"set","p":"headers","pt":"msg","to":"{}","tot":"json"},{"t":"set","p":"headers.authorization","pt":"msg","to":"\"Bearer \" & msg.accessToken","tot":"jsonata"}],"action":"","property":"","from":"","to":"","reg":false,"x":1610,"y":40,"wires":[["9f1451ec.165fa"]]},{"id":"661264f9.1bd4ac","type":"http request","z":"e2448208.9f92f","name":"auth","method":"POST","ret":"obj","paytoqs":"ignore","url":"https://localhost:1880/auth/token","tls":"b1a419c1.609c29","persist":false,"proxy":"","authType":"","x":930,"y":140,"wires":[["68e2e1d2.b42db"]]},{"id":"abd8628f.9d0a1","type":"change","z":"e2448208.9f92f","name":"auth payload","rules":[{"t":"set","p":"payload.client_id","pt":"msg","to":"node-red-editor","tot":"str"},{"t":"set","p":"payload.grant_type","pt":"msg","to":"password","tot":"str"},{"t":"set","p":"payload.scope","pt":"msg","to":"","tot":"str"},{"t":"set","p":"payload.username","pt":"msg","to":"NRADM_USER","tot":"env"},{"t":"set","p":"payload.password","pt":"msg","to":"NRADM_PASS","tot":"env"}],"action":"","property":"","from":"","to":"","reg":false,"x":770,"y":140,"wires":[["661264f9.1bd4ac"]]},{"id":"e386c05c.b5bb","type":"change","z":"e2448208.9f92f","name":"","rules":[{"t":"set","p":"accessToken","pt":"msg","to":"payload.access_token","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":1260,"y":140,"wires":[["4fd63e0f.c19b5"]]},{"id":"4fd63e0f.c19b5","type":"change","z":"e2448208.9f92f","name":"bearer","rules":[{"t":"set","p":"headers","pt":"msg","to":"{}","tot":"json"},{"t":"set","p":"headers.authorization","pt":"msg","to":"\"Bearer \" & msg.accessToken","tot":"jsonata"}],"action":"","property":"","from":"","to":"","reg":false,"x":1450,"y":140,"wires":[["588fbf9c.5a395"]]},{"id":"6a7e2d8c.f28d94","type":"http request","z":"e2448208.9f92f","name":"","method":"POST","ret":"obj","paytoqs":"ignore","url":"${CFG_ACL_ENDP}","tls":"51b09598.a1114d","persist":false,"proxy":"","authType":"","x":610,"y":40,"wires":[["7665eaa8.2571e4"]]},{"id":"7665eaa8.2571e4","type":"switch","z":"e2448208.9f92f","name":"","property":"statusCode","propertyType":"msg","rules":[{"t":"eq","v":"200","vt":"num"},{"t":"else"}],"checkall":"true","repair":false,"outputs":2,"x":770,"y":40,"wires":[["ae2d2685.2df6e8"],["cda036c9.77fb38"]]},{"id":"5bc69490.5ef4cc","type":"http request","z":"e2448208.9f92f","name":"","method":"POST","ret":"obj","paytoqs":"ignore","url":"${CFG_ACL_ENDP}","tls":"51b09598.a1114d","persist":false,"proxy":"","authType":"","x":450,"y":140,"wires":[["d159f7fa.23e428"]]},{"id":"d159f7fa.23e428","type":"switch","z":"e2448208.9f92f","name":"","property":"statusCode","propertyType":"msg","rules":[{"t":"eq","v":"200","vt":"num"},{"t":"else"}],"checkall":"true","repair":false,"outputs":2,"x":610,"y":140,"wires":[["abd8628f.9d0a1"],["de924015.3737e"]]},{"id":"13d2d933.882b97","type":"change","z":"e2448208.9f92f","name":"acl req payload","rules":[{"t":"set","p":"headers","pt":"msg","to":"{}","tot":"json"},{"t":"set","p":"payload","pt":"msg","to":"{}","tot":"json"},{"t":"set","p":"payload.url","pt":"msg","to":"req.url","tot":"msg"},{"t":"set","p":"payload.method","pt":"msg","to":"req.method","tot":"msg"},{"t":"set","p":"payload.headers","pt":"msg","to":"req.headers","tot":"msg"},{"t":"set","p":"payload.params","pt":"msg","to":"req.params","tot":"msg"},{"t":"set","p":"payload.query","pt":"msg","to":"req.query","tot":"msg"},{"t":"set","p":"payload.body","pt":"msg","to":"req.body","tot":"msg"},{"t":"set","p":"property","pt":"msg","to":"req.params.property","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":260,"y":140,"wires":[["5bc69490.5ef4cc"]]},{"id":"c7ca160a.bae8e8","type":"change","z":"e2448208.9f92f","name":"acl req payload","rules":[{"t":"set","p":"headers","pt":"msg","to":"{}","tot":"json"},{"t":"set","p":"payload","pt":"msg","to":"{}","tot":"json"},{"t":"set","p":"payload.url","pt":"msg","to":"req.url","tot":"msg"},{"t":"set","p":"payload.method","pt":"msg","to":"req.method","tot":"msg"},{"t":"set","p":"payload.headers","pt":"msg","to":"req.headers","tot":"msg"},{"t":"set","p":"payload.params","pt":"msg","to":"req.params","tot":"msg"},{"t":"set","p":"payload.query","pt":"msg","to":"req.query","tot":"msg"},{"t":"set","p":"payload.body","pt":"msg","to":"req.body","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":420,"y":40,"wires":[["6a7e2d8c.f28d94"]]},{"id":"de924015.3737e","type":"http response","z":"e2448208.9f92f","name":"","statusCode":"","headers":{},"x":750,"y":180,"wires":[]},{"id":"91dacf11.73505","type":"change","z":"e2448208.9f92f","name":"","rules":[{"t":"set","p":"payload","pt":"msg","to":"*[name = \"opcuab\" and type=\"OpcUa-Browser\"]","tot":"jsonata"}],"action":"","property":"","from":"","to":"","reg":false,"x":1920,"y":140,"wires":[["a23fa49e.04fec8"]]},{"id":"38d860ef.e8b87","type":"change","z":"e2448208.9f92f","name":"pre edit","rules":[{"t":"set","p":"old","pt":"msg","to":"*[name = \"opcuab\" and type=\"OpcUa-Browser\"]","tot":"jsonata"},{"t":"set","p":"new","pt":"msg","to":"old","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":2060,"y":40,"wires":[["3cfc6da8.7f5d62"]]},{"id":"cda036c9.77fb38","type":"http response","z":"e2448208.9f92f","name":"","statusCode":"","headers":{},"x":910,"y":80,"wires":[]},{"id":"7b785e6.979b0a","type":"switch","z":"e2448208.9f92f","name":"","property":"statusCode","propertyType":"msg","rules":[{"t":"eq","v":"200","vt":"num"},{"t":"else"}],"checkall":"true","repair":false,"outputs":2,"x":1230,"y":40,"wires":[["903c9b16.2a5f08"],["26f08bda.a7cb64"]]},{"id":"26f08bda.a7cb64","type":"http response","z":"e2448208.9f92f","name":"","statusCode":"","headers":{},"x":1370,"y":80,"wires":[]},{"id":"42715ec7.2a0f4","type":"switch","z":"e2448208.9f92f","name":"","property":"statusCode","propertyType":"msg","rules":[{"t":"eq","v":"200","vt":"num"},{"t":"else"}],"checkall":"true","repair":false,"outputs":2,"x":1910,"y":40,"wires":[["38d860ef.e8b87"],["136c2cc.6d143d3"]]},{"id":"136c2cc.6d143d3","type":"http response","z":"e2448208.9f92f","name":"","statusCode":"","headers":{},"x":2050,"y":80,"wires":[]},{"id":"80daeb87.b9d168","type":"function","z":"e2448208.9f92f","name":"update flows","func":"const http = global.get('https');\nconst data = JSON.stringify(msg.payload);\nconst options = {\n  hostname: 'localhost',\n  port: 1880,\n  path: '/flows',\n  method: 'POST',\n  headers: {\n    'Content-Type': 'application/json',\n    'Content-Length': data.length,\n    'Authorization': 'Bearer '+msg.accessToken\n  },\n  rejectUnauthorized: false\n};\nconst req = http.request(options);\nreq.write(data);\nreq.end();\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":2530,"y":40,"wires":[["cd9e8e57.c383a"]]},{"id":"68e2e1d2.b42db","type":"switch","z":"e2448208.9f92f","name":"","property":"statusCode","propertyType":"msg","rules":[{"t":"eq","v":"200","vt":"num"},{"t":"else"}],"checkall":"true","repair":false,"outputs":2,"x":1070,"y":140,"wires":[["e386c05c.b5bb"],["887c68c0.ffb0b8"]]},{"id":"887c68c0.ffb0b8","type":"http response","z":"e2448208.9f92f","name":"","statusCode":"","headers":{},"x":1210,"y":180,"wires":[]},{"id":"404ff542.61c87c","type":"switch","z":"e2448208.9f92f","name":"","property":"statusCode","propertyType":"msg","rules":[{"t":"eq","v":"200","vt":"num"},{"t":"else"}],"checkall":"true","repair":false,"outputs":2,"x":1750,"y":140,"wires":[["91dacf11.73505"],["1614bfbd.3877a"]]},{"id":"1614bfbd.3877a","type":"http response","z":"e2448208.9f92f","name":"","statusCode":"","headers":{},"x":1890,"y":180,"wires":[]},{"id":"f936895e.e29a88","type":"change","z":"e2448208.9f92f","name":"status","rules":[{"t":"set","p":"payload","pt":"msg","to":"{}","tot":"json"},{"t":"set","p":"payload.text","pt":"msg","to":"property & \": \" & value","tot":"jsonata"},{"t":"set","p":"payload.shape","pt":"msg","to":"dot","tot":"str"},{"t":"set","p":"payload.fill","pt":"msg","to":"grey","tot":"str"}],"action":"","property":"","from":"","to":"","reg":false,"x":3090,"y":100,"wires":[[]]},{"id":"3cfc6da8.7f5d62","type":"function","z":"e2448208.9f92f","name":"edit","func":"if([\"x\",\"y\"].includes(msg.property)) msg[\"new\"][msg.property] = parseInt(msg.value);\nelse msg[\"new\"][msg.property] = msg.value;\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":2210,"y":40,"wires":[["45ec8b01.062d94"]]},{"id":"45ec8b01.062d94","type":"change","z":"e2448208.9f92f","name":"post edit","rules":[{"t":"set","p":"payload","pt":"msg","to":"$eval($replace($string(payload),$string(old),$string(new)))","tot":"jsonata"}],"action":"","property":"","from":"","to":"","reg":false,"x":2360,"y":40,"wires":[["80daeb87.b9d168"]]},{"id":"a23fa49e.04fec8","type":"function","z":"e2448208.9f92f","name":"get","func":"msg.payload = msg.payload[msg.property];\nif(msg.payload === true) msg.payload = \"true\";\nif(msg.payload === false) msg.payload = \"false\";\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":2090,"y":140,"wires":[["dad31123.f1155"]]},{"id":"27e9743c.75e9bc","type":"change","z":"e2448208.9f92f","name":"status input","rules":[{"t":"set","p":"input","pt":"msg","to":"payload","tot":"msg"},{"t":"set","p":"payload","pt":"msg","to":"{}","tot":"json"},{"t":"set","p":"payload.text","pt":"msg","to":"\"input: \" & input","tot":"jsonata"},{"t":"set","p":"payload.shape","pt":"msg","to":"ring","tot":"str"},{"t":"set","p":"payload.fill","pt":"msg","to":"green","tot":"str"}],"action":"","property":"","from":"","to":"","reg":false,"x":170,"y":580,"wires":[[]]},{"id":"27c75b44.fbcaa4","type":"change","z":"e2448208.9f92f","name":"status output","rules":[{"t":"set","p":"output","pt":"msg","to":"payload","tot":"msg"},{"t":"set","p":"payload","pt":"msg","to":"{}","tot":"json"},{"t":"set","p":"payload.text","pt":"msg","to":"\"output: \" & output","tot":"jsonata"},{"t":"set","p":"payload.shape","pt":"msg","to":"dot","tot":"str"},{"t":"set","p":"payload.fill","pt":"msg","to":"green","tot":"str"}],"action":"","property":"","from":"","to":"","reg":false,"x":530,"y":520,"wires":[[]]},{"id":"6041bcc1.7ee584","type":"http in","z":"e2448208.9f92f","name":"PUT endpoint property","url":"/opcuab/endpoint/:property","method":"put","upload":false,"swaggerDoc":"","x":120,"y":240,"wires":[["99945ca0.b8ec"]]},{"id":"5047e86.0071318","type":"change","z":"e2448208.9f92f","name":"","rules":[{"t":"set","p":"payload","pt":"msg","to":"value","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":2800,"y":240,"wires":[["1d376e74.00ce32"]]},{"id":"8fc5afd5.70f8b","type":"http in","z":"e2448208.9f92f","name":"GET endpoint property","url":"/opcuab/endpoint/:property","method":"get","upload":false,"swaggerDoc":"","x":120,"y":340,"wires":[["886b2eca.751c5"]]},{"id":"ed2fc0cf.ef79f","type":"http response","z":"e2448208.9f92f","name":"","statusCode":"","headers":{},"x":2510,"y":340,"wires":[]},{"id":"2492b88d.cd3af8","type":"change","z":"e2448208.9f92f","name":"","rules":[{"t":"set","p":"headers","pt":"msg","to":"{\"Content-Type\":\"text/plain\"}","tot":"json"}],"action":"","property":"","from":"","to":"","reg":false,"x":2340,"y":340,"wires":[["ed2fc0cf.ef79f"]]},{"id":"99945ca0.b8ec","type":"change","z":"e2448208.9f92f","name":"get inputs","rules":[{"t":"set","p":"value","pt":"msg","to":"payload","tot":"msg"},{"t":"set","p":"property","pt":"msg","to":"req.params.property","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":320,"y":240,"wires":[["62b372cb.41da8c"]]},{"id":"76e3f598.53ba3c","type":"http request","z":"e2448208.9f92f","name":"get flows","method":"GET","ret":"obj","paytoqs":"ignore","url":"https://localhost:1880/flows","tls":"b1a419c1.609c29","persist":false,"proxy":"","authType":"","x":1840,"y":240,"wires":[["5d565e6d.fa08a"]]},{"id":"525b8b7b.065044","type":"http response","z":"e2448208.9f92f","name":"","statusCode":"","headers":{},"x":3170,"y":240,"wires":[]},{"id":"1d376e74.00ce32","type":"change","z":"e2448208.9f92f","name":"","rules":[{"t":"set","p":"headers","pt":"msg","to":"{\"Content-Type\":\"text/plain\"}","tot":"json"}],"action":"","property":"","from":"","to":"","reg":false,"x":3000,"y":240,"wires":[["525b8b7b.065044","fa7afba1.4d5c38"]]},{"id":"67f0d651.d038f8","type":"http request","z":"e2448208.9f92f","name":"get flows","method":"GET","ret":"obj","paytoqs":"ignore","url":"https://localhost:1880/flows","tls":"b1a419c1.609c29","persist":false,"proxy":"","authType":"","x":1680,"y":340,"wires":[["1137acb9.cbb7e3"]]},{"id":"af719fab.bcc44","type":"http request","z":"e2448208.9f92f","name":"auth","method":"POST","ret":"obj","paytoqs":"ignore","url":"https://localhost:1880/auth/token","tls":"b1a419c1.609c29","persist":false,"proxy":"","authType":"","x":1170,"y":240,"wires":[["3f46562f.36c80a"]]},{"id":"d47db43a.24b598","type":"change","z":"e2448208.9f92f","name":"auth payload","rules":[{"t":"set","p":"payload","pt":"msg","to":"{}","tot":"json"},{"t":"set","p":"payload.client_id","pt":"msg","to":"node-red-editor","tot":"str"},{"t":"set","p":"payload.grant_type","pt":"msg","to":"password","tot":"str"},{"t":"set","p":"payload.scope","pt":"msg","to":"","tot":"str"},{"t":"set","p":"payload.username","pt":"msg","to":"NRADM_USER","tot":"env"},{"t":"set","p":"payload.password","pt":"msg","to":"NRADM_PASS","tot":"env"}],"action":"","property":"","from":"","to":"","reg":false,"x":1010,"y":240,"wires":[["af719fab.bcc44"]]},{"id":"b5b5eb9d.be4588","type":"change","z":"e2448208.9f92f","name":"","rules":[{"t":"set","p":"accessToken","pt":"msg","to":"payload.access_token","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":1500,"y":240,"wires":[["defd6d7e.8b06b"]]},{"id":"defd6d7e.8b06b","type":"change","z":"e2448208.9f92f","name":"bearer","rules":[{"t":"set","p":"headers","pt":"msg","to":"{}","tot":"json"},{"t":"set","p":"headers.authorization","pt":"msg","to":"\"Bearer \" & msg.accessToken","tot":"jsonata"}],"action":"","property":"","from":"","to":"","reg":false,"x":1690,"y":240,"wires":[["76e3f598.53ba3c"]]},{"id":"cc967d4f.f105f","type":"http request","z":"e2448208.9f92f","name":"auth","method":"POST","ret":"obj","paytoqs":"ignore","url":"https://localhost:1880/auth/token","tls":"b1a419c1.609c29","persist":false,"proxy":"","authType":"","x":1010,"y":340,"wires":[["95a65a85.e70678"]]},{"id":"a480576e.321c58","type":"change","z":"e2448208.9f92f","name":"auth payload","rules":[{"t":"set","p":"payload.client_id","pt":"msg","to":"node-red-editor","tot":"str"},{"t":"set","p":"payload.grant_type","pt":"msg","to":"password","tot":"str"},{"t":"set","p":"payload.scope","pt":"msg","to":"","tot":"str"},{"t":"set","p":"payload.username","pt":"msg","to":"NRADM_USER","tot":"env"},{"t":"set","p":"payload.password","pt":"msg","to":"NRADM_PASS","tot":"env"}],"action":"","property":"","from":"","to":"","reg":false,"x":850,"y":340,"wires":[["cc967d4f.f105f"]]},{"id":"249e9499.ec769c","type":"change","z":"e2448208.9f92f","name":"","rules":[{"t":"set","p":"accessToken","pt":"msg","to":"payload.access_token","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":1340,"y":340,"wires":[["51b690b.06ba87"]]},{"id":"51b690b.06ba87","type":"change","z":"e2448208.9f92f","name":"bearer","rules":[{"t":"set","p":"headers","pt":"msg","to":"{}","tot":"json"},{"t":"set","p":"headers.authorization","pt":"msg","to":"\"Bearer \" & msg.accessToken","tot":"jsonata"}],"action":"","property":"","from":"","to":"","reg":false,"x":1530,"y":340,"wires":[["67f0d651.d038f8"]]},{"id":"3cd9f43b.7b58dc","type":"http request","z":"e2448208.9f92f","name":"","method":"POST","ret":"obj","paytoqs":"ignore","url":"${CFG_ACL_ENDP}","tls":"51b09598.a1114d","persist":false,"proxy":"","authType":"","x":690,"y":240,"wires":[["84f97b7a.f2fbc8"]]},{"id":"84f97b7a.f2fbc8","type":"switch","z":"e2448208.9f92f","name":"","property":"statusCode","propertyType":"msg","rules":[{"t":"eq","v":"200","vt":"num"},{"t":"else"}],"checkall":"true","repair":false,"outputs":2,"x":850,"y":240,"wires":[["d47db43a.24b598"],["7e3405cf.49be2c"]]},{"id":"631f83b7.1b81fc","type":"http request","z":"e2448208.9f92f","name":"","method":"POST","ret":"obj","paytoqs":"ignore","url":"${CFG_ACL_ENDP}","tls":"51b09598.a1114d","persist":false,"proxy":"","authType":"","x":530,"y":340,"wires":[["8f8a18d1.499dc8"]]},{"id":"8f8a18d1.499dc8","type":"switch","z":"e2448208.9f92f","name":"","property":"statusCode","propertyType":"msg","rules":[{"t":"eq","v":"200","vt":"num"},{"t":"else"}],"checkall":"true","repair":false,"outputs":2,"x":690,"y":340,"wires":[["a480576e.321c58"],["e2081e11.be66a"]]},{"id":"886b2eca.751c5","type":"change","z":"e2448208.9f92f","name":"acl req payload","rules":[{"t":"set","p":"headers","pt":"msg","to":"{}","tot":"json"},{"t":"set","p":"payload","pt":"msg","to":"{}","tot":"json"},{"t":"set","p":"payload.url","pt":"msg","to":"req.url","tot":"msg"},{"t":"set","p":"payload.method","pt":"msg","to":"req.method","tot":"msg"},{"t":"set","p":"payload.headers","pt":"msg","to":"req.headers","tot":"msg"},{"t":"set","p":"payload.params","pt":"msg","to":"req.params","tot":"msg"},{"t":"set","p":"payload.query","pt":"msg","to":"req.query","tot":"msg"},{"t":"set","p":"payload.body","pt":"msg","to":"req.body","tot":"msg"},{"t":"set","p":"property","pt":"msg","to":"req.params.property","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":340,"y":340,"wires":[["631f83b7.1b81fc"]]},{"id":"62b372cb.41da8c","type":"change","z":"e2448208.9f92f","name":"acl req payload","rules":[{"t":"set","p":"headers","pt":"msg","to":"{}","tot":"json"},{"t":"set","p":"payload","pt":"msg","to":"{}","tot":"json"},{"t":"set","p":"payload.url","pt":"msg","to":"req.url","tot":"msg"},{"t":"set","p":"payload.method","pt":"msg","to":"req.method","tot":"msg"},{"t":"set","p":"payload.headers","pt":"msg","to":"req.headers","tot":"msg"},{"t":"set","p":"payload.params","pt":"msg","to":"req.params","tot":"msg"},{"t":"set","p":"payload.query","pt":"msg","to":"req.query","tot":"msg"},{"t":"set","p":"payload.body","pt":"msg","to":"req.body","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":500,"y":240,"wires":[["3cd9f43b.7b58dc"]]},{"id":"e2081e11.be66a","type":"http response","z":"e2448208.9f92f","name":"","statusCode":"","headers":{},"x":830,"y":380,"wires":[]},{"id":"cf1ef09f.7c995","type":"change","z":"e2448208.9f92f","name":"","rules":[{"t":"set","p":"payload","pt":"msg","to":"*[type=\"OpcUa-Endpoint\"]","tot":"jsonata"}],"action":"","property":"","from":"","to":"","reg":false,"x":2000,"y":340,"wires":[["641f0e86.6c06"]]},{"id":"564940f7.69284","type":"change","z":"e2448208.9f92f","name":"pre edit","rules":[{"t":"set","p":"old","pt":"msg","to":"*[type=\"OpcUa-Endpoint\"]","tot":"jsonata"},{"t":"set","p":"new","pt":"msg","to":"old","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":2140,"y":240,"wires":[["b469ecec.4752c"]]},{"id":"7e3405cf.49be2c","type":"http response","z":"e2448208.9f92f","name":"","statusCode":"","headers":{},"x":990,"y":280,"wires":[]},{"id":"3f46562f.36c80a","type":"switch","z":"e2448208.9f92f","name":"","property":"statusCode","propertyType":"msg","rules":[{"t":"eq","v":"200","vt":"num"},{"t":"else"}],"checkall":"true","repair":false,"outputs":2,"x":1310,"y":240,"wires":[["b5b5eb9d.be4588"],["54bb922c.3f075c"]]},{"id":"54bb922c.3f075c","type":"http response","z":"e2448208.9f92f","name":"","statusCode":"","headers":{},"x":1450,"y":280,"wires":[]},{"id":"5d565e6d.fa08a","type":"switch","z":"e2448208.9f92f","name":"","property":"statusCode","propertyType":"msg","rules":[{"t":"eq","v":"200","vt":"num"},{"t":"else"}],"checkall":"true","repair":false,"outputs":2,"x":1990,"y":240,"wires":[["564940f7.69284"],["2d7e6449.f9db6c"]]},{"id":"2d7e6449.f9db6c","type":"http response","z":"e2448208.9f92f","name":"","statusCode":"","headers":{},"x":2130,"y":280,"wires":[]},{"id":"fa660314.a19c5","type":"function","z":"e2448208.9f92f","name":"update flows","func":"const http = global.get('https');\nconst data = JSON.stringify(msg.payload);\nconst options = {\n  hostname: 'localhost',\n  port: 1880,\n  path: '/flows',\n  method: 'POST',\n  headers: {\n    'Content-Type': 'application/json',\n    'Content-Length': data.length,\n    'Authorization': 'Bearer '+msg.accessToken\n  },\n  rejectUnauthorized: false\n};\nconst req = http.request(options);\nreq.write(data);\nreq.end();\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":2610,"y":240,"wires":[["5047e86.0071318"]]},{"id":"95a65a85.e70678","type":"switch","z":"e2448208.9f92f","name":"","property":"statusCode","propertyType":"msg","rules":[{"t":"eq","v":"200","vt":"num"},{"t":"else"}],"checkall":"true","repair":false,"outputs":2,"x":1150,"y":340,"wires":[["249e9499.ec769c"],["d8ffa76e.a692c8"]]},{"id":"d8ffa76e.a692c8","type":"http response","z":"e2448208.9f92f","name":"","statusCode":"","headers":{},"x":1290,"y":380,"wires":[]},{"id":"1137acb9.cbb7e3","type":"switch","z":"e2448208.9f92f","name":"","property":"statusCode","propertyType":"msg","rules":[{"t":"eq","v":"200","vt":"num"},{"t":"else"}],"checkall":"true","repair":false,"outputs":2,"x":1830,"y":340,"wires":[["cf1ef09f.7c995"],["3beea9e5.119ef6"]]},{"id":"3beea9e5.119ef6","type":"http response","z":"e2448208.9f92f","name":"","statusCode":"","headers":{},"x":1970,"y":380,"wires":[]},{"id":"fa7afba1.4d5c38","type":"change","z":"e2448208.9f92f","name":"status","rules":[{"t":"set","p":"payload","pt":"msg","to":"{}","tot":"json"},{"t":"set","p":"payload.text","pt":"msg","to":"\"endpoint \" & property & \": \" & value","tot":"jsonata"},{"t":"set","p":"payload.shape","pt":"msg","to":"dot","tot":"str"},{"t":"set","p":"payload.fill","pt":"msg","to":"grey","tot":"str"}],"action":"","property":"","from":"","to":"","reg":false,"x":3170,"y":300,"wires":[[]]},{"id":"b469ecec.4752c","type":"function","z":"e2448208.9f92f","name":"edit","func":"if([\"login\"].includes(msg.property)) msg[\"new\"][msg.property] = (msg.value === 'true');\nelse msg[\"new\"][msg.property] = msg.value;\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":2290,"y":240,"wires":[["929ee3b9.8908c"]]},{"id":"929ee3b9.8908c","type":"change","z":"e2448208.9f92f","name":"post edit","rules":[{"t":"set","p":"payload","pt":"msg","to":"$eval($replace($string(payload),$string(old),$string(new)))","tot":"jsonata"}],"action":"","property":"","from":"","to":"","reg":false,"x":2440,"y":240,"wires":[["fa660314.a19c5"]]},{"id":"641f0e86.6c06","type":"function","z":"e2448208.9f92f","name":"get","func":"msg.payload = msg.payload[msg.property];\nif(msg.payload === true) msg.payload = \"true\";\nif(msg.payload === false) msg.payload = \"false\";\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":2170,"y":340,"wires":[["2492b88d.cd3af8"]]},{"id":"65966ad0.c0f5d4","type":"OpcUa-Server","z":"90c296a3.7369d8","port":"53880","name":"opcuas","endpoint":"","users":"users.json","nodeset":"","autoAcceptUnknownCertificate":true,"registerToDiscovery":false,"constructDefaultAddressSpace":true,"allowAnonymous":true,"endpointNone":true,"endpointSign":true,"endpointSignEncrypt":true,"endpointBasic128Rsa15":true,"endpointBasic256":true,"endpointBasic256Sha256":true,"maxNodesPerBrowse":0,"maxNodesPerHistoryReadData":0,"maxNodesPerHistoryReadEvents":0,"maxNodesPerHistoryUpdateData":0,"maxNodesPerRead":0,"maxNodesPerWrite":0,"maxNodesPerMethodCall":0,"maxNodesPerRegisterNodes":0,"maxNodesPerNodeManagement":0,"maxMonitoredItemsPerCall":0,"maxNodesPerHistoryUpdateEvents":0,"maxNodesPerTranslateBrowsePathsToNodeIds":0,"x":300,"y":260,"wires":[["84d829f7.3ad998"]]},{"id":"4274e420.44827c","type":"function","z":"90c296a3.7369d8","name":"parse","func":"try { \n    if( \"object\" === typeof JSON.parse(msg.payload) ) {\n        msg = JSON.parse(msg.payload); \n    }\n} \ncatch(e) {} \nfinally { return msg; }","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":150,"y":260,"wires":[["65966ad0.c0f5d4"]]},{"id":"caf5ea9f.50d438","type":"http in","z":"90c296a3.7369d8","name":"PUT property","url":"/opcuas/:property","method":"put","upload":false,"swaggerDoc":"","x":90,"y":40,"wires":[["2f1b548b.b425ac"]]},{"id":"5a0015a5.a8be8c","type":"change","z":"90c296a3.7369d8","name":"","rules":[{"t":"set","p":"payload","pt":"msg","to":"value","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":2720,"y":40,"wires":[["4272cb41.377044"]]},{"id":"88859a31.57d528","type":"http in","z":"90c296a3.7369d8","name":"GET property","url":"/opcuas/:property","method":"get","upload":false,"swaggerDoc":"","x":90,"y":140,"wires":[["59e101d3.c4c02"]]},{"id":"b59e1ace.825a58","type":"http response","z":"90c296a3.7369d8","name":"","statusCode":"","headers":{},"x":2430,"y":140,"wires":[]},{"id":"dff4dbc5.fe9658","type":"change","z":"90c296a3.7369d8","name":"","rules":[{"t":"set","p":"headers","pt":"msg","to":"{\"Content-Type\":\"text/plain\"}","tot":"json"}],"action":"","property":"","from":"","to":"","reg":false,"x":2260,"y":140,"wires":[["b59e1ace.825a58"]]},{"id":"2f1b548b.b425ac","type":"change","z":"90c296a3.7369d8","name":"get inputs","rules":[{"t":"set","p":"value","pt":"msg","to":"payload","tot":"msg"},{"t":"set","p":"property","pt":"msg","to":"req.params.property","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":240,"y":40,"wires":[["b9862fdf.26f8b"]]},{"id":"cdc7347a.83bf58","type":"http request","z":"90c296a3.7369d8","name":"get flows","method":"GET","ret":"obj","paytoqs":"ignore","url":"https://localhost:1880/flows","tls":"b1a419c1.609c29","persist":false,"proxy":"","authType":"","x":1760,"y":40,"wires":[["ec295945.715c88"]]},{"id":"2f897f9b.7b52e","type":"http response","z":"90c296a3.7369d8","name":"","statusCode":"","headers":{},"x":3090,"y":40,"wires":[]},{"id":"4272cb41.377044","type":"change","z":"90c296a3.7369d8","name":"","rules":[{"t":"set","p":"headers","pt":"msg","to":"{\"Content-Type\":\"text/plain\"}","tot":"json"}],"action":"","property":"","from":"","to":"","reg":false,"x":2920,"y":40,"wires":[["2f897f9b.7b52e","428b2ce9.86ce44"]]},{"id":"ee67c907.4a2e98","type":"http request","z":"90c296a3.7369d8","name":"get flows","method":"GET","ret":"obj","paytoqs":"ignore","url":"https://localhost:1880/flows","tls":"b1a419c1.609c29","persist":false,"proxy":"","authType":"","x":1600,"y":140,"wires":[["a76b23c1.78fc6"]]},{"id":"976dca77.59ce38","type":"http request","z":"90c296a3.7369d8","name":"auth","method":"POST","ret":"obj","paytoqs":"ignore","url":"https://localhost:1880/auth/token","tls":"b1a419c1.609c29","persist":false,"proxy":"","authType":"","x":1090,"y":40,"wires":[["1be59f13.d2b411"]]},{"id":"8f5f67ed.1b5108","type":"change","z":"90c296a3.7369d8","name":"auth payload","rules":[{"t":"set","p":"payload","pt":"msg","to":"{}","tot":"json"},{"t":"set","p":"payload.client_id","pt":"msg","to":"node-red-editor","tot":"str"},{"t":"set","p":"payload.grant_type","pt":"msg","to":"password","tot":"str"},{"t":"set","p":"payload.scope","pt":"msg","to":"","tot":"str"},{"t":"set","p":"payload.username","pt":"msg","to":"NRADM_USER","tot":"env"},{"t":"set","p":"payload.password","pt":"msg","to":"NRADM_PASS","tot":"env"}],"action":"","property":"","from":"","to":"","reg":false,"x":930,"y":40,"wires":[["976dca77.59ce38"]]},{"id":"b394e357.98f1","type":"change","z":"90c296a3.7369d8","name":"","rules":[{"t":"set","p":"accessToken","pt":"msg","to":"payload.access_token","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":1420,"y":40,"wires":[["4c0d20e2.4167"]]},{"id":"4c0d20e2.4167","type":"change","z":"90c296a3.7369d8","name":"bearer","rules":[{"t":"set","p":"headers","pt":"msg","to":"{}","tot":"json"},{"t":"set","p":"headers.authorization","pt":"msg","to":"\"Bearer \" & msg.accessToken","tot":"jsonata"}],"action":"","property":"","from":"","to":"","reg":false,"x":1610,"y":40,"wires":[["cdc7347a.83bf58"]]},{"id":"94f73ad7.481638","type":"http request","z":"90c296a3.7369d8","name":"auth","method":"POST","ret":"obj","paytoqs":"ignore","url":"https://localhost:1880/auth/token","tls":"b1a419c1.609c29","persist":false,"proxy":"","authType":"","x":930,"y":140,"wires":[["4bf15716.d46d68"]]},{"id":"feadb64c.b0d288","type":"change","z":"90c296a3.7369d8","name":"auth payload","rules":[{"t":"set","p":"payload.client_id","pt":"msg","to":"node-red-editor","tot":"str"},{"t":"set","p":"payload.grant_type","pt":"msg","to":"password","tot":"str"},{"t":"set","p":"payload.scope","pt":"msg","to":"","tot":"str"},{"t":"set","p":"payload.username","pt":"msg","to":"NRADM_USER","tot":"env"},{"t":"set","p":"payload.password","pt":"msg","to":"NRADM_PASS","tot":"env"}],"action":"","property":"","from":"","to":"","reg":false,"x":770,"y":140,"wires":[["94f73ad7.481638"]]},{"id":"946a2bfc.ccbab8","type":"change","z":"90c296a3.7369d8","name":"","rules":[{"t":"set","p":"accessToken","pt":"msg","to":"payload.access_token","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":1260,"y":140,"wires":[["4585825f.3ecfcc"]]},{"id":"4585825f.3ecfcc","type":"change","z":"90c296a3.7369d8","name":"bearer","rules":[{"t":"set","p":"headers","pt":"msg","to":"{}","tot":"json"},{"t":"set","p":"headers.authorization","pt":"msg","to":"\"Bearer \" & msg.accessToken","tot":"jsonata"}],"action":"","property":"","from":"","to":"","reg":false,"x":1450,"y":140,"wires":[["ee67c907.4a2e98"]]},{"id":"b49398cb.441f78","type":"http request","z":"90c296a3.7369d8","name":"","method":"POST","ret":"obj","paytoqs":"ignore","url":"${CFG_ACL_ENDP}","tls":"51b09598.a1114d","persist":false,"proxy":"","authType":"","x":610,"y":40,"wires":[["baa26e97.ad76d"]]},{"id":"baa26e97.ad76d","type":"switch","z":"90c296a3.7369d8","name":"","property":"statusCode","propertyType":"msg","rules":[{"t":"eq","v":"200","vt":"num"},{"t":"else"}],"checkall":"true","repair":false,"outputs":2,"x":770,"y":40,"wires":[["8f5f67ed.1b5108"],["b7850d1f.70273"]]},{"id":"bf793362.d20ae","type":"http request","z":"90c296a3.7369d8","name":"","method":"POST","ret":"obj","paytoqs":"ignore","url":"${CFG_ACL_ENDP}","tls":"51b09598.a1114d","persist":false,"proxy":"","authType":"","x":450,"y":140,"wires":[["f173a16.89b306"]]},{"id":"f173a16.89b306","type":"switch","z":"90c296a3.7369d8","name":"","property":"statusCode","propertyType":"msg","rules":[{"t":"eq","v":"200","vt":"num"},{"t":"else"}],"checkall":"true","repair":false,"outputs":2,"x":610,"y":140,"wires":[["feadb64c.b0d288"],["e16cb002.366f7"]]},{"id":"59e101d3.c4c02","type":"change","z":"90c296a3.7369d8","name":"acl req payload","rules":[{"t":"set","p":"headers","pt":"msg","to":"{}","tot":"json"},{"t":"set","p":"payload","pt":"msg","to":"{}","tot":"json"},{"t":"set","p":"payload.url","pt":"msg","to":"req.url","tot":"msg"},{"t":"set","p":"payload.method","pt":"msg","to":"req.method","tot":"msg"},{"t":"set","p":"payload.headers","pt":"msg","to":"req.headers","tot":"msg"},{"t":"set","p":"payload.params","pt":"msg","to":"req.params","tot":"msg"},{"t":"set","p":"payload.query","pt":"msg","to":"req.query","tot":"msg"},{"t":"set","p":"payload.body","pt":"msg","to":"req.body","tot":"msg"},{"t":"set","p":"property","pt":"msg","to":"req.params.property","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":260,"y":140,"wires":[["bf793362.d20ae"]]},{"id":"b9862fdf.26f8b","type":"change","z":"90c296a3.7369d8","name":"acl req payload","rules":[{"t":"set","p":"headers","pt":"msg","to":"{}","tot":"json"},{"t":"set","p":"payload","pt":"msg","to":"{}","tot":"json"},{"t":"set","p":"payload.url","pt":"msg","to":"req.url","tot":"msg"},{"t":"set","p":"payload.method","pt":"msg","to":"req.method","tot":"msg"},{"t":"set","p":"payload.headers","pt":"msg","to":"req.headers","tot":"msg"},{"t":"set","p":"payload.params","pt":"msg","to":"req.params","tot":"msg"},{"t":"set","p":"payload.query","pt":"msg","to":"req.query","tot":"msg"},{"t":"set","p":"payload.body","pt":"msg","to":"req.body","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":420,"y":40,"wires":[["b49398cb.441f78"]]},{"id":"e16cb002.366f7","type":"http response","z":"90c296a3.7369d8","name":"","statusCode":"","headers":{},"x":750,"y":180,"wires":[]},{"id":"1d01508c.bac4df","type":"change","z":"90c296a3.7369d8","name":"","rules":[{"t":"set","p":"payload","pt":"msg","to":"*[name = \"opcuas\" and type=\"OpcUa-Server\"]","tot":"jsonata"}],"action":"","property":"","from":"","to":"","reg":false,"x":1920,"y":140,"wires":[["14db9385.38b51c"]]},{"id":"251797b3.cefa78","type":"change","z":"90c296a3.7369d8","name":"pre edit","rules":[{"t":"set","p":"old","pt":"msg","to":"*[name = \"opcuas\" and type=\"OpcUa-Server\"]","tot":"jsonata"},{"t":"set","p":"new","pt":"msg","to":"old","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":2060,"y":40,"wires":[["f8ac7b9.fae9388"]]},{"id":"b7850d1f.70273","type":"http response","z":"90c296a3.7369d8","name":"","statusCode":"","headers":{},"x":910,"y":80,"wires":[]},{"id":"1be59f13.d2b411","type":"switch","z":"90c296a3.7369d8","name":"","property":"statusCode","propertyType":"msg","rules":[{"t":"eq","v":"200","vt":"num"},{"t":"else"}],"checkall":"true","repair":false,"outputs":2,"x":1230,"y":40,"wires":[["b394e357.98f1"],["556223f2.b06d6c"]]},{"id":"556223f2.b06d6c","type":"http response","z":"90c296a3.7369d8","name":"","statusCode":"","headers":{},"x":1370,"y":80,"wires":[]},{"id":"ec295945.715c88","type":"switch","z":"90c296a3.7369d8","name":"","property":"statusCode","propertyType":"msg","rules":[{"t":"eq","v":"200","vt":"num"},{"t":"else"}],"checkall":"true","repair":false,"outputs":2,"x":1910,"y":40,"wires":[["251797b3.cefa78"],["9ce5624b.bfa36"]]},{"id":"9ce5624b.bfa36","type":"http response","z":"90c296a3.7369d8","name":"","statusCode":"","headers":{},"x":2050,"y":80,"wires":[]},{"id":"5c047a5a.34eda4","type":"function","z":"90c296a3.7369d8","name":"update flows","func":"const http = global.get('https');\nconst data = JSON.stringify(msg.payload);\nconst options = {\n  hostname: 'localhost',\n  port: 1880,\n  path: '/flows',\n  method: 'POST',\n  headers: {\n    'Content-Type': 'application/json',\n    'Content-Length': data.length,\n    'Authorization': 'Bearer '+msg.accessToken\n  },\n  rejectUnauthorized: false\n};\nconst req = http.request(options);\nreq.write(data);\nreq.end();\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":2530,"y":40,"wires":[["5a0015a5.a8be8c"]]},{"id":"4bf15716.d46d68","type":"switch","z":"90c296a3.7369d8","name":"","property":"statusCode","propertyType":"msg","rules":[{"t":"eq","v":"200","vt":"num"},{"t":"else"}],"checkall":"true","repair":false,"outputs":2,"x":1070,"y":140,"wires":[["946a2bfc.ccbab8"],["5654ff2f.f7657"]]},{"id":"5654ff2f.f7657","type":"http response","z":"90c296a3.7369d8","name":"","statusCode":"","headers":{},"x":1210,"y":180,"wires":[]},{"id":"a76b23c1.78fc6","type":"switch","z":"90c296a3.7369d8","name":"","property":"statusCode","propertyType":"msg","rules":[{"t":"eq","v":"200","vt":"num"},{"t":"else"}],"checkall":"true","repair":false,"outputs":2,"x":1750,"y":140,"wires":[["1d01508c.bac4df"],["9184b8c1.e4b478"]]},{"id":"9184b8c1.e4b478","type":"http response","z":"90c296a3.7369d8","name":"","statusCode":"","headers":{},"x":1890,"y":180,"wires":[]},{"id":"428b2ce9.86ce44","type":"change","z":"90c296a3.7369d8","name":"status","rules":[{"t":"set","p":"payload","pt":"msg","to":"{}","tot":"json"},{"t":"set","p":"payload.text","pt":"msg","to":"property & \": \" & value","tot":"jsonata"},{"t":"set","p":"payload.shape","pt":"msg","to":"dot","tot":"str"},{"t":"set","p":"payload.fill","pt":"msg","to":"grey","tot":"str"}],"action":"","property":"","from":"","to":"","reg":false,"x":3090,"y":100,"wires":[[]]},{"id":"f8ac7b9.fae9388","type":"function","z":"90c296a3.7369d8","name":"edit","func":"if([\"maxNodesPerBrowse\",\"maxNodesPerHistoryReadData\",\"maxNodesPerHistoryReadEvents\",\"maxNodesPerHistoryUpdateData\",\"maxNodesPerRead\",\"maxNodesPerWrite\",\"maxNodesPerMethodCall\",\"maxNodesPerRegisterNodes\",\"maxNodesPerNodeManagement\",\"maxMonitoredItemsPerCall\",\"maxNodesPerHistoryUpdateEvents\",\"maxNodesPerTranslateBrowsePathsToNodeIds\"].includes(msg.property)) msg[\"new\"][msg.property] = parseInt(msg.value);\nelse if([\"autoAcceptUnknownCertificate\",\"registerToDiscovery\",\"constructDefaultAddressSpace\",\"allowAnonymous\",\"endpointNone\",\"endpointSign\",\"endpointSignEncrypt\",\"endpointBasic128Rsa15\",\"endpointBasic256\",\"endpointBasic256Sha256\"].includes(msg.property)) msg[\"new\"][msg.property] = (\"true\" === msg.value);\nelse msg[\"new\"][msg.property] = msg.value;\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":2210,"y":40,"wires":[["d977f729.12fdf8"]]},{"id":"d977f729.12fdf8","type":"change","z":"90c296a3.7369d8","name":"post edit","rules":[{"t":"set","p":"payload","pt":"msg","to":"$eval($replace($string(payload),$string(old),$string(new)))","tot":"jsonata"}],"action":"","property":"","from":"","to":"","reg":false,"x":2360,"y":40,"wires":[["5c047a5a.34eda4"]]},{"id":"14db9385.38b51c","type":"function","z":"90c296a3.7369d8","name":"get","func":"msg.payload = msg.payload[msg.property];\nif(msg.payload === true) msg.payload = \"true\";\nif(msg.payload === false) msg.payload = \"false\";\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":2090,"y":140,"wires":[["dff4dbc5.fe9658"]]},{"id":"6b5c5d4e.756204","type":"change","z":"90c296a3.7369d8","name":"status input","rules":[{"t":"set","p":"input","pt":"msg","to":"payload","tot":"msg"},{"t":"set","p":"payload","pt":"msg","to":"{}","tot":"json"},{"t":"set","p":"payload.text","pt":"msg","to":"\"input: \" & input","tot":"jsonata"},{"t":"set","p":"payload.shape","pt":"msg","to":"ring","tot":"str"},{"t":"set","p":"payload.fill","pt":"msg","to":"green","tot":"str"}],"action":"","property":"","from":"","to":"","reg":false,"x":170,"y":380,"wires":[[]]},{"id":"84d829f7.3ad998","type":"change","z":"90c296a3.7369d8","name":"status output","rules":[{"t":"set","p":"output","pt":"msg","to":"payload","tot":"msg"},{"t":"set","p":"payload","pt":"msg","to":"{}","tot":"json"},{"t":"set","p":"payload.text","pt":"msg","to":"\"output: \" & output","tot":"jsonata"},{"t":"set","p":"payload.shape","pt":"msg","to":"dot","tot":"str"},{"t":"set","p":"payload.fill","pt":"msg","to":"green","tot":"str"}],"action":"","property":"","from":"","to":"","reg":false,"x":450,"y":320,"wires":[[]]},{"id":"199aa9c6.ba6356","type":"OpcUa-Event","z":"8c872134.80e4c","root":"i=2253","eventtype":"i=2041","name":"opcuae","x":300,"y":260,"wires":[["eaf9446d.ed0a08"]]},{"id":"dd39e82a.706a38","type":"function","z":"8c872134.80e4c","name":"parse","func":"try { \n    if( \"object\" === typeof JSON.parse(msg.payload) ) {\n        msg = JSON.parse(msg.payload); \n    }\n} \ncatch(e) {} \nfinally { return msg; }","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":150,"y":260,"wires":[["199aa9c6.ba6356"]]},{"id":"fbfeae9.c7c3f5","type":"http in","z":"8c872134.80e4c","name":"PUT property","url":"/opcuae/:property","method":"put","upload":false,"swaggerDoc":"","x":90,"y":40,"wires":[["2e4cdd89.310c52"]]},{"id":"736a5ac.5a65aa4","type":"change","z":"8c872134.80e4c","name":"","rules":[{"t":"set","p":"payload","pt":"msg","to":"value","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":2720,"y":40,"wires":[["ff3adbe5.53b5a8"]]},{"id":"e45911d9.bc5ca","type":"http in","z":"8c872134.80e4c","name":"GET property","url":"/opcuae/:property","method":"get","upload":false,"swaggerDoc":"","x":90,"y":140,"wires":[["1125df6c.cdc351"]]},{"id":"fd72cc3c.3ca0b","type":"http response","z":"8c872134.80e4c","name":"","statusCode":"","headers":{},"x":2430,"y":140,"wires":[]},{"id":"1711c81d.5d20d8","type":"change","z":"8c872134.80e4c","name":"","rules":[{"t":"set","p":"headers","pt":"msg","to":"{\"Content-Type\":\"text/plain\"}","tot":"json"}],"action":"","property":"","from":"","to":"","reg":false,"x":2260,"y":140,"wires":[["fd72cc3c.3ca0b"]]},{"id":"2e4cdd89.310c52","type":"change","z":"8c872134.80e4c","name":"get inputs","rules":[{"t":"set","p":"value","pt":"msg","to":"payload","tot":"msg"},{"t":"set","p":"property","pt":"msg","to":"req.params.property","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":240,"y":40,"wires":[["cca0b3f1.903d6"]]},{"id":"b945ab00.77feb8","type":"http request","z":"8c872134.80e4c","name":"get flows","method":"GET","ret":"obj","paytoqs":"ignore","url":"https://localhost:1880/flows","tls":"b1a419c1.609c29","persist":false,"proxy":"","authType":"","x":1760,"y":40,"wires":[["84c6362c.3b0378"]]},{"id":"b4d60e48.0990b","type":"http response","z":"8c872134.80e4c","name":"","statusCode":"","headers":{},"x":3090,"y":40,"wires":[]},{"id":"ff3adbe5.53b5a8","type":"change","z":"8c872134.80e4c","name":"","rules":[{"t":"set","p":"headers","pt":"msg","to":"{\"Content-Type\":\"text/plain\"}","tot":"json"}],"action":"","property":"","from":"","to":"","reg":false,"x":2920,"y":40,"wires":[["b4d60e48.0990b","51aa5362.23078c"]]},{"id":"3ac57ae3.184f96","type":"http request","z":"8c872134.80e4c","name":"get flows","method":"GET","ret":"obj","paytoqs":"ignore","url":"https://localhost:1880/flows","tls":"b1a419c1.609c29","persist":false,"proxy":"","authType":"","x":1600,"y":140,"wires":[["314ceaae.b86cd6"]]},{"id":"3d4223f2.3e7ddc","type":"http request","z":"8c872134.80e4c","name":"auth","method":"POST","ret":"obj","paytoqs":"ignore","url":"https://localhost:1880/auth/token","tls":"b1a419c1.609c29","persist":false,"proxy":"","authType":"","x":1090,"y":40,"wires":[["5c60432b.71f9dc"]]},{"id":"eacdc3da.aa644","type":"change","z":"8c872134.80e4c","name":"auth payload","rules":[{"t":"set","p":"payload","pt":"msg","to":"{}","tot":"json"},{"t":"set","p":"payload.client_id","pt":"msg","to":"node-red-editor","tot":"str"},{"t":"set","p":"payload.grant_type","pt":"msg","to":"password","tot":"str"},{"t":"set","p":"payload.scope","pt":"msg","to":"","tot":"str"},{"t":"set","p":"payload.username","pt":"msg","to":"NRADM_USER","tot":"env"},{"t":"set","p":"payload.password","pt":"msg","to":"NRADM_PASS","tot":"env"}],"action":"","property":"","from":"","to":"","reg":false,"x":930,"y":40,"wires":[["3d4223f2.3e7ddc"]]},{"id":"5352bf0a.6716f","type":"change","z":"8c872134.80e4c","name":"","rules":[{"t":"set","p":"accessToken","pt":"msg","to":"payload.access_token","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":1420,"y":40,"wires":[["ad7e582a.1571e8"]]},{"id":"ad7e582a.1571e8","type":"change","z":"8c872134.80e4c","name":"bearer","rules":[{"t":"set","p":"headers","pt":"msg","to":"{}","tot":"json"},{"t":"set","p":"headers.authorization","pt":"msg","to":"\"Bearer \" & msg.accessToken","tot":"jsonata"}],"action":"","property":"","from":"","to":"","reg":false,"x":1610,"y":40,"wires":[["b945ab00.77feb8"]]},{"id":"a02098bc.77e0a8","type":"http request","z":"8c872134.80e4c","name":"auth","method":"POST","ret":"obj","paytoqs":"ignore","url":"https://localhost:1880/auth/token","tls":"b1a419c1.609c29","persist":false,"proxy":"","authType":"","x":930,"y":140,"wires":[["452a84c8.d9aa4c"]]},{"id":"42901fa.41be2e","type":"change","z":"8c872134.80e4c","name":"auth payload","rules":[{"t":"set","p":"payload.client_id","pt":"msg","to":"node-red-editor","tot":"str"},{"t":"set","p":"payload.grant_type","pt":"msg","to":"password","tot":"str"},{"t":"set","p":"payload.scope","pt":"msg","to":"","tot":"str"},{"t":"set","p":"payload.username","pt":"msg","to":"NRADM_USER","tot":"env"},{"t":"set","p":"payload.password","pt":"msg","to":"NRADM_PASS","tot":"env"}],"action":"","property":"","from":"","to":"","reg":false,"x":770,"y":140,"wires":[["a02098bc.77e0a8"]]},{"id":"6b1b4712.3d4188","type":"change","z":"8c872134.80e4c","name":"","rules":[{"t":"set","p":"accessToken","pt":"msg","to":"payload.access_token","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":1260,"y":140,"wires":[["3015debf.1f49c2"]]},{"id":"3015debf.1f49c2","type":"change","z":"8c872134.80e4c","name":"bearer","rules":[{"t":"set","p":"headers","pt":"msg","to":"{}","tot":"json"},{"t":"set","p":"headers.authorization","pt":"msg","to":"\"Bearer \" & msg.accessToken","tot":"jsonata"}],"action":"","property":"","from":"","to":"","reg":false,"x":1450,"y":140,"wires":[["3ac57ae3.184f96"]]},{"id":"e8968767.47cff8","type":"http request","z":"8c872134.80e4c","name":"","method":"POST","ret":"obj","paytoqs":"ignore","url":"${CFG_ACL_ENDP}","tls":"51b09598.a1114d","persist":false,"proxy":"","authType":"","x":610,"y":40,"wires":[["6cf35169.73d64"]]},{"id":"6cf35169.73d64","type":"switch","z":"8c872134.80e4c","name":"","property":"statusCode","propertyType":"msg","rules":[{"t":"eq","v":"200","vt":"num"},{"t":"else"}],"checkall":"true","repair":false,"outputs":2,"x":770,"y":40,"wires":[["eacdc3da.aa644"],["2210ab59.f8e814"]]},{"id":"81e1e00b.87067","type":"http request","z":"8c872134.80e4c","name":"","method":"POST","ret":"obj","paytoqs":"ignore","url":"${CFG_ACL_ENDP}","tls":"51b09598.a1114d","persist":false,"proxy":"","authType":"","x":450,"y":140,"wires":[["252b1991.4e9196"]]},{"id":"252b1991.4e9196","type":"switch","z":"8c872134.80e4c","name":"","property":"statusCode","propertyType":"msg","rules":[{"t":"eq","v":"200","vt":"num"},{"t":"else"}],"checkall":"true","repair":false,"outputs":2,"x":610,"y":140,"wires":[["42901fa.41be2e"],["78d6954b.2e57ac"]]},{"id":"1125df6c.cdc351","type":"change","z":"8c872134.80e4c","name":"acl req payload","rules":[{"t":"set","p":"headers","pt":"msg","to":"{}","tot":"json"},{"t":"set","p":"payload","pt":"msg","to":"{}","tot":"json"},{"t":"set","p":"payload.url","pt":"msg","to":"req.url","tot":"msg"},{"t":"set","p":"payload.method","pt":"msg","to":"req.method","tot":"msg"},{"t":"set","p":"payload.headers","pt":"msg","to":"req.headers","tot":"msg"},{"t":"set","p":"payload.params","pt":"msg","to":"req.params","tot":"msg"},{"t":"set","p":"payload.query","pt":"msg","to":"req.query","tot":"msg"},{"t":"set","p":"payload.body","pt":"msg","to":"req.body","tot":"msg"},{"t":"set","p":"property","pt":"msg","to":"req.params.property","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":260,"y":140,"wires":[["81e1e00b.87067"]]},{"id":"cca0b3f1.903d6","type":"change","z":"8c872134.80e4c","name":"acl req payload","rules":[{"t":"set","p":"headers","pt":"msg","to":"{}","tot":"json"},{"t":"set","p":"payload","pt":"msg","to":"{}","tot":"json"},{"t":"set","p":"payload.url","pt":"msg","to":"req.url","tot":"msg"},{"t":"set","p":"payload.method","pt":"msg","to":"req.method","tot":"msg"},{"t":"set","p":"payload.headers","pt":"msg","to":"req.headers","tot":"msg"},{"t":"set","p":"payload.params","pt":"msg","to":"req.params","tot":"msg"},{"t":"set","p":"payload.query","pt":"msg","to":"req.query","tot":"msg"},{"t":"set","p":"payload.body","pt":"msg","to":"req.body","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":420,"y":40,"wires":[["e8968767.47cff8"]]},{"id":"78d6954b.2e57ac","type":"http response","z":"8c872134.80e4c","name":"","statusCode":"","headers":{},"x":750,"y":180,"wires":[]},{"id":"658a31a4.93104","type":"change","z":"8c872134.80e4c","name":"","rules":[{"t":"set","p":"payload","pt":"msg","to":"*[name = \"opcuae\" and type=\"OpcUa-Event\"]","tot":"jsonata"}],"action":"","property":"","from":"","to":"","reg":false,"x":1920,"y":140,"wires":[["c9d2a95.50dc158"]]},{"id":"eb17a1ec.aaffc","type":"change","z":"8c872134.80e4c","name":"pre edit","rules":[{"t":"set","p":"old","pt":"msg","to":"*[name = \"opcuae\" and type=\"OpcUa-Event\"]","tot":"jsonata"},{"t":"set","p":"new","pt":"msg","to":"old","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":2060,"y":40,"wires":[["2d33e15a.5d92be"]]},{"id":"2210ab59.f8e814","type":"http response","z":"8c872134.80e4c","name":"","statusCode":"","headers":{},"x":910,"y":80,"wires":[]},{"id":"5c60432b.71f9dc","type":"switch","z":"8c872134.80e4c","name":"","property":"statusCode","propertyType":"msg","rules":[{"t":"eq","v":"200","vt":"num"},{"t":"else"}],"checkall":"true","repair":false,"outputs":2,"x":1230,"y":40,"wires":[["5352bf0a.6716f"],["cd79d966.44a298"]]},{"id":"cd79d966.44a298","type":"http response","z":"8c872134.80e4c","name":"","statusCode":"","headers":{},"x":1370,"y":80,"wires":[]},{"id":"84c6362c.3b0378","type":"switch","z":"8c872134.80e4c","name":"","property":"statusCode","propertyType":"msg","rules":[{"t":"eq","v":"200","vt":"num"},{"t":"else"}],"checkall":"true","repair":false,"outputs":2,"x":1910,"y":40,"wires":[["eb17a1ec.aaffc"],["ecb80b4a.22c9e8"]]},{"id":"ecb80b4a.22c9e8","type":"http response","z":"8c872134.80e4c","name":"","statusCode":"","headers":{},"x":2050,"y":80,"wires":[]},{"id":"cd9df54b.fa5a58","type":"function","z":"8c872134.80e4c","name":"update flows","func":"const http = global.get('https');\nconst data = JSON.stringify(msg.payload);\nconst options = {\n  hostname: 'localhost',\n  port: 1880,\n  path: '/flows',\n  method: 'POST',\n  headers: {\n    'Content-Type': 'application/json',\n    'Content-Length': data.length,\n    'Authorization': 'Bearer '+msg.accessToken\n  },\n  rejectUnauthorized: false\n};\nconst req = http.request(options);\nreq.write(data);\nreq.end();\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":2530,"y":40,"wires":[["736a5ac.5a65aa4"]]},{"id":"452a84c8.d9aa4c","type":"switch","z":"8c872134.80e4c","name":"","property":"statusCode","propertyType":"msg","rules":[{"t":"eq","v":"200","vt":"num"},{"t":"else"}],"checkall":"true","repair":false,"outputs":2,"x":1070,"y":140,"wires":[["6b1b4712.3d4188"],["22928155.28d6ae"]]},{"id":"22928155.28d6ae","type":"http response","z":"8c872134.80e4c","name":"","statusCode":"","headers":{},"x":1210,"y":180,"wires":[]},{"id":"314ceaae.b86cd6","type":"switch","z":"8c872134.80e4c","name":"","property":"statusCode","propertyType":"msg","rules":[{"t":"eq","v":"200","vt":"num"},{"t":"else"}],"checkall":"true","repair":false,"outputs":2,"x":1750,"y":140,"wires":[["658a31a4.93104"],["d05c9187.358aa"]]},{"id":"d05c9187.358aa","type":"http response","z":"8c872134.80e4c","name":"","statusCode":"","headers":{},"x":1890,"y":180,"wires":[]},{"id":"51aa5362.23078c","type":"change","z":"8c872134.80e4c","name":"status","rules":[{"t":"set","p":"payload","pt":"msg","to":"{}","tot":"json"},{"t":"set","p":"payload.text","pt":"msg","to":"property & \": \" & value","tot":"jsonata"},{"t":"set","p":"payload.shape","pt":"msg","to":"dot","tot":"str"},{"t":"set","p":"payload.fill","pt":"msg","to":"grey","tot":"str"}],"action":"","property":"","from":"","to":"","reg":false,"x":3090,"y":100,"wires":[[]]},{"id":"2d33e15a.5d92be","type":"function","z":"8c872134.80e4c","name":"edit","func":"if([\"x\",\"y\"].includes(msg.property)) msg[\"new\"][msg.property] = parseInt(msg.value);\nelse msg[\"new\"][msg.property] = msg.value;\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":2210,"y":40,"wires":[["6b80542e.c8304c"]]},{"id":"6b80542e.c8304c","type":"change","z":"8c872134.80e4c","name":"post edit","rules":[{"t":"set","p":"payload","pt":"msg","to":"$eval($replace($string(payload),$string(old),$string(new)))","tot":"jsonata"}],"action":"","property":"","from":"","to":"","reg":false,"x":2360,"y":40,"wires":[["cd9df54b.fa5a58"]]},{"id":"c9d2a95.50dc158","type":"function","z":"8c872134.80e4c","name":"get","func":"msg.payload = msg.payload[msg.property];\nif(msg.payload === true) msg.payload = \"true\";\nif(msg.payload === false) msg.payload = \"false\";\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":2090,"y":140,"wires":[["1711c81d.5d20d8"]]},{"id":"d088016f.5a10b","type":"change","z":"8c872134.80e4c","name":"status input","rules":[{"t":"set","p":"input","pt":"msg","to":"payload","tot":"msg"},{"t":"set","p":"payload","pt":"msg","to":"{}","tot":"json"},{"t":"set","p":"payload.text","pt":"msg","to":"\"input: \" & input","tot":"jsonata"},{"t":"set","p":"payload.shape","pt":"msg","to":"ring","tot":"str"},{"t":"set","p":"payload.fill","pt":"msg","to":"green","tot":"str"}],"action":"","property":"","from":"","to":"","reg":false,"x":170,"y":380,"wires":[[]]},{"id":"eaf9446d.ed0a08","type":"change","z":"8c872134.80e4c","name":"status output","rules":[{"t":"set","p":"output","pt":"msg","to":"payload","tot":"msg"},{"t":"set","p":"payload","pt":"msg","to":"{}","tot":"json"},{"t":"set","p":"payload.text","pt":"msg","to":"\"output: \" & output","tot":"jsonata"},{"t":"set","p":"payload.shape","pt":"msg","to":"dot","tot":"str"},{"t":"set","p":"payload.fill","pt":"msg","to":"green","tot":"str"}],"action":"","property":"","from":"","to":"","reg":false,"x":510,"y":320,"wires":[[]]},{"id":"38d1a72f.428328","type":"OpcUa-Method","z":"c654cb89.a3c268","endpoint":"1b177826.9fa7b8","objectId":"","methodId":"","name":"opcuam","inputArguments":[],"arg0name":"","arg0type":"","arg0value":"","arg1name":"","arg1type":"","arg1value":"","arg2name":"","arg2type":"","arg2value":"","x":300,"y":460,"wires":[["9ad2d9ac.ac4758"]]},{"id":"f1e2f5b3.a0bef8","type":"function","z":"c654cb89.a3c268","name":"parse","func":"try { \n    if( \"object\" === typeof JSON.parse(msg.payload) ) {\n        msg = JSON.parse(msg.payload); \n    }\n} \ncatch(e) {} \nfinally { return msg; }","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":150,"y":460,"wires":[["38d1a72f.428328"]]},{"id":"c33a54d6.f81ff8","type":"http in","z":"c654cb89.a3c268","name":"PUT property","url":"/opcuam/:property","method":"put","upload":false,"swaggerDoc":"","x":90,"y":40,"wires":[["6a29a6fd.e2a5c8"]]},{"id":"bcb1811d.15c0c","type":"change","z":"c654cb89.a3c268","name":"","rules":[{"t":"set","p":"payload","pt":"msg","to":"value","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":2720,"y":40,"wires":[["5c25938a.a0f04c"]]},{"id":"6e2a4623.d52db8","type":"http in","z":"c654cb89.a3c268","name":"GET property","url":"/opcuam/:property","method":"get","upload":false,"swaggerDoc":"","x":90,"y":140,"wires":[["97e87931.04c898"]]},{"id":"2e9529f8.ee79f6","type":"http response","z":"c654cb89.a3c268","name":"","statusCode":"","headers":{},"x":2430,"y":140,"wires":[]},{"id":"3a1ae2f6.11400e","type":"change","z":"c654cb89.a3c268","name":"","rules":[{"t":"set","p":"headers","pt":"msg","to":"{\"Content-Type\":\"text/plain\"}","tot":"json"}],"action":"","property":"","from":"","to":"","reg":false,"x":2260,"y":140,"wires":[["2e9529f8.ee79f6"]]},{"id":"6a29a6fd.e2a5c8","type":"change","z":"c654cb89.a3c268","name":"get inputs","rules":[{"t":"set","p":"value","pt":"msg","to":"payload","tot":"msg"},{"t":"set","p":"property","pt":"msg","to":"req.params.property","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":240,"y":40,"wires":[["ec3a2424.e391e8"]]},{"id":"3cb0d0d9.cac8d","type":"http request","z":"c654cb89.a3c268","name":"get flows","method":"GET","ret":"obj","paytoqs":"ignore","url":"https://localhost:1880/flows","tls":"b1a419c1.609c29","persist":false,"proxy":"","authType":"","x":1760,"y":40,"wires":[["3514f378.9bfbbc"]]},{"id":"a46b85e6.414578","type":"http response","z":"c654cb89.a3c268","name":"","statusCode":"","headers":{},"x":3090,"y":40,"wires":[]},{"id":"5c25938a.a0f04c","type":"change","z":"c654cb89.a3c268","name":"","rules":[{"t":"set","p":"headers","pt":"msg","to":"{\"Content-Type\":\"text/plain\"}","tot":"json"}],"action":"","property":"","from":"","to":"","reg":false,"x":2920,"y":40,"wires":[["a46b85e6.414578","48665cc4.463ff4"]]},{"id":"538c9d58.326174","type":"http request","z":"c654cb89.a3c268","name":"get flows","method":"GET","ret":"obj","paytoqs":"ignore","url":"https://localhost:1880/flows","tls":"b1a419c1.609c29","persist":false,"proxy":"","authType":"","x":1600,"y":140,"wires":[["9ff5dae6.af56e8"]]},{"id":"6b20e0c9.a8b2c","type":"http request","z":"c654cb89.a3c268","name":"auth","method":"POST","ret":"obj","paytoqs":"ignore","url":"https://localhost:1880/auth/token","tls":"b1a419c1.609c29","persist":false,"proxy":"","authType":"","x":1090,"y":40,"wires":[["dc9788a1.e08648"]]},{"id":"fe81578c.5beb58","type":"change","z":"c654cb89.a3c268","name":"auth payload","rules":[{"t":"set","p":"payload","pt":"msg","to":"{}","tot":"json"},{"t":"set","p":"payload.client_id","pt":"msg","to":"node-red-editor","tot":"str"},{"t":"set","p":"payload.grant_type","pt":"msg","to":"password","tot":"str"},{"t":"set","p":"payload.scope","pt":"msg","to":"","tot":"str"},{"t":"set","p":"payload.username","pt":"msg","to":"NRADM_USER","tot":"env"},{"t":"set","p":"payload.password","pt":"msg","to":"NRADM_PASS","tot":"env"}],"action":"","property":"","from":"","to":"","reg":false,"x":930,"y":40,"wires":[["6b20e0c9.a8b2c"]]},{"id":"be142257.adabd","type":"change","z":"c654cb89.a3c268","name":"","rules":[{"t":"set","p":"accessToken","pt":"msg","to":"payload.access_token","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":1420,"y":40,"wires":[["a88857d0.917c78"]]},{"id":"a88857d0.917c78","type":"change","z":"c654cb89.a3c268","name":"bearer","rules":[{"t":"set","p":"headers","pt":"msg","to":"{}","tot":"json"},{"t":"set","p":"headers.authorization","pt":"msg","to":"\"Bearer \" & msg.accessToken","tot":"jsonata"}],"action":"","property":"","from":"","to":"","reg":false,"x":1610,"y":40,"wires":[["3cb0d0d9.cac8d"]]},{"id":"ba0e1159.6ad16","type":"http request","z":"c654cb89.a3c268","name":"auth","method":"POST","ret":"obj","paytoqs":"ignore","url":"https://localhost:1880/auth/token","tls":"b1a419c1.609c29","persist":false,"proxy":"","authType":"","x":930,"y":140,"wires":[["3f1be162.3b350e"]]},{"id":"883ad935.f0f2c8","type":"change","z":"c654cb89.a3c268","name":"auth payload","rules":[{"t":"set","p":"payload.client_id","pt":"msg","to":"node-red-editor","tot":"str"},{"t":"set","p":"payload.grant_type","pt":"msg","to":"password","tot":"str"},{"t":"set","p":"payload.scope","pt":"msg","to":"","tot":"str"},{"t":"set","p":"payload.username","pt":"msg","to":"NRADM_USER","tot":"env"},{"t":"set","p":"payload.password","pt":"msg","to":"NRADM_PASS","tot":"env"}],"action":"","property":"","from":"","to":"","reg":false,"x":770,"y":140,"wires":[["ba0e1159.6ad16"]]},{"id":"39d6a618.8b17da","type":"change","z":"c654cb89.a3c268","name":"","rules":[{"t":"set","p":"accessToken","pt":"msg","to":"payload.access_token","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":1260,"y":140,"wires":[["af93243d.4e7498"]]},{"id":"af93243d.4e7498","type":"change","z":"c654cb89.a3c268","name":"bearer","rules":[{"t":"set","p":"headers","pt":"msg","to":"{}","tot":"json"},{"t":"set","p":"headers.authorization","pt":"msg","to":"\"Bearer \" & msg.accessToken","tot":"jsonata"}],"action":"","property":"","from":"","to":"","reg":false,"x":1450,"y":140,"wires":[["538c9d58.326174"]]},{"id":"512c118f.82854","type":"http request","z":"c654cb89.a3c268","name":"","method":"POST","ret":"obj","paytoqs":"ignore","url":"${CFG_ACL_ENDP}","tls":"51b09598.a1114d","persist":false,"proxy":"","authType":"","x":610,"y":40,"wires":[["7ac2df3.1f21e2"]]},{"id":"7ac2df3.1f21e2","type":"switch","z":"c654cb89.a3c268","name":"","property":"statusCode","propertyType":"msg","rules":[{"t":"eq","v":"200","vt":"num"},{"t":"else"}],"checkall":"true","repair":false,"outputs":2,"x":770,"y":40,"wires":[["fe81578c.5beb58"],["fe0d97aa.33a468"]]},{"id":"6613e261.c1d6cc","type":"http request","z":"c654cb89.a3c268","name":"","method":"POST","ret":"obj","paytoqs":"ignore","url":"${CFG_ACL_ENDP}","tls":"51b09598.a1114d","persist":false,"proxy":"","authType":"","x":450,"y":140,"wires":[["69b5c410.aac0bc"]]},{"id":"69b5c410.aac0bc","type":"switch","z":"c654cb89.a3c268","name":"","property":"statusCode","propertyType":"msg","rules":[{"t":"eq","v":"200","vt":"num"},{"t":"else"}],"checkall":"true","repair":false,"outputs":2,"x":610,"y":140,"wires":[["883ad935.f0f2c8"],["d4ddeb5e.4a3948"]]},{"id":"97e87931.04c898","type":"change","z":"c654cb89.a3c268","name":"acl req payload","rules":[{"t":"set","p":"headers","pt":"msg","to":"{}","tot":"json"},{"t":"set","p":"payload","pt":"msg","to":"{}","tot":"json"},{"t":"set","p":"payload.url","pt":"msg","to":"req.url","tot":"msg"},{"t":"set","p":"payload.method","pt":"msg","to":"req.method","tot":"msg"},{"t":"set","p":"payload.headers","pt":"msg","to":"req.headers","tot":"msg"},{"t":"set","p":"payload.params","pt":"msg","to":"req.params","tot":"msg"},{"t":"set","p":"payload.query","pt":"msg","to":"req.query","tot":"msg"},{"t":"set","p":"payload.body","pt":"msg","to":"req.body","tot":"msg"},{"t":"set","p":"property","pt":"msg","to":"req.params.property","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":260,"y":140,"wires":[["6613e261.c1d6cc"]]},{"id":"ec3a2424.e391e8","type":"change","z":"c654cb89.a3c268","name":"acl req payload","rules":[{"t":"set","p":"headers","pt":"msg","to":"{}","tot":"json"},{"t":"set","p":"payload","pt":"msg","to":"{}","tot":"json"},{"t":"set","p":"payload.url","pt":"msg","to":"req.url","tot":"msg"},{"t":"set","p":"payload.method","pt":"msg","to":"req.method","tot":"msg"},{"t":"set","p":"payload.headers","pt":"msg","to":"req.headers","tot":"msg"},{"t":"set","p":"payload.params","pt":"msg","to":"req.params","tot":"msg"},{"t":"set","p":"payload.query","pt":"msg","to":"req.query","tot":"msg"},{"t":"set","p":"payload.body","pt":"msg","to":"req.body","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":420,"y":40,"wires":[["512c118f.82854"]]},{"id":"d4ddeb5e.4a3948","type":"http response","z":"c654cb89.a3c268","name":"","statusCode":"","headers":{},"x":750,"y":180,"wires":[]},{"id":"59518cc4.136e64","type":"change","z":"c654cb89.a3c268","name":"","rules":[{"t":"set","p":"payload","pt":"msg","to":"*[name = \"opcuam\" and type=\"OpcUa-Method\"]","tot":"jsonata"}],"action":"","property":"","from":"","to":"","reg":false,"x":1920,"y":140,"wires":[["5c712e1c.c06ae"]]},{"id":"7244d800.1fa888","type":"change","z":"c654cb89.a3c268","name":"pre edit","rules":[{"t":"set","p":"old","pt":"msg","to":"*[name = \"opcuam\" and type=\"OpcUa-Method\"]","tot":"jsonata"},{"t":"set","p":"new","pt":"msg","to":"old","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":2060,"y":40,"wires":[["775f6313.63a2ec"]]},{"id":"fe0d97aa.33a468","type":"http response","z":"c654cb89.a3c268","name":"","statusCode":"","headers":{},"x":910,"y":80,"wires":[]},{"id":"dc9788a1.e08648","type":"switch","z":"c654cb89.a3c268","name":"","property":"statusCode","propertyType":"msg","rules":[{"t":"eq","v":"200","vt":"num"},{"t":"else"}],"checkall":"true","repair":false,"outputs":2,"x":1230,"y":40,"wires":[["be142257.adabd"],["526bb4e2.91096c"]]},{"id":"526bb4e2.91096c","type":"http response","z":"c654cb89.a3c268","name":"","statusCode":"","headers":{},"x":1370,"y":80,"wires":[]},{"id":"3514f378.9bfbbc","type":"switch","z":"c654cb89.a3c268","name":"","property":"statusCode","propertyType":"msg","rules":[{"t":"eq","v":"200","vt":"num"},{"t":"else"}],"checkall":"true","repair":false,"outputs":2,"x":1910,"y":40,"wires":[["7244d800.1fa888"],["bd7f11b4.434c1"]]},{"id":"bd7f11b4.434c1","type":"http response","z":"c654cb89.a3c268","name":"","statusCode":"","headers":{},"x":2050,"y":80,"wires":[]},{"id":"32d99f76.3199b","type":"function","z":"c654cb89.a3c268","name":"update flows","func":"const http = global.get('https');\nconst data = JSON.stringify(msg.payload);\nconst options = {\n  hostname: 'localhost',\n  port: 1880,\n  path: '/flows',\n  method: 'POST',\n  headers: {\n    'Content-Type': 'application/json',\n    'Content-Length': data.length,\n    'Authorization': 'Bearer '+msg.accessToken\n  },\n  rejectUnauthorized: false\n};\nconst req = http.request(options);\nreq.write(data);\nreq.end();\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":2530,"y":40,"wires":[["bcb1811d.15c0c"]]},{"id":"3f1be162.3b350e","type":"switch","z":"c654cb89.a3c268","name":"","property":"statusCode","propertyType":"msg","rules":[{"t":"eq","v":"200","vt":"num"},{"t":"else"}],"checkall":"true","repair":false,"outputs":2,"x":1070,"y":140,"wires":[["39d6a618.8b17da"],["d3c9ebbc.435c98"]]},{"id":"d3c9ebbc.435c98","type":"http response","z":"c654cb89.a3c268","name":"","statusCode":"","headers":{},"x":1210,"y":180,"wires":[]},{"id":"9ff5dae6.af56e8","type":"switch","z":"c654cb89.a3c268","name":"","property":"statusCode","propertyType":"msg","rules":[{"t":"eq","v":"200","vt":"num"},{"t":"else"}],"checkall":"true","repair":false,"outputs":2,"x":1750,"y":140,"wires":[["59518cc4.136e64"],["b654c1f5.1b586"]]},{"id":"b654c1f5.1b586","type":"http response","z":"c654cb89.a3c268","name":"","statusCode":"","headers":{},"x":1890,"y":180,"wires":[]},{"id":"48665cc4.463ff4","type":"change","z":"c654cb89.a3c268","name":"status","rules":[{"t":"set","p":"payload","pt":"msg","to":"{}","tot":"json"},{"t":"set","p":"payload.text","pt":"msg","to":"property & \": \" & value","tot":"jsonata"},{"t":"set","p":"payload.shape","pt":"msg","to":"dot","tot":"str"},{"t":"set","p":"payload.fill","pt":"msg","to":"grey","tot":"str"}],"action":"","property":"","from":"","to":"","reg":false,"x":3090,"y":100,"wires":[[]]},{"id":"775f6313.63a2ec","type":"function","z":"c654cb89.a3c268","name":"edit","func":"if([\"x\",\"y\"].includes(msg.property)) msg[\"new\"][msg.property] = parseInt(msg.value);\nelse msg[\"new\"][msg.property] = msg.value;\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":2210,"y":40,"wires":[["25200a35.0d34b6"]]},{"id":"25200a35.0d34b6","type":"change","z":"c654cb89.a3c268","name":"post edit","rules":[{"t":"set","p":"payload","pt":"msg","to":"$eval($replace($string(payload),$string(old),$string(new)))","tot":"jsonata"}],"action":"","property":"","from":"","to":"","reg":false,"x":2360,"y":40,"wires":[["32d99f76.3199b"]]},{"id":"5c712e1c.c06ae","type":"function","z":"c654cb89.a3c268","name":"get","func":"msg.payload = msg.payload[msg.property];\nif(msg.payload === true) msg.payload = \"true\";\nif(msg.payload === false) msg.payload = \"false\";\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":2090,"y":140,"wires":[["3a1ae2f6.11400e"]]},{"id":"10805cd4.920823","type":"change","z":"c654cb89.a3c268","name":"status input","rules":[{"t":"set","p":"input","pt":"msg","to":"payload","tot":"msg"},{"t":"set","p":"payload","pt":"msg","to":"{}","tot":"json"},{"t":"set","p":"payload.text","pt":"msg","to":"\"input: \" & input","tot":"jsonata"},{"t":"set","p":"payload.shape","pt":"msg","to":"ring","tot":"str"},{"t":"set","p":"payload.fill","pt":"msg","to":"green","tot":"str"}],"action":"","property":"","from":"","to":"","reg":false,"x":170,"y":580,"wires":[[]]},{"id":"9ad2d9ac.ac4758","type":"change","z":"c654cb89.a3c268","name":"status output","rules":[{"t":"set","p":"output","pt":"msg","to":"payload","tot":"msg"},{"t":"set","p":"payload","pt":"msg","to":"{}","tot":"json"},{"t":"set","p":"payload.text","pt":"msg","to":"\"output: \" & output","tot":"jsonata"},{"t":"set","p":"payload.shape","pt":"msg","to":"dot","tot":"str"},{"t":"set","p":"payload.fill","pt":"msg","to":"green","tot":"str"}],"action":"","property":"","from":"","to":"","reg":false,"x":470,"y":520,"wires":[[]]},{"id":"831a0e13.0e82b","type":"http in","z":"c654cb89.a3c268","name":"PUT endpoint property","url":"/opcuam/endpoint/:property","method":"put","upload":false,"swaggerDoc":"","x":120,"y":240,"wires":[["cb0f354d.928358"]]},{"id":"b481c75a.ddb678","type":"change","z":"c654cb89.a3c268","name":"","rules":[{"t":"set","p":"payload","pt":"msg","to":"value","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":2800,"y":240,"wires":[["62e0ea5b.a4ecb4"]]},{"id":"2e201234.49611e","type":"http in","z":"c654cb89.a3c268","name":"GET endpoint property","url":"/opcuam/endpoint/:property","method":"get","upload":false,"swaggerDoc":"","x":120,"y":340,"wires":[["56789064.34d6b"]]},{"id":"a95bca68.4b48d8","type":"http response","z":"c654cb89.a3c268","name":"","statusCode":"","headers":{},"x":2510,"y":340,"wires":[]},{"id":"c4fa0087.3e3c8","type":"change","z":"c654cb89.a3c268","name":"","rules":[{"t":"set","p":"headers","pt":"msg","to":"{\"Content-Type\":\"text/plain\"}","tot":"json"}],"action":"","property":"","from":"","to":"","reg":false,"x":2340,"y":340,"wires":[["a95bca68.4b48d8"]]},{"id":"cb0f354d.928358","type":"change","z":"c654cb89.a3c268","name":"get inputs","rules":[{"t":"set","p":"value","pt":"msg","to":"payload","tot":"msg"},{"t":"set","p":"property","pt":"msg","to":"req.params.property","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":320,"y":240,"wires":[["44097433.95687c"]]},{"id":"1e970623.a5d13a","type":"http request","z":"c654cb89.a3c268","name":"get flows","method":"GET","ret":"obj","paytoqs":"ignore","url":"https://localhost:1880/flows","tls":"b1a419c1.609c29","persist":false,"proxy":"","authType":"","x":1840,"y":240,"wires":[["6a1cba7f.8b2a94"]]},{"id":"51f42d09.86f524","type":"http response","z":"c654cb89.a3c268","name":"","statusCode":"","headers":{},"x":3170,"y":240,"wires":[]},{"id":"62e0ea5b.a4ecb4","type":"change","z":"c654cb89.a3c268","name":"","rules":[{"t":"set","p":"headers","pt":"msg","to":"{\"Content-Type\":\"text/plain\"}","tot":"json"}],"action":"","property":"","from":"","to":"","reg":false,"x":3000,"y":240,"wires":[["51f42d09.86f524","a2085333.658ab"]]},{"id":"eb3b61b0.74438","type":"http request","z":"c654cb89.a3c268","name":"get flows","method":"GET","ret":"obj","paytoqs":"ignore","url":"https://localhost:1880/flows","tls":"b1a419c1.609c29","persist":false,"proxy":"","authType":"","x":1680,"y":340,"wires":[["d2ccddf8.6297a"]]},{"id":"5003f5b4.60711c","type":"http request","z":"c654cb89.a3c268","name":"auth","method":"POST","ret":"obj","paytoqs":"ignore","url":"https://localhost:1880/auth/token","tls":"b1a419c1.609c29","persist":false,"proxy":"","authType":"","x":1170,"y":240,"wires":[["aaa63dd8.71e9d"]]},{"id":"abeb5021.fb48","type":"change","z":"c654cb89.a3c268","name":"auth payload","rules":[{"t":"set","p":"payload","pt":"msg","to":"{}","tot":"json"},{"t":"set","p":"payload.client_id","pt":"msg","to":"node-red-editor","tot":"str"},{"t":"set","p":"payload.grant_type","pt":"msg","to":"password","tot":"str"},{"t":"set","p":"payload.scope","pt":"msg","to":"","tot":"str"},{"t":"set","p":"payload.username","pt":"msg","to":"NRADM_USER","tot":"env"},{"t":"set","p":"payload.password","pt":"msg","to":"NRADM_PASS","tot":"env"}],"action":"","property":"","from":"","to":"","reg":false,"x":1010,"y":240,"wires":[["5003f5b4.60711c"]]},{"id":"3d7c233a.7fb42c","type":"change","z":"c654cb89.a3c268","name":"","rules":[{"t":"set","p":"accessToken","pt":"msg","to":"payload.access_token","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":1500,"y":240,"wires":[["4ef65557.6cbdfc"]]},{"id":"4ef65557.6cbdfc","type":"change","z":"c654cb89.a3c268","name":"bearer","rules":[{"t":"set","p":"headers","pt":"msg","to":"{}","tot":"json"},{"t":"set","p":"headers.authorization","pt":"msg","to":"\"Bearer \" & msg.accessToken","tot":"jsonata"}],"action":"","property":"","from":"","to":"","reg":false,"x":1690,"y":240,"wires":[["1e970623.a5d13a"]]},{"id":"c804e977.5548a8","type":"http request","z":"c654cb89.a3c268","name":"auth","method":"POST","ret":"obj","paytoqs":"ignore","url":"https://localhost:1880/auth/token","tls":"b1a419c1.609c29","persist":false,"proxy":"","authType":"","x":1010,"y":340,"wires":[["4d6e1a6c.d1f364"]]},{"id":"8fa10413.1855e8","type":"change","z":"c654cb89.a3c268","name":"auth payload","rules":[{"t":"set","p":"payload.client_id","pt":"msg","to":"node-red-editor","tot":"str"},{"t":"set","p":"payload.grant_type","pt":"msg","to":"password","tot":"str"},{"t":"set","p":"payload.scope","pt":"msg","to":"","tot":"str"},{"t":"set","p":"payload.username","pt":"msg","to":"NRADM_USER","tot":"env"},{"t":"set","p":"payload.password","pt":"msg","to":"NRADM_PASS","tot":"env"}],"action":"","property":"","from":"","to":"","reg":false,"x":850,"y":340,"wires":[["c804e977.5548a8"]]},{"id":"11c568e.7213d97","type":"change","z":"c654cb89.a3c268","name":"","rules":[{"t":"set","p":"accessToken","pt":"msg","to":"payload.access_token","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":1340,"y":340,"wires":[["951c4c37.ad979"]]},{"id":"951c4c37.ad979","type":"change","z":"c654cb89.a3c268","name":"bearer","rules":[{"t":"set","p":"headers","pt":"msg","to":"{}","tot":"json"},{"t":"set","p":"headers.authorization","pt":"msg","to":"\"Bearer \" & msg.accessToken","tot":"jsonata"}],"action":"","property":"","from":"","to":"","reg":false,"x":1530,"y":340,"wires":[["eb3b61b0.74438"]]},{"id":"4ce7f22.9790f0c","type":"http request","z":"c654cb89.a3c268","name":"","method":"POST","ret":"obj","paytoqs":"ignore","url":"${CFG_ACL_ENDP}","tls":"51b09598.a1114d","persist":false,"proxy":"","authType":"","x":690,"y":240,"wires":[["62fefde6.f60d34"]]},{"id":"62fefde6.f60d34","type":"switch","z":"c654cb89.a3c268","name":"","property":"statusCode","propertyType":"msg","rules":[{"t":"eq","v":"200","vt":"num"},{"t":"else"}],"checkall":"true","repair":false,"outputs":2,"x":850,"y":240,"wires":[["abeb5021.fb48"],["144e73df.1b3e1c"]]},{"id":"6ca07615.b4ef28","type":"http request","z":"c654cb89.a3c268","name":"","method":"POST","ret":"obj","paytoqs":"ignore","url":"${CFG_ACL_ENDP}","tls":"51b09598.a1114d","persist":false,"proxy":"","authType":"","x":530,"y":340,"wires":[["b1d720b.7ce01e"]]},{"id":"b1d720b.7ce01e","type":"switch","z":"c654cb89.a3c268","name":"","property":"statusCode","propertyType":"msg","rules":[{"t":"eq","v":"200","vt":"num"},{"t":"else"}],"checkall":"true","repair":false,"outputs":2,"x":690,"y":340,"wires":[["8fa10413.1855e8"],["57bac28c.3ea51c"]]},{"id":"56789064.34d6b","type":"change","z":"c654cb89.a3c268","name":"acl req payload","rules":[{"t":"set","p":"headers","pt":"msg","to":"{}","tot":"json"},{"t":"set","p":"payload","pt":"msg","to":"{}","tot":"json"},{"t":"set","p":"payload.url","pt":"msg","to":"req.url","tot":"msg"},{"t":"set","p":"payload.method","pt":"msg","to":"req.method","tot":"msg"},{"t":"set","p":"payload.headers","pt":"msg","to":"req.headers","tot":"msg"},{"t":"set","p":"payload.params","pt":"msg","to":"req.params","tot":"msg"},{"t":"set","p":"payload.query","pt":"msg","to":"req.query","tot":"msg"},{"t":"set","p":"payload.body","pt":"msg","to":"req.body","tot":"msg"},{"t":"set","p":"property","pt":"msg","to":"req.params.property","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":340,"y":340,"wires":[["6ca07615.b4ef28"]]},{"id":"44097433.95687c","type":"change","z":"c654cb89.a3c268","name":"acl req payload","rules":[{"t":"set","p":"headers","pt":"msg","to":"{}","tot":"json"},{"t":"set","p":"payload","pt":"msg","to":"{}","tot":"json"},{"t":"set","p":"payload.url","pt":"msg","to":"req.url","tot":"msg"},{"t":"set","p":"payload.method","pt":"msg","to":"req.method","tot":"msg"},{"t":"set","p":"payload.headers","pt":"msg","to":"req.headers","tot":"msg"},{"t":"set","p":"payload.params","pt":"msg","to":"req.params","tot":"msg"},{"t":"set","p":"payload.query","pt":"msg","to":"req.query","tot":"msg"},{"t":"set","p":"payload.body","pt":"msg","to":"req.body","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":500,"y":240,"wires":[["4ce7f22.9790f0c"]]},{"id":"57bac28c.3ea51c","type":"http response","z":"c654cb89.a3c268","name":"","statusCode":"","headers":{},"x":830,"y":380,"wires":[]},{"id":"a9bfed74.6ee41","type":"change","z":"c654cb89.a3c268","name":"","rules":[{"t":"set","p":"payload","pt":"msg","to":"*[type=\"OpcUa-Endpoint\"]","tot":"jsonata"}],"action":"","property":"","from":"","to":"","reg":false,"x":2000,"y":340,"wires":[["4553a17.ae89b6"]]},{"id":"52e6255a.7404ec","type":"change","z":"c654cb89.a3c268","name":"pre edit","rules":[{"t":"set","p":"old","pt":"msg","to":"*[type=\"OpcUa-Endpoint\"]","tot":"jsonata"},{"t":"set","p":"new","pt":"msg","to":"old","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":2140,"y":240,"wires":[["80b49198.76c6a"]]},{"id":"144e73df.1b3e1c","type":"http response","z":"c654cb89.a3c268","name":"","statusCode":"","headers":{},"x":990,"y":280,"wires":[]},{"id":"aaa63dd8.71e9d","type":"switch","z":"c654cb89.a3c268","name":"","property":"statusCode","propertyType":"msg","rules":[{"t":"eq","v":"200","vt":"num"},{"t":"else"}],"checkall":"true","repair":false,"outputs":2,"x":1310,"y":240,"wires":[["3d7c233a.7fb42c"],["ffc00e82.507fa"]]},{"id":"ffc00e82.507fa","type":"http response","z":"c654cb89.a3c268","name":"","statusCode":"","headers":{},"x":1450,"y":280,"wires":[]},{"id":"6a1cba7f.8b2a94","type":"switch","z":"c654cb89.a3c268","name":"","property":"statusCode","propertyType":"msg","rules":[{"t":"eq","v":"200","vt":"num"},{"t":"else"}],"checkall":"true","repair":false,"outputs":2,"x":1990,"y":240,"wires":[["52e6255a.7404ec"],["4f4d723.4b5d78c"]]},{"id":"4f4d723.4b5d78c","type":"http response","z":"c654cb89.a3c268","name":"","statusCode":"","headers":{},"x":2130,"y":280,"wires":[]},{"id":"7f954023.7a9ed","type":"function","z":"c654cb89.a3c268","name":"update flows","func":"const http = global.get('https');\nconst data = JSON.stringify(msg.payload);\nconst options = {\n  hostname: 'localhost',\n  port: 1880,\n  path: '/flows',\n  method: 'POST',\n  headers: {\n    'Content-Type': 'application/json',\n    'Content-Length': data.length,\n    'Authorization': 'Bearer '+msg.accessToken\n  },\n  rejectUnauthorized: false\n};\nconst req = http.request(options);\nreq.write(data);\nreq.end();\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":2610,"y":240,"wires":[["b481c75a.ddb678"]]},{"id":"4d6e1a6c.d1f364","type":"switch","z":"c654cb89.a3c268","name":"","property":"statusCode","propertyType":"msg","rules":[{"t":"eq","v":"200","vt":"num"},{"t":"else"}],"checkall":"true","repair":false,"outputs":2,"x":1150,"y":340,"wires":[["11c568e.7213d97"],["63b862a3.228a9c"]]},{"id":"63b862a3.228a9c","type":"http response","z":"c654cb89.a3c268","name":"","statusCode":"","headers":{},"x":1290,"y":380,"wires":[]},{"id":"d2ccddf8.6297a","type":"switch","z":"c654cb89.a3c268","name":"","property":"statusCode","propertyType":"msg","rules":[{"t":"eq","v":"200","vt":"num"},{"t":"else"}],"checkall":"true","repair":false,"outputs":2,"x":1830,"y":340,"wires":[["a9bfed74.6ee41"],["e9475ab0.7e3368"]]},{"id":"e9475ab0.7e3368","type":"http response","z":"c654cb89.a3c268","name":"","statusCode":"","headers":{},"x":1970,"y":380,"wires":[]},{"id":"a2085333.658ab","type":"change","z":"c654cb89.a3c268","name":"status","rules":[{"t":"set","p":"payload","pt":"msg","to":"{}","tot":"json"},{"t":"set","p":"payload.text","pt":"msg","to":"\"endpoint \" & property & \": \" & value","tot":"jsonata"},{"t":"set","p":"payload.shape","pt":"msg","to":"dot","tot":"str"},{"t":"set","p":"payload.fill","pt":"msg","to":"grey","tot":"str"}],"action":"","property":"","from":"","to":"","reg":false,"x":3170,"y":300,"wires":[[]]},{"id":"80b49198.76c6a","type":"function","z":"c654cb89.a3c268","name":"edit","func":"if([\"login\"].includes(msg.property)) msg[\"new\"][msg.property] = (msg.value === 'true');\nelse msg[\"new\"][msg.property] = msg.value;\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":2290,"y":240,"wires":[["8fb8c35a.78684"]]},{"id":"8fb8c35a.78684","type":"change","z":"c654cb89.a3c268","name":"post edit","rules":[{"t":"set","p":"payload","pt":"msg","to":"$eval($replace($string(payload),$string(old),$string(new)))","tot":"jsonata"}],"action":"","property":"","from":"","to":"","reg":false,"x":2440,"y":240,"wires":[["7f954023.7a9ed"]]},{"id":"4553a17.ae89b6","type":"function","z":"c654cb89.a3c268","name":"get","func":"msg.payload = msg.payload[msg.property];\nif(msg.payload === true) msg.payload = \"true\";\nif(msg.payload === false) msg.payload = \"false\";\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":2170,"y":340,"wires":[["c4fa0087.3e3c8"]]}]